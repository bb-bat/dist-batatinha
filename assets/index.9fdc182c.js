import{u as o,v as t,w as l,x as fc,y as pc,z as Kh,D as Dn,H as Ic,J as B,K as qr,L as cs,N as Xh,O as Qh,Q as lt,U as Jh,V as Ec,W as Zh,X as Jd,Y as Mt,Z as eg,_ as tg,$ as ng,a0 as In,a1 as En,a2 as Cc,a3 as ei,a4 as Zd,a5 as em,a6 as tm,a7 as rg,a8 as sg,a9 as nm,aa as ag,ab as ig,ac as rm,ad as Ua,ae as sm,af as og,ag as lg,ah as _c,ai as zl,aj as cg,ak as ug,al as dg,am as mg,an as hg,ao as bc,ap as Sc,aq as gg,ar as Ii,as as fg,at as pg,au as Ig,av as Eg,aw as Cg,ax as eu,ay as _g,az as bg,aA as Sg,aB as Ng,aC as ll,aD as cl,aE as ul,aF as Tg}from"./vendor.68137b65.js";import{N as Bs,a as Ur,H as ti,M as Oe,T as Rn,R as ee,b as nt,A as ta,c as bn,G as vg,d as J,D as wg,C as Cn,e as Rg,f as Fe,g as Og,h as Xi,i as _r,j as xr,k as Nc,l as Qi,E as yg,m as tu,n as Hn,o as xa,p as pt,F as Yi,q as Fa,S as ni,r as pa,s as kg,t as am,u as Ga,v as Ag,w as Dg,x as Pg,y as Ji,z as an,B as kr,O as im,V as Ot,I as dl,P as sa,J as Gt,K as Zn,U as Lg,L as Mg,Q as ml,W as om,X as Vr,Y as Ug,Z as xg,_ as Fg,$ as Gg,a0 as Vg,a1 as Bg,a2 as Hg,a3 as Wg,a4 as jg,a5 as qg,a6 as zg,a7 as Yg,a8 as lm,a9 as $g,aa as Kg,ab as Xg,ac as Qg,ad as Jg,ae as Zg,af as ef,ag as tf,ah as nf,ai as rf,aj as sf,ak as af,al as of,am as lf,an as Yl,ao as cf,ap as uf,aq as cm,ar as df,as as mf,at as hf,au as gf,av as ff,aw as pf,ax as If,ay as Ef,az as Cf,aA as _f,aB as bf,aC as Sf,aD as Nf,aE as um,aF as Tf,aG as vf,aH as wf,aI as nu,aJ as Rf,aK as Of,aL as yf,aM as Ho,aN as kf,aO as Af,aP as dm,aQ as Df,aR as Pf,aS as Zi,aT as Kt,aU as ca,aV as mm,aW as hm,aX as Lf,aY as Mf,aZ as Uf,a_ as xf,a$ as Ff,b0 as Gf,b1 as Vf,b2 as Bf,b3 as Wo,b4 as Ea,b5 as gm,b6 as ru,b7 as Hf,b8 as Wf,b9 as jf,ba as qf,bb as zf,bc as Yf,bd as $f,be as Kf,bf as Xf,bg as Qf,bh as Jf,bi as Zf,bj as ep,bk as tp,bl as np,bm as rp,bn as sp,bo as ap,bp as ip,bq as op,br as lp,bs as cp,bt as up,bu as dp,bv as mp,bw as hp,bx as gp,by as fp,bz as pp,bA as Ip,bB as fm,bC as $l,bD as Ep,bE as pm,bF as Cp,bG as _p,bH as bp,bI as Sp,bJ as Np,bK as Tp,bL as vp,bM as wp,bN as Rp,bO as Op,bP as yp,bQ as kp,bR as Ap,bS as Dp,bT as Pp,bU as Lp,bV as Mp,bW as Up,bX as xp,bY as Fp,bZ as Gp,b_ as Vp,b$ as Bp,c0 as Hp,c1 as Wp,c2 as jp,c3 as qp,c4 as zp,c5 as Yp,c6 as $p,c7 as Kp,c8 as Xp,c9 as Qp,ca as Jp,cb as Im,cc as Em,cd as eo,ce as Zp,cf as eI,cg as Va,ch as Cm,ci as rt,cj as tI,ck as nI,cl as rI,cm as sI,cn as aI,co as iI,cp as oI,cq as lI,cr as cI,cs as uI,ct as dI,cu as hl,cv as mI,cw as hI,cx as gI,cy as fI,cz as pI,cA as II,cB as su,cC as EI,cD as CI,cE as Cs,cF as _I,cG as bI,cH as yn,cI as St,cJ as SI,cK as NI,cL as TI,cM as Ei,cN as tr,cO as ve,cP as vI,cQ as Ft,cR as wI,cS as RI,cT as OI,cU as yI,cV as kI,cW as AI,cX as DI,cY as PI,cZ as LI,c_ as MI,c$ as UI,d0 as xI,d1 as FI,d2 as GI,d3 as VI,d4 as BI,d5 as HI,d6 as Kl,d7 as WI,d8 as jI,d9 as qI,da as _m,db as zI,dc as YI,dd as au,de as $I,df as KI,dg as XI,dh as QI,di as Xl,dj as JI,dk as ZI,dl as eE,dm as tE,dn as Ci,dp as iu,dq as nE,dr as rE,ds as sE,dt as aE,du as bm,dv as iE,dw as Sm,dx as oE,dy as Nm,dz as lE,dA as cE,dB as uE,dC as dE,dD as ou,dE as Gn,dF as Tm,dG as Ql,dH as hr,dI as lu,dJ as cu,dK as Nt,dL as es,dM as mE,dN as hE,dO as gE,dP as fE,dQ as gl,dR as pE,dS as uu,dT as du,dU as IE,dV as fl,dW as pl,dX as EE,dY as vm,dZ as CE,d_ as _i,d$ as _E,e0 as wm,e1 as bE,e2 as SE,e3 as NE,e4 as TE,e5 as vE,e6 as wE,e7 as RE,e8 as OE,e9 as Il,ea as yE,eb as kE,ec as AE,ed as DE,ee as PE,ef as LE,eg as Rm,eh as ME,ei as UE,ej as xE,ek as FE,el as GE,em as Ca,en as VE,eo as BE,ep as HE,eq as WE,er as mu,es as jE,et as qE,eu as zE,ev as YE,ew as $E,ex as KE,ey as hu,ez as XE,eA as QE,eB as JE,eC as ZE,eD as eC,eE as tC,eF as nC,eG as rC,eH as sC,eI as aC,eJ as Om,eK as iC,eL as oC,eM as lC,eN as cC,eO as uC,eP as ym,eQ as dC,eR as mC,eS as hC,eT as gC,eU as fC,eV as pC,eW as IC,eX as EC,eY as CC,eZ as _C,e_ as bC,e$ as SC,f0 as NC,f1 as TC,f2 as vC,f3 as wC,f4 as RC,f5 as Tc,f6 as ri,f7 as OC,f8 as El,f9 as yC,fa as gu,fb as kC,fc as AC,fd as ln,fe as DC,ff as PC,fg as LC,fh as MC,fi as UC,fj as xC,fk as FC,fl as GC,fm as VC,fn as BC,fo as HC,fp as WC,fq as jC,fr as qC,fs as zC,ft as YC,fu as km,fv as fu,fw as Am,fx as $C,fy as KC,fz as XC,fA as QC,fB as JC,fC as ZC,fD as e_,fE as t_,fF as n_,fG as nr,fH as r_,fI as s_,fJ as a_,fK as i_,fL as o_,fM as l_,fN as c_,fO as u_,fP as d_,fQ as m_,fR as h_,fS as g_,fT as f_,fU as p_,fV as I_,fW as E_,fX as C_,fY as __,fZ as pu,f_ as b_,f$ as S_,g0 as N_,g1 as T_,g2 as v_,g3 as w_,g4 as bi,g5 as Iu,g6 as R_,g7 as O_,g8 as Si,g9 as Dm,ga as y_,gb as Cl,gc as k_,gd as A_,ge as D_,gf as Pm,gg as P_,gh as L_,gi as M_,gj as U_,gk as x_,gl as F_,gm as G_,gn as V_,go as B_,gp as H_,gq as W_,gr as j_,gs as q_,gt as aa,gu as z_,gv as Eu,gw as Y_,gx as $_,gy as K_,gz as Lm,gA as X_,gB as Q_,gC as J_,gD as Z_,gE as eb,gF as tb,gG as nb,gH as rb,gI as sb,gJ as ab,gK as ib,gL as ob,gM as Mm,gN as lb,gO as Um,gP as cb,gQ as ub,gR as db,gS as mb,gT as hb,gU as yr,gV as _l,gW as gb,gX as fb,gY as Cu,gZ as pb,g_ as Ib,g$ as Eb,h0 as vc,h1 as xm,h2 as er,h3 as Cb,h4 as _b,h5 as bb,h6 as Fm,h7 as Gm,h8 as Sb,h9 as Nb,ha as Tb,hb as Vm,hc as vb,hd as wb,he as Rb,hf as Ob,hg as yb,hh as kb,hi as Ab,hj as Db,hk as Pb,hl as Lb,hm as Mb,hn as Ub,ho as Ni,hp as gt,hq as xb,hr as Fb,hs as bl,ht as _u,hu as Gb,hv as Vb,hw as Bb,hx as Hb,hy as Wb,hz as jb,hA as qb,hB as zb,hC as Yb,hD as $b,hE as Kb,hF as Xb,hG as Qb,hH as Jb,hI as bu,hJ as ir,hK as Ti}from"./nitro-renderer.0658e045.js";(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))r(s);new MutationObserver(s=>{for(const a of s)if(a.type==="childList")for(const c of a.addedNodes)c.tagName==="LINK"&&c.rel==="modulepreload"&&r(c)}).observe(document,{childList:!0,subtree:!0});function n(s){const a={};return s.integrity&&(a.integrity=s.integrity),s.referrerPolicy&&(a.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?a.credentials="include":s.crossOrigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function r(s){if(s.ep)return;s.ep=!0;const a=n(s);fetch(s.href,a)}})();function _e(){return Bs.instance}function It(i){_e().addLinkEventTracker(i)}function kt(){return _e().avatar}function Su(i){return kt().structureData.getPalette(i)}function Nu(i){return kt().structureData.getSetType(i)}function _a(){return _e().cameraManager}function Zb(){return _e().core}function eS(){return Zb().configuration}function Z(i){i=i.startsWith("event:")?i.substring(6):i,_e().createLinkEvent(i)}function Ba(){var i;return(i=_e())==null?void 0:i.communication}function K(i,e=null){return Ur.getValue(i,e)}function Jl(){var i;return(i=Ba())==null?void 0:i.connection}function Bm(){return _e().localization}const ys=i=>{!i||!i.length||(i.startsWith("http")?ti.openWebPage(i):Z(i))};function Et(i){_e().removeLinkEventTracker(i)}function j(){return _e().roomEngine}let Sl=!1,vi=0,wi=0;const Ri=(i,e=1)=>{const n=i.clientX,r=i.clientY;let s=i.type;switch(s===Oe.MOUSE_CLICK&&(vi&&(wi=1,vi>=Date.now()-300&&wi++),vi=Date.now(),wi===2&&(Sl||(s=Oe.DOUBLE_CLICK),wi=0,vi=null)),s){case Oe.MOUSE_CLICK:break;case Oe.DOUBLE_CLICK:break;case Oe.MOUSE_MOVE:Sl=!0;break;case Oe.MOUSE_DOWN:Sl=!1;break;case Oe.MOUSE_UP:break;case Oe.RIGHT_CLICK:break;default:return}j().dispatchMouseEvent(e,n,r,s,i.altKey,i.ctrlKey||i.metaKey,i.shiftKey,!1)};let Nl=!1,Oi=0,yi=0;const ki=(i,e=1,n=!1,r=!1,s=!1,a=!1)=>{let c=0,u=0;i.touches[0]?(c=i.touches[0].clientX,u=i.touches[0].clientY):i.changedTouches[0]&&(c=i.changedTouches[0].clientX,u=i.changedTouches[0].clientY);let d=i.type;switch(n&&(d=Rn.TOUCH_LONG),(d===Oe.MOUSE_CLICK||d===Rn.TOUCH_END)&&(d=Oe.MOUSE_CLICK,Oi&&(yi=1,Oi>=Date.now()-300&&yi++),Oi=Date.now(),yi===2&&(Nl||(d=Oe.DOUBLE_CLICK),yi=0,Oi=null)),d){case Oe.MOUSE_CLICK:break;case Oe.DOUBLE_CLICK:break;case Rn.TOUCH_START:d=Oe.MOUSE_DOWN,Nl=!1;break;case Rn.TOUCH_MOVE:d=Oe.MOUSE_MOVE,Nl=!0;break;case Rn.TOUCH_END:d=Oe.MOUSE_UP;break;case Rn.TOUCH_LONG:d=Oe.MOUSE_DOWN_LONG;break;default:return}d===Rn.TOUCH_START&&j().dispatchMouseEvent(e,c,u,d,r,s,a,!1),j().dispatchMouseEvent(e,c,u,d,r,s,a,!1)};function Yt(i){if(!i||!i.model)return!1;const e=W().userId,n=i.model.getValue(ee.FURNITURE_OWNER_ID);return e===n}function Ha(i,e,n){return i?i.isRoomOwner||i.controllerLevel>=nt.GUEST||W().isModerator||Yt(j().getRoomObject(i.roomId,e,n)):!1}function ks(){return _e().roomSessionManager}function _s(i,e=null){ks().createSession(i,e)}function tS(){const i=As();return i?i.model.getValue(ee.FIGURE_CAN_STAND_UP):ta.POSTURE_STAND}function Tl(){const i=As();if(!i)return!1;const n=i.model.getValue(ee.FIGURE_EFFECT);return!(n===29||n===30||n===185)}function W(){return _e().sessionDataManager}function kn(){return K("hc.disabled",!1)?bn.VIP:W().clubLevel}const Dr=class Dr{};Dr.OKAY=0,Dr.MISSING_OFFER=1,Dr.FURNI_LIMIT_REACHED=2,Dr.NOT_IN_ROOM=3,Dr.NOT_ROOM_OWNER=4,Dr.GUILD_ROOM=5,Dr.VISITORS_IN_ROOM=6;let Ar=Dr;class nS{constructor(e,n,r){this._depth=0,this._localization="",this._pageId=-1,this._pageName="",this._iconId=0,this._depth=n,this._parent=r,this._localization=e.localization,this._pageId=e.pageId,this._pageName=e.pageName,this._iconId=e.icon,this._children=[],this._offerIds=e.offerIds,this._isVisible=e.visible,this._isActive=!1,this._isOpen=!1}activate(){this._isActive=!0}deactivate(){this._isActive=!1}open(){this._isOpen=!0}close(){this._isOpen=!1}addChild(e){e&&this._children.push(e)}get depth(){return this._depth}get isBranch(){return this._children.length>0}get isLeaf(){return this._children.length===0}get localization(){return this._localization}get pageId(){return this._pageId}get pageName(){return this._pageName}get iconId(){return this._iconId}get children(){return this._children}get offerIds(){return this._offerIds}get parent(){return this._parent}get isVisible(){return this._isVisible}get isActive(){return this._isActive}get isOpen(){return this._isOpen}}const Io=class Io{constructor(e,n,r,s,a,c=-1){this._pageId=e,this._layoutCode=n,this._localization=r,this._offers=s,this._acceptSeasonCurrencyAsCredits=a;for(const u of s)u.page=this;c===-1?this._mode=Io.MODE_NORMAL:this._mode=c}get pageId(){return this._pageId}get layoutCode(){return this._layoutCode}get localization(){return this._localization}get offers(){return this._offers}get acceptSeasonCurrencyAsCredits(){return this._acceptSeasonCurrencyAsCredits}get mode(){return this._mode}};Io.MODE_NORMAL=0;let to=Io;const ct=class ct{};ct.DUCKET_INFO="ducket_info",ct.CREDITS="credits",ct.AVATAR_EFFECTS="avatar_effects",ct.HC_MEMBERSHIP="hc_membership",ct.CLUB_GIFTS="club_gifts",ct.LIMITED_SOLD="limited_sold",ct.PET_ACCESSORIES="pet_accessories",ct.TRAX_SONGS="trax_songs",ct.NEW_ADDITIONS="new_additions",ct.QUEST_SHELL="quest_shell",ct.QUEST_SNOWFLAKES="quest_snowflakes",ct.VAL_QUESTS="val_quests",ct.GUILD_CUSTOM_FURNI="guild_custom_furni",ct.GIFT_SHOP="gift_shop",ct.HORSE_STYLES="horse_styles",ct.HORSE_SHOE="horse_shoe",ct.SET_EASTER="set_easter",ct.ECOTRON_TRANSFORM="ecotron_transform",ct.LOYALTY_INFO="loyalty_info",ct.ROOM_BUNDLES="room_bundles",ct.ROOM_BUNDLES_MOBILE="room_bundles_mobile",ct.HABBO_CLUB_DESKTOP="habbo_club_desktop",ct.MOBILE_SUBSCRIPTIONS="mobile_subscriptions";let no=ct;class rS{constructor(e,n){this.breed=e,this.palettes=n}}const Pr=class Pr{};Pr.NONE=0,Pr.CONFIRM=1,Pr.PURCHASE=2,Pr.NO_CREDITS=3,Pr.NO_POINTS=4,Pr.SOLD_OUT=5,Pr.FAILED=6;let Xe=Pr;const Eo=class Eo{};Eo.NORMAL="NORMAL",Eo.BUILDER="BUILDERS_CLUB";let jn=Eo;const sS=i=>"",aS=i=>"",Tu=(i,e)=>{const n=i.get(e),r=[];if(n&&n.length)for(const s of n)s.isVisible&&r.push(s);return r},Hm=(i,e,n,r)=>{if(n.isVisible&&n.pageId>0){let s=!1;const a=[n.pageName,n.localization].join(" ").toLowerCase().replace(/ /gi,"");if(a.indexOf(i)>-1&&(r.push(n),s=!0),!s){for(const c of e)if(a.indexOf(c)>=0){r.push(n);break}}}for(const s of n.children)Hm(i,e,s,r)};function iS(i){if(!i.length)return 0;let e=i.length-1;for(;e>=0&&!isNaN(parseInt(i.charAt(e)));)e--;return e>0?parseInt(i.substring(e+1)):-1}function oS(i,e){switch(i){case 0:return[[16743226],[16750435],[16764339],[16094464],[16498012],[16704690],[15586304],[16115545],[16513201],[8694111],[11585939],[14413767],[6664599],[9553845],[12971486],[8358322],[10002885],[13292268],[10780600],[12623573],[14403561],[12418717],[14327229],[15517403],[14515069],[15764368],[16366271],[11250603],[13948116],[16777215],[14256481],[14656129],[15848130],[14005087],[14337152],[15918540],[15118118],[15531929],[9764857],[11258085]];case 1:return[[16743226],[16750435],[16764339],[16094464],[16498012],[16704690],[15586304],[16115545],[16513201],[8694111],[11585939],[14413767],[6664599],[9553845],[12971486],[8358322],[10002885],[13292268],[10780600],[12623573],[14403561],[12418717],[14327229],[15517403],[14515069],[15764368],[16366271],[11250603],[13948116],[16777215],[14256481],[14656129],[15848130],[14005087],[14337152],[15918540],[15118118],[15531929],[9764857],[11258085]];case 2:return[[16579283],[15378351],[8830016],[15257125],[9340985],[8949607],[6198292],[8703620],[9889626],[8972045],[12161285],[13162269],[8620113],[12616503],[8628101],[13827840],[9764857]];case 3:return[[16777215],[15658734],[14540253]];case 4:return[[16777215],[16053490],[15464440],[16248792],[15396319],[15007487]];case 5:return[[16777215],[15658734],[14540253]];case 6:return[[16777215],[15658734],[14540253],[16767177],[16770205],[16751331]];case 7:return[[13421772],[11447982],[16751331],[10149119],[16763290],[16743786]];default:{const n=[];for(const r of e){const s=j().getPetColorResult(i,r.paletteId);s&&(s.primaryColor===s.secondaryColor?n.push([s.primaryColor]):n.push([s.primaryColor,s.secondaryColor]))}return n}}}const lr=class lr{};lr.WALL="i",lr.FLOOR="s",lr.EFFECT="e",lr.HABBO_CLUB="h",lr.BADGE="b",lr.GAME_TOKEN="GAME_TOKEN",lr.PET="p",lr.ROBOT="r";let fe=lr;const Co=class Co{constructor(e,n,r,s,a,c,u=!1,d=0,g=0){this._productType=e.toLowerCase(),this._productClassId=n,this._extraParam=r,this._productCount=s,this._productData=a,this._furnitureData=c,this._isUniqueLimitedItem=u,this._uniqueLimitedItemSeriesSize=d,this._uniqueLimitedItemsLeft=g}static stripAddonProducts(e){return e.length===1?e:e.filter(n=>n.productType!==fe.BADGE&&n.productType!==fe.EFFECT&&n.productClassId!==Co.EFFECT_CLASSID_NINJA_DISAPPEAR)}getIconUrl(e=null,n=null){switch(this._productType){case fe.FLOOR:return j().getFurnitureFloorIconUrl(this.productClassId);case fe.WALL:{if(e&&this._furnitureData){let r="";switch(this._furnitureData.className){case"floor":r=["th",this._furnitureData.className,e.product.extraParam].join("_");break;case"wallpaper":r=["th","wall",e.product.extraParam].join("_");break;case"landscape":r=["th",this._furnitureData.className,(e.product.extraParam||"").replace(".","_"),"001"].join("_");break}if(r!=="")return`${K("catalog.asset.url")}/${r}.png`}return j().getFurnitureWallIconUrl(this.productClassId,this._extraParam)}case fe.EFFECT:return sS(this.productClassId);case fe.HABBO_CLUB:return aS(this.productClassId);case fe.BADGE:return W().getBadgeUrl(this._extraParam);case fe.ROBOT:return null}return null}get productType(){return this._productType}get productClassId(){return this._productClassId}get extraParam(){return this._extraParam}set extraParam(e){this._extraParam=e}get productCount(){return this._productCount}get productData(){return this._productData}get furnitureData(){return this._furnitureData}get isUniqueLimitedItem(){return this._isUniqueLimitedItem}get uniqueLimitedItemSeriesSize(){return this._uniqueLimitedItemSeriesSize}get uniqueLimitedItemsLeft(){return this._uniqueLimitedItemsLeft}set uniqueLimitedItemsLeft(e){this._uniqueLimitedItemsLeft=e}};Co.EFFECT_CLASSID_NINJA_DISAPPEAR=108;let ts=Co;const Dt=class Dt{constructor(e,n,r,s,a,c,u,d,g,m){this._clubLevel=0,this._bundlePurchaseAllowed=!1,this._offerId=e,this._localizationId=n,this._isRentOffer=r,this._priceInCredits=s,this._priceInActivityPoints=a,this._activityPointType=c,this._giftable=u,this._clubLevel=d,this._products=g,this._bundlePurchaseAllowed=m,this.setPricingModelForProducts(),this.setPricingType();for(const f of g)if(f.productType===fe.BADGE){this._badgeCode=f.extraParam;break}}activate(){}get clubLevel(){return this._clubLevel}get page(){return this._page}set page(e){this._page=e}get offerId(){return this._offerId}get localizationId(){return this._localizationId}get priceInCredits(){return this._priceInCredits}get priceInActivityPoints(){return this._priceInActivityPoints}get activityPointType(){return this._activityPointType}get giftable(){return this._giftable}get product(){if(!this._products||!this._products.length)return null;if(this._products.length===1)return this._products[0];const e=ts.stripAddonProducts(this._products);return e.length?e[0]:null}get pricingModel(){return this._pricingModel}get priceType(){return this._priceType}get bundlePurchaseAllowed(){return this._bundlePurchaseAllowed}get isRentOffer(){return this._isRentOffer}get badgeCode(){return this._badgeCode}get localizationName(){const e=na(this._localizationId);return e?e.name:h(this._localizationId)}get localizationDescription(){const e=na(this._localizationId);return e?e.description:h(this._localizationId)}get isLazy(){return!1}get products(){return this._products}setPricingModelForProducts(){const e=ts.stripAddonProducts(this._products);e.length===1?e[0].productCount===1?this._pricingModel=Dt.PRICING_MODEL_SINGLE:this._pricingModel=Dt.PRICING_MODEL_MULTI:e.length>1?this._pricingModel=Dt.PRICING_MODEL_BUNDLE:this._pricingModel=Dt.PRICING_MODEL_UNKNOWN}setPricingType(){this._priceInCredits>0&&this._priceInActivityPoints>0?this._priceType=Dt.PRICE_TYPE_CREDITS_ACTIVITYPOINTS:this._priceInCredits>0?this._priceType=Dt.PRICE_TYPE_CREDITS:this._priceInActivityPoints>0?this._priceType=Dt.PRICE_TYPE_ACTIVITYPOINTS:this._priceType=Dt.PRICE_TYPE_NONE}clone(){const e=[],n=na(this.localizationId);for(const s of this._products){const a=Zl(s.productClassId,s.productType);e.push(new ts(s.productType,s.productClassId,s.extraParam,s.productCount,n,a))}const r=new Dt(this.offerId,this.localizationId,this.isRentOffer,this.priceInCredits,this.priceInActivityPoints,this.activityPointType,this.giftable,this.clubLevel,e,this.bundlePurchaseAllowed);return r.page=this.page,r}};Dt.PRICING_MODEL_UNKNOWN="pricing_model_unknown",Dt.PRICING_MODEL_SINGLE="pricing_model_single",Dt.PRICING_MODEL_MULTI="pricing_model_multi",Dt.PRICING_MODEL_BUNDLE="pricing_model_bundle",Dt.PRICING_MODEL_FURNITURE="pricing_model_furniture",Dt.PRICE_TYPE_NONE="price_type_none",Dt.PRICE_TYPE_CREDITS="price_type_credits",Dt.PRICE_TYPE_ACTIVITYPOINTS="price_type_activitypoints",Dt.PRICE_TYPE_CREDITS_ACTIVITYPOINTS="price_type_credits_and_activitypoints";let Vt=Dt;class lS{constructor(e){this._furniData=e,this._product=new ts(this._furniData.type,this._furniData.id,this._furniData.customParams,1,na(this._furniData.className),this._furniData)}activate(){L(new vg(this._furniData.rentOfferId>-1?this._furniData.rentOfferId:this._furniData.purchaseOfferId))}get offerId(){return this.isRentOffer?this._furniData.rentOfferId:this._furniData.purchaseOfferId}get priceInActivityPoints(){return 0}get activityPointType(){return 0}get priceInCredits(){return 0}get page(){return this._page}set page(e){this._page=e}get priceType(){return""}get product(){return this._product}get products(){return[this._product]}get localizationId(){return"roomItem.name."+this._furniData.id}get bundlePurchaseAllowed(){return!1}get isRentOffer(){return this._furniData.rentOfferId>-1}get giftable(){return!1}get pricingModel(){return Vt.PRICING_MODEL_FURNITURE}get clubLevel(){return 0}get badgeCode(){return""}get localizationName(){return this._furniData.name}get localizationDescription(){return this._furniData.description}get isLazy(){return!0}}const cS=(i,e,n=null)=>{let r=null;switch(i.toLocaleLowerCase()){case fe.FLOOR:r=j().getFurnitureFloorIconUrl(e);break;case fe.WALL:r=j().getFurnitureWallIconUrl(e,n);break}return r};class uS{constructor(e){this._isEnabled=!1,this._price=null,this._stuffTypes=null,this._boxTypes=null,this._ribbonTypes=null,this._defaultStuffTypes=null,this._isEnabled=e.isEnabled,this._price=e.price,this._boxTypes=e.boxTypes,this._ribbonTypes=e.ribbonTypes,this._stuffTypes=e.giftWrappers,this._defaultStuffTypes=e.giftFurnis}get isEnabled(){return this._isEnabled}get price(){return this._price}get stuffTypes(){return this._stuffTypes}get boxTypes(){return this._boxTypes}get ribbonTypes(){return this._ribbonTypes}get defaultStuffTypes(){return this._defaultStuffTypes}}const _o=class _o{constructor(e,n,r,s,a,c,u,d,g=-1){this._timeLeftMinutes=-1,this._offerId=e,this._furniId=n,this._furniType=r,this._extraData=s,this._stuffData=a,this._price=c,this._status=u,this._averagePrice=d,this._offerCount=g}get offerId(){return this._offerId}set offerId(e){this._offerId=e}get furniId(){return this._furniId}get furniType(){return this._furniType}get extraData(){return this._extraData}get stuffData(){return this._stuffData}get price(){return this._price}set price(e){this._price=e}get averagePrice(){return this._averagePrice}get image(){return this._image}set image(e){this._image=e}get imageCallback(){return this._imageCallback}set imageCallback(e){this._imageCallback=e}get status(){return this._status}get timeLeftMinutes(){return this._timeLeftMinutes}set timeLeftMinutes(e){this._timeLeftMinutes=e}get offerCount(){return this._offerCount}set offerCount(e){this._offerCount=e}get isUniqueLimitedItem(){return this.stuffData&&this.stuffData.uniqueSeries>0}};_o.TYPE_FLOOR=1,_o.TYPE_WALL=2;let Wa=_o;const js=class js{};js.ONGOING=1,js.ONGOING_OWN=1,js.SOLD=2,js.EXPIRED=3;let ja=js;const Sa=class Sa{};Sa.BY_ACTIVITY=1,Sa.BY_VALUE=2,Sa.ADVANCED=3;let qt=Sa;class Wm{constructor(e,n){this._images=e,this._texts=n}getText(e){let n=this._texts[e]||"";return n&&n.length&&(n=n.replace(/\r\n|\r|\n/g,"<br />")),n}getImage(e){const n=this._images[e]||"";if(!n||!n.length)return null;let r=K("catalog.asset.image.url");return r=r.replace("%name%",n),r}}class dS{constructor(e,n,r,s,a,c,u,d){this.roomId=e,this.objectId=n,this.category=r,this.wallLocation=s,this.x=a,this.y=c,this.direction=u,this.offer=d}get offerId(){return this.offer.offerId}get productClassId(){return this.offer.product.productClassId}get productData(){return this.offer.product.productData}get furniData(){return this.offer.product.furnitureData}get extraParam(){return this.offer.product.extraParam}}const $n=class $n{constructor(){this._requestType=$n.REQUEST_TYPE_NONE}resetRequest(){this._requestType=$n.REQUEST_TYPE_NONE,this._requestById=-1,this._requestedByOfferId=-1,this._requestByName=null}get requestType(){return this._requestType}get requestById(){return this._requestById}set requestById(e){this._requestType=$n.REQUEST_TYPE_ID,this._requestById=e}get requestedByOfferId(){return this._requestedByOfferId}set requestedByOfferId(e){this._requestType=$n.REQUEST_TYPE_OFFER,this._requestedByOfferId=e}get requestByName(){return this._requestByName}set requestByName(e){this._requestType=$n.REQUEST_TYPE_NAME,this._requestByName=e}};$n.REQUEST_TYPE_NONE=0,$n.REQUEST_TYPE_ID=1,$n.REQUEST_TYPE_OFFER=2,$n.REQUEST_TYPE_NAME=3;let gs=$n;class mS{constructor(e,n,r){this.searchValue=e,this.offers=n,this.filteredNodes=r}}function Zl(i,e){let n=null;switch(e.toLowerCase()){case fe.FLOOR:n=W().getFloorItemData(i);break;case fe.WALL:n=W().getWallItemData(i);break}return n}function jo(i,e,n){const r=j().getRoomObject(i,e,n);if(!r)return;const s=r.model.getValue(ee.FURNITURE_TYPE_ID);switch(n){case J.FLOOR:return W().getFloorItemData(s);case J.WALL:return W().getWallItemData(s)}return null}function hS(){const i=As();return i?i.model.getValue(ee.FIGURE_POSTURE):ta.POSTURE_STAND}function na(i){return i?W().getProductData(i):null}function Re(){return ks().getSession(-1)}function ec(){L(new wg)}function bs(){return W().clubLevel>=bn.CLUB}function Ai(){return W().clubLevel>=bn.VIP}function gS(i){const e=j().getRoomObject(Re().roomId,i,J.FLOOR);if(!e||!e.model)return!1;const n=W().userId,r=e.model.getValue(ee.FURNITURE_OWNER_ID);return n===r}function fS(){const i=As();return i?i.model.getValue(ee.FIGURE_EFFECT)===77:!1}function pS(i){ks().startSession(i)}const wc=()=>{Re()&&(ec(),ks().removeSession(-1))};function As(){const i=W().userId,e=j().activeRoomId,n=J.UNIT,r=j().getTotalObjectsForManager(e,n);let s=0;for(;s<r;){const a=j().getRoomObjectByIndex(e,s,n);if(a){const c=Re().userDataManager.getUserDataByIndex(a.id);if(c&&c.webID===i)return a}s++}return null}const Rc=(i,e,n,r=1)=>{const s=j().getRoomObjectBoundingRectangle(i,e,n,r);return s?(s.x=Math.round(s.x),s.y=Math.round(s.y),s):null},jm=(i,e,n,r=1)=>{const s=j().getRoomObjectScreenLocation(i,e,n,r);return s?(s.x=Math.round(s.x),s.y=Math.round(s.y),s):null},IS=(i,e,n=1)=>{const r=j(),s=r.activeRoomId;r.initializeRoomInstanceRenderingCanvas(s,n,i,e)};function ES(i){let e=!1;const n=j().getRoomObject(i.roomId,i.objectId,i.category);return n&&n.model.getValue(ee.FURNITURE_SELECTION_DISABLED)===1&&(e=!0,W().isModerator&&(e=!1)),e}function Hs(i,e,n){j().processRoomObjectOperation(i,e,n)}function vu(i){j().setActiveRoomId(i)}const L=i=>Jl().send(i);class _n{static getAchievementBadgeCode(e){if(!e)return null;let n=e.badgeId;return e.finalLevel||(n=Bm().getPreviousLevelBadgeId(n)),n}static getAchievementCategoryImageUrl(e,n=null,r=!1){const s=K("achievements.images.url");let a=r?"achicon_":"achcategory_";return a+=e.code,n!==null&&(a+=`_${n>0?"active":"inactive"}`),s.replace("%image%",a)}static getAchievementCategoryMaxProgress(e){if(!e)return 0;let n=0;for(const r of e.achievements)n+=r.levelCount;return n}static getAchievementCategoryProgress(e){if(!e)return 0;let n=0;for(const r of e.achievements)n+=r.finalLevel?r.level:r.level-1;return n}static getAchievementCategoryTotalUnseen(e){if(!e)return 0;let n=0;for(const r of e.achievements)r.unseen>0&&n++;return n}static getAchievementHasStarted(e){return e?!!(e.finalLevel||e.level-1>0):!1}static getAchievementIsIgnored(e){if(!e)return!1;const n=K("achievements.unseen.ignored"),r=e.badgeId.replace(/[0-9]/g,"");return n.indexOf(r)>=0}static getAchievementLevel(e){return e?e.finalLevel?e.level:e.level-1:0}}class wu{constructor(e){this._code=e,this._achievements=[]}getProgress(){return _n.getAchievementCategoryProgress(this)}getMaxProgress(){return _n.getAchievementCategoryMaxProgress(this)}get code(){return this._code}get achievements(){return this._achievements}set achievements(e){this._achievements=e}}const qs=class qs{};qs.ACTION_SAVE="AEA_ACTION_SAVE",qs.ACTION_CLEAR="AEA_ACTION_CLEAR",qs.ACTION_RESET="AEA_ACTION_RESET",qs.ACTION_RANDOMIZE="AEA_ACTION_RANDOMIZE";let or=qs;class CS{constructor(e,n=!1){this._partColor=e,this._isDisabled=n,this._isHC=this._partColor.clubLevel>0,this._isSelected=!1}dispose(){this._partColor=null}get partColor(){return this._partColor}get color(){return Cn.int2rgb(this._partColor.rgb)}get isDisabled(){return this._isDisabled}get isHC(){return this._isHC}get isSelected(){return this._isSelected}set isSelected(e){this._isSelected=e,this.notify&&this.notify()}get notify(){return this._notifier}set notify(e){this._notifier=e}}class Oc{constructor(e,n,r){this._selectedPartIndex=-1,this._name=e,this._parts=n,this._palettes=r,this._selectedPartIndex=-1}static defaultColorId(e,n){if(!e||!e.length)return-1;let r=0;for(;r<e.length;){const s=e[r];if(s.partColor&&s.partColor.clubLevel<=n)return s.partColor.id;r++}return-1}init(){for(const e of this._parts)e&&e.init()}dispose(){if(this._parts){for(const e of this._parts)e.dispose();this._parts=null}if(this._palettes){for(const e of this._palettes)for(const n of e)n.dispose();this._palettes=null}this._selectedPartIndex=-1,this._paletteIndexes=null}selectPartId(e){if(!this._parts)return;let n=0;for(;n<this._parts.length;){if(this._parts[n].id===e){this.selectPartIndex(n);return}n++}}selectColorIds(e){if(!e||!this._palettes)return;this._paletteIndexes=new Array(e.length);let n=0;for(;n<this._palettes.length;){const r=this.getPalette(n);if(r){let s=0;if(e.length>n)s=e[n];else{const c=r[0];c&&c.partColor&&(s=c.partColor.id)}let a=0;for(;a<r.length;){const c=r[a];c.partColor.id===s?(this._paletteIndexes[n]=a,c.isSelected=!0):c.isSelected=!1,a++}}n++}this.updatePartColors()}selectPartIndex(e){if(!this._parts)return null;if(this._selectedPartIndex>=0&&this._parts.length>this._selectedPartIndex){const n=this._parts[this._selectedPartIndex];n&&(n.isSelected=!1)}if(this._parts.length>e){const n=this._parts[e];if(n)return n.isSelected=!0,this._selectedPartIndex=e,n}return null}selectColorIndex(e,n){const r=this.getPalette(n);if(!r||r.length<=e)return null;this.deselectColorIndex(this._paletteIndexes[n],n),this._paletteIndexes[n]=e;const s=r[e];return s?(s.isSelected=!0,this.updatePartColors(),s):null}getCurrentColorIndex(e){return this._paletteIndexes[e]}deselectColorIndex(e,n){const r=this.getPalette(n);if(!r||r.length<=e)return;const s=r[e];s&&(s.isSelected=!1)}getSelectedColorIds(){if(!this._paletteIndexes||!this._paletteIndexes.length||!this._palettes||!this._palettes.length)return null;const e=this._palettes[0];if(!e||!e.length)return null;const n=e[0];if(!n||!n.partColor)return null;const r=n.partColor.id,s=[];let a=0;for(;a<this._paletteIndexes.length;){const u=this._palettes[a];if(!(!u||u.length<=a))if(u.length>this._paletteIndexes[a]){const d=u[this._paletteIndexes[a]];d&&d.partColor?s.push(d.partColor.id):s.push(r)}else s.push(r);a++}const c=this.getCurrentPart();return c?s.slice(0,Math.max(c.maxColorIndex,1)):null}getSelectedColors(){const e=[];let n=0;for(;n<this._paletteIndexes.length;){const r=this.getSelectedColor(n);r?e.push(r.partColor):e.push(null),n++}return e}getSelectedColor(e){const n=this.getPalette(e);return!n||n.length<=this._paletteIndexes[e]?null:n[this._paletteIndexes[e]]}getSelectedColorId(e){const n=this.getSelectedColor(e);return n&&n.partColor?n.partColor.id:0}getPalette(e){return!this._paletteIndexes||!this._palettes||this._palettes.length<=e?null:this._palettes[e]}getCurrentPart(){return this._parts[this._selectedPartIndex]}updatePartColors(){const e=this.getSelectedColors();for(const n of this._parts)n&&(n.partColors=e)}hasClubSelectionsOverLevel(e){let n=!1;const r=this.getSelectedColors();if(r){let a=0;for(;a<r.length;){const c=r[a];c&&c.clubLevel>e&&(n=!0),a++}}const s=this.getCurrentPart();if(s&&s.partSet){const a=s.partSet;a&&a.clubLevel>e&&(n=!0)}return n}hasInvalidSelectedItems(e){const n=this.getCurrentPart();if(!n)return!1;const r=n.partSet;if(!(!r||!r.isSellable))return e.indexOf(r.id)>-1}stripClubItemsOverLevel(e){const n=this.getCurrentPart();if(n&&n.partSet&&n.partSet.clubLevel>e){const s=this.selectPartIndex(0);return s&&!s.partSet&&this.selectPartIndex(1),!0}return!1}stripClubColorsOverLevel(e){const n=[],r=this.getSelectedColors(),s=this.getPalette(0);let a=!1;const c=Oc.defaultColorId(s,e);if(c===-1)return!1;let u=0;for(;u<r.length;){const d=r[u];d?d.clubLevel>e?(n.push(c),a=!0):n.push(d.id):(n.push(c),a=!0),u++}return a&&this.selectColorIds(n),a}get name(){return this._name}get parts(){return this._parts}get selectedPartIndex(){return this._selectedPartIndex}}const zs=class zs{static getGender(e){switch(e){case we.MALE:case"m":case"M":e=we.MALE;break;case we.FEMALE:case"f":case"F":e=we.FEMALE;break;default:e=we.MALE}return e}static hasFigureSetId(e){return this.FIGURE_SET_IDS.indexOf(e)>=0}static createCategory(e,n){if(!e||!n||!this.CURRENT_FIGURE)return null;const r=[],s=[];let a=0;for(;a<this.MAX_PALETTES;)s.push([]),a++;const c=Nu(n);if(!c)return null;const u=Su(c.paletteID);if(!u)return null;let d=this.CURRENT_FIGURE.getColorIds(n);d||(d=[]);const g=new Array(d.length),m=this.clubItemsDimmed,f=kn();for(const b of u.colors.getValues())if(b.isSelectable&&(m||f>=b.clubLevel)){let S=0;for(;S<this.MAX_PALETTES;){const v=f<b.clubLevel,y=new CS(b,v);s[S].push(y),S++}if(n!==we.FACE){let v=0;for(;v<d.length;)b.id===d[v]&&(g[v]=b),v++}}let p=[];if(m?p=kt().getMandatoryAvatarPartSetIds(this.CURRENT_FIGURE.gender,2):p=kt().getMandatoryAvatarPartSetIds(this.CURRENT_FIGURE.gender,f),p.indexOf(n)===-1){const b=new ro(null,null,!1);b.isClear=!0,r.push(b)}const E=n!==we.FACE,C=c.partSets;for(a=C.length-1;a>=0;){const b=C.getWithIndex(a);let S=!1;if((b.gender===we.UNISEX||b.gender===this.CURRENT_FIGURE.gender)&&(S=!0),b.isSelectable&&S&&(m||f>=b.clubLevel)){const v=f<b.clubLevel;let y=!0;b.isSellable&&(y=this.hasFigureSetId(b.id)),y&&r.push(new ro(b,g,E,v))}a--}for(r.sort(this.clubItemsFirst?this.clubSorter:this.noobSorter),a=0;a<this.MAX_PALETTES;)s[a].sort(this.colorSorter),a++;return new Oc(n,r,s)}static clubSorter(e,n){const r=e.partSet?e.partSet.clubLevel:9999999999,s=n.partSet?n.partSet.clubLevel:9999999999,a=e.partSet?e.partSet.isSellable:!1,c=n.partSet?n.partSet.isSellable:!1;return a&&!c?1:c&&!a||r>s?-1:r<s?1:e.partSet.id>n.partSet.id?-1:e.partSet.id<n.partSet.id?1:0}static colorSorter(e,n){const r=e.partColor?e.partColor.clubLevel:-1,s=n.partColor?n.partColor.clubLevel:-1;return r<s?-1:r>s?1:e.partColor.index<n.partColor.index?-1:e.partColor.index>n.partColor.index?1:0}static noobSorter(e,n){const r=e.partSet?e.partSet.clubLevel:-1,s=n.partSet?n.partSet.clubLevel:-1,a=e.partSet?e.partSet.isSellable:!1,c=n.partSet?n.partSet.isSellable:!1;return a&&!c?1:c&&!a||r<s?-1:r>s?1:e.partSet.id<n.partSet.id?-1:e.partSet.id>n.partSet.id?1:0}static avatarSetFirstSelectableColor(e){const n=Nu(e);if(!n)return-1;const r=Su(n.paletteID);if(!r)return-1;for(const s of r.colors.getValues())if(!(!s.isSelectable||kn()<s.clubLevel))return s.id;return-1}static get clubItemsFirst(){return K("avatareditor.show.clubitems.first",!0)}static get clubItemsDimmed(){return K("avatareditor.show.clubitems.dimmed",!0)}};zs.MAX_PALETTES=2,zs.CURRENT_FIGURE=null,zs.FIGURE_SET_IDS=[],zs.BOUND_FURNITURE_NAMES=[];let Rt=zs;const ce=class ce{constructor(){this._gender="M",this._direction=ce.DEFAULT_DIRECTION,this._avatarEffectType=-1,this._notifier=null}loadAvatarData(e,n){this._data=new Map,this._colors=new Map,this._gender=n,this.parseFigureString(e),this.updateView()}parseFigureString(e){if(!e)return;const n=e.split(".");if(!(!n||!n.length))for(const r of n){const s=r.split("-");if(!s.length)continue;const a=s[0],c=parseInt(s[1]),u=[];let d=2;for(;d<s.length;)u.push(parseInt(s[d])),d++;u.length||u.push(0),this.savePartSetId(a,c,!1),this.savePartSetColourId(a,u,!1)}}getPartSetId(e){const n=this._data.get(e);return n!==void 0?n:-1}getColorIds(e){const n=this._colors.get(e);return n!==void 0?n:[Rt.avatarSetFirstSelectableColor(e)]}getFigureString(){let e="";const n=[];for(const[s,a]of this._data.entries()){const c=this._colors.get(s);let u=s+"-"+a;if(c&&c.length){let d=0;for(;d<c.length;)u=u+("-"+c[d]),d++}n.push(u)}let r=0;for(;r<n.length;)e=e+n[r],r<n.length-1&&(e=e+"."),r++;return e}savePartData(e,n,r,s=!1){this.savePartSetId(e,n,s),this.savePartSetColourId(e,r,s)}savePartSetId(e,n,r=!0){switch(e){case ce.FACE:case ce.HAIR:case ce.HAT:case ce.HEAD_ACCESSORIES:case ce.EYE_ACCESSORIES:case ce.FACE_ACCESSORIES:case ce.SHIRT:case ce.JACKET:case ce.CHEST_ACCESSORIES:case ce.CHEST_PRINTS:case ce.TROUSERS:case ce.SHOES:case ce.TROUSER_ACCESSORIES:n>=0?this._data.set(e,n):this._data.delete(e);break}r&&this.updateView()}savePartSetColourId(e,n,r=!0){switch(e){case ce.FACE:case ce.HAIR:case ce.HAT:case ce.HEAD_ACCESSORIES:case ce.EYE_ACCESSORIES:case ce.FACE_ACCESSORIES:case ce.SHIRT:case ce.JACKET:case ce.CHEST_ACCESSORIES:case ce.CHEST_PRINTS:case ce.TROUSERS:case ce.SHOES:case ce.TROUSER_ACCESSORIES:this._colors.set(e,n);break}r&&this.updateView()}getFigureStringWithFace(e,n=!0){let r="";const s=[ce.FACE],a=[];for(const u of s){const d=this._colors.get(u);if(!d)continue;let g=this._data.get(u);u===ce.FACE&&n&&(g=e);let m=u+"-"+g;if(g>=0){let f=0;for(;f<d.length;)m=m+("-"+d[f]),f++}a.push(m)}let c=0;for(;c<a.length;)r=r+a[c],c<a.length-1&&(r=r+"."),c++;return r}updateView(){this.notify&&this.notify()}get gender(){return this._gender}get direction(){return this._direction}set direction(e){this._direction=e,this.updateView()}set avatarEffectType(e){this._avatarEffectType=e}get avatarEffectType(){return this._avatarEffectType}get notify(){return this._notifier}set notify(e){this._notifier=e}};ce.DEFAULT_DIRECTION=4,ce.MALE="M",ce.FEMALE="F",ce.UNISEX="U",ce.SCALE="h",ce.STD="std",ce.DEFAULT_FRAME="0",ce.FACE="hd",ce.HAIR="hr",ce.HAT="ha",ce.HEAD_ACCESSORIES="he",ce.EYE_ACCESSORIES="ea",ce.FACE_ACCESSORIES="fa",ce.JACKET="cc",ce.SHIRT="ch",ce.CHEST_ACCESSORIES="ca",ce.CHEST_PRINTS="cp",ce.TROUSERS="lg",ce.SHOES="sh",ce.TROUSER_ACCESSORIES="wa",ce.SET_TYPES=[ce.FACE,ce.HAIR,ce.HAT,ce.HEAD_ACCESSORIES,ce.EYE_ACCESSORIES,ce.FACE_ACCESSORIES,ce.JACKET,ce.SHIRT,ce.CHEST_ACCESSORIES,ce.CHEST_PRINTS,ce.TROUSERS,ce.SHOES,ce.TROUSERS];let we=ce;const cr=class cr{constructor(e,n,r=!0,s=!1){if(this._renderManager=kt(),this._partSet=e,this._partColors=n,this._useColors=r,this._isDisabled=s,this._thumbContainer=null,this._imageUrl=null,this._maxColorIndex=0,this._isValidFigure=!1,this._isHC=!1,this._isSellable=!1,this._isClear=!1,this._isSelected=!1,this._disposed=!1,this._isInitalized=!1,e){const a=e.parts;for(const c of a)this._maxColorIndex=Math.max(this._maxColorIndex,c.colorLayerIndex)}}init(){this._isInitalized||(this._isInitalized=!0,this.update())}dispose(){this._disposed||(this._renderManager=null,this._partSet=null,this._partColors=null,this._imageUrl=null,this._disposed=!0,this._isInitalized=!1,this._thumbContainer&&(this._thumbContainer.destroy(),this._thumbContainer=null))}update(){this.updateThumbVisualization()}analyzeFigure(){if(!this._renderManager||!this._partSet||!this._partSet.parts||!this._partSet.parts.length)return!1;const e=this._renderManager.createFigureContainer(this.partSet.type+"-"+this.partSet.id);return this._renderManager.isFigureContainerReady(e)?(this._isValidFigure=!0,!0):(this._renderManager.downloadAvatarFigure(e,this),!1)}renderThumb(){if(!this._renderManager||!this._partSet||!this._isValidFigure&&!this.analyzeFigure())return null;const e=this._partSet.parts.concat().sort(this.sortByDrawOrder),n=new Og;for(const r of e){if(!r)continue;let s=null,a=0,c=!1;for(;!c&&a<cr.THUMB_DIRECTIONS.length;){const f=we.SCALE+"_"+we.STD+"_"+r.type+"_"+r.id+"_"+cr.THUMB_DIRECTIONS[a]+"_"+we.DEFAULT_FRAME;s=this._renderManager.getAssetByName(f),s&&s.texture?c=!0:a++}if(!c)continue;const u=s.offsetX,d=s.offsetY;let g=null;if(this._useColors&&r.colorLayerIndex>0){const f=this._partColors[r.colorLayerIndex-1];f&&(g=f)}const m=new Xi(s.texture);m.position.set(u,d),g&&(m.tint=g.rgb),n.addChild(m)}return n}updateThumbVisualization(){if(!this._isInitalized)return;let e=this._thumbContainer;e||(e=this.renderThumb()),e&&(this._partSet?(this._isHC=this._partSet.clubLevel>0,this._isSellable=this._partSet.isSellable):(this._isHC=!1,this._isSellable=!1),this._isDisabled&&this.setAlpha(e,.2),this._imageUrl=_r.generateImageUrl(e),this.notify&&this.notify())}setAlpha(e,n){return e.filters=[cr.ALPHA_FILTER],e}sortByDrawOrder(e,n){const r=cr.DRAW_ORDER.indexOf(e.type),s=cr.DRAW_ORDER.indexOf(n.type);return r<s?-1:r>s?1:e.index<n.index?-1:e.index>n.index?1:0}resetFigure(e){this.analyzeFigure()&&this.update()}get disposed(){return this._disposed}get id(){return this._partSet?this._partSet.id:-1}get partSet(){return this._partSet}set partColors(e){this._partColors=e,this.update()}get isDisabled(){return this._isDisabled}set thumbContainer(e){this._thumbContainer=e,this.update()}get imageUrl(){return this._imageUrl}get maxColorIndex(){return this._maxColorIndex}get isHC(){return this._isHC}get isSellable(){return this._isSellable}get isClear(){return this._isClear}set isClear(e){this._isClear=e}get isSelected(){return this._isSelected}set isSelected(e){this._isSelected=e,this.notify&&this.notify()}get notify(){return this._notifier}set notify(e){this._notifier=e}};cr.ALPHA_FILTER=new Rg(.2),cr.THUMB_DIRECTIONS=[2,6,0,4,3,1],cr.DRAW_ORDER=[Fe.LEFT_HAND_ITEM,Fe.LEFT_HAND,Fe.LEFT_SLEEVE,Fe.LEFT_COAT_SLEEVE,Fe.BODY,Fe.SHOES,Fe.LEGS,Fe.CHEST,Fe.CHEST_ACCESSORY,Fe.COAT_CHEST,Fe.CHEST_PRINT,Fe.WAIST_ACCESSORY,Fe.RIGHT_HAND,Fe.RIGHT_SLEEVE,Fe.RIGHT_COAT_SLEEVE,Fe.HEAD,Fe.FACE,Fe.EYES,Fe.HAIR,Fe.HAIR_BIG,Fe.FACE_ACCESSORY,Fe.EYE_ACCESSORY,Fe.HEAD_ACCESSORY,Fe.HEAD_ACCESSORY_EXTRA,Fe.RIGHT_HAND_ITEM];let ro=cr;class qo{constructor(){this._isInitalized=!1,this._maxPaletteCount=0}dispose(){this._categories=null,this._disposed=!0}get disposed(){return this._disposed}init(){this._categories||(this._categories=new Map)}reset(){if(this._isInitalized=!1,this._categories)for(const e of this._categories.values())e&&e.dispose();this._categories=new Map}addCategory(e){let n=this._categories.get(e);n||(n=Rt.createCategory(this,e),n&&(this._categories.set(e,n),this.updateSelectionsFromFigure(e)))}updateSelectionsFromFigure(e){const n=this._categories.get(e);if(!n)return;const r=Rt.CURRENT_FIGURE.getPartSetId(e);let s=Rt.CURRENT_FIGURE.getColorIds(e);s||(s=[]),n.selectPartId(r),n.selectColorIds(s)}hasClubSelectionsOverLevel(e){if(!this._categories)return!1;for(const n of this._categories.values())if(n&&n.hasClubSelectionsOverLevel(e))return!0;return!1}hasInvalidSelectedItems(e){if(!this._categories)return!1;for(const n of this._categories.values())if(n.hasInvalidSelectedItems(e))return!0;return!1}stripClubItemsOverLevel(e){if(!this._categories)return!1;let n=!1;for(const[r,s]of this._categories.entries()){let a=!1;if(s.stripClubItemsOverLevel(e)&&(a=!0),s.stripClubColorsOverLevel(e)&&(a=!0),a){const c=s.getCurrentPart();c&&Rt.CURRENT_FIGURE&&Rt.CURRENT_FIGURE.savePartData(r,c.id,s.getSelectedColorIds(),!0),n=!0}}return n}stripInvalidSellableItems(){if(!this._categories)return!1;let e=!1;for(const[n,r]of this._categories.entries());return e}selectPart(e,n){const r=this._categories.get(e);if(!r)return;const s=r.selectedPartIndex;r.selectPartIndex(n);const a=r.getCurrentPart();if(a){if(a.isDisabled){r.selectPartIndex(s);return}this._maxPaletteCount=a.maxColorIndex,Rt.CURRENT_FIGURE.savePartData(e,a.id,r.getSelectedColorIds(),!0)}}selectColor(e,n,r){const s=this._categories.get(e);if(!s)return;const a=s.getCurrentColorIndex(r);if(s.selectColorIndex(n,r),s.getSelectedColor(r).isDisabled){s.selectColorIndex(a,r);return}Rt.CURRENT_FIGURE.savePartSetColourId(e,s.getSelectedColorIds(),!0)}getCategoryData(e){return this._isInitalized||this.init(),this._categories?this._categories.get(e):null}get categories(){return this._categories}get canSetGender(){return!1}get maxPaletteCount(){return this._maxPaletteCount||1}set maxPaletteCount(e){this._maxPaletteCount=e}get name(){return null}}class _S extends qo{constructor(){super(...arguments),this._imageCallBackHandled=!1}init(){super.init(),this.addCategory(we.FACE),this._isInitalized=!0}selectColor(e,n,r){super.selectColor(e,n,r),this.updateSelectionsFromFigure(we.FACE)}updateSelectionsFromFigure(e){if(!this._categories||!Rt.CURRENT_FIGURE)return;const n=this._categories.get(e);if(!n)return;const r=Rt.CURRENT_FIGURE.getPartSetId(e);let s=Rt.CURRENT_FIGURE.getColorIds(e);s||(s=[]),n.selectPartId(r),n.selectColorIds(s);for(const a of n.parts){const c=u=>{const d=Rt.CURRENT_FIGURE.getFigureStringWithFace(a.id),g=kt().createAvatarImage(d,Nc.LARGE,null,{resetFigure:c,dispose:null,disposed:!1}),m=g.getImageAsSprite(Qi.HEAD);m&&(m.y=10,a.thumbContainer=m,setTimeout(()=>g.dispose(),0))};c()}}get canSetGender(){return!0}get name(){return xr.GENERIC}}const sn=i=>{if(i==null||typeof i!="object")return i;const e=new i.constructor;for(const n in i)i.hasOwnProperty(n)&&(e[n]=i[n]);return e};class mn{static makeColorHex(e){return"#"+e}static makeColorNumberHex(e){return"#"+e.toString(16).padStart(6,"0")}static convertFromHex(e){return parseInt(e.replace("#",""),16)}static uintHexColor(e){const n=e>>>0;return mn.makeColorHex(n.toString(16).substring(2))}static int_to_8BitVals(e){const n=e>>24&255,r=e>>16&255,s=e>>8&255,a=e&255;return[n,r,s,a]}static eight_bitVals_to_int(e,n,r,s){return(e<<24)+(n<<16)+(r<<8)+(s|0)}static int2rgb(e){e>>>=0;const n=e&255,r=(e&65280)>>>8;return"rgba("+[(e&16711680)>>>16,r,n,1].join(",")+")"}}const us=i=>{let e=Math.floor(i/86400),n=Math.floor(i%86400/3600),r=Math.floor(i%86400%3600/60),s=i%86400%3600%60;return e.toString().padStart(2,"0")+":"+n.toString().padStart(2,"0")+":"+r.toString().padStart(2,"0")+":"+s.toString().padStart(2,"0")},so=i=>{try{JSON.parse(window.localStorage.getItem(i))}catch{return null}},yc=i=>{let e=_e().localization.getBadgeDesc(i);return(!e||!e.length)&&(e=`badge_desc_${i}`),e},si=i=>{let e=_e().localization.getBadgeName(i);return(!e||!e.length)&&(e=`badge_name_${i}`),e};function ao(i){return!i||isNaN(i)?"0":i.toString().replace(/\B(?=(\d{3})+(?!\d))/g," ")}function bS(i){if(!i||isNaN(i))return"0";let e=Math.abs(i);const n=Math.pow(10,1),r=i<0;let s="";const a=[{key:"Q",value:Math.pow(10,15)},{key:"T",value:Math.pow(10,12)},{key:"B",value:Math.pow(10,9)},{key:"M",value:Math.pow(10,6)},{key:"K",value:1e3}];for(const c of a){let u=e/c.value;if(u=Math.round(u*n)/n,u>=1){e=u,s=c.key;break}}return(r?"-":"")+e+s}function h(i,e=null,n=null){return _e().getLocalizationWithParameters(i,e,n)}const bo=class bo{};bo.CATALOG_PLACE_MULTIPLE_OBJECTS="catalogPlaceMultipleObjects",bo.CATALOG_SKIP_PURCHASE_CONFIRMATION="catalogSkipPurchaseConfirmation";let qa=bo;const qm=(i,e)=>i.dispatchEvent(e),tc=i=>qm(_e().events,i),br=new yg,yt=i=>qm(br,i);let zm=!1;const Sr=i=>{zm&&tc(new tu(tu.PLAY_SOUND,i))},Ru=[Oe.MOUSE_CLICK],SS=()=>{const i=()=>Ru.forEach(n=>window.removeEventListener(n,e)),e=n=>(zm=!0)&&i();Ru.forEach(n=>window.addEventListener(n,e))};SS();const ut=class ut{};ut.DEFAULT=1,ut.WALL_PAPER=2,ut.FLOOR=3,ut.LANDSCAPE=4,ut.POST_IT=5,ut.POSTER=6,ut.SOUND_SET=7,ut.TRAX_SONG=8,ut.PRESENT=9,ut.ECOTRON_BOX=10,ut.TROPHY=11,ut.CREDIT_FURNI=12,ut.PET_SHAMPOO=13,ut.PET_CUSTOM_PART=14,ut.PET_CUSTOM_PART_SHAMPOO=15,ut.PET_SADDLE=16,ut.GUILD_FURNI=17,ut.GAME_FURNI=18,ut.MONSTERPLANT_SEED=19,ut.MONSTERPLANT_REVIVAL=20,ut.MONSTERPLANT_REBREED=21,ut.MONSTERPLANT_FERTILIZE=22,ut.FIGURE_PURCHASABLE_SET=23;let me=ut;class za{constructor(e){e&&(this._locked=!1,this._id=e.itemId,this._type=e.spriteId,this._ref=e.ref,this._category=e.category,this._groupable=e.isGroupable&&!e.rentable,this._tradeable=e.tradable,this._recyclable=e.isRecycleable,this._sellable=e.sellable,this._stuffData=e.stuffData,this._extra=e.extra,this._secondsToExpiration=e.secondsToExpiration,this._expirationTimeStamp=e.expirationTimeStamp,this._hasRentPeriodStarted=e.hasRentPeriodStarted,this._creationDay=e.creationDay,this._creationMonth=e.creationMonth,this._creationYear=e.creationYear,this._slotId=e.slotId,this._songId=e.songId,this._flatId=e.flatId,this._isRented=e.rentable,this._isWallItem=e.isWallItem)}get rentable(){return this._isRented}get id(){return this._id}get ref(){return this._ref}get category(){return this._category}get type(){return this._type}get stuffData(){return this._stuffData}set stuffData(e){this._stuffData=e}get extra(){return this._extra}get recyclable(){return this._recyclable}get isTradable(){return this._tradeable}get isGroupable(){return this._groupable}get sellable(){return this._sellable}get secondsToExpiration(){if(this._secondsToExpiration===-1)return-1;let e=-1;return this._hasRentPeriodStarted?(e=this._secondsToExpiration-(Hn()-this._expirationTimeStamp)/1e3,e<0&&(e=0)):e=this._secondsToExpiration,e}get creationDay(){return this._creationDay}get creationMonth(){return this._creationMonth}get creationYear(){return this._creationYear}get slotId(){return this._slotId}get songId(){return this._songId}get locked(){return this._locked}set locked(e){this._locked=e}get flatId(){return this._flatId}get isWallItem(){return this._isWallItem}get hasRentPeriodStarted(){return this._hasRentPeriodStarted}get expirationTimeStamp(){return this._expirationTimeStamp}update(e){this._type=e.spriteId,this._ref=e.ref,this._category=e.category,this._groupable=e.isGroupable&&!e.rentable,this._tradeable=e.tradable,this._recyclable=e.isRecycleable,this._sellable=e.sellable,this._stuffData=e.stuffData,this._extra=e.extra,this._secondsToExpiration=e.secondsToExpiration,this._expirationTimeStamp=e.expirationTimeStamp,this._hasRentPeriodStarted=e.hasRentPeriodStarted,this._creationDay=e.creationDay,this._creationMonth=e.creationMonth,this._creationYear=e.creationYear,this._slotId=e.slotId,this._songId=e.songId,this._flatId=e.flatId,this._isRented=e.rentable,this._isWallItem=e.isWallItem}clone(){const e=new za(null);return e._expirationTimeStamp=this._expirationTimeStamp,e._isWallItem=this._isWallItem,e._songId=this._songId,e._locked=this._locked,e._id=this._id,e._ref=this._ref,e._category=this._category,e._type=this._type,e._stuffData=this._stuffData,e._extra=this._extra,e._recyclable=this._recyclable,e._tradeable=this._tradeable,e._groupable=this._groupable,e._sellable=this._sellable,e._secondsToExpiration=this._secondsToExpiration,e._hasRentPeriodStarted=this._hasRentPeriodStarted,e._creationDay=this._creationDay,e._creationMonth=this._creationMonth,e._creationYear=this._creationYear,e._slotId=this._slotId,e._isRented=this._isRented,e._flatId=this._flatId,e}}class kc{constructor(e=-1,n=-1,r=null,s=null,a=-1){this._type=e,this._category=n,this._roomEngine=r,this._stuffData=s,this._extra=a,this._isWallItem=!1,this._iconUrl=null,this._name=null,this._description=null,this._locked=!1,this._selected=!1,this._hasUnseenItems=!1,this._items=[]}clone(){const e=new kc;return e._type=this._type,e._category=this._category,e._roomEngine=this._roomEngine,e._stuffData=this._stuffData,e._extra=this._extra,e._isWallItem=this._isWallItem,e._iconUrl=this._iconUrl,e._name=this._name,e._description=this._description,e._locked=this._locked,e._selected=this._selected,e._hasUnseenItems=this._hasUnseenItems,e._items=this._items,e}prepareGroup(){this.setIcon(),this.setName(),this.setDescription()}dispose(){}getItemByIndex(e){return this._items[e]}getItemById(e){for(const n of this._items)if(n.id===e)return n;return null}getTradeItems(e){const n=[],r=this.getLastItem();if(!r)return n;let s=0,a=0;for(;a<this._items.length&&!(s>=e);){const c=this.getItemByIndex(a);!c.locked&&c.isTradable&&c.type===r.type&&(n.push(c),s++),a++}return n}push(e){const n=[...this._items];let r=0;for(;r<n.length;){let s=n[r];if(s.id===e.id){s=s.clone(),s.locked=!1,n.splice(r,1),n.push(s),this._items=n;return}r++}n.push(e),this._items=n,this._items.length===1&&this.prepareGroup()}pop(){const e=[...this._items];let n=null;if(e.length>0){const r=e.length-1;n=e[r],e.splice(r,1)}return this._items=e,n}remove(e){const n=[...this._items];let r=0;for(;r<n.length;){let s=n[r];if(s.id===e)return n.splice(r,1),this._items=n,s;r++}return null}getTotalCount(){if(this._category===me.POST_IT){let e=0,n=0;for(;n<this._items.length;){const r=this.getItemByIndex(n);e=e+parseInt(r.stuffData.getLegacyString()),n++}return e}return this._items.length}getUnlockedCount(){if(this.category===me.POST_IT)return this.getTotalCount();let e=0,n=0;for(;n<this._items.length;)this.getItemByIndex(n).locked||e++,n++;return e}getLastItem(){return this._items.length?this.getItemByIndex(this._items.length-1):null}unlockAllItems(){const e=[...this._items];let n=0;for(;n<e.length;){const r=e[n];if(r.locked){const s=r.clone();s.locked=!1,e[n]=s}n++}this._items=e}lockItemIds(e){const n=[...this._items];let r=0,s=!1;for(;r<n.length;){const a=n[r],c=e.indexOf(a.ref)>=0;if(a.locked!==c){s=!0;const u=a.clone();u.locked=c,n[r]=u}r++}return this._items=n,s}setName(){const e=this.getLastItem();if(!e){this._name="";return}let n="";switch(this._category){case me.POSTER:n="poster_"+e.stuffData.getLegacyString()+"_name";break;case me.TRAX_SONG:this._name="SONG_NAME";return;default:this.isWallItem?n="wallItem.name."+e.type:n="roomItem.name."+e.type}this._name=h(n)}setDescription(){this._description=""}setIcon(){if(this._iconUrl)return;let e=null;this.isWallItem?e=this._roomEngine.getFurnitureWallIconUrl(this._type,this._stuffData.getLegacyString()):e=this._roomEngine.getFurnitureFloorIconUrl(this._type),e&&(this._iconUrl=e)}get type(){return this._type}get category(){return this._category}get stuffData(){return this._stuffData}get extra(){return this._extra}get iconUrl(){return this._iconUrl}get name(){return this._name}get description(){return this._description}get hasUnseenItems(){return this._hasUnseenItems}set hasUnseenItems(e){this._hasUnseenItems=e}get locked(){return this._locked}set locked(e){this._locked=e}get selected(){return this._selected}set selected(e){this._selected=e}get isWallItem(){const e=this.getItemByIndex(0);return e?e.isWallItem:!1}get isGroupable(){const e=this.getItemByIndex(0);return e?e.isGroupable:!1}get isSellable(){const e=this.getItemByIndex(0);return e?e.sellable:!1}get items(){return this._items}set items(e){this._items=e}}const Ac=(i,e,n,r=NaN)=>new kc(i,e,j(),n,r),NS=(i,e,n)=>{const r=[];for(const a of i)a.type===e.type&&r.push(a);for(const a of r)if(a.getItemById(e.id))return a;const s=Ac(e.type,e.category,e.stuffData,e.extra);return s.push(e),n?(s.hasUnseenItems=!0,i.unshift(s)):i.push(s),s},TS=(i,e,n)=>{let r=null;for(const s of i)if(s.type===e.type&&s.isWallItem===e.isWallItem&&s.isGroupable)if(e.category===me.POSTER){if(s.stuffData.getLegacyString()===e.stuffData.getLegacyString()){r=s;break}}else if(e.category===me.GUILD_FURNI){if(e.stuffData.compare(s.stuffData)){r=s;break}}else{r=s;break}if(r){if(r.push(e),n){r.hasUnseenItems=!0;const s=i.indexOf(r);s>=0&&i.splice(s,1),i.unshift(r)}return r}return r=Ac(e.type,e.category,e.stuffData,e.extra),r.push(e),n?(r.hasUnseenItems=!0,i.unshift(r)):i.push(r),r},Ou=(i,e,n)=>{e.isGroupable?TS(i,e,n):NS(i,e,n)},vS=(i,e,n,r)=>{if(e===1)return i;r[n]=i;for(const a of r)if(!a)return null;const s=new Map;for(const a of r){for(const[c,u]of a)s.set(c,u);a.clear()}return r=null,s},wS=i=>{const e=[];for(const n of i){let r=n.getTotalCount();n.category===me.POST_IT&&(r=1);let s=0;for(;s<r;)e.push(n.getItemByIndex(s).id),s++}return e};let Ym=!1,$m=-1;const RS=()=>Ym,ai=i=>Ym=i,ia=()=>$m,zo=i=>$m=i,Ya=()=>{ia()!==-1&&(j().cancelRoomObjectPlacement(),zo(-1),ai(!1))},nc=(i,e=!1)=>{const n=i.petData;if(!n)return!1;const r=ks().getSession(1);return!r||!r.isRoomOwner&&!r.allowPets?!1:(Z("inventory/hide"),j().processRoomObjectPlacement(xa.INVENTORY,-n.id,J.UNIT,pt.PET,n.figureData.figuredata)&&(zo(n.id),ai(!0)),!0)},oa=(i,e=!1)=>{if(!i||!i.getUnlockedCount())return!1;const n=i.getLastItem();if(!n)return!1;if(n.category===me.FLOOR||n.category===me.WALL_PAPER||n.category===me.LANDSCAPE)return e||L(new Yi(n.id)),!1;{Z("inventory/hide");let r=0,s=!1;n.isWallItem?r=J.WALL:r=J.FLOOR,n.category===me.POSTER?s=j().processRoomObjectPlacement(xa.INVENTORY,n.id,r,n.type,n.stuffData.getLegacyString()):s=j().processRoomObjectPlacement(xa.INVENTORY,n.id,r,n.type,n.extra.toString(),n.stuffData),s&&(zo(n.ref),ai(!0))}return!0},rc=(i,e=!1)=>{const n=i.botData;if(!n)return!1;const r=ks().getSession(1);return!r||!r.isRoomOwner?!1:(Z("inventory/hide"),j().processRoomObjectPlacement(xa.INVENTORY,-n.id,J.UNIT,pt.RENTABLE_BOT,n.figure)&&(zo(n.id),ai(!0)),!0)},Kr=class Kr{};Kr.FURNI=1,Kr.RENTABLE=2,Kr.PET=3,Kr.BADGE=4,Kr.BOT=5,Kr.GAMES=6;let at=Kr;const OS=i=>i.map(e=>e.petData.id),Km=(i,e,n=!0)=>{const r={petData:i};return n?e.unshift(r):e.push(r),r},Xm=(i,e)=>{let n=0;for(;n<e.length;){const r=e[n];if(r&&r.petData.id===i)return ia()===r.petData.id&&(Ya(),Z("inventory/open")),e.splice(n,1),r;n++}return null},yS=(i,e,n)=>{const r=OS(i),s=[],a=[];for(const c of e.keys())r.indexOf(c)===-1&&s.push(c);for(const c of r)!e.get(c)&&a.push(c);r.length;for(const c of a)Xm(c,i);for(const c of s){const u=e.get(c);u&&Km(u,i,n(at.PET,u.id))}return i},kS=(i,e,n,r)=>{if(e===1)return i;r[n]=i;for(const a of r)if(!a)return null;const s=new Map;for(const a of r){for(const[c,u]of a)s.set(c,u);a.clear()}return r=null,s},Lr=class Lr{};Lr.TRADING_STATE_READY=0,Lr.TRADING_STATE_RUNNING=1,Lr.TRADING_STATE_COUNTDOWN=2,Lr.TRADING_STATE_CONFIRMING=3,Lr.TRADING_STATE_CONFIRMED=4,Lr.TRADING_STATE_COMPLETED=5,Lr.TRADING_STATE_CANCELLED=6;let wt=Lr;class yu{constructor(e=-1,n="",r=new Fa,s=0,a=0,c=!1,u=!1){this.userId=e,this.userName=n,this.userItems=r,this.itemCount=s,this.creditsCount=a,this.accepts=c,this.canTrade=u}}const Kn=class Kn{};Kn.ALERT_SCAM=0,Kn.HOTEL_TRADING_DISABLED=1,Kn.YOU_NOT_ALLOWED=2,Kn.THEY_NOT_ALLOWED=4,Kn.ROOM_DISABLED=6,Kn.YOU_OPEN=7,Kn.THEY_OPEN=8,Kn.ERROR_WHILE_COMMIT=9,Kn.THEY_CANCELLED=10;let cn=Kn;const ku=i=>{var e;return((e=W().getWallItemData(i))==null?void 0:e.isExternalImage)||!1},Au=i=>{const e=new Fa;if(i.length)for(const r of i){const s=r.spriteId,a=r.category;let c=r.furniType+s;(!r.isGroupable||ku(s))&&(c="itemid"+r.itemId),r.category===me.POSTER?c=r.itemId+"poster"+r.stuffData.getLegacyString():r.category===me.GUILD_FURNI&&(c="");let u=r.isGroupable&&!ku(r.spriteId)?e.getValue(c):null;u||(u=Ac(s,a,r.stuffData),e.add(c,u)),u.push(new za(r))}return e},AS=(i,e)=>{let n=i.toString();if(!(e instanceof ni))return n;let r=1;for(;r<5;)n=n+(","+e.getValue(r)),r++;return n};class $i{static getProductImageUrl(e,n,r){let s=null;switch(e){case pa.S:s=j().getFurnitureFloorIconUrl(n);break;case pa.I:this.getProductCategory(pa.I,n)===1&&(s=j().getFurnitureWallIconUrl(n,r));break}return s}static getProductCategory(e,n){if(e===pa.S)return 1;if(e===pa.I){if(n===3001)return me.WALL_PAPER;if(n===3002)return me.FLOOR;if(n===4057)return me.LANDSCAPE}return 1}}class io{static getRandomNumber(e){return Math.floor(Math.random()*e)}static getRandomElement(e){return e[this.getRandomNumber(e.length)]}static getRandomElements(e,n){const r=new Array(n);let s=e.length;const a=new Array(s);for(;n--;){var c=this.getRandomNumber(s);r[n]=e[c in a?a[c]:c],a[c]=--s in a?a[s]:s}return r}}const At=new Map;At.set("r","red");At.set("b","blue");At.set("g","green");At.set("y","yellow");At.set("w","white");At.set("o","orange");At.set("c","cyan");At.set("br","brown");At.set("pr","purple");At.set("pk","pink");At.set("red","red");At.set("blue","blue");At.set("green","green");At.set("yellow","yellow");At.set("white","white");At.set("orange","orange");At.set("cyan","cyan");At.set("brown","brown");At.set("purple","purple");At.set("pink","pink");const DS=i=>i.replace(/([\u00A0-\u9999<>&])(.|$)/g,(e,n,r)=>n!=="&"||r!=="#"?(/[\u00A0-\u9999<>&]/.test(r)&&(r="&#"+r.charCodeAt(0)+";"),"&#"+n.charCodeAt(0)+";"+r):e),PS=i=>{let e="";if(i=DS(i),i.startsWith("@")&&i.indexOf("@",1)>-1){let n=null;for(;(n=/@[a-zA-Z]+@/g.exec(i))!==null;){const r=n[0].toString(),s=r.substr(1,r.length-2),a=i.replace(r,"");At.has(s)?e='<span style="color: '+At.get(s)+'">'+a+"</span>":e=a;break}}else e=i;return e},Qm=(i,e)=>window.localStorage.setItem(i,JSON.stringify(e)),wn=class wn{};wn.CAMERA_SHUTTER="camera_shutter",wn.CREDITS="credits",wn.DUCKETS="duckets",wn.MESSENGER_NEW_THREAD="messenger_new_thread",wn.MESSENGER_MESSAGE_RECEIVED="messenger_message_received",wn.MODTOOLS_NEW_TICKET="modtools_new_ticket",wn.NOTIFICATION_CUSTOM="notification_custom",wn.NOTIFICATION_MENTION="notification_mention",wn.NOTIFICATION_SUCCESS="notification_success",wn.NOTIFICATION_ERROR="notification_error",wn.NOTIFICATION_ACHIEVEMENT="notification_achievement";let Nr=wn;function LS(i){const e=i.parts;let n=0;for(const r of e)n=Math.max(n,r.colorLayerIndex);return n}function MS(i,e){return e=e.filter(n=>i.indexOf(n)===-1),[...i,...io.getRandomElements(e,io.getRandomNumber(e.length)+1)]}function US(i,e,n=0,r=[]){if(!i)return null;const s=i.partSets.getValues().filter(a=>!a.isSelectable||a.gender!=="U"&&a.gender!==e||a.clubLevel>n||a.isSellable&&r.indexOf(a.id)===-1?null:a);return!s||!s.length?null:io.getRandomElement(s)}function xS(i,e,n=0){if(!i)return[];const r=i.colors.getValues().filter(s=>!s.isSelectable||s.clubLevel>n?null:s);return!r||!r.length?null:io.getRandomElements(r,LS(e))}function FS(i,e,n=0,r=[],s=[]){const a=kt().structure,c=new kg(""),u=MS(a.getMandatorySetTypeIds(e,n),we.SET_TYPES);for(const d of s){const g=i.getPartSetId(d),m=i.getColorIds(d);c.updatePart(d,g,m)}for(const d of u){if(c.hasPartType(d))continue;const g=a.figureData.getSetType(d),m=US(g,e,n,r);if(!m)continue;let f=[];m.isColorable&&(f=xS(a.figureData.getPalette(g.paletteID),m,n).map(p=>p.id)),c.updatePart(g.type,m.id,f)}return c.getFigureString()}class GS extends qo{init(){super.init(),this.addCategory(we.HAIR),this.addCategory(we.HAT),this.addCategory(we.HEAD_ACCESSORIES),this.addCategory(we.EYE_ACCESSORIES),this.addCategory(we.FACE_ACCESSORIES),this._isInitalized=!0}get name(){return xr.HEAD}}class VS extends qo{init(){super.init(),this.addCategory(we.TROUSERS),this.addCategory(we.SHOES),this.addCategory(we.TROUSER_ACCESSORIES),this._isInitalized=!0}get name(){return xr.LEGS}}class BS extends qo{init(){super.init(),this.addCategory(we.SHIRT),this.addCategory(we.CHEST_PRINTS),this.addCategory(we.JACKET),this.addCategory(we.CHEST_ACCESSORIES),this._isInitalized=!0}get name(){return xr.TORSO}}const So=class So{};So.COLORMATRIX="colormatrix",So.COMPOSITE="composite";let $a=So;class HS{constructor(e,n){this.texture=e,this.imageUrl=n}}class WS{constructor(e,n){this.effectName=e,this.thumbnailUrl=n}}class jS{constructor(e,n,r){this._productName=e,this._customImage=n,this._furnitureClassName=r}get productName(){return this._productName}get customImage(){return this._customImage}get furnitureClassName(){return this._furnitureClassName}}const Ys=class Ys{};Ys.STATE_UNLOCKED=1,Ys.STATE_LOCKED_AVAILABLE=2,Ys.STATE_LOCKED_EXPIRED=3,Ys.STATE_LOCKED_FUTURE=4;let nn=Ys;const Na=class Na{};Na.TYPE_CHAT=1,Na.TYPE_ROOM_INFO=2,Na.TYPE_IM=3;let rr=Na;const Jm=()=>{const i=new Date;return`${i.getHours().toString().padStart(2,"0")}:${i.getMinutes().toString().padStart(2,"0")}`},Du=(i=0)=>{const e=i?new Date(Date.now()-i*1e3):new Date;return`${e.getHours().toString().padStart(2,"0")}:${e.getMinutes().toString().padStart(2,"0")}`},Zm=i=>{if(!i||!i.length)return null;const e=i.split("/"),n=e[0],r=e[1],s=parseInt(e[2]);return{username:n,figure:r,userId:s}},$s=class $s{constructor(){this.id=-1,this.name=null,this.gender=0,this.online=!1,this.followingAllowed=!1,this.figure=null,this.categoryId=0,this.motto=null,this.realName=null,this.lastAccess=null,this.persistedMessageUser=!1,this.vipMember=!1,this.pocketHabboUser=!1,this.relationshipStatus=-1,this.unread=0}populate(e){this.id=e.id,this.name=e.name,this.gender=e.gender,this.online=e.online,this.followingAllowed=e.followingAllowed,this.figure=e.figure,this.categoryId=e.categoryId,this.motto=e.motto,this.realName=e.realName,this.lastAccess=e.lastAccess,this.persistedMessageUser=e.persistedMessageUser,this.vipMember=e.vipMember,this.pocketHabboUser=e.pocketHabboUser,this.relationshipStatus=e.relationshipStatus}};$s.RELATIONSHIP_NONE=0,$s.RELATIONSHIP_HEART=1,$s.RELATIONSHIP_SMILE=2,$s.RELATIONSHIP_BOBBA=3;let dn=$s;const No=class No{};No.GROUP_CHAT=0,No.PRIVATE_CHAT=1;let Ss=No;const Ta=class Ta{};Ta.HIDDEN=0,Ta.SHOW=1,Ta.UNREAD=2;let Er=Ta;class Pu{populate(e){return e?(this._id=e.requestId,this._name=e.requesterName,this._figureString=e.figureString,this._requesterUserId=e.requesterUserId,!0):!1}get id(){return this._id}get name(){return this._name}get requesterUserId(){return this._requesterUserId}get figureString(){return this._figureString}}class qS{constructor(e=0,n=0,r=0,s=[]){this.userFriendLimit=e,this.normalFriendLimit=n,this.extendedFriendLimit=r,this.categories=s}}const Ks=class Ks{constructor(e,n,r=0,s=null,a=0){this._type=a,this._senderId=e,this._message=n,this._secondsSinceSent=r,this._extraData=s,this._date=new Date}get type(){return this._type}get senderId(){return this._senderId}get message(){return this._message}get secondsSinceSent(){return this._secondsSinceSent}get extraData(){return this._extraData}get date(){return this._date}};Ks.CHAT=0,Ks.ROOM_INVITE=1,Ks.STATUS_NOTIFICATION=2,Ks.SECURITY_NOTIFICATION=3;let Fr=Ks;class zS{constructor(e,n=Ss.PRIVATE_CHAT){this._userId=e,this._chats=[],this._type=n}addChat(e){this._chats.push(e)}get userId(){return this._userId}get chats(){return this._chats}get type(){return this._type}set type(e){this._type=e}}const va=class va{constructor(e){this._threadId=++va.THREAD_ID,this._participant=e,this._groups=[],this._lastUpdated=new Date,this._unreadCount=0}addMessage(e,n,r=0,s=null,a=0){const c=e<0&&s,u=c?Zm(s).userId:e,d=this.getLastGroup(u);if(!d)return;c&&(d.type=Ss.GROUP_CHAT);const g=new Fr(e,n,r,s,a);return d.addChat(g),this._lastUpdated=new Date,this._unreadCount++,g}getLastGroup(e){let n=this._groups[this._groups.length-1];return n&&n.userId===e||(n=new zS(e),this._groups.push(n)),n}setRead(){this._unreadCount=0}get threadId(){return this._threadId}get participant(){return this._participant}get groups(){return this._groups}get lastUpdated(){return this._lastUpdated}get unreadCount(){return this._unreadCount}get unread(){return this._unreadCount>0}};va.MESSAGE_RECEIVED="MT_MESSAGE_RECEIVED",va.THREAD_ID=0;let sc=va;function Yo(i=0){Z(i===0?"friends-messenger/toggle":`friends-messenger/${i}`)}const YS=()=>am.RENDERER_VERSION,eh=()=>"2.2.0";function ii(i){L(new Ga(i,!0))}function th(i){Z(`groups/manage/${i}`)}function Lu(i,e){Z(e?`group-members/${i}/${e}`:`group-members/${i}`)}const Xs=class Xs{constructor(e,n,r,s){this.type=e,this.key=n||0,this.color=r||0,this.position=s||4}get code(){return this.key===0&&this.type!==Xs.BASE?null:Xs.getCode(this.type,this.key,this.color,this.position)}static getCode(e,n,r,s){return e+(n<10?"0":"")+n+(r<10?"0":"")+r+s}};Xs.BASE="b",Xs.SYMBOL="s";let tn=Xs;const wa=class wa{};wa.NOT_MEMBER=0,wa.MEMBER=1,wa.REQUEST_PENDING=2;let Pt=wa;const Ra=class Ra{};Ra.REGULAR=0,Ra.EXCLUSIVE=1,Ra.PRIVATE=2;let On=Ra;const $S=i=>{L(i.favourite?new Ag(i.groupId):new Dg(i.groupId))},Dc=i=>L(new Pg(i)),Tt=class Tt{};Tt.NONE="NONE",Tt.ERROR="ERROR",Tt.REJECTED="REJECTED",Tt.USER_CREATE="USER_CREATE",Tt.USER_PENDING="USER_PENDING",Tt.USER_ONGOING="USER_ONGOING",Tt.USER_FEEDBACK="USER_FEEDBACK",Tt.USER_NO_HELPERS="USER_NO_HELPERS",Tt.USER_SOMETHING_WRONG="USER_SOMETHING_WRONG",Tt.USER_THANKS="USER_THANKS",Tt.USER_GUIDE_DISCONNECTED="USER_GUIDE_DISCONNECTED",Tt.GUIDE_TOOL_MENU="GUIDE_TOOL_MENU",Tt.GUIDE_ACCEPT="GUIDE_ACCEPT",Tt.GUIDE_ONGOING="GUIDE_ONGOING",Tt.GUIDE_CLOSED="GUIDE_CLOSED",Tt.GUARDIAN_CHAT_REVIEW_ACCEPT="GUARDIAN_CHAT_REVIEW_ACCEPT",Tt.GUARDIAN_CHAT_REVIEW_WAIT_FOR_VOTERS="GUARDIAN_CHAT_REVIEW_WAIT_FOR_VOTERS",Tt.GUARDIAN_CHAT_REVIEW_VOTE="GUARDIAN_CHAT_REVIEW_VOTE",Tt.GUARDIAN_CHAT_REVIEW_WAIT_FOR_RESULTS="GUARDIAN_CHAT_REVIEW_WAIT_FOR_RESULTS",Tt.GUARDIAN_CHAT_REVIEW_RESULTS="GUARDIAN_CHAT_REVIEW_RESULTS";let Ae=Tt;class Mu{constructor(e,n){this._message=e,this._roomId=n}get message(){return this._message}get roomId(){return this._roomId}}class Uu{constructor(e){this._userId=e,this._messages=[]}addChat(e){this._messages.push(e)}get userId(){return this._userId}get messages(){return this._messages}}const Oa=class Oa{};Oa.ACTIVE="active",Oa.NONE="none",Oa.EXPIRED="expired";let fr=Oa;const KS="HC1",XS=["ACH_VipHC1","ACH_VipHC2","ACH_VipHC3","ACH_VipHC4","ACH_VipHC5","HC1","HC2","HC3","HC4","HC5"],QS=i=>{let e=null;return XS.forEach(n=>i.indexOf(n)>-1&&(e=n)),e||KS},To=class To{};To.TOO_MANY_PENDING_CALLS_CODE=1,To.HAS_ABUSIVE_CALL_CODE=2;let oo=To;const JS=i=>i===1?"useless":i===2?"abusive":"resolved",ps=class ps{};ps.SELECT_USER=0,ps.SELECT_CHATS=1,ps.SELECT_TOPICS=2,ps.INPUT_REPORT_MESSAGE=3,ps.REPORT_SUMMARY=4;let $t=ps;const ur=class ur{};ur.EMERGENCY=1,ur.GUIDE=2,ur.IM=3,ur.ROOM=4,ur.BULLY=6,ur.THREAD=7,ur.MESSAGE=8,ur.PHOTO=9;let st=ur;const ZS=i=>{switch(i){case 1:case 2:return"Normal";case 3:return"Automatic";case 4:return"Automatic IM";case 5:return"Guide System";case 6:return"IM";case 7:return"Room";case 8:return"Panic";case 9:return"Guardian";case 10:return"Automatic Helper";case 11:return"Discussion";case 12:return"Selfie";case 14:return"Photo";case 15:return"Ambassador"}return"Unknown"},Xr=class Xr{constructor(e,n,r,s,a){this._actionId=e,this._name=n,this._actionType=r,this._sanctionTypeId=s,this._actionLengthHours=a}get actionId(){return this._actionId}get name(){return this._name}get actionType(){return this._actionType}get sanctionTypeId(){return this._sanctionTypeId}get actionLengthHours(){return this._actionLengthHours}};Xr.ALERT=1,Xr.MUTE=2,Xr.BAN=3,Xr.KICK=4,Xr.TRADE_LOCK=5,Xr.MESSAGE=6;let Ge=Xr;const Xn=class Xn{};Xn.NONE=0,Xn.START_DOORBELL=1,Xn.START_PASSWORD=2,Xn.STATE_PENDING_SERVER=3,Xn.UPDATE_STATE=4,Xn.STATE_WAITING=5,Xn.STATE_NO_ANSWER=6,Xn.STATE_WRONG_PASSWORD=7,Xn.STATE_ACCEPTED=8;let He=Xn;const ya=class ya{};ya.LIST=0,ya.THUMBNAILS=1,ya.FORCED_THUMBNAILS=2;let Yr=ya;const eN=()=>{const i=[];for(let e=10;e<=100;e=e+10)i.push(e);return i},xu=eN(),xs=[{name:"anything",query:null},{name:"room.name",query:"roomname"},{name:"owner",query:"owner"},{name:"tag",query:"tag"},{name:"group",query:"group"}];function Sn(i){L(new Ji(i,!1,!0))}const Mr=class Mr{};Mr.DEFAULT="default",Mr.MOTD="motd",Mr.MODERATION="moderation",Mr.EVENT="event",Mr.NITRO="nitro",Mr.SEARCH="search",Mr.ALERT="alert";let ge=Mr;const ka=class ka{constructor(e,n=ge.DEFAULT,r=null,s=null,a=null,c=null){ka.ITEM_ID+=1,this._id=ka.ITEM_ID,this._messages=e,this._alertType=n,this._clickUrl=r,this._clickUrlText=s,this._title=a,this._imageUrl=c}get id(){return this._id}get messages(){return this._messages}set alertType(e){this._alertType=e}get alertType(){return this._alertType}get clickUrl(){return this._clickUrl}get clickUrlText(){return this._clickUrlText}get title(){return this._title}get imageUrl(){return this._imageUrl}};ka.ITEM_ID=-1;let lo=ka;const _t=class _t{};_t.FRIENDOFFLINE="friendoffline",_t.FRIENDONLINE="friendonline",_t.THIRDPARTYFRIENDOFFLINE="thirdpartyfriendoffline",_t.THIRDPARTYFRIENDONLINE="thirdpartyfriendonline",_t.ACHIEVEMENT="achievement",_t.BADGE_RECEIVED="badge_received",_t.INFO="info",_t.RECYCLEROK="recyclerok",_t.RESPECT="respect",_t.CLUB="club",_t.SOUNDMACHINE="soundmachine",_t.PETLEVEL="petlevel",_t.CLUBGIFT="clubgift",_t.BUYFURNI="buyfurni",_t.VIP="vip",_t.ROOMMESSAGESPOSTED="roommessagesposted",_t.MENTION="mention",_t.SUCCESS="success",_t.WARNING="warning",_t.ERROR="error",_t.GIFT="gift";let ft=_t;const Aa=class Aa{constructor(e,n=ft.INFO,r=null,s=null){Aa.ITEM_ID+=1,this._id=Aa.ITEM_ID,this._message=e,this._notificationType=n,this._iconUrl=r,this._linkUrl=s}get id(){return this._id}get message(){return this._message}get notificationType(){return this._notificationType}get iconUrl(){return this._iconUrl}get linkUrl(){return this._linkUrl}};Aa.ITEM_ID=-1;let ac=Aa;const Da=class Da{constructor(e,n,r,s,a,c,u){Da.ITEM_ID+=1,this._id=Da.ITEM_ID,this._confirmType=e,this._message=n,this._onConfirm=r,this._onCancel=s,this._confirmText=a,this._cancelText=c,this._title=u}get id(){return this._id}get confirmType(){return this._confirmType}get message(){return this._message}get onConfirm(){return this._onConfirm}get onCancel(){return this._onCancel}get confirmText(){return this._confirmText}get cancelText(){return this._cancelText}get title(){return this._title}};Da.ITEM_ID=-1;let ic=Da;const Kc=class Kc{};Kc.DEFAULT="default";let Fu=Kc;class Pc{constructor(){this._credits=0,this._activityPoints=new Map,this._clubDays=0,this._clubPeriods=0,this._isVIP=!1,this._pastClubDays=0,this._pastVipDays=0,this._isExpiring=!1,this._minutesUntilExpiration=0,this._minutesSinceLastModified=0,this._lastUpdated=0}static from(e){const n=new Pc;return n._credits=e._credits,n._activityPoints=e._activityPoints,n._clubDays=e._clubDays,n._clubPeriods=e._clubPeriods,n._isVIP=e._isVIP,n._pastClubDays=e._pastClubDays,n._pastVipDays=e._pastVipDays,n._isExpiring=e._isExpiring,n._minutesUntilExpiration=e._minutesUntilExpiration,n._minutesSinceLastModified=e._minutesSinceLastModified,n._lastUpdated=e._lastUpdated,n}get credits(){return this._credits}set credits(e){this._lastUpdated=Hn(),this._credits=e}get activityPoints(){return this._activityPoints}set activityPoints(e){this._lastUpdated=Hn(),this._activityPoints=e}get clubDays(){return this._clubDays}set clubDays(e){this._lastUpdated=Hn(),this._clubDays=e}get clubPeriods(){return this._clubPeriods}set clubPeriods(e){this._lastUpdated=Hn(),this._clubPeriods=e}get hasClubLeft(){return this._clubDays>0||this._clubPeriods>0}get isVip(){return this._isVIP}set isVip(e){this._isVIP=e}get pastClubDays(){return this._pastClubDays}set pastClubDays(e){this._lastUpdated=Hn(),this._pastClubDays=e}get pastVipDays(){return this._pastVipDays}set pastVipDays(e){this._lastUpdated=Hn(),this._pastVipDays=e}get isExpiring(){return this._isExpiring}set isExpiring(e){this._isExpiring=e}get minutesUntilExpiration(){var e=(Hn()-this._lastUpdated)/6e4,n=this._minutesUntilExpiration-e;return n>0?n:0}set minutesUntilExpiration(e){this._lastUpdated=Hn(),this._minutesUntilExpiration=e}get minutesSinceLastModified(){return this._minutesSinceLastModified}set minutesSinceLastModified(e){this._lastUpdated=Hn(),this._minutesSinceLastModified=e}get lastUpdated(){return this._lastUpdated}get clubLevel(){return this.clubDays===0&&this.clubPeriods===0?bn.NO_CLUB:this.isVip?bn.VIP:bn.CLUB}}class oi extends an{}const Pa=class Pa extends oi{constructor(e,n){super(e),this._id=-1,this._numQuestions=0,this._startMessage="",this._endMessage="",this._questionArray=null,this._pollType="",this._npsPoll=!1,this._id=n}get id(){return this._id}get summary(){return this._summary}set summary(e){this._summary=e}get headline(){return this._headline}set headline(e){this._headline=e}get numQuestions(){return this._numQuestions}set numQuestions(e){this._numQuestions=e}get startMessage(){return this._startMessage}set startMessage(e){this._startMessage=e}get endMessage(){return this._endMessage}set endMessage(e){this._endMessage=e}get questionArray(){return this._questionArray}set questionArray(e){this._questionArray=e}get pollType(){return this._pollType}set pollType(e){this._pollType=e}get npsPoll(){return this._npsPoll}set npsPoll(e){this._npsPoll=e}};Pa.OFFER="RWPUW_OFFER",Pa.ERROR="RWPUW_ERROR",Pa.CONTENT="RWPUW_CONTENT";let $r=Pa;const vo=class vo extends oi{constructor(e,n=0,r=0,s=0){super(e),this._hue=n,this._saturation=r,this._lightness=s}get hue(){return this._hue}get saturation(){return this._saturation}get lightness(){return this._lightness}};vo.PREVIEW="RWUBCPE_PREVIEW",vo.CLEAR_PREVIEW="RWUBCPE_CLEAR_PREVIEW";let Jr=vo;const Qs=class Qs extends oi{constructor(e,n){super(Qs.CHAT_INPUT_CONTENT),this._chatMode="",this._userName="",this._chatMode=e,this._userName=n}get chatMode(){return this._chatMode}get userName(){return this._userName}};Qs.CHAT_INPUT_CONTENT="RWUCICE_CHAT_INPUT_CONTENT",Qs.WHISPER="whisper",Qs.SHOUT="shout";let Ns=Qs;const wo=class wo extends oi{constructor(e,n,r,s,a,c,u){super(wo.UPDATE_CHAT),this._objectId=e,this._category=n,this._botId=r,this._chat=s,this._automaticChat=a,this._chatDelay=c,this._mixSentences=u}get objectId(){return this._objectId}get category(){return this._category}get botId(){return this._botId}get chat(){return this._chat}get automaticChat(){return this._automaticChat}get chatDelay(){return this._chatDelay}get mixSentences(){return this._mixSentences}};wo.UPDATE_CHAT="RWURBCE_UPDATE_CHAT";let co=wo;const Vn=class Vn extends oi{constructor(e,n,r,s){super(e),this._id=n,this._category=r,this._roomId=s}get id(){return this._id}get category(){return this._category}get roomId(){return this._roomId}};Vn.OBJECT_SELECTED="RWUROE_OBJECT_SELECTED",Vn.OBJECT_DESELECTED="RWUROE_OBJECT_DESELECTED",Vn.USER_REMOVED="RWUROE_USER_REMOVED",Vn.FURNI_REMOVED="RWUROE_FURNI_REMOVED",Vn.FURNI_ADDED="RWUROE_FURNI_ADDED",Vn.USER_ADDED="RWUROE_USER_ADDED",Vn.OBJECT_ROLL_OVER="RWUROE_OBJECT_ROLL_OVER",Vn.OBJECT_ROLL_OUT="RWUROE_OBJECT_ROLL_OUT",Vn.OBJECT_REQUEST_MANIPULATION="RWUROE_OBJECT_REQUEST_MANIPULATION",Vn.OBJECT_DOUBLE_CLICKED="RWUROE_OBJECT_DOUBLE_CLICKED";let Ve=Vn;class tN{constructor(e,n){this._data=[e,n]}getMessageArray(){return this._data}dispose(){}}const Xc=class Xc{constructor(e){this.type=e,this.id=0,this.category=0,this.name="",this.description="",this.image=null,this.isWallItem=!1,this.isStickie=!1,this.isRoomOwner=!1,this.roomControllerLevel=0,this.isAnyRoomController=!1,this.expiration=-1,this.purchaseCatalogPageId=-1,this.purchaseOfferId=-1,this.extraParam="",this.isOwner=!1,this.stuffData=null,this.groupId=0,this.ownerId=0,this.ownerName="",this.usagePolicy=0,this.rentCatalogPageId=-1,this.rentOfferId=-1,this.purchaseCouldBeUsedForBuyout=!1,this.rentCouldBeUsedForBuyout=!1,this.availableForBuildersClub=!1,this.tileSizeX=1,this.tileSizeY=1}};Xc.FURNI="IFI_FURNI";let vs=Xc;class nh{constructor(e,n,r,s,a,c=!1){this.roomIndex=e,this.category=n,this.id=r,this.name=s,this.userType=a,this.isFriend=c}}const Qc=class Qc{constructor(e){this.type=e,this.level=0,this.maximumLevel=0,this.experience=0,this.levelExperienceGoal=0,this.energy=0,this.maximumEnergy=0,this.happyness=0,this.maximumHappyness=0,this.respectsPetLeft=0,this.respect=0,this.age=0,this.name="",this.id=-1,this.image=null,this.petType=0,this.petBreed=0,this.petFigure="",this.posture="std",this.isOwner=!1,this.ownerId=-1,this.ownerName="",this.canRemovePet=!1,this.roomIndex=0,this.unknownRarityLevel=0,this.saddle=!1,this.rider=!1,this.breedable=!1,this.skillTresholds=[],this.publiclyRideable=0,this.fullyGrown=!1,this.dead=!1,this.rarityLevel=0,this.maximumTimeToLive=0,this.remainingTimeToLive=0,this.remainingGrowTime=0,this.publiclyBreedable=!1}};Qc.PET_INFO="IPI_PET_INFO";let ws=Qc;const Jc=class Jc{constructor(e){this.type=e,this.name="",this.motto="",this.webID=0,this.figure="",this.badges=[],this.carryItem=0,this.roomIndex=0,this.amIOwner=!1,this.amIAnyRoomController=!1,this.roomControllerLevel=0,this.ownerId=-1,this.ownerName="",this.botSkills=[]}};Jc.RENTABLE_BOT="IRBI_RENTABLE_BOT";let Rs=Jc;const dr=class dr{constructor(e){this.type=e,this.name="",this.motto="",this.achievementScore=0,this.webID=0,this.xp=0,this.userType=-1,this.figure="",this.badges=[],this.groupId=0,this.groupName="",this.groupBadgeId="",this.carryItem=0,this.roomIndex=0,this.isSpectatorMode=!1,this.allowNameChange=!1,this.amIOwner=!1,this.amIAnyRoomController=!1,this.roomControllerLevel=0,this.canBeKicked=!1,this.canBeBanned=!1,this.canBeMuted=!1,this.respectLeft=0,this.isIgnored=!1,this.isGuildRoom=!1,this.canTrade=!1,this.canTradeReason=0,this.targetRoomControllerLevel=0,this.isAmbassador=!1}get isOwnUser(){return this.type===dr.OWN_USER}};dr.OWN_USER="IUI_OWN_USER",dr.PEER="IUI_PEER",dr.BOT="IUI_BOT",dr.TRADE_REASON_OK=0,dr.TRADE_REASON_SHUTDOWN=2,dr.TRADE_REASON_NO_TRADING=3,dr.DEFAULT_BOT_BADGE_ID="BOT";let vt=dr;class Fs{static getObjectName(e,n){const r=Re();let s=-1,a=null,c=0;switch(n){case J.FLOOR:case J.WALL:{const u=j().getRoomObject(r.roomId,e,n);if(!u)break;if(u.type.indexOf("poster")===0)a=h("${poster_"+parseInt(u.type.replace("poster",""))+"_name}");else{let d=null;const g=u.model.getValue(ee.FURNITURE_TYPE_ID);if(n===J.FLOOR?d=W().getFloorItemData(g):n===J.WALL&&(d=W().getWallItemData(g)),!d)break;s=d.id,a=d.name}break}case J.UNIT:{const u=r.userDataManager.getUserDataByIndex(e);if(!u)break;s=u.webID,a=u.name,c=u.type;break}}return!a||!a.length?null:new nh(e,n,s,a,c)}static getFurniInfo(e,n){const r=Re(),s=new vs(vs.FURNI);s.id=e,s.category=n;const a=j().getRoomObject(r.roomId,e,n);if(!a)return;const c=a.model;c.getValue(kr.INFOSTAND_EXTRA_PARAM)&&(s.extraParam=c.getValue(kr.INFOSTAND_EXTRA_PARAM));const u=c.getValue(ee.FURNITURE_DATA_FORMAT),d=im.getData(u);d.initializeFromRoomObjectModel(c),s.stuffData=d;const g=a.type;if(g.indexOf("poster")===0){const E=parseInt(g.replace("poster",""));s.name=h("${poster_"+E+"_name}"),s.description=h("${poster_"+E+"_desc}")}else{const E=c.getValue(ee.FURNITURE_TYPE_ID);let C=null;n===J.FLOOR?C=W().getFloorItemData(E):n===J.WALL&&(C=W().getWallItemData(E)),C&&(s.name=C.name,s.description=C.description,s.purchaseOfferId=C.purchaseOfferId,s.purchaseCouldBeUsedForBuyout=C.purchaseCouldBeUsedForBuyout,s.rentOfferId=C.rentOfferId,s.rentCouldBeUsedForBuyout=C.rentCouldBeUsedForBuyout,s.availableForBuildersClub=C.availableForBuildersClub,s.tileSizeX=C.tileSizeX,s.tileSizeY=C.tileSizeY)}g.indexOf("post_it")>-1&&(s.isStickie=!0);const m=c.getValue(ee.FURNITURE_EXPIRY_TIME),f=c.getValue(ee.FURNITURE_EXPIRTY_TIMESTAMP);s.expiration=m<0?m:Math.max(0,m-(Hn()-f)/1e3);let p=j().getRoomObjectImage(r.roomId,e,n,new Ot(180),64,null);(!p.data||p.data.width>140||p.data.height>200)&&(p=j().getRoomObjectImage(r.roomId,e,n,new Ot(180),1,null)),s.image=p.getImage(),s.isWallItem=n===J.WALL,s.isRoomOwner=r.isRoomOwner,s.roomControllerLevel=r.controllerLevel,s.isAnyRoomController=W().isModerator,s.ownerId=c.getValue(ee.FURNITURE_OWNER_ID),s.ownerName=c.getValue(ee.FURNITURE_OWNER_NAME),s.usagePolicy=c.getValue(ee.FURNITURE_USAGE_POLICY);const _=c.getValue(ee.FURNITURE_GUILD_CUSTOMIZED_GUILD_ID);return _!==0&&(s.groupId=_),Yt(a)&&(s.isOwner=!0),s}static getUserInfo(e,n){const r=Re();let s=vt.OWN_USER;n.webID!==W().userId&&(s=vt.PEER);const a=new vt(s);a.isSpectatorMode=r.isSpectator,a.name=n.name,a.motto=n.custom,a.achievementScore=n.activityPoints,a.webID=n.webID,a.roomIndex=n.roomIndex,a.userType=pt.USER;const c=j().getRoomObject(r.roomId,n.roomIndex,e);if(c&&(a.carryItem=c.model.getValue(ee.FIGURE_CARRY_OBJECT)||0),s===vt.OWN_USER&&(a.allowNameChange=W().canChangeName),a.amIOwner=r.isRoomOwner,a.isGuildRoom=r.isGuildRoom,a.roomControllerLevel=r.controllerLevel,a.amIAnyRoomController=W().isModerator,a.isAmbassador=W().isAmbassador,s===vt.PEER){if(c){const g=c.model.getValue(ee.FIGURE_FLAT_CONTROL);g!==null&&(a.targetRoomControllerLevel=g),a.canBeMuted=this.canBeMuted(a),a.canBeKicked=this.canBeKicked(a),a.canBeBanned=this.canBeBanned(a)}a.isIgnored=W().isUserIgnored(n.name),a.respectLeft=W().respectsLeft;const u=W().isSystemShutdown,d=r.tradeMode;if(u)a.canTrade=!1;else switch(d){case dl.ROOM_CONTROLLER_REQUIRED:{const g=a.roomControllerLevel!==nt.NONE&&a.roomControllerLevel!==nt.GUILD_MEMBER,m=a.targetRoomControllerLevel!==nt.NONE&&a.targetRoomControllerLevel!==nt.GUILD_MEMBER;a.canTrade=g||m;break}case dl.NO_TRADING:a.canTrade=!0;break;default:a.canTrade=!1;break}a.canTradeReason=vt.TRADE_REASON_OK,u&&(a.canTradeReason=vt.TRADE_REASON_SHUTDOWN),d!==dl.FREE_TRADING&&(a.canTradeReason=vt.TRADE_REASON_NO_TRADING)}return a.groupId=n.groupId,a.groupBadgeId=W().getGroupBadge(a.groupId),a.groupName=n.groupName,a.badges=r.userDataManager.getUserBadges(n.webID),a.figure=n.figure,a}static getBotInfo(e,n){const r=Re(),s=new vt(vt.BOT);s.name=n.name,s.motto=n.custom,s.webID=n.webID,s.roomIndex=n.roomIndex,s.userType=n.type;const a=j().getRoomObject(r.roomId,n.roomIndex,e);return a&&(s.carryItem=a.model.getValue(ee.FIGURE_CARRY_OBJECT)||0),s.amIOwner=r.isRoomOwner,s.isGuildRoom=r.isGuildRoom,s.roomControllerLevel=r.controllerLevel,s.amIAnyRoomController=W().isModerator,s.isAmbassador=W().isAmbassador,s.badges=[vt.DEFAULT_BOT_BADGE_ID],s.figure=n.figure,s}static getRentableBotInfo(e,n){const r=Re(),s=new Rs(Rs.RENTABLE_BOT);s.name=n.name,s.motto=n.custom,s.webID=n.webID,s.roomIndex=n.roomIndex,s.ownerId=n.ownerId,s.ownerName=n.ownerName,s.botSkills=n.botSkills;const a=j().getRoomObject(r.roomId,n.roomIndex,e);return a&&(s.carryItem=a.model.getValue(ee.FIGURE_CARRY_OBJECT)||0),s.amIOwner=r.isRoomOwner,s.roomControllerLevel=r.controllerLevel,s.amIAnyRoomController=W().isModerator,s.badges=[vt.DEFAULT_BOT_BADGE_ID],s.figure=n.figure,s}static getPetInfo(e){const n=Re(),r=n.userDataManager.getPetData(e.id);if(!r)return;const s=new sa(r.figure);let a=null;s.typeId===Gt.MONSTERPLANT&&(e.level>=e.adultLevel?a="std":a="grw"+e.level);const c=e.ownerId===W().userId,u=new ws(ws.PET_INFO);return u.name=r.name,u.id=e.id,u.ownerId=e.ownerId,u.ownerName=e.ownerName,u.rarityLevel=e.rarityLevel,u.petType=s.typeId,u.petBreed=s.paletteId,u.petFigure=r.figure,u.posture=a,u.isOwner=c,u.roomIndex=r.roomIndex,u.level=e.level,u.maximumLevel=e.maximumLevel,u.experience=e.experience,u.levelExperienceGoal=e.levelExperienceGoal,u.energy=e.energy,u.maximumEnergy=e.maximumEnergy,u.happyness=e.happyness,u.maximumHappyness=e.maximumHappyness,u.respect=e.respect,u.respectsPetLeft=W().respectsPetLeft,u.age=e.age,u.saddle=e.saddle,u.rider=e.rider,u.breedable=e.breedable,u.fullyGrown=e.fullyGrown,u.dead=e.dead,u.rarityLevel=e.rarityLevel,u.skillTresholds=e.skillTresholds,u.canRemovePet=!1,u.publiclyRideable=e.publiclyRideable,u.maximumTimeToLive=e.maximumTimeToLive,u.remainingTimeToLive=e.remainingTimeToLive,u.remainingGrowTime=e.remainingGrowTime,u.publiclyBreedable=e.publiclyBreedable,(c||n.isRoomOwner||W().isModerator||n.controllerLevel>=nt.GUEST)&&(u.canRemovePet=!0),u}static checkGuildSetting(e){return e.isGuildRoom?e.roomControllerLevel>=nt.GUILD_ADMIN:e.roomControllerLevel>=nt.GUEST}static isValidSetting(e,n){const r=Re();if(!r.isPrivateRoom)return!1;const s=r.moderationSettings;let a=!1;return s&&(a=n(e,s)),a&&e.targetRoomControllerLevel<nt.ROOM_OWNER}static canBeMuted(e){const n=(r,s)=>{switch(s.allowMute){case Zn.MODERATION_LEVEL_USER_WITH_RIGHTS:return this.checkGuildSetting(r);default:return r.roomControllerLevel>=nt.ROOM_OWNER}};return this.isValidSetting(e,n)}static canBeKicked(e){const n=(r,s)=>{switch(s.allowKick){case Zn.MODERATION_LEVEL_ALL:return!0;case Zn.MODERATION_LEVEL_USER_WITH_RIGHTS:return this.checkGuildSetting(r);default:return r.roomControllerLevel>=nt.ROOM_OWNER}};return this.isValidSetting(e,n)}static canBeBanned(e){const n=(r,s)=>{switch(s.allowBan){case Zn.MODERATION_LEVEL_USER_WITH_RIGHTS:return this.checkGuildSetting(r);default:return r.roomControllerLevel>=nt.ROOM_OWNER}};return this.isValidSetting(e,n)}}const jt=class jt{};jt.GENERIC_SKILL=0,jt.DRESS_UP=1,jt.SETUP_CHAT=2,jt.RANDOM_WALK=3,jt.DANCE=4,jt.CHANGE_BOT_NAME=5,jt.SERVE_BEVERAGE=6,jt.INCLIENT_LINK=7,jt.NUX_PROCEED=8,jt.CHANGE_BOT_MOTTO=9,jt.NUX_TAKE_TOUR=10,jt.NO_PICK_UP=12,jt.NAVIGATOR_SEARCH=14,jt.DONATE_TO_USER=24,jt.DONATE_TO_ALL=25;let qe=jt;const Ro=class Ro{constructor(e=-1,n=-1,r=-1,s="",a="",c="",u=null,d=0,g=0,m=null,f=null){this.senderId=e,this.senderCategory=n,this.roomId=r,this.text=s,this.formattedText=a,this.username=c,this.location=u,this.type=d,this.styleId=g,this.imageUrl=m,this.color=f,this.id=-1,this.width=0,this.height=0,this.elementRef=null,this.skipMovement=!1,this._top=0,this._left=0,this.id=++Ro.BUBBLE_COUNTER}get top(){return this._top}set top(e){this._top=e,this.elementRef&&(this.elementRef.style.top=this._top+"px")}get left(){return this._left}set left(e){this._left=e,this.elementRef&&(this.elementRef.style.left=this._left+"px")}};Ro.BUBBLE_COUNTER=0;let oc=Ro;const La=class La{};La.CHAT_DEFAULT=0,La.CHAT_WHISPER=1,La.CHAT_SHOUT=2;let pr=La;class Gu{constructor(e=0,n=0,r=0,s=0){this.id=e,this.type=n,this.color=r,this.light=s}}const nN=(i,e,n,r=0)=>!(i.left+r+i.width<e.left+r||i.left+r>e.left+r+e.width||i.top+i.height<e.top+n||i.top>e.top+n+e.height),Js=class Js{static savePreset(e,n,r,s,a){Re().updateMoodlightData(e,n,r,s,a)}static changeState(){Re().toggleMoodlightState()}static previewDimmer(e,n,r){j().updateObjectRoomColor(Re().roomId,e,n,r)}static scaleBrightness(e){return~~((e-this.MIN_BRIGHTNESS)*(100-0)/(this.MAX_BRIGHTNESS-this.MIN_BRIGHTNESS)+0)}};Js.AVAILABLE_COLORS=[7665141,21495,15161822,15353138,15923281,8581961,0],Js.HTML_COLORS=["#74F5F5","#0053F7","#E759DE","#EA4532","#F2F851","#82F349","#000000"],Js.MIN_BRIGHTNESS=76,Js.MAX_BRIGHTNESS=255;let Wn=Js;const rN=130,sN=100,aN=130,iN=100,oN=130,lN=100,rh=i=>{let e=0,n=0,r=0,s=0;for(;s<i.length;){switch(s%3){case 0:e=e+i.charCodeAt(s)*37;break;case 1:n=n+i.charCodeAt(s)*37;break;case 2:r=r+i.charCodeAt(s)*37;break}s++}return e=e%sN+rN,n=n%iN+aN,r=r%lN+oN,`rgb(${e},${n},${r})`},Oo=class Oo{static getMergedMannequinFigureContainer(e,n){const r=kt().createFigureContainer(e),s=kt().createFigureContainer(n);for(const a of this.MANNEQUIN_CLOTHING_PART_TYPES)r.removePart(a);for(const a of s.getPartTypeIds())r.updatePart(a,s.getPartSetId(a),s.getPartColorIds(a));return r}static transformAsMannequinFigure(e){for(const n of e.getPartTypeIds())this.MANNEQUIN_CLOTHING_PART_TYPES.indexOf(n)>=0||e.removePart(n);e.updatePart(this.MANNEQUIN_FIGURE[0],this.MANNEQUIN_FIGURE[1],this.MANNEQUIN_FIGURE[2])}};Oo.MANNEQUIN_FIGURE=["hd",99999,[99998]],Oo.MANNEQUIN_CLOTHING_PART_TYPES=[Fe.CHEST_ACCESSORY,Fe.COAT_CHEST,Fe.CHEST,Fe.LEGS,Fe.SHOES,Fe.WAIST_ACCESSORY];let ra=Oo;const yo=class yo{};yo.WATER=0,yo.LIGHT=1;let Vu=yo;const ko=class ko{};ko.POSTURE_STAND=0,ko.POSTURE_SIT=1;let uo=ko;class Ws{constructor(e,n,r){this._id=e,this._category=n,this._name=r}get id(){return this._id}get category(){return this._category}get name(){return this._name}}class cN{constructor(e,n,r,s,a,c,u){this.id=e,this.category=n,this.name=r,this.requestRoomObjectId=s,this.targetRoomObjectId=a,this.requestInventoryStripId=c,this.replace=u}}const mo="0",sh="1",Qr=class Qr{};Qr.UNSTARTED=-1,Qr.ENDED=0,Qr.PLAYING=1,Qr.PAUSED=2,Qr.BUFFERING=3,Qr.CUED=5;let Zr=Qr;function hn(i){L(new Lg(i))}const li=i=>{const e=Math.floor(i/2);return i%2?(e+.5).toString():e.toString()},$e=class $e{};$e.TOGGLE_FURNI_STATE=0,$e.RESET=1,$e.SET_FURNI_STATE=3,$e.MOVE_FURNI=4,$e.GIVE_SCORE=6,$e.CHAT=7,$e.TELEPORT=8,$e.JOIN_TEAM=9,$e.LEAVE_TEAM=10,$e.CHASE=11,$e.FLEE=12,$e.MOVE_AND_ROTATE_FURNI=13,$e.GIVE_SCORE_TO_PREDEFINED_TEAM=14,$e.TOGGLE_TO_RANDOM_STATE=15,$e.MOVE_FURNI_TO=16,$e.GIVE_REWARD=17,$e.CALL_ANOTHER_STACK=18,$e.KICK_FROM_ROOM=19,$e.MUTE_USER=20,$e.BOT_TELEPORT=21,$e.BOT_MOVE=22,$e.BOT_TALK=23,$e.BOT_GIVE_HAND_ITEM=24,$e.BOT_FOLLOW_AVATAR=25,$e.BOT_CHANGE_FIGURE=26,$e.BOT_TALK_DIRECT_TO_AVTR=27;let tt=$e;const Ke=class Ke{};Ke.STATES_MATCH=0,Ke.FURNIS_HAVE_AVATARS=1,Ke.ACTOR_IS_ON_FURNI=2,Ke.TIME_ELAPSED_MORE=3,Ke.TIME_ELAPSED_LESS=4,Ke.USER_COUNT_IN=5,Ke.ACTOR_IS_IN_TEAM=6,Ke.HAS_STACKED_FURNIS=7,Ke.STUFF_TYPE_MATCHES=8,Ke.STUFFS_IN_FORMATION=9,Ke.ACTOR_IS_GROUP_MEMBER=10,Ke.ACTOR_IS_WEARING_BADGE=11,Ke.ACTOR_IS_WEARING_EFFECT=12,Ke.NOT_STATES_MATCH=13,Ke.FURNI_NOT_HAVE_HABBO=14,Ke.NOT_ACTOR_ON_FURNI=15,Ke.NOT_USER_COUNT_IN=16,Ke.NOT_ACTOR_IN_TEAM=17,Ke.NOT_HAS_STACKED_FURNIS=18,Ke.NOT_FURNI_IS_OF_TYPE=19,Ke.NOT_STUFFS_IN_FORMATION=20,Ke.NOT_ACTOR_IN_GROUP=21,Ke.NOT_ACTOR_WEARS_BADGE=22,Ke.NOT_ACTOR_WEARING_EFFECT=23,Ke.DATE_RANGE_ACTIVE=24,Ke.ACTOR_HAS_HANDITEM=25;let ot=Ke;const Bu=i=>`${i.getFullYear()}/${("0"+(i.getMonth()+1)).slice(-2)}/${("0"+i.getDate()).slice(-2)} ${("0"+i.getHours()).slice(-2)}:${("0"+i.getMinutes()).slice(-2)}`,Zs=class Zs{};Zs.STUFF_SELECTION_OPTION_NONE=0,Zs.STUFF_SELECTION_OPTION_BY_ID=1,Zs.STUFF_SELECTION_OPTION_BY_ID_OR_BY_TYPE=2,Zs.STUFF_SELECTION_OPTION_BY_ID_BY_TYPE_OR_FROM_CONTEXT=3;let de=Zs;const uN=`
attribute vec2 aVertexPosition;
attribute vec2 aTextureCoord;
uniform mat3 projectionMatrix;
varying vec2 vTextureCoord;
void main(void)
{
    gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);
    vTextureCoord = aTextureCoord;
}`,dN=`
varying vec2 vTextureCoord;
uniform sampler2D uSampler;
uniform vec3 lineColor;
uniform vec3 color;
void main(void) {
    vec4 currentColor = texture2D(uSampler, vTextureCoord);
    vec3 colorLine = lineColor * currentColor.a;
    vec3 colorOverlay = color * currentColor.a;

    if(currentColor.r == 0.0 && currentColor.g == 0.0 && currentColor.b == 0.0 && currentColor.a > 0.0) {
        gl_FragColor = vec4(colorLine.r, colorLine.g, colorLine.b, currentColor.a);
    } else if(currentColor.a > 0.0) {
        gl_FragColor = vec4(colorOverlay.r, colorOverlay.g, colorOverlay.b, currentColor.a);
    }
}`;class mN extends Mg{constructor(e,n){super(uN,dN),this.uniforms.lineColor=new Float32Array(3),this.uniforms.color=new Float32Array(3),this.lineColor=e,this.color=n}get lineColor(){return this._lineColor}set lineColor(e){const n=this.uniforms.lineColor;typeof e=="number"?(Cn.hex2rgb(e,n),this._lineColor=e):(n[0]=e[0],n[1]=e[1],n[2]=e[2],this._lineColor=Cn.rgb2hex(n))}get color(){return this._color}set color(e){const n=this.uniforms.color;typeof e=="number"?(Cn.hex2rgb(e,n),this._color=e):(n[0]=e[0],n[1]=e[1],n[2]=e[2],this._color=Cn.rgb2hex(n))}}const Bn=class Bn{static show(e){Bn.applySelectionShader(Bn.getRoomObject(e))}static hide(e){Bn.clearSelectionShader(Bn.getRoomObject(e))}static clearSelectionShaderFromFurni(e){for(const n of e)Bn.clearSelectionShader(Bn.getRoomObject(n))}static applySelectionShaderToFurni(e){for(const n of e)Bn.applySelectionShader(Bn.getRoomObject(n))}static getRoomObject(e){const n=j();return n.getRoomObject(n.activeRoomId,e,J.FLOOR)}static applySelectionShader(e){if(!e)return;const n=e.visualization;if(n)for(const r of n.sprites)r.blendMode!==1&&(r.filters=[Bn._selectionShader])}static clearSelectionShader(e){if(!e)return;const n=e.visualization;if(n)for(const r of n.sprites)r.filters=[]}};Bn._selectionShader=new mN([1,1,1],[.6,.6,.6]);let Ts=Bn;const la="	",en=class en{};en.AVATAR_SAYS_SOMETHING=0,en.AVATAR_WALKS_ON_FURNI=1,en.AVATAR_WALKS_OFF_FURNI=2,en.EXECUTE_ONCE=3,en.TOGGLE_FURNI=4,en.EXECUTE_PERIODICALLY=6,en.AVATAR_ENTERS_ROOM=7,en.GAME_STARTS=8,en.GAME_ENDS=9,en.SCORE_ACHIEVED=10,en.COLLISION=11,en.EXECUTE_PERIODICALLY_LONG=12,en.BOT_REACHED_STUFF=13,en.BOT_REACHED_AVATAR=14;let Zt=en;const P=i=>{const{ref:e=null,innerRef:n=null,display:r=null,fit:s=!1,fitV:a=!1,grow:c=!1,shrink:u=!1,fullWidth:d=!1,fullHeight:g=!1,overflow:m=null,position:f=null,float:p=null,pointer:_=!1,visible:E=null,textColor:C=null,classNames:I=[],className:b="",style:S={},children:v=null,...y}=i,R=o.useMemo(()=>{const U=[];return r&&r.length&&U.push("d-"+r),(s||d)&&U.push("w-100"),(s||g)&&U.push("h-100"),a&&U.push("vw-100","vh-100"),c&&U.push("flex-grow-1"),u&&U.push("flex-shrink-0"),m&&U.push("overflow-"+m),f&&U.push("position-"+f),p&&U.push("float-"+p),_&&U.push("cursor-pointer"),E!==null&&U.push(E?"visible":"invisible"),C&&U.push("text-"+C),I.length&&U.push(...I),U},[r,s,a,c,u,d,g,m,f,p,_,E,C,I]),O=o.useMemo(()=>{let U=R.join(" ");return b.length&&(U+=" "+b),U.trim()},[R,b]),F=o.useMemo(()=>{let U={};return Object.keys(S).length&&(U={...U,...S}),U},[S]);return t("div",{ref:n,className:O,style:F,...y,children:v})},ah=o.createContext({isCssGrid:!1}),hN=i=>t(ah.Provider,{value:i.value,children:i.children}),gN=()=>o.useContext(ah),ne=i=>{const{inline:e=!1,gap:n=2,maxContent:r=!1,columnCount:s=0,center:a=!1,alignSelf:c=null,alignItems:u=null,justifyContent:d=null,fullHeight:g=!0,classNames:m=[],style:f={},...p}=i,_=o.useMemo(()=>{const C=[];return e?C.push("inline-grid"):C.push("grid"),n?C.push("gap-"+n):n===0&&C.push("gap-0"),r&&C.push("flex-basis-max-content"),c&&C.push("align-self-"+c),u&&C.push("align-items-"+u),d&&C.push("justify-content-"+d),!u&&!d&&a&&C.push("align-items-center","justify-content-center"),m.length&&C.push(...m),C},[e,n,r,c,u,d,a,m]),E=o.useMemo(()=>{let C={};return s&&(C["--bs-columns"]=s.toString()),Object.keys(f).length&&(C={...C,...f}),C},[s,f]);return t(hN,{value:{isCssGrid:!0},children:t(P,{fullHeight:g,classNames:_,style:E,...p})})},De=i=>{const{columnMinWidth:e=40,columnMinHeight:n=40,columnCount:r=0,fullHeight:s=!1,maxContent:a=!0,overflow:c="auto",style:u={},...d}=i,g=o.useMemo(()=>{let m={};return m["--nitro-grid-column-min-height"]=n+"px",r>1&&(m.gridTemplateColumns=`repeat(auto-fill, minmax(${e}px, 1fr))`),Object.keys(u).length&&(m={...m,...u}),m},[e,n,r,u]);return t(ne,{columnCount:r,fullHeight:s,overflow:c,style:g,...d})},w=i=>{const{display:e="flex",column:n=void 0,reverse:r=!1,gap:s=null,center:a=!1,alignSelf:c=null,alignItems:u=null,justifyContent:d=null,classNames:g=[],...m}=i,f=o.useMemo(()=>{const p=[];return n?r?p.push("flex-column-reverse"):p.push("flex-column"):r&&p.push("flex-row-reverse"),s&&p.push("gap-"+s),c&&p.push("align-self-"+c),u&&p.push("align-items-"+u),d&&p.push("justify-content-"+d),!u&&!d&&a&&p.push("align-items-center","justify-content-center"),g.length&&p.push(...g),p},[n,r,s,a,c,u,d,g]);return t(P,{display:e,classNames:f,...m})},M=i=>{const{variant:e="primary",size:n="sm",active:r=!1,disabled:s=!1,classNames:a=[],...c}=i,u=o.useMemo(()=>{const d=["btn"];return e&&d.push("btn-"+e),n&&d.push("btn-"+n),r&&d.push("active"),s&&d.push("disabled"),a.length&&d.push(...a),d},[e,n,r,s,a]);return t(w,{center:!0,classNames:u,...c})},Cr=i=>{const{classNames:e=[],...n}=i,r=o.useMemo(()=>{const s=["btn-group"];return e.length&&s.push(...e),s},[e]);return t(P,{classNames:r,...n})},ih=o.createContext({closers:null,setClosers:null,closeAll:null}),fN=i=>t(ih.Provider,{...i}),pN=()=>o.useContext(ih),ho=i=>{const{alignItems:e="center",gap:n=1,children:r=null,...s}=i;return t(w,{alignItems:e,gap:n,...s,children:r})},go=i=>{const{headerText:e="",isExpanded:n=!1,gap:r=0,classNames:s=[],children:a=null,...c}=i,[u,d]=o.useState(!1),{setClosers:g=null,closeAll:m=null}=pN(),f=()=>{m(),d(E=>!E)},p=o.useCallback(()=>d(!1),[]),_=o.useMemo(()=>{const E=["nitro-card-accordion-set"];return u&&E.push("active"),s&&s.length&&E.push(...s),E},[u,s]);return o.useEffect(()=>{d(n)},[n]),o.useEffect(()=>{const E=p;return g(C=>{const I=[...C];return I.push(E),I}),()=>{g(C=>{const I=[...C],b=I.indexOf(E);return b>=0&&I.splice(b,1),I})}},[p,g]),l(T,{classNames:_,gap:r,...c,children:[l(w,{pointer:!0,justifyContent:"between",className:"nitro-card-accordion-set-header px-2 py-1",onClick:f,children:[t(N,{children:e}),u&&t(fc,{className:"fa-icon"}),!u&&t(pc,{className:"fa-icon"})]}),u&&t(T,{fullHeight:!0,overflow:"auto",gap:0,className:"nitro-card-accordion-set-content",children:a})]})},IN=i=>{const{...e}=i,[n,r]=o.useState([]),s=o.useCallback(()=>{for(const a of n)a()},[n]);return t(fN,{value:{closers:n,setClosers:r,closeAll:s},children:t(T,{gap:0,...e})})},re=i=>{const{overflow:e="auto",classNames:n=[],...r}=i,s=o.useMemo(()=>{const a=["container-fluid","content-area"];return n.length&&a.push(...n),a},[n]);return t(T,{classNames:s,overflow:e,...r})},EN=o.createContext({theme:null}),CN=i=>t(EN.Provider,{value:i.value,children:i.children}),ae=i=>{const{headerText:e=null,isGalleryPhoto:n=!1,noCloseButton:r=!1,onReportPhoto:s=null,onCloseClick:a=null,justifyContent:c="center",alignItems:u="center",classNames:d=[],children:g=null,...m}=i,f=o.useMemo(()=>{const _=["drag-handler","container-fluid","nitro-card-header"];return d.length&&_.push(...d),_},[d]);return t(T,{center:!0,position:"relative",classNames:f,...m,children:l(w,{fullWidth:!0,center:!0,children:[t("span",{className:"nitro-card-header-text",children:e}),n&&t(P,{position:"absolute",className:"end-4 nitro-card-header-report-camera",onClick:s,children:t(Kh,{className:"fa-icon"})}),t(w,{center:!0,position:"absolute",className:"end-2 nitro-card-header-close",onMouseDownCapture:_=>{_.stopPropagation(),_.nativeEvent.stopImmediatePropagation()},onClick:a,children:t(Dn,{className:"fa-icon w-12 h-12"})})]})})},oh=i=>{const{justifyContent:e="center",classNames:n=[],variant:r="muted",...s}=i,a=o.useMemo(()=>{const c=["container-fluid","p-1"];return n.length&&c.push(...n),c.push("bg-"+r),c},[n,r]);return t(w,{justifyContent:e,classNames:a,...s})},ea=class ea{};ea.CENTER="DWP_CENTER",ea.TOP_CENTER="DWP_TOP_CENTER",ea.TOP_LEFT="DWP_TOP_LEFT",ea.NOTHING="DWP_NOTHING";let Ht=ea;const Or=[],Hu=0,Wu=0,as=i=>{const{uniqueKey:e=null,handleSelector:n=".drag-handler",windowPosition:r=Ht.CENTER,disableDrag:s=!1,dragStyle:a={},children:c=null,offsetLeft:u=0,offsetTop:d=0}=i,[g,m]=o.useState(null),[f,p]=o.useState(null),[_,E]=o.useState({x:0,y:0}),[C,I]=o.useState(!1),[b,S]=o.useState(null),v=o.useRef(),y=o.useCallback(()=>{let Y=400;for(const Ee of Or)Y+=1,Ee.style.zIndex=Y.toString()},[]),R=o.useCallback(()=>{const Y=Or.indexOf(v.current);if(Y===-1)Or.push(v.current);else{if(Y===Or.length-1)return;Y>=0&&(Or.splice(Y,1),Or.push(v.current))}y()},[y]),O=o.useCallback(Y=>{R()},[R]),F=o.useCallback(Y=>{R()},[R]),U=o.useCallback((Y,Ee)=>{E({x:Y,y:Ee}),I(!0)},[]),A=o.useCallback(Y=>{U(Y.clientX,Y.clientY)},[U]),k=o.useCallback(Y=>{const Ee=Y.touches[0];U(Ee.clientX,Ee.clientY)},[U]),D=o.useCallback(Y=>{m({x:Y.clientX-_.x,y:Y.clientY-_.y})},[_]),V=o.useCallback(Y=>{const Ee=Y.touches[0];m({x:Ee.clientX-_.x,y:Ee.clientY-_.y})},[_]),G=o.useCallback(()=>{if(!v.current||!b)return;let Y=f.x+g.x,Ee=f.y+g.y;const ue=v.current.offsetLeft+Y,ye=v.current.offsetTop+Ee;if(ye<Hu?Ee=-v.current.offsetTop:ye+b.offsetHeight>=document.body.offsetHeight-Hu&&(Ee=document.body.offsetHeight-v.current.offsetHeight-v.current.offsetTop),ue+v.current.offsetWidth<Wu?Y=-v.current.offsetLeft:ue>=document.body.offsetWidth-Wu&&(Y=document.body.offsetWidth-v.current.offsetWidth-v.current.offsetLeft),m({x:0,y:0}),p({x:Y,y:Ee}),I(!1),e!==null){const Ye={...so(`nitro.windows.${e}`)};Ye.offset={x:Y,y:Ee},Qm(`nitro.windows.${e}`,Ye)}},[b,g,f,e]),$=o.useCallback(Y=>{G()},[G]),X=o.useCallback(Y=>{G()},[G]);return o.useEffect(()=>{const Y=v.current;if(!Y)return;if(Or.push(Y),y(),!s){const ye=Y.querySelector(n);ye&&S(ye)}let Ee=0,ue=0;switch(r){case Ht.TOP_CENTER:Y.style.top=50+d+"px",Y.style.left=`calc(50vw - ${Y.offsetWidth/2+u}px)`;break;case Ht.CENTER:Y.style.top=`calc(50vh - ${Y.offsetHeight/2+d}px)`,Y.style.left=`calc(50vw - ${Y.offsetWidth/2+u}px)`;break;case Ht.TOP_LEFT:Y.style.top=50+d+"px",Y.style.left=50+u+"px";break}return m({x:0,y:0}),p({x:Ee,y:ue}),()=>{const ye=Or.indexOf(Y);ye>=0&&Or.splice(ye,1)}},[n,r,e,s,u,d,y]),o.useEffect(()=>{if(!f&&!g)return;const Y=v.current;Y&&(Y.style.transform=`translate(${f.x+g.x}px, ${f.y+g.y}px)`,Y.style.visibility="visible")},[f,g]),o.useEffect(()=>{if(b)return b.addEventListener(Oe.MOUSE_DOWN,A),b.addEventListener(Rn.TOUCH_START,k),()=>{b.removeEventListener(Oe.MOUSE_DOWN,A),b.removeEventListener(Rn.TOUCH_START,k)}},[b,A,k]),o.useEffect(()=>{if(C)return document.addEventListener(Oe.MOUSE_UP,$),document.addEventListener(Rn.TOUCH_END,X),document.addEventListener(Oe.MOUSE_MOVE,D),document.addEventListener(Rn.TOUCH_MOVE,V),()=>{document.removeEventListener(Oe.MOUSE_UP,$),document.removeEventListener(Rn.TOUCH_END,X),document.removeEventListener(Oe.MOUSE_MOVE,D),document.removeEventListener(Rn.TOUCH_MOVE,V)}},[C,$,D,X,V]),o.useEffect(()=>{if(!e)return;const Y=so(`nitro.windows.${e}`);!Y||!Y.offset||(m({x:0,y:0}),Y.offset&&p(Y.offset))},[e]),Ic.createPortal(t(P,{position:"absolute",innerRef:v,className:"draggable-window",onMouseDownCapture:O,onTouchStartCapture:F,style:a,children:c}),document.getElementById("draggable-windows-container"))},ie=i=>{const{theme:e="primary",uniqueKey:n=null,handleSelector:r=".drag-handler",windowPosition:s=Ht.CENTER,disableDrag:a=!1,overflow:c="hidden",position:u="relative",gap:d=0,classNames:g=[],...m}=i,f=o.useRef(),p=o.useMemo(()=>{const _=["nitro-card","rounded","shadow"];return _.push(`theme-${e||"primary"}`),g.length&&_.push(...g),_},[e,g]);return t(CN,{value:{theme:e},children:t(as,{uniqueKey:n,handleSelector:r,windowPosition:s,disableDrag:a,children:t(T,{innerRef:f,overflow:c,position:u,gap:d,classNames:p,...m})})})},it=i=>{const{figure:e="",gender:n="M",headOnly:r=!1,direction:s=0,scale:a=1,classNames:c=[],style:u={},...d}=i,[g,m]=o.useState(null),[f,p]=o.useState(-1),_=o.useRef(!1),E=o.useMemo(()=>{const I=["avatar-image"];return c.length&&I.push(...c),I},[c]),C=o.useMemo(()=>{let I={};return g&&g.length&&(I.backgroundImage=`url('${g}')`),a!==1&&(I.transform=`scale(${a})`,a%1||(I.imageRendering="pixelated")),Object.keys(u).length&&(I={...I,...u}),I},[g,a,u]);return o.useEffect(()=>{const I=kt().createAvatarImage(e,Nc.LARGE,n,{resetFigure:v=>{_.current||p(Math.random())},dispose:()=>{},disposed:!1},null);if(!I)return;let b=Qi.FULL;r&&(b=Qi.HEAD),I.setDirection(b,s);const S=I.getCroppedImage(b);S&&m(S.src),I.dispose()},[e,n,s,r,f]),o.useEffect(()=>(_.current=!1,()=>{_.current=!0}),[]),t(P,{classNames:E,style:C,...d})},lh=i=>{const{imageUrl:e=null,fit:n=!0,style:r=null,...s}=i,a=o.useMemo(()=>{const c={...r};return e&&(c.background=`url(${e}) center no-repeat`),c},[r,e]);return t(P,{fit:n,style:a,...s})},We=i=>{const{badgeCode:e=null,isGroup:n=!1,showInfo:r=!1,customTitle:s=null,isGrayscale:a=!1,scale:c=1,classNames:u=[],style:d={},children:g=null,...m}=i,[f,p]=o.useState(null),_=o.useMemo(()=>{const C=["badge-image"];return n&&C.push("group-badge"),a&&C.push("grayscale"),u.length&&C.push(...u),C},[u,n,a]),E=o.useMemo(()=>{let C={};return f&&(C.backgroundImage=`url(${n?f.src:K("badge.asset.url").replace("%badgename%",e.toString())})`,C.width=f.width,C.height=f.height,c!==1&&(C.transform=`scale(${c})`,c%1||(C.imageRendering="pixelated"),C.width=f.width*c,C.height=f.height*c)),Object.keys(d).length&&(C={...C,...d}),C},[f,c,d]);return o.useEffect(()=>{if(!e||!e.length)return;let C=!1;const I=S=>{if(S.badgeId!==e)return;const v=_r.generateImage(new Xi(S.image));v.onload=()=>p(v),C=!0,W().events.removeEventListener(ml.IMAGE_READY,I)};W().events.addEventListener(ml.IMAGE_READY,I);const b=n?W().getGroupBadgeImage(e):W().getBadgeImage(e);if(b&&!C){const S=_r.generateImage(new Xi(b));S.onload=()=>p(S)}return()=>W().events.removeEventListener(ml.IMAGE_READY,I)},[e,n]),l(P,{classNames:_,style:E,...m,children:[r&&K("badge.descriptions.enabled",!0)&&l(P,{className:"badge-information text-black py-1 px-2 small",children:[t("div",{className:"fw-bold mb-1",children:n?s:si(e)}),t("div",{children:n?h("group.badgepopup.body"):yc(e)})]}),g]})},_N=i=>{const{day:e="00",hour:n="00",minutes:r="00",seconds:s="00",classNames:a=[],children:c=null,...u}=i,d=o.useMemo(()=>{const g=["nitro-counter-time"];return a.length&&g.push(...a),g},[a]);return l(w,{gap:1,children:[t(P,{classNames:d,...u,children:l("div",{children:[e!="00"?e:n,e!="00"?h("countdown_clock_unit_days"):h("countdown_clock_unit_hours")]})}),t(P,{style:{marginTop:"3px"},children:":"}),t(P,{classNames:d,...u,children:l("div",{children:[r,h("countdown_clock_unit_minutes")]})}),t(P,{style:{marginTop:"3px"},children:":"}),t(P,{classNames:d,...u,children:l("div",{children:[s,h("countdown_clock_unit_seconds")]})}),c]})},dt=i=>{const{type:e="",classNames:n=[],style:r={},...s}=i,a=o.useMemo(()=>{const d=["nitro-currency-icon"];return n.length&&d.push(...n),d},[n]),c=o.useMemo(()=>{let d=K("currency.asset.icon.url","");return d=d.replace("%type%",e.toString()),`url(${d})`},[e]),u=o.useMemo(()=>{let d={};return d.backgroundImage=c,Object.keys(r).length&&(d={...d,...r}),d},[r,c]);return t(P,{classNames:a,style:u,...s})},Lc=i=>{const{productType:e="s",productClassId:n=-1,direction:r=2,extraData:s="",scale:a=1,style:c={},...u}=i,[d,g]=o.useState(null),m=o.useMemo(()=>{var p;let f={};return(p=d==null?void 0:d.src)!=null&&p.length&&(f.backgroundImage=`url('${d.src}')`,f.width=d.width,f.height=d.height),a!==1&&(f.transform=`scale(${a})`,a%1||(f.imageRendering="pixelated")),Object.keys(c).length&&(f={...f,...c}),f},[d,a,c]);return o.useEffect(()=>{let f=null;const p={imageReady:(_,E,C)=>{!C&&E&&(C=_r.generateImage(E)),C.onload=()=>g(C)},imageFailed:null};switch(e.toLocaleLowerCase()){case fe.FLOOR:f=j().getFurnitureFloorImage(n,new Ot(r),64,p,0,s);break;case fe.WALL:f=j().getFurnitureWallImage(n,new Ot(r),64,p,0,s);break}if(f){const _=f.getImage();_.onload=()=>g(_)}},[e,n,r,s]),d?t(P,{classNames:["furni-image"],style:m,...u}):null},ch=i=>{const{figure:e=null,userName:n=null,message:r=null,editable:s=!1,onChange:a=null}=i;return l(w,{overflow:"hidden",className:"nitro-gift-card text-black",children:[l("div",{className:"d-flex align-items-center justify-content-center gift-face flex-shrink-0",children:[!n&&t("div",{className:"gift-incognito"}),e&&t("div",{className:"gift-avatar",children:t(it,{figure:e,direction:2,headOnly:!0})})]}),t(w,{overflow:"hidden",className:"w-100 pt-4 pb-4 pe-4 ps-3",children:l(T,{grow:!0,overflow:"auto",justifyContent:"between",children:[!s&&t(N,{textBreak:!0,className:"gift-message",children:r}),s&&a!==null&&t("textarea",{className:"gift-message h-100",maxLength:140,value:r,onChange:c=>a(c.target.value),placeholder:h("catalog.gift_wrapping_new.message_hint")}),n&&t(N,{italics:!0,textEnd:!0,className:"pe-1",children:h("catalog.gift_wrapping_new.message_from",["name"],[n])})]})})]})},T=i=>{const{size:e=0,offset:n=0,column:r=!0,gap:s=2,classNames:a=[],...c}=i,{isCssGrid:u=!1}=gN(),d=o.useMemo(()=>{const g=[];if(e){let m=`col-${e}`;u&&(m=`g-${m}`),g.push(m)}if(n){let m=`offset-${n}`;u&&(m=`g-start-${n}`),g.push(m)}return a.length&&g.push(...a),g},[e,n,u,a]);return t(w,{classNames:d,column:r,gap:s,...c})},Gr=i=>{const{count:e=0,position:n="absolute",classNames:r=[],children:s=null,...a}=i,c=o.useMemo(()=>{const u=["badge","border","border-black","bg-danger","px-1","nitro-item-count"];return r.length&&u.push(...r),u},[r]);return l(P,{position:"absolute",classNames:c,...a,children:[e,s]})},Ka=i=>{const{value:e=0}=i,n=e.toString().split("");return t(B,{children:n.map((r,s)=>t("i",{className:"limited-edition-number n-"+r},s))})},uh=i=>{const{uniqueNumber:e=0,uniqueSeries:n=0,classNames:r=[],children:s=null,...a}=i,c=o.useMemo(()=>{const u=["unique-compact-plate","z-index-1"];return r.length&&u.push(...r),u},[r]);return l(P,{classNames:c,...a,children:[t("div",{children:t(Ka,{value:e})}),t("div",{children:t(Ka,{value:n})}),s]})},bN=i=>{const{uniqueLimitedItemsLeft:e=0,uniqueLimitedSeriesSize:n=0,classNames:r=[],...s}=i,a=o.useMemo(()=>{const c=["unique-complete-plate"];return r.length&&c.push(...r),c},[r]);return t(P,{classNames:a,...s,children:l(T,{className:"plate-container",gap:0,children:[l(w,{justifyContent:"between",alignItems:"center",children:[h("unique.items.left"),t("div",{children:t(Ka,{value:e})})]}),l(w,{justifyContent:"between",alignItems:"center",children:[h("unique.items.number.sold"),t("div",{children:t(Ka,{value:n})})]})]})})},be=i=>{const{itemImage:e=void 0,itemColor:n=void 0,itemActive:r=!1,itemCount:s=1,itemCountMinimum:a=1,itemUniqueSoldout:c=!1,itemUniqueNumber:u=-2,itemUnseen:d=!1,itemHighlight:g=!1,disabled:m=!1,center:f=!0,column:p=!0,style:_={},classNames:E=[],position:C="relative",overflow:I="hidden",children:b=null,...S}=i,v=o.useMemo(()=>{const R=["layout-grid-item","border","border-2","border-muted","rounded"];return r&&R.push("active"),(c||u>0)&&R.push("unique-item"),c&&R.push("sold-out"),d&&R.push("unseen"),g&&R.push("has-highlight"),m&&R.push("disabled"),e===null&&R.push("icon","loading-icon"),E.length&&R.push(...E),R},[r,c,u,d,g,m,e,E]),y=o.useMemo(()=>{let R={..._};return e&&!(c||u>0)&&(R.backgroundImage=`url(${e})`),n&&(R.backgroundColor=n),Object.keys(_).length&&(R={...R,..._}),R},[_,e,n,c,u]);return l(T,{center:f,pointer:!0,position:C,overflow:I,column:p,classNames:v,style:y,...S,children:[s>a&&t(Gr,{count:s}),u>0&&l(B,{children:[t(P,{fit:!0,className:"unique-bg-override",style:{backgroundImage:`url(${e})`}}),t("div",{className:"position-absolute bottom-0 unique-item-counter",children:t(Ka,{value:u})})]}),b]})},vr=i=>{const{imageUrl:e=null,className:n="",...r}=i;return t("img",{src:e,className:"no-select "+n,alt:"",...r})},Mc=i=>{const{...e}=i;return l(P,{classNames:["spinner-container"],...e,children:[t(P,{className:"spinner"}),t(P,{className:"spinner"}),t(P,{className:"spinner"})]})},SN=i=>{const{roomId:e=-1,textureReceiver:n=null,onClose:r=null}=i,s=o.useRef(),a=()=>{if(!s||!s.current)return null;const u=s.current.getBoundingClientRect();return new om(Math.floor(u.x),Math.floor(u.y),Math.floor(u.width),Math.floor(u.height))},c=()=>{Sr(Nr.CAMERA_SHUTTER),n(j().createTextureFromRoom(e,1,a()))};return t(as,{handleSelector:".nitro-room-thumbnail-camera",children:l("div",{className:"nitro-room-thumbnail-camera px-2",children:[t("div",{ref:s,className:"camera-frame"}),l("div",{className:"d-flex align-items-end h-100 pb-2",children:[t("button",{className:"btn btn-sm btn-danger w-100 mb-1 me-2",onClick:r,children:h("cancel")}),t("button",{className:"btn btn-sm btn-success w-100 mb-1",onClick:c,children:h("navigator.thumbeditor.save")})]})]})})},$o=i=>{const{title:e="",onClose:n=null,classNames:r=[],children:s=null,type:a=ge.DEFAULT,...c}=i,u=o.useMemo(()=>{const d=["nitro-alert"];return d.push("nitro-alert-"+a),r.length&&d.push(...r),d},[r,a]);return l(ie,{classNames:u,theme:"primary-slim",...c,children:[t(ae,{headerText:e,onCloseClick:n}),t(re,{grow:!0,justifyContent:"between",overflow:"hidden",className:"text-black",gap:0,children:s})]})},mr=class mr{};mr.BOUNCE="bounce",mr.SLIDE_LEFT="slideLeft",mr.SLIDE_RIGHT="slideRight",mr.FLIP_X="flipX",mr.FADE_IN="fadeIn",mr.FADE_DOWN="fadeDown",mr.FADE_UP="fadeUp",mr.HEAD_SHAKE="headShake";let un=mr;function NN(i,e,n=300){switch(i){case un.BOUNCE:switch(e){default:return{};case qr:return{animationName:"bounceIn",animationDuration:`${n}ms`};case cs:return{animationName:"bounceOut",animationDuration:`${n}ms`}}case un.SLIDE_LEFT:switch(e){default:return{};case qr:return{animationName:"slideInLeft",animationDuration:`${n}ms`};case cs:return{animationName:"slideOutLeft",animationDuration:`${n}ms`}}case un.SLIDE_RIGHT:switch(e){default:return{};case qr:return{animationName:"slideInRight",animationDuration:`${n}ms`};case cs:return{animationName:"slideOutRight",animationDuration:`${n}ms`}}case un.FLIP_X:switch(e){default:return{};case qr:return{animationName:"flipInX",animationDuration:`${n}ms`};case cs:return{animationName:"flipOutX",animationDuration:`${n}ms`}}case un.FADE_UP:switch(e){default:return{};case qr:return{animationName:"fadeInUp",animationDuration:`${n}ms`};case cs:return{animationName:"fadeOutDown",animationDuration:`${n}ms`}}case un.FADE_IN:switch(e){default:return{};case qr:return{animationName:"fadeIn",animationDuration:`${n}ms`};case cs:return{animationName:"fadeOut",animationDuration:`${n}ms`}}case un.FADE_DOWN:switch(e){default:return{};case qr:return{animationName:"fadeInDown",animationDuration:`${n}ms`};case cs:return{animationName:"fadeOutUp",animationDuration:`${n}ms`}}case un.HEAD_SHAKE:switch(e){default:return{};case qr:return{animationName:"headShake",animationDuration:`${n}ms`}}}return null}const ci=i=>{const{type:e=null,inProp:n=!1,timeout:r=300,className:s=null,children:a=null}=i,[c,u]=o.useState(!1);return o.useEffect(()=>{let d=null;return n?u(!0):d=setTimeout(()=>{u(!1),clearTimeout(r)},r),()=>{d&&clearTimeout(d)}},[n,r]),t(Xh,{in:n,timeout:r,children:d=>t("div",{className:(s??"")+" animate__animated",style:{...NN(e,d,r)},children:c&&a})})},Uc=i=>{const{fadesOut:e=!0,timeoutMs:n=8e3,onClose:r=null,overflow:s="hidden",classNames:a=[],...c}=i,[u,d]=o.useState(!1),g=o.useMemo(()=>{const m=["nitro-notification-bubble","rounded"];return a.length&&m.push(...a),m},[a]);return o.useEffect(()=>(d(!0),()=>d(!1)),[]),o.useEffect(()=>{if(!e)return;const m=setTimeout(()=>{d(!1),setTimeout(()=>r(),300)},n);return()=>clearTimeout(m)},[e,n,r]),t(ci,{type:un.FADE_IN,inProp:u,timeout:300,children:t(w,{overflow:s,classNames:g,onClick:r,...c})})},Ir=i=>{const{figure:e="",typeId:n=-1,paletteId:r=-1,petColor:s=16777215,customParts:a=[],posture:c="std",headOnly:u=!1,direction:d=0,scale:g=1,style:m={},...f}=i,[p,_]=o.useState(null),[E,C]=o.useState(0),[I,b]=o.useState(0),S=o.useRef(!1),v=o.useMemo(()=>{let y={};return p&&p.length&&(y.backgroundImage=`url(${p})`),g!==1&&(y.transform=`scale(${g})`,g%1||(y.imageRendering="pixelated")),y.width=E,y.height=I,Object.keys(m).length&&(y={...y,...m}),y},[p,g,m,E,I]);return o.useEffect(()=>{let y=n,R=r,O=s,F=a,U=u;if(e&&e.length){const k=new sa(e);y=k.typeId,R=k.paletteId,O=k.color,F=k.customParts}y===16&&(U=!1);const A=j().getRoomObjectPetImage(y,R,O,new Ot(d*45),64,{imageReady:(k,D,V)=>{S.current||(V?(_(V.src),C(V.width),b(V.height)):D&&(_(_r.generateImageUrl(D)),C(D.width),b(D.height)))},imageFailed:k=>{}},U,0,F,c);if(A){const k=A.getImage();k&&(_(k.src),C(k.width),b(k.height))}},[e,n,r,s,a,c,u,d]),o.useEffect(()=>(S.current=!1,()=>{S.current=!0}),[]),t(P,{classNames:["pet-image"],style:v,...f})},xc=i=>{const{text:e="",progress:n=0,maxProgress:r=100,position:s="relative",justifyContent:a="center",classNames:c=[],children:u=null,...d}=i,g=o.useMemo(()=>{const m=["nitro-progress-bar","text-white"];return c.length&&m.push(...c),m},[c]);return l(T,{position:s,justifyContent:a,classNames:g,...d,children:[e&&e.length>0&&t(w,{fit:!0,center:!0,position:"absolute",className:"nitro-progress-bar-text small",children:e}),t(P,{className:"nitro-progress-bar-inner",style:{width:~~((n-0)*(100-0)/(r-0)+0)+"%"}}),u]})},Fc=i=>{const{level:e=0,classNames:n=[],children:r=null,...s}=i,a=o.useMemo(()=>{const c=["nitro-rarity-level"];return n.length&&c.push(...n),c},[n]);return l(P,{classNames:a,...s,children:[t("div",{children:e}),r]})},Ko=i=>{const{roomPreviewer:e=null,height:n=0,children:r=null}=i,[s,a]=o.useState(null),c=o.useRef(),u=d=>{e&&(d.shiftKey?e.changeRoomObjectDirection():e.changeRoomObjectState())};return o.useEffect(()=>{if(!e)return;const d=m=>{!e||!s||!c.current||(e.updatePreviewRoomView(),s.canvasUpdated&&(c.current.style.backgroundImage=`url(${_r.generateImageUrl(s.master)})`))};if(!s&&c.current&&e){let f=document.defaultView.getComputedStyle(c.current,null).backgroundColor;f=Cn.rgbStringToHex(f),f=f.replace("#","0x"),e.backgroundColor=parseInt(f,16);const p=c.current.parentElement.clientWidth;e.getRoomCanvas(p,n);const _=e.getRenderingCanvas();a(_),_.canvasUpdated=!0,d()}Vr().add(d);const g=new ResizeObserver(()=>{if(!e||!c.current)return;const m=c.current.parentElement.offsetWidth;e.modifyRoomCanvas(m,n),d()});return g.observe(c.current),()=>{g.disconnect(),Vr().remove(d)}},[s,e,c,n]),l("div",{className:"room-preview-container",children:[t("div",{ref:c,className:"room-preview-image",style:{height:n},onClick:u}),r]})},Xo=i=>{const{roomId:e=-1,customUrl:n=null,shrink:r=!0,overflow:s="hidden",classNames:a=[],children:c=null,...u}=i,d=o.useMemo(()=>{const m=["room-thumbnail","rounded","border"];return a.length&&m.push(...a),m},[a]),g=o.useMemo(()=>n&&n.length?K("image.library.url")+n:K("thumbnails.url").replace("%thumbnail%",e.toString()),[n,e]);return l(P,{shrink:r,overflow:s,classNames:d,...u,children:[g&&t("img",{alt:"",src:g}),c]})},dh=i=>{const{color:e="",message:n="",date:r="",senderName:s="",customTitle:a=null,onCloseClick:c=null}=i;return t(as,{handleSelector:".drag-handler",children:l(T,{gap:0,alignItems:"center",className:`nitro-layout-trophy trophy-${e}`,children:[l(w,{center:!0,fullWidth:!0,position:"relative",className:"trophy-header drag-handler",children:[t(P,{position:"absolute",pointer:!0,className:"trophy-close",onClick:c}),t(N,{bold:!0,children:h("widget.furni.trophy.title")})]}),l(T,{className:"trophy-content py-1",gap:1,children:[a&&t(N,{bold:!0,children:a}),n]}),l(w,{alignItems:"center",justifyContent:"between",className:"trophy-footer mt-1",children:[t(N,{bold:!0,children:r}),t(N,{bold:!0,children:s})]})]})})},An=i=>{const{userId:e=0,userName:n=null,classNames:r=[],pointer:s=!0,children:a=null,...c}=i,u=o.useMemo(()=>{const d=["nitro-friends-spritesheet","icon-profile-sm"];return r.length&&d.push(...r),d},[r]);return t(P,{classNames:u,pointer:s,onClick:d=>hn(e),...c,children:a})},sr=i=>{const{isActive:e=!1,count:n=0,overflow:r="hidden",position:s="relative",pointer:a=!0,classNames:c=[],children:u=null,...d}=i,g=o.useMemo(()=>{const m=["nav-item","rounded-top","border"];return e&&m.push("active"),c.length&&m.push(...c),m},[e,c]);return l(w,{overflow:r,pointer:a,position:s,classNames:g,...d,children:[t(w,{shrink:!0,center:!0,children:u}),n>0&&t(Gr,{count:n})]})},Br=i=>{const{justifyContent:e="center",gap:n=1,classNames:r=[],children:s=null,...a}=i,c=o.useMemo(()=>{const u=["container-fluid","nitro-card-tabs","pt-1"];return r.length&&u.push(...r),u},[r]);return t(w,{justifyContent:e,gap:n,classNames:c,...a,children:s})},zt=(...i)=>i.filter(Boolean).join(" "),TN=i=>{const{classNames:e=[],...n}=i,r=o.useMemo(()=>{const s=["form-group"];return e.length&&s.push(...e),s},[e]);return t(w,{classNames:r,...n})},vN=i=>{const{variant:e="black",height:n=1,classNames:r=[],style:s={},...a}=i,c=o.useMemo(()=>{const d=[];return e&&d.push("bg-"+e),r.length&&d.push(...r),d},[e,r]),u=o.useMemo(()=>{let d={display:"list-item"};return n>0&&(d.height=n),Object.keys(s).length&&(d={...d,...s}),d},[n,s]);return t(P,{classNames:c,style:u,...a})},Qo=i=>{var _,E;const{rows:e=[],overscan:n=5,scrollToBottom:r=!1,rowRender:s=null}=i,[a,c]=o.useState(e.length-1),u=o.useRef(null),{virtualItems:d=[],totalSize:g=0,scrollToIndex:m=null}=Qh({parentRef:u,size:e.length,overscan:n}),f=d.length>0&&((_=d==null?void 0:d[0])==null?void 0:_.start)||0,p=d.length>0?g-(((E=d==null?void 0:d[d.length-1])==null?void 0:E.end)||0):0;return o.useEffect(()=>{r&&m(a)},[r,a,m]),l(P,{fit:!0,innerRef:u,position:"relative",overflow:"auto",children:[f>0&&t("div",{style:{minHeight:`${f}px`}}),d.map(C=>{const I=e[C.index];return I?t("div",{"data-index":C.index,ref:C.measureRef,children:s(I)},C.key):t(o.Fragment,{},C.key)}),p>0&&t("div",{style:{minHeight:`${p}px`}})]})},N=i=>{const{variant:e="black",fontWeight:n=null,fontSize:r=0,align:s=null,bold:a=!1,underline:c=!1,italics:u=!1,truncate:d=!1,center:g=!1,textEnd:m=!1,small:f=!1,wrap:p=!1,noWrap:_=!1,textBreak:E=!1,...C}=i,I=o.useMemo(()=>{const b=["d-inline"];return e&&b.push("text-"+e),a&&b.push("fw-bold"),n&&b.push("fw-"+n),r&&b.push("fs-"+r),s&&b.push("text-"+s),c&&b.push("text-decoration-underline"),u&&b.push("fst-italic"),d&&b.push("text-truncate"),g&&b.push("text-center"),m&&b.push("text-end"),f&&b.push("small"),p&&b.push("text-wrap"),_&&b.push("text-nowrap"),E&&b.push("text-break"),b},[e,n,r,s,a,c,u,d,g,m,f,p,_,E]);return t(P,{classNames:I,...C})},wN=i=>{const{isError:e=!1,message:n="",percent:r=0}=i;return t(T,{fullHeight:!0,position:"relative",className:"nitro-loading",children:t(P,{fullHeight:!0,className:"container h-100",children:l(T,{fullHeight:!0,alignItems:"center",justifyContent:"end",children:[t(P,{className:"connecting-duck"}),t(T,{size:6,className:"text-center py-4",children:e&&n&&n.length?t(P,{className:"fs-4 text-shadow",children:n}):l(B,{children:[l(N,{fontSize:4,variant:"white",className:"text-shadow",children:[r.toFixed(),"%"]}),t(xc,{progress:r,className:"mt-2 large"})]})})]})})})},Hr=(i,e,n,r=!0)=>{o.useEffect(()=>{if(r)return Array.isArray(i)?i.map(s=>e.addEventListener(s,n)):e.addEventListener(i,n),()=>{Array.isArray(i)?i.map(s=>e.removeEventListener(s,n)):e.removeEventListener(i,n)}},[i,e,r,n])},ju=(i,e)=>Hr(i,eS().events,e),RN=(i,e)=>Hr(i,_e().cameraManager.events,e),ON=(i,e)=>Hr(i,_e().localization.events,e),ds=(i,e)=>Hr(i,_e().events,e),Ne=(i,e)=>Hr(i,j().events,e),je=(i,e)=>Hr(i,ks().events,e),yN=(i,e)=>Hr(i,W().events,e),fs=(i,e,n=!0)=>Hr(i,_e().soundManager.events,e,n),x=(i,e)=>{o.useEffect(()=>{const n=new i(e);return Ba().registerMessageEvent(n),()=>Ba().removeMessageEvent(n)},[i,e])},Qe=(i,e,n=!0)=>Hr(i,br,e,n),kN=()=>{const[i,e]=o.useState(!0),[n,r]=o.useState([]),[s,a]=o.useState(null),[c,u]=o.useState(-1),[d,g]=o.useState(0),m=o.useMemo(()=>{let b=0;return n.forEach(S=>b+=_n.getAchievementCategoryTotalUnseen(S)),b},[n]),f=o.useMemo(()=>{let b=0;return n.forEach(S=>b+=S.getProgress()),b},[n]),p=o.useMemo(()=>{let b=0;return n.forEach(S=>b+=S.getMaxProgress()),b},[n]),_=o.useMemo(()=>~~((f-0)*(100-0)/(p-0)+0),[f,p]),E=o.useMemo(()=>s===null?null:n.find(b=>b.code===s),[n,s]),C=o.useMemo(()=>c===-1||!E?null:E.achievements.find(b=>b.achievementId===c),[E,c]),I=o.useCallback((b,S)=>{r(v=>{const y=[...v];for(const R of y)if(R.code===b)for(const O of R.achievements)O.achievementId===S&&(O.unseen=0);return y})},[]);return x(Ug,b=>{const v=b.getParser().achievement;r(y=>{const R=[...y],O=R.findIndex(F=>F.code===v.category);if(O===-1){const F=new wu(v.category);F.achievements.push(v),R.push(F)}else{const F=sn(R[O]),U=[...F.achievements],A=U.findIndex(D=>D.achievementId===v.achievementId);let k=null;A===-1?U.push(v):(k=U[A],U[A]=v),_n.getAchievementIsIgnored(v)||(v.unseen++,k&&(v.unseen+=k.unseen)),F.achievements=U,R[O]=F}return R})}),x(xg,b=>{const S=b.getParser(),v=[];for(const y of S.achievements){const R=y.category;let O=v.find(F=>F.code===R);O||(O=new wu(R),v.push(O)),O.achievements.push(y)}r(v)}),x(Fg,b=>{const S=b.getParser();g(S.score)}),o.useEffect(()=>{i&&(L(new Gg),e(!1))},[i]),o.useEffect(()=>{!s||c===-1||I(s,c)},[s,c,I]),{achievementCategories:n,selectedCategoryCode:s,setSelectedCategoryCode:a,selectedAchievementId:c,setSelectedAchievementId:u,achievementScore:d,getTotalUnseen:m,getProgress:f,getMaxProgress:p,scaledProgressPercent:_,selectedCategory:E,selectedAchievement:C,setAchievementSeen:I}},Jo=()=>lt(kN),AN=()=>{const[i,e]=o.useState([]),[n,r]=o.useState([]),[s,a]=o.useState(-1),[c,u]=o.useState(10),[d,g]=o.useState(null);return RN(Hg.INITIALIZED,m=>{e(Array.from(_a().effects.values()))}),x(Vg,m=>{const f=m.getParser();g({credits:f.creditPrice,duckets:f.ducketPrice,publishDucketPrice:f.publishDucketPrice})}),o.useEffect(()=>{if(!_a().isLoaded){_a().init(),L(new Bg);return}},[]),{availableEffects:i,cameraRoll:n,setCameraRoll:r,selectedPictureIndex:s,setSelectedPictureIndex:a,myLevel:c,price:d}},mh=()=>lt(AN),Qn=class Qn extends an{};Qn.SHOW_CATALOG="CE_SHOW_CATALOG",Qn.HIDE_CATALOG="CE_HIDE_CATALOG",Qn.TOGGLE_CATALOG="CE_TOGGLE_CATALOG",Qn.SOLD_OUT="CE_SOLD_OUT",Qn.APPROVE_NAME_RESULT="CE_APPROVE_NAME_RESULT",Qn.PURCHASE_APPROVED="CE_PURCHASE_APPROVED",Qn.INIT_GIFT="CE_INIT_GIFT",Qn.CATALOG_RESET="CE_RESET",Qn.CATALOG_INVISIBLE_PAGE_VISITED="CE_CATALOG_INVISIBLE_PAGE_VISITED";let Os=Qn;class DN extends Os{constructor(e,n,r){super(Os.INIT_GIFT),this._pageId=e,this._offerId=n,this._extraData=r}get pageId(){return this._pageId}get offerId(){return this._offerId}get extraData(){return this._extraData}}const Ao=class Ao extends Os{constructor(e){super(Ao.POST_MARKETPLACE),this._item=e}get item(){return this._item}};Ao.POST_MARKETPLACE="CE_POST_MARKETPLACE";let fo=Ao;const Do=class Do extends an{constructor(e){super(Do.PURCHASE_SUCCESS),this._purchase=e}get purchase(){return this._purchase}};Do.PURCHASE_SUCCESS="CPE_PURCHASE_SUCCESS";let Tr=Do;const Po=class Po extends an{constructor(e){super(Po.PURCHASE_FAILED),this._code=e}get code(){return this._code}};Po.PURCHASE_FAILED="CPFE_PURCHASE_FAILED";let rs=Po;const Lo=class Lo extends an{constructor(e){super(Lo.NOT_ALLOWED),this._code=e}get code(){return this._code}};Lo.NOT_ALLOWED="CPNAE_NOT_ALLOWED";let Xa=Lo;const bt=class bt extends an{};bt.WIDGETS_INITIALIZED="CWE_CWE_WIDGETS_INITIALIZED",bt.SELECT_PRODUCT="CWE_SELECT_PRODUCT",bt.SET_EXTRA_PARM="CWE_CWE_SET_EXTRA_PARM",bt.PURCHASE="CWE_PURCHASE",bt.COLOUR_ARRAY="CWE_COLOUR_ARRAY",bt.MULTI_COLOUR_ARRAY="CWE_MULTI_COLOUR_ARRAY",bt.COLOUR_INDEX="CWE_COLOUR_INDEX",bt.TEXT_INPUT="CWE_TEXT_INPUT",bt.DROPMENU_SELECT="CWE_CWE_DROPMENU_SELECT",bt.PURCHASE_OVERRIDE="CWE_PURCHASE_OVERRIDE",bt.SELLABLE_PET_PALETTES="CWE_SELLABLE_PET_PALETTES",bt.UPDATE_ROOM_PREVIEW="CWE_UPDATE_ROOM_PREVIEW",bt.GUILD_SELECTED="CWE_GUILD_SELECTED",bt.TOTAL_PRICE_WIDGET_INITIALIZED="CWE_TOTAL_PRICE_WIDGET_INITIALIZED",bt.PRODUCT_OFFER_UPDATED="CWE_CWE_PRODUCT_OFFER_UPDATED",bt.SET_PREVIEWER_STUFFDATA="CWE_CWE_SET_PREVIEWER_STUFFDATA",bt.EXTRA_PARAM_REQUIRED_FOR_BUY="CWE_CWE_EXTRA_PARAM_REQUIRED_FOR_BUY",bt.TOGGLE="CWE_CWE_TOGGLE",bt.BUILDER_SUBSCRIPTION_UPDATED="CWE_CWE_BUILDER_SUBSCRIPTION_UPDATED",bt.ROOM_CHANGED="CWE_CWE_ROOM_CHANGED",bt.SHOW_WARNING_TEXT="CWE_CWE_SHOW_WARNING_TEXT";let qu=bt;const Mo=class Mo extends an{constructor(){super(Mo.SOLD_OUT)}};Mo.SOLD_OUT="CPSOE_SOLD_OUT";let Qa=Mo;const Uo=class Uo extends an{constructor(e,n){super(Uo.UPDATE_STUFF_DATA),this._offer=e,this._stuffData=n}get offer(){return this._offer}get stuffData(){return this._stuffData}};Uo.UPDATE_STUFF_DATA="SRPSA_UPDATE_STUFF_DATA";let zu=Uo;const Is=class Is extends an{};Is.SHOW_GUIDE_TOOL="GTE_SHOW_GUIDE_TOOL",Is.HIDE_GUIDE_TOOL="GTE_HIDE_GUIDE_TOOL",Is.TOGGLE_GUIDE_TOOL="GTE_TOGGLE_GUIDE_TOOL",Is.CREATE_HELP_REQUEST="GTE_CREATE_HELP_REQUEST",Is.CREATE_BULLY_REQUEST="GTE_CREATE_BULLY_REQUEST";let pn=Is;const Zc=class Zc extends an{};Zc.INIT="HC_NAME_CHANGE_INIT";let Ja=Zc;const xo=class xo extends an{constructor(e,n,r){super(xo.FURNI_ADDED),this.id=e,this.spriteId=n,this.category=r}};xo.FURNI_ADDED="IFAE_FURNI_ADDED";let Za=xo;const Fo=class Fo extends an{constructor(e,n,r,s){super(Fo.MENTION_ACTION),this._action=e,this._mentionId=n,this._success=r,this._message=s}get action(){return this._action}get mentionId(){return this._mentionId}get success(){return this._success}get message(){return this._message}};Fo.MENTION_ACTION="MENTION_ACTION";let lc=Fo;const Go=class Go extends an{constructor(e){super(Go.MENTION_COUNT),this._unreadCount=e}get unreadCount(){return this._unreadCount}};Go.MENTION_COUNT="MENTION_COUNT";let cc=Go;const Vo=class Vo extends an{constructor(e,n){super(Vo.MENTIONS_LIST),this._totalCount=e,this._mentions=n}get totalCount(){return this._totalCount}get mentions(){return this._mentions}};Vo.MENTIONS_LIST="MENTIONS_LIST";let uc=Vo;const Bo=class Bo extends an{constructor(e,n,r,s){super(Bo.NOTIFICATION_BUBBLE),this._message=e,this._type=n,this._userId=r,this._imageUrl=s}get message(){return this._message}get type(){return this._type}get userId(){return this._userId}get imageUrl(){return this._imageUrl}};Bo.NOTIFICATION_BUBBLE="NOTIFICATION_BUBBLE";let Yu=Bo;const Ma=class Ma extends an{};Ma.SHOW_THUMBNAIL="NE_SHOW_THUMBNAIL",Ma.HIDE_THUMBNAIL="NE_HIDE_THUMBNAIL",Ma.TOGGLE_THUMBNAIL="NE_TOGGLE_THUMBNAIL";let gr=Ma;const $u=i=>i&&i.length?i.replace(/\\r/g,"\r"):"",Ku=i=>{const e="0"+i;return e.substr(e.length-2,e.length)};let Ia=null;const PN=()=>{const[i,e]=o.useState([]),[n,r]=o.useState([]),[s,a]=o.useState([]),[c,u]=o.useState(!1),[d,g]=o.useState(!1),m=()=>K("notification",{}),f=A=>{const k=m();return k?k[A]:null},p=(A,k,D,V)=>{if(A.has(D))return A.get(D);const G=["notification",k,D].join(".");return _e().localization.hasValue(G)||V?h(G,Array.from(A.keys()),Array.from(A.values())):null},_=(A,k)=>{let D=A.get("image");return D||(D=K("image.library.notifications.url","").replace("%image%",k.replace(/\./g,"_"))),h(D)},E=o.useCallback((A,k=null,D=null,V=null,G=null,$=null)=>{(!G||!G.length)&&(G=h("notifications.broadcast.title")),(!k||!k.length)&&(k=ge.DEFAULT);const X=new lo([$u(A)],k,D,V,G,$);e(Y=>[X,...Y])},[]),C=o.useCallback(()=>E(null,ge.NITRO),[E]),I=o.useCallback((A,k,D=null,V=null)=>{if(c)return;const G=new ac(A,k,D,V);r($=>[G,...$])},[c]),b=(A,k=null)=>{k||(k=new Map);const D=f("notification."+A);if(D)for(const Ee in D)k.set(Ee,D[Ee]);A==="floorplan_editor.error"&&k.set("message",k.get("message").replace(/[^a-zA-Z._ ]/g,""));const V=p(k,A,"title",!0),G=p(k,A,"message",!0).replace(/\\r/g,"\r"),$=p(k,A,"linkTitle",!1),X=p(k,A,"linkUrl",!1),Y=_(k,A);k.get("display")==="BUBBLE"?I(h(G),ft.INFO,Y,X):E(h(G),A,X,$,V,Y),k.get("sound")&&Sr(k.get("sound"))},S=o.useCallback((A,k,D,V=null,G=null,$=null,X=null)=>{(!V||!V.length)&&(V=h("generic.confirm")),(!G||!G.length)&&(G=h("generic.cancel")),(!$||!$.length)&&($=h("notifications.broadcast.title"));const Y=new ic(X,A,k,D,V,G,$);a(Ee=>[Y,...Ee])},[]),v=(A,k=null,D=!0)=>{E(A,ge.DEFAULT,k,h("mod.alert.link"),h("mod.alert.title"))},y=o.useCallback((A,k="")=>{switch(A){case cn.ALERT_SCAM:E(h("inventory.trading.warning.other_not_offering"),null,null,null,h("inventory.trading.notification.title"));return;case cn.HOTEL_TRADING_DISABLED:case cn.YOU_NOT_ALLOWED:case cn.THEY_NOT_ALLOWED:case cn.ROOM_DISABLED:case cn.YOU_OPEN:case cn.THEY_OPEN:E(h(`inventory.trading.openfail.${A}`,["otherusername"],[k]),null,null,null,h("inventory.trading.openfail.title"));return;case cn.ERROR_WHILE_COMMIT:E(`${h("inventory.trading.notification.caption")}, ${h("inventory.trading.notification.commiterror.info")}`,null,null,null,h("inventory.trading.notification.title"));return;case cn.THEY_CANCELLED:E(h("inventory.trading.info.closed"),null,null,null,h("inventory.trading.notification.title"));return}},[E]),R=o.useCallback(A=>{e(k=>{const D=[...k],V=D.findIndex(G=>A===G);return V>=0&&D.splice(V,1),D})},[]),O=o.useCallback(A=>{r(k=>{const D=[...k],V=D.findIndex(G=>A===G);return V>=0&&D.splice(V,1),D})},[]),F=o.useCallback(A=>{a(k=>{const D=[...k],V=D.findIndex(G=>A===G);return V>=0&&D.splice(V,1),D})},[]);x(Wg,A=>{const k=A.getParser();if(k.userId!==W().userId)return;const D=h("notifications.text.respect.1"),V=h("notifications.text.respect.2",["count"],[k.respectsReceived.toString()]);I(D,ft.RESPECT),I(V,ft.RESPECT)}),x(jg,A=>{const k=A.getParser();E(k.message.replace(/\\r/g,"\r"),null,null,h("notifications.broadcast.title"))}),x(qg,A=>{const k=A.getParser(),D=h("achievements.levelup.desc"),V=si(k.data.badgeCode),G=W().getBadgeUrl(k.data.badgeCode),$="questengine/achievements/"+k.data.category;I(D+" "+V,ft.ACHIEVEMENT,G,$)}),x(zg,A=>{const k=A.getParser();k.numGifts<=0||I(k.numGifts.toString(),ft.CLUBGIFT,null,"catalog/open/"+K("catalog.links")["hc.hc_gifts"])}),x(Yg,A=>{const k=A.getParser();v(k.message,k.url,!1)}),x(lm,A=>{const k=A.getParser();if(k.amountChanged<=0||k.type!==5)return;const D=K("currency.asset.icon.url","").replace("%type%",k.type.toString());I(h("notifications.text.loyalty.received",["AMOUNT"],[k.amountChanged.toString()]),ft.INFO,D)}),x($g,A=>{const k=A.getParser();v(k.message)}),x(Kg,A=>{const k=A.getParser();E(h("opening.hours."+(k.userThrowOutAtClose?"disconnected":"closed"),["h","m"],[Ku(k.openHour),Ku(k.openMinute)]),ge.DEFAULT,null,null,h("opening.hours.title"))}),x(Xg,A=>{const k=A.getParser(),D=h("notifications.text."+(k.boughtAsGift?"petbought":"petreceived"));let V=null;const G=j().getRoomObjectPetImage(k.pet.typeId,k.pet.paletteId,parseInt(k.pet.color,16),new Ot(45*3),64,null,!0);G&&(V=G.getImage().src),I(D,ft.PETLEVEL,V)}),x(Qg,A=>{const D=A.getParser().messages.map(G=>$u(G)),V=new lo(D,ge.MOTD,null,null,h("notifications.motd.title"));e(G=>[V,...G])}),x(Jg,A=>{const k=A.getParser();let D=null;const V=j().getRoomObjectPetImage(k.figureData.typeId,k.figureData.paletteId,parseInt(k.figureData.color,16),new Ot(45*3),64,null,!0);V&&(D=V.getImage().src),I(h("notifications.text.petlevel",["pet_name","level"],[k.petName,k.level.toString()]),ft.PETLEVEL,D)}),x(Zg,A=>{const k=A.getParser();u(!k.enabled)}),x(ef,A=>{const k=A.getParser();if(!k.products||!k.products.length)return;const D=k.products[0];D&&I(h("notifications.text.club_gift.selected"),ft.INFO,$i.getProductImageUrl(D.productType,D.furniClassId,D.extraParam))}),x(tf,A=>{const k=A.getParser();E(h("maintenance.shutdown",["m","d"],[k.minutesUntilMaintenance.toString(),k.duration.toString()]),ge.DEFAULT,null,null,h("opening.hours.title"))}),x(nf,A=>{const k=A.getParser();v(k.message,k.url)}),x(rf,A=>{const k=A.getParser();b(k.type,k.parameters)}),x(sf,A=>{const k=A.getParser();E(h("opening.hours.shutdown",["m"],[k.openMinute.toString()]),ge.DEFAULT,null,null,h("opening.hours.title"))}),x(af,A=>{const k=A.getParser();E(h("opening.hours.disconnected",["h","m"],[k.openHour.toString(),k.openMinute.toString()]),ge.DEFAULT,null,null,h("opening.hours.title"))}),x(of,A=>{const k=A.getParser();switch(k.errorCode){default:case 0:E(h("connection.server.error.desc",["errorCode"],[k.errorCode.toString()]),ge.ALERT,null,null,h("connection.server.error.title"));break;case 1001:case 1002:case 1003:case 1004:case 1005:case 1006:case 1007:case 1008:case 1009:case 1010:case 1011:case 1012:case 1013:case 1014:case 1015:case 1016:case 1017:case 1018:case 1019:A.connection.dispose();break;case 4013:E(h("connection.room.maintenance.desc"),ge.ALERT,null,null,h("connection.room.maintenance.title"));break}}),x(lf,A=>{const k=A.getParser();E(h(k.alertMessage),ge.DEFAULT,null,null,h(k.titleMessage?k.titleMessage:"notifications.broadcast.title"))});const U=o.useCallback(()=>{if(!d)if(Yl.isRunning()){if(Ia)return;Ia=setTimeout(()=>{U()},Yl.totalRunningTime+5e3)}else Ia&&(clearTimeout(Ia),Ia=null),I(h("mod.chatdisclaimer"),ft.INFO),g(!0)},[d,I]);return x(cf,U),x(uf,A=>{const k=A.getParser();if(console.log(" [DEBUG] Custom Notification Received!",{message:k.message,type:k.type,userId:k.userId,imageUrl:k.imageUrl}),!k.message||!k.type){console.warn(" [DEBUG] Invalid notification data",k);return}let D=ft.INFO;switch(k.type){case"mention":D=ft.CUSTOM_MENTION;break;case"info":D=ft.CUSTOM_INFO;break;case"success":D=ft.CUSTOM_SUCCESS;break;case"warning":D=ft.CUSTOM_WARNING;break;case"error":D=ft.CUSTOM_ERROR;break;case"achievement":D=ft.CUSTOM_ACHIEVEMENT;break;case"gift":D=ft.CUSTOM_GIFT;break}let V=k.imageUrl||null,G=null;if(k.type==="mention"){const $=k.message.match(/^([^\s]+)\s+(mencionou|mentioned)/i);$&&$[1]&&(G=`follow:${$[1]}`),V||(V="./images/notifications/logo.gif")}else k.userId>0&&(G=`profile/${k.userId}`);if(console.log(" [DEBUG] Showing bubble:",{message:k.message,bubbleType:D,imageUrl:V,linkUrl:G}),I(k.message,D,V,G),k.type==="mention"){console.log(" [DEBUG] Playing mention sound");const $=new Audio("./sounds/notification_custom.mp3");$.volume=.5,$.play().catch(X=>{console.error(" [DEBUG] Sound error:",X)})}}),{alerts:i,bubbleAlerts:n,confirms:s,simpleAlert:E,showNitroAlert:C,showTradeAlert:y,showConfirm:S,showSingleBubble:I,closeAlert:R,closeBubbleAlert:O,closeConfirm:F}},ze=()=>lt(PN),LN=(i,e)=>{const[n,r]=o.useState(()=>{if(typeof window>"u")return e;try{return so(i)??e}catch{return e}});return[n,a=>{try{const c=a instanceof Function?a(n):a;r(c),typeof window<"u"&&Qm(i,c)}catch(c){cm.error(c)}}]},Zo=LN,MN=()=>Zo(qa.CATALOG_PLACE_MULTIPLE_OBJECTS,!1),hh=()=>lt(MN),UN=()=>Zo(qa.CATALOG_SKIP_PURCHASE_CONFIRMATION,!1),gh=()=>lt(UN),xN=-12345678,FN=()=>{const[i,e]=o.useState(!1),[n,r]=o.useState(!1),[s,a]=o.useState(-1),[c,u]=o.useState(-1),[d,g]=o.useState(jn.NORMAL),[m,f]=o.useState(null),[p,_]=o.useState(null),[E,C]=o.useState(null),[I,b]=o.useState(null),[S,v]=o.useState([]),[y,R]=o.useState(null),[O,F]=o.useState([]),[U,A]=o.useState(null),[k,D]=o.useState(!1),[V,G]=o.useState({quantity:1,extraData:null,extraParamRequired:!1,previewStuffData:null}),[$,X]=o.useState({}),[Y,Ee]=o.useState(!1),[ue,ye]=hh(),[Ye,Ct]=gh(),[Je,Wt]=o.useState(null),[Be,Xt]=o.useState(null),[on,Me]=o.useState(0),[pe,ht]=o.useState(0),[Ut,Mn]=o.useState(0),[da,Ls]=o.useState(0),[vn,Ce]=o.useState(0),[Ue,Un]=o.useState(0),{simpleAlert:ma=null}=ze(),fn=o.useRef(new gs),Qt=o.useCallback(()=>{a(-1),u(-1),f(null),_(null),C(null),b(null),v([]),R(null),F([]),e(!1)},[]),ha=o.useCallback(H=>{if(!H)return Ar.MISSING_OFFER;if(on<0||on>=pe)return Ar.FURNI_LIMIT_REACHED;const z=Re();if(!z)return Ar.NOT_IN_ROOM;if(!z.isRoomOwner)return Ar.NOT_ROOM_OWNER;if(da<=0){const Q=j();let te=Q.getRoomObjectCount(z.roomId,J.UNIT);for(;te>0;){const he=Q.getRoomObjectByIndex(z.roomId,te,J.UNIT),ke=z.userDataManager.getUserDataByIndex(he.id);if(ke&&ke.type===pt.USER&&ke.roomIndex!==z.ownRoomIndex&&!ke.isModerator)return Ar.VISITORS_IN_ROOM;te--}}return Ar.OKAY},[on,pe,da]),mi=o.useCallback(H=>{const z=Re();return!!((z&&H.page&&H.page.layoutCode!=="sold_ltd_items"&&d===jn.NORMAL&&(z.isRoomOwner||z.isGuildRoom&&z.controllerLevel>=nt.GUILD_MEMBER)||d===jn.BUILDER&&ha(H)===Ar.OKAY)&&H.pricingModel!==Vt.PRICING_MODEL_BUNDLE&&H.product.productType!==fe.EFFECT&&H.product.productType!==fe.HABBO_CLUB)},[d,ha]),Ms=o.useCallback(H=>{if(!mi(H))return;const z=H.product;if(!z)return;let Q=0;switch(z.productType){case fe.FLOOR:Q=J.FLOOR;break;case fe.WALL:Q=J.WALL;break}j().processRoomObjectPlacement(xa.CATALOG,-H.offerId,Q,z.productClassId,z.extraParam)&&(Wt(H),Ee(!0),e(!1))},[mi]),ga=o.useCallback((H,z)=>{const Q=j();let te=Q.getRoomInstanceVariable(Q.activeRoomId,ee.ROOM_WALL_TYPE),he=Q.getRoomInstanceVariable(Q.activeRoomId,ee.ROOM_FLOOR_TYPE),ke=Q.getRoomInstanceVariable(Q.activeRoomId,ee.ROOM_LANDSCAPE_TYPE);switch(te=te&&te.length?te:"101",he=he&&he.length?he:"101",ke=ke&&ke.length?ke:"1.1",H){case"floor":Q.updateRoomInstancePlaneType(Q.activeRoomId,z,te,ke,!0);return;case"wallpaper":Q.updateRoomInstancePlaneType(Q.activeRoomId,he,z,ke,!0);return;case"landscape":Q.updateRoomInstancePlaneType(Q.activeRoomId,he,te,z,!0);return;default:Q.updateRoomInstancePlaneType(Q.activeRoomId,he,te,ke,!0);return}},[]),Rr=o.useCallback(()=>{Je&&(j().cancelRoomObjectInsert(),Ee(!1),Wt(null))},[Je]),Us=o.useCallback((H=!0)=>{Ee(z=>(z&&H&&Z("catalog/open"),!1))},[]),hi=o.useCallback((H=!1)=>{H||Us(),Xt(z=>{if(z)switch(z.category){case J.FLOOR:j().removeRoomObjectFloor(z.roomId,z.objectId);break;case J.WALL:{switch(z.furniData.className){case"floor":case"wallpaper":case"landscape":ga("reset","");break;default:j().removeRoomObjectWall(z.roomId,z.objectId);break}break}default:j().deleteRoomObject(z.objectId,z.category);break}return null})},[Us,ga]),os=o.useCallback((H,z)=>{if(z.pageId===H&&z!==m)return z;for(const Q of z.children){const te=os(H,Q);if(te)return te}return null},[m]),xn=o.useCallback((H,z)=>{if(z.pageName===H&&z!==m)return z;for(const Q of z.children){const te=xn(H,Q);if(te)return te}return null},[m]),gi=o.useCallback((H,z=!1)=>{if(!p||!p.size)return null;if(z){const Q=[],te=p.get(H);if(te&&te.length)for(const he of te)he.isVisible&&Q.push(he);if(Q.length)return Q}return p.get(H)},[p]),oe=o.useCallback((H,z)=>{H<0||(r(!0),a(H),H>-1&&L(new df(H,z,d)))},[d]),se=o.useCallback((H,z,Q,te,he,ke)=>{const et=new to(H,z,Q,te,ke);if(C(et),u(Ie=>H!==-1?H:Ie),D(!1),he>-1&&et.offers.length){for(const Ie of et.offers)if(Ie.offerId===he){b(Ie);break}}},[]),le=o.useCallback((H,z=-1)=>{if(Rr(),H.parent.pageName==="root"&&H.children.length){for(const he of H.children)if(he.isVisible){H=he;break}}const Q=[];let te=H;for(;te&&te.pageName!=="root";)Q.push(te),te=te.parent;Q.reverse(),v(he=>{const ke=he.indexOf(H)>=0,et=H.isOpen;for(const Ie of he)Ie.deactivate(),Q.indexOf(Ie)===-1&&Ie.close();for(const Ie of Q)Ie.activate(),Ie.parent&&Ie.open(),Ie===H.parent&&Ie.children.length&&Ie.open();return ke&&et?H.close():H.open(),Q}),H.pageId>-1&&oe(H.pageId,z)},[v,oe,Rr]),Se=o.useCallback(H=>{if(H!==-1&&R(null),!i)fn.current.requestById=H,e(!0);else{const z=os(H,m);z&&le(z)}},[i,m,os,le]),xe=o.useCallback(H=>{if(R(null),!i)fn.current.requestByName=H,e(!0);else{const z=xn(H,m);z&&le(z)}},[i,m,xn,le]),Ze=o.useCallback(H=>{if(R(null),!i)fn.current.requestedByOfferId=H,e(!0);else{const z=gi(H);if(!z||!z.length)return;le(z[0],H)}},[i,gi,le]),xt=o.useCallback(()=>{},[]);return x(mf,H=>{const z=H.getParser(),Q=new Map,te=(he,ke,et)=>{const Ie=new nS(he,ke,et);for(const Jt of Ie.offerIds)Q.has(Jt)?Q.get(Jt).push(Ie):Q.set(Jt,[Ie]);ke++;for(const Jt of he.children)Ie.addChild(te(Jt,ke,Ie));return Ie};f(te(z.root,0,null)),_(Q)}),x(hf,H=>{const z=H.getParser();if(z.catalogType!==d)return;const Q=[];for(const te of z.offers){const he=[],ke=na(te.localizationId);for(const Ie of te.products){const Jt=Zl(Ie.furniClassId,Ie.productType);he.push(new ts(Ie.productType,Ie.furniClassId,Ie.extraParam,Ie.productCount,ke,Jt,Ie.uniqueLimitedItem,Ie.uniqueLimitedSeriesSize,Ie.uniqueLimitedItemsLeft))}if(!he.length)continue;const et=new Vt(te.offerId,te.localizationId,te.rent,te.priceCredits,te.priceActivityPoints,te.priceActivityPointsType,te.giftable,te.clubLevel,he,te.bundlePurchaseAllowed);(d===jn.NORMAL||et.pricingModel!==Vt.PRICING_MODEL_BUNDLE&&et.pricingModel!==Vt.PRICING_MODEL_MULTI)&&Q.push(et)}z.frontPageItems&&z.frontPageItems.length&&F(z.frontPageItems),r(!1),s===z.pageId&&se(z.pageId,z.layoutCode,new Wm(z.localization.images.concat(),z.localization.texts.concat()),Q,z.offerId,z.acceptSeasonCurrencyAsCredits)}),x(gf,H=>{const z=H.getParser();yt(new Tr(z.offer))}),x(ff,H=>{const z=H.getParser();yt(new rs(z.code))}),x(pf,H=>{const z=H.getParser();yt(new Xa(z.code))}),x(If,H=>{H.getParser(),yt(new Qa)}),x(Ef,H=>{const Q=H.getParser().offer;if(!Q||!Q.products.length)return;Q.products[0].uniqueLimitedItem;const he=[],ke=na(Q.localizationId);for(const Ie of Q.products){const Jt=Zl(Ie.furniClassId,Ie.productType);he.push(new ts(Ie.productType,Ie.furniClassId,Ie.extraParam,Ie.productCount,ke,Jt,Ie.uniqueLimitedItem,Ie.uniqueLimitedSeriesSize,Ie.uniqueLimitedItemsLeft))}const et=new Vt(Q.offerId,Q.localizationId,Q.rent,Q.priceCredits,Q.priceActivityPoints,Q.priceActivityPointsType,Q.giftable,Q.clubLevel,he,Q.bundlePurchaseAllowed);(d===jn.NORMAL||et.pricingModel!==Vt.PRICING_MODEL_BUNDLE&&et.pricingModel!==Vt.PRICING_MODEL_MULTI)&&(et.page=E,b(et),et.product&&et.product.productType===fe.WALL&&G(Ie=>{const Jt={...Ie};return Jt.extraData=et.product.extraParam||null,Jt}))}),x(Cf,H=>{const z=H.getParser(),Q=new rS(z.productCode,z.palettes.slice());X(te=>{const he=[];te.petPalettes&&he.push(...te.petPalettes);for(let ke=0;ke<he.length;ke++)if(he[ke].breed===Q.breed){he.splice(ke,1);break}return he.push(Q),{...te,petPalettes:he}})}),x(_f,H=>{const z=H.getParser();X(Q=>{const te=z.offers;return{...Q,clubOffers:te}})}),x(bf,H=>{const z=H.getParser();X(Q=>{const te=z.groups;return{...Q,groups:te}})}),x(Sf,H=>{const z=H.getParser();X(Q=>{const te=new uS(z);return{...Q,giftConfiguration:te}})}),x(Nf,H=>{const z=H.getParser();if(!z)return;let Q="";z.result===1?Q=h("inventory.marketplace.result.title.success"):Q=h("inventory.marketplace.result.title.failure");const te=h(`inventory.marketplace.result.${z.result}`);ma(te,ge.DEFAULT,null,null,Q)}),x(um,H=>{const z=H.getParser();X(Q=>({...Q,clubGifts:z}))}),x(Tf,H=>{const z=i;Qt(),z&&ma(h("catalog.alert.published.description"),ge.ALERT,null,null,h("catalog.alert.published.title"))}),x(vf,H=>{const z=H.getParser();Me(z.furniCount),xt()}),x(wf,H=>{const z=H.getParser();ht(z.furniLimit),Mn(z.maxFurniLimit),Ls(z.secondsLeft),Ce(Hn()),Un(z.secondsLeftWithGrace),xt()}),Qe(Tr.PURCHASE_SUCCESS,H=>Sr(Nr.CREDITS)),Ne(nu.PLACED,H=>{if(!Y||H.type!==nu.PLACED)return;if(hi(!0),!Je){Us();return}let z=!1;const Q=Je.product;if(H.category===J.WALL)switch(Q.furnitureData.className){case"floor":case"wallpaper":case"landscape":z=H.placedOnFloor||H.placedOnWall;break;default:z=H.placedInRoom;break}else z=H.placedInRoom;if(!z){Us();return}switch(Xt(new dS(H.roomId,H.objectId,H.category,H.wallLocation,H.x,H.y,H.direction,Je)),d){case jn.NORMAL:{switch(H.category){case J.FLOOR:j().addFurnitureFloor(H.roomId,H.objectId,Q.productClassId,new Ot(H.x,H.y,H.z),new Ot(H.direction),0,new yf);break;case J.WALL:switch(Q.furnitureData.className){case"floor":case"wallpaper":case"landscape":ga(Q.furnitureData.className,Q.extraParam);break;default:j().addFurnitureWall(H.roomId,H.objectId,Q.productClassId,new Ot(H.x,H.y,H.z),new Ot(H.direction*45),0,H.instanceData,0);break}}const te=j().getRoomObject(H.roomId,H.objectId,H.category);te&&te.model.setValue(ee.FURNITURE_ALPHA_MULTIPLIER,.5),Ye&&L(new Ho(s,Je.offerId,Q.extraParam,1)),ue&&Ms(Je);break}case jn.BUILDER:{let te=Je.page.pageId;switch(te===xN&&(te=-1),H.category){case J.FLOOR:L(new Of(te,Je.offerId,Q.extraParam,H.x,H.y,H.direction));break;case J.WALL:L(new Rf(te,Je.offerId,Q.extraParam,H.wallLocation));break}ue&&Ms(Je);break}}}),Qe(Za.FURNI_ADDED,H=>{const z=j();if(!(!Be||Be.productClassId!==H.spriteId||Be.roomId!==z.activeRoomId)){switch(H.category){case me.FLOOR:{const Q=z.getRoomInstanceVariable(z.activeRoomId,ee.ROOM_FLOOR_TYPE);Be.extraParam!==Q&&L(new Yi(H.id));break}case me.WALL_PAPER:{const Q=z.getRoomInstanceVariable(z.activeRoomId,ee.ROOM_WALL_TYPE);Be.extraParam!==Q&&L(new Yi(H.id));break}case me.LANDSCAPE:{const Q=z.getRoomInstanceVariable(z.activeRoomId,ee.ROOM_LANDSCAPE_TYPE);Be.extraParam!==Q&&L(new Yi(H.id));break}default:L(new kf(H.id,Be.category,Be.wallLocation,Be.x,Be.y,Be.direction))}ue||hi()}}),o.useEffect(()=>()=>b(null),[E]),o.useEffect(()=>{if(!(!i||!m||!p||!fn.current))switch(fn.current.requestType){case gs.REQUEST_TYPE_NONE:if(E)return;if(m.isBranch){for(const H of m.children)if(H&&H.isVisible){le(H);return}}return;case gs.REQUEST_TYPE_ID:Se(fn.current.requestById),fn.current.resetRequest();return;case gs.REQUEST_TYPE_OFFER:Ze(fn.current.requestedByOfferId),fn.current.resetRequest();return;case gs.REQUEST_TYPE_NAME:xe(fn.current.requestByName),fn.current.resetRequest();return}},[i,m,p,E,le,Se,Ze,xe]),o.useEffect(()=>{!y&&E&&E.pageId===-1&&Se(c)},[y,E,c,Se]),o.useEffect(()=>{I&&G({quantity:1,extraData:null,extraParamRequired:!1,previewStuffData:null})},[I]),o.useEffect(()=>{!i||m||(L(new Af),L(new dm),L(new Df(d)),L(new Pf))},[i,m,d]),o.useEffect(()=>(A(new Zi(j(),++Zi.PREVIEW_COUNTER)),()=>{A(H=>(H.dispose(),null))}),[]),{isVisible:i,setIsVisible:e,isBusy:n,pageId:s,previousPageId:c,currentType:d,rootNode:m,offersToNodes:p,currentPage:E,setCurrentPage:C,currentOffer:I,setCurrentOffer:b,activeNodes:S,searchResult:y,setSearchResult:R,frontPageItems:O,roomPreviewer:U,navigationHidden:k,setNavigationHidden:D,purchaseOptions:V,setPurchaseOptions:G,catalogOptions:$,setCatalogOptions:X,getNodeById:os,getNodeByName:xn,activateNode:le,openPageById:Se,openPageByName:xe,openPageByOfferId:Ze,requestOfferToMover:Ms}},Pe=()=>lt(FN),GN=1e3,VN=10,BN=1e3;let HN=0,WN=0;const jN=()=>{const[i,e]=o.useState([]),[n,r]=o.useState([]),[s,a]=o.useState([]),[c,u]=o.useState(!1),d=f=>{f.id=HN++,e(p=>{const _=[...p];return _.push(f),_.length>GN&&_.shift(),_})},g=f=>{r(p=>{const _=[...p];return _.push(f),_.length>VN&&_.shift(),_})},m=f=>{f.id=WN++,a(p=>{const _=[...p];return _.push(f),_.length>BN&&_.shift(),_})};return je(Kt.STARTED,f=>u(!0)),x(ca,f=>{if(!c)return;const p=f.getParser();n.length&&n[n.length-1].id===p.data.roomId||(d({id:-1,webId:-1,entityId:-1,name:p.data.roomName,timestamp:Jm(),type:rr.TYPE_ROOM_INFO,roomId:p.data.roomId}),g({id:p.data.roomId,name:p.data.roomName}),u(!1))}),x(mm,f=>{const p=f.getParser();m({id:-1,webId:p.senderId,entityId:-1,name:"",message:p.messageText,roomId:-1,timestamp:Du(p.secondsSinceSent),type:rr.TYPE_IM})}),x(hm,f=>{const p=f.getParser();m({id:-1,webId:p.senderId,entityId:-1,name:"",message:p.messageText,roomId:-1,timestamp:Du(),type:rr.TYPE_IM})}),{addChatEntry:d,chatHistory:i,roomHistory:n,messengerHistory:s}},el=()=>lt(jN),qN=()=>{const[i,e]=o.useState([]),[n,r]=o.useState([]),[s,a]=o.useState([]),[c,u]=o.useState([]),[d,g]=o.useState(null),m=o.useMemo(()=>{const S=i.filter(v=>v.online);return S.sort((v,y)=>v.name<y.name?-1:v.name>y.name?1:0),S},[i]),f=o.useMemo(()=>{const S=i.filter(v=>!v.online);return S.sort((v,y)=>v.name<y.name?-1:v.name>y.name?1:0),S},[i]),p=S=>L(new Wo(S.id)),_=(S,v)=>v!==S.relationshipStatus&&L(new Ea(S.id,v)),E=S=>{for(const v of i)if(v.id===S)return v;return null},C=S=>!(S===W().userId||E(S)||n.find(v=>v.requesterUserId===S)||s.indexOf(S)>=0),I=(S,v)=>{if(!C(S))return!1;a(y=>{const R=[...y];return R.push(S),R}),L(new gm(v))},b=(S,v)=>{S===-1&&!v?(L(new ru(!0)),r([])):r(y=>{const R=[...y],O=R.findIndex(F=>F.id===S);return O===-1?y:(L(v?new Hf(R[O].id):new ru(!1,R[O].id)),R.splice(O,1),R)})};return x(Mf,S=>{const v=S.getParser();g(new qS(v.userFriendLimit,v.normalFriendLimit,v.extendedFriendLimit,v.categories)),L(new Lf)}),x(Uf,S=>{const v=S.getParser();e(y=>{const R=[...y];for(const O of v.fragment){const F=R.findIndex(A=>A.id===O.id),U=new dn;U.populate(O),F>-1?R[F]=U:R.push(U)}return R})}),x(xf,S=>{const v=S.getParser();e(y=>{const R=[...y],O=F=>{const U=R.findIndex(A=>A.id===F.id);if(U===-1){const A=new dn;A.populate(F),R.unshift(A)}else R[U].populate(F)};for(const F of v.addedFriends)O(F);for(const F of v.updatedFriends)O(F);for(const F of v.removedFriendIds){const U=R.findIndex(A=>A.id===F);U>-1&&R.splice(U,1)}return R})}),x(Ff,S=>{const v=S.getParser();r(y=>{const R=[...y];for(const O of v.requests){const F=R.findIndex(U=>U.requesterUserId===O.requesterUserId);if(F>0)R[F]=sn(R[F]),R[F].populate(O);else{const U=new Pu;U.populate(O),R.push(U)}}return R})}),x(Gf,S=>{const y=S.getParser().request;r(R=>{const O=[...R];if(O.findIndex(U=>U.requesterUserId===y.requesterUserId)===-1){const U=new Pu;U.populate(y),O.push(U)}return O})}),o.useEffect(()=>{L(new Vf);const S=setInterval(()=>L(new Bf),12e4);return()=>{clearInterval(S)}},[]),{friends:i,requests:n,sentRequests:s,dismissedRequestIds:c,setDismissedRequestIds:u,settings:d,onlineFriends:m,offlineFriends:f,getFriend:E,canRequestFriend:C,requestFriend:I,requestResponse:b,followFriend:p,updateRelationship:_}},Nn=()=>lt(qN),zN=()=>{const[i,e]=o.useState([]),[n,r]=o.useState(-1),[s,a]=o.useState([]),[c,u]=o.useState(Er.HIDDEN),{getFriend:d=null}=Nn(),{simpleAlert:g=null}=ze(),m=o.useMemo(()=>i.filter(C=>s.indexOf(C.threadId)===-1),[i,s]),f=o.useMemo(()=>n>0&&m.find(C=>C.threadId===n||null),[n,m]),p=C=>{let I=i.find(b=>b.participant&&b.participant.id===C);if(I){const b=s.indexOf(I.threadId);b>=0&&a(S=>{const v=[...S];return v.splice(b,1),v})}else{const b=d(C);if(!b)return null;I=new sc(b),I.addMessage(null,h("messenger.moderationinfo"),0,null,Fr.SECURITY_NOTIFICATION),I.setRead(),e(S=>{const v=[...S];return v.push(I),v})}return I},_=C=>{a(I=>{const b=[...I];return b.indexOf(C)>=0?I:(b.push(C),b)}),n===C&&r(-1)},E=(C,I,b,S=0,v=null,y=Fr.CHAT)=>{if(!C||!b||!b.length)return;const R=I===W().userId;R&&b.length<=255&&L(new jf(C.participant.id,b)),e(O=>{const F=[...O],U=F.findIndex(A=>A.threadId===C.threadId);return U===-1?O:(C=sn(F[U]),R&&C.groups.length===1&&Sr(Nr.MESSENGER_NEW_THREAD),C.addMessage(y===Fr.ROOM_INVITE?null:I,b,S,v,y),n===C.threadId&&C.setRead(),F[U]=C,!R&&C.unread&&Sr(Nr.MESSENGER_MESSAGE_RECEIVED),F)})};return x(mm,C=>{const I=C.getParser(),b=p(I.senderId);b&&E(b,I.senderId,I.messageText,I.secondsSinceSent,I.extraData)}),x(hm,C=>{const I=C.getParser(),b=p(I.senderId);b&&E(b,I.senderId,I.messageText,0,null,Fr.ROOM_INVITE)}),x(Wf,C=>{const I=C.getParser();g(`Received room invite error: ${I.errorCode},recipients: ${I.failedRecipients}`,ge.DEFAULT,null,null,h("friendlist.alert.title"))}),o.useEffect(()=>{n<=0||e(C=>{const I=[...C],b=I.findIndex(S=>S.threadId===n);return b>=0&&(I[b]=sn(I[b]),I[b].setRead()),I})},[n]),o.useEffect(()=>{u(C=>{if(!m.length)return Er.HIDDEN;let I=!1;for(const b of m)if(b.unreadCount>0){I=!0;break}return I?Er.UNREAD:Er.SHOW})},[m]),{messageThreads:i,activeThread:f,iconState:c,visibleThreads:m,getMessageThread:p,setActiveThreadId:r,closeThread:_,sendMessage:E}},fh=()=>lt(zN),YN=()=>{const[i,e]=o.useState(!1),[n,r]=o.useState(null),[s,a]=o.useState(null),[c,u]=o.useState(null),[d,g]=o.useState(!1),[m,f]=o.useState(null);return x(qf,p=>{let _=p.getParser();!_||_&&!_.games.length||(a(_.games[0]),r(_.games))}),x(zf,p=>{let _=p.getParser();_&&u(_)}),x(Yf,p=>{let _=p.getParser();_&&g(_.isInMaintenance)}),x($f,p=>{let _=p.getParser();if(_)switch(_.gameTypeId){case 2:return console.log("snowwar");default:return f(_.url)}}),o.useEffect(()=>{i&&(L(new Kf),wc())},[i]),{isVisible:i,setIsVisible:e,games:n,accountStatus:c,selectedGame:s,setSelectedGame:a,gameOffline:d,gameURL:m,setGameURL:f}},tl=()=>lt(YN),$N=()=>{const[i,e]=o.useState(null);return x(Xf,n=>{const r=n.getParser(),s={badgeBases:[],badgeSymbols:[],badgePartColors:[],groupColorsA:[],groupColorsB:[]};r.bases.forEach((c,u)=>s.badgeBases.push({id:u,images:c})),r.symbols.forEach((c,u)=>s.badgeSymbols.push({id:u,images:c})),r.partColors.forEach((c,u)=>s.badgePartColors.push({id:u,color:c})),r.colorsA.forEach((c,u)=>s.groupColorsA.push({id:u,color:c})),r.colorsB.forEach((c,u)=>s.groupColorsB.push({id:u,color:c}));const a=(c,u)=>c.id<u.id?-1:c.id>u.id?1:0;s.badgeBases.sort(a),s.badgeSymbols.sort(a),s.badgePartColors.sort(a),s.groupColorsA.sort(a),s.groupColorsB.sort(a),e(s)}),o.useEffect(()=>{L(new Qf)},[]),{groupCustomize:i}},ui=()=>lt($N),KN=()=>{const[i,e]=o.useState(null),[n,r]=o.useState(null),{simpleAlert:s=null,showConfirm:a=null}=ze(),c=(u,d)=>{const g={reportType:u,reportedUserId:-1,reportedChats:[],cfhCategory:-1,cfhTopic:-1,roomId:-1,roomName:"",messageId:-1,threadId:-1,groupId:-1,extraData:"",roomObjectId:-1,message:"",currentStep:0};switch(u){case st.BULLY:case st.EMERGENCY:case st.IM:g.reportedUserId=d.reportedUserId,g.currentStep=$t.SELECT_CHATS;break;case st.ROOM:g.roomId=d.roomId,g.roomName=d.roomName,g.currentStep=$t.SELECT_TOPICS;break;case st.THREAD:g.groupId=d.groupId,g.threadId=d.threadId,g.currentStep=$t.SELECT_TOPICS;break;case st.MESSAGE:g.groupId=d.groupId,g.threadId=d.threadId,g.messageId=d.messageId,g.currentStep=$t.SELECT_TOPICS;break;case st.PHOTO:g.extraData=d.extraData,g.roomId=d.roomId,g.reportedUserId=d.reportedUserId,g.roomObjectId=d.roomObjectId,g.currentStep=$t.SELECT_TOPICS;break}e(g)};return x(Zf,u=>{const d=u.getParser();let g=d.messageText;switch(d.resultType){case oo.TOO_MANY_PENDING_CALLS_CODE:L(new Jf),s(h("help.cfh.error.pending"),ge.MODERATION,null,null,h("help.cfh.error.title"));break;case oo.HAS_ABUSIVE_CALL_CODE:s(h("help.cfh.error.abusive"),ge.MODERATION,null,null,h("help.cfh.error.title"));break;default:g.trim().length===0&&(g=h("help.cfh.sent.text")),s(g,ge.MODERATION,null,null,h("help.cfh.sent.title"))}}),x(ep,u=>{const d=u.getParser(),g=d.messageText.length===0?h("help.cfh.closed."+JS(d.closeReason)):d.messageText;s(g,ge.MODERATION,null,null,h("mod.alert.title"))}),x(np,u=>{const d=u.getParser();d.count>0&&a(h("help.emergency.pending.title")+`
`+d.pendingCalls[0].message,()=>{L(new tp)},null,h("help.emergency.pending.button.discard"),h("help.emergency.pending.button.keep"),h("help.emergency.pending.message.subtitle"))}),x(rp,u=>{s("Your pending calls were deleted",ge.MODERATION,null,null,h("mod.alert.title"))}),x(sp,u=>{const d=u.getParser();s(d.message,ge.MODERATION,null,null,h("help.cfh.reply.title"))}),x(ap,u=>{const d=u.getParser();s(h("help.emergency.global_mute.message"),ge.MODERATION,d.infoUrl,h("help.emergency.global_mute.link"),h("help.emergency.global_mute.subtitle"))}),x(ip,u=>{const d=u.getParser();r(d)}),{activeReport:i,setActiveReport:e,sanctionInfo:n,setSanctionInfo:r,report:c}},zn=()=>lt(KN),nl=()=>{const[i,e]=o.useState([]),n=o.useMemo(()=>!!i.length,[i]),r=o.useCallback(()=>{let a=-1;return e(c=>{const u=[...c];return a=u.length?u[u.length-1]+1:0,u.push(a),u}),a},[]),s=o.useCallback(a=>{e(c=>{const u=[...c],d=u.indexOf(a);return d===-1?c:(u.splice(d,1),u)})},[]);return{isVisible:n,activate:r,deactivate:s}},XN=i=>L(new lp(i)),QN=(i,e)=>L(new cp(i,...e)),JN=()=>{const[i,e]=o.useState(new Map),n=o.useCallback(d=>{var g;return((g=i.get(d))==null?void 0:g.length)||0},[i]),r=o.useMemo(()=>{let d=0;for(const g of i.keys())d+=n(g);return d},[i,n]),s=o.useCallback(d=>{let g=!0;return e(m=>{if(!m.has(d))return g=!1,m;const f=new Map(m);return f.delete(d),XN(d),f}),g},[]),a=o.useCallback((d,g)=>{let m=!0;return e(f=>{if(!f.has(d))return m=!1,f;const p=new Map(f),_=p.get(d);if(_)for(const E of g)_.splice(_.indexOf(E),1);return QN(d,g),p}),m},[]),c=o.useCallback((d,g)=>i.has(d)?i.get(d).indexOf(g)>=0:!1,[i]),u=o.useCallback((d,g)=>{e(m=>{if(!m.has(d))return m;const f=new Map(m),p=f.get(d),_=p.indexOf(g);return _>=0&&p.splice(_,1),f})},[]);return x(op,d=>{const g=d.getParser();e(m=>{const f=new Map(m);for(const p of g.categories){let _=f.get(p);_||(_=[],f.set(p,_));const E=g.getItemsByCategory(p);for(const C of E)_.indexOf(C)===-1&&_.push(C)}return f})}),{getCount:n,getFullCount:r,resetCategory:s,resetItems:a,isUnseen:c,removeUnseen:u}},Pn=()=>lt(JN),ZN=()=>{const[i,e]=o.useState(!0),[n,r]=o.useState([]),[s,a]=o.useState(new Map),[c,u]=o.useState([]),[d,g]=o.useState(null),{isVisible:m=!1,activate:f=null,deactivate:p=null}=nl(),{isUnseen:_=null,resetCategory:E=null}=Pn(),C=K("user.badges.max.slots",5),I=y=>c.indexOf(y)>=0,b=()=>c.length<C,S=y=>{u(R=>{const O=[...R],F=O.indexOf(y);if(F===-1){if(!b())return R;O.push(y)}else O.splice(F,1);const U=new hp;for(let A=0;A<C;A++)U.addActivatedBadge(O[A]??"");return L(U),O})},v=y=>n.indexOf(y)===-1?0:s.get(y)??0;return x(up,y=>{const R=y.getParser(),O=[];a(F=>{const U=new Map(F);return R.getAllBadgeCodes().forEach(A=>{const k=n.indexOf(A)>=0,D=R.getBadgeId(A);U.set(A,D),!k&&O.push(A)}),U}),u(R.getActiveBadgeCodes()),r(F=>[...F,...O])}),x(dp,y=>{const R=y.getParser(),O=_(at.BADGE,R.badgeId);r(F=>{const U=[...F];return O?U.unshift(R.badgeCode):U.push(R.badgeCode),U}),a(F=>{const U=new Map(F);return U.set(R.badgeCode,R.badgeId),U})}),o.useEffect(()=>{!n||!n.length||g(y=>{let R=y;return R&&n.indexOf(R)===-1&&(R=null),R||(R=n[0]),R})},[n]),o.useEffect(()=>{if(m)return()=>{E(at.BADGE)}},[m,E]),o.useEffect(()=>{!m||!i||(L(new mp),e(!1))},[m,i]),{badgeCodes:n,activeBadgeCodes:c,selectedBadgeCode:d,setSelectedBadgeCode:g,isWearingBadge:I,canWearBadges:b,toggleBadge:S,getBadgeId:v,activate:f,deactivate:p}},rl=()=>lt(ZN),eT=()=>{const[i,e]=o.useState(!0),[n,r]=o.useState([]),[s,a]=o.useState(null),{isVisible:c=!1,activate:u=null,deactivate:d=null}=nl(),{isUnseen:g=null,resetCategory:m=null}=Pn();return x(gp,f=>{const p=f.getParser();r(_=>{const E=[..._],C=E.map(b=>b.botData.id),I=[];for(const b of p.items.values())C.indexOf(b.id)===-1&&I.push(b);for(const b of C){let S=!0;for(const R of p.items.values())if(R.id===b){S=!1;break}if(!S)continue;const v=E.findIndex(R=>R.botData.id===b),y=E[v];v===-1||!y||(ia()===y.botData.id&&(Ya(),Z("inventory/open")),E.splice(v,1))}for(const b of I){const S={botData:b};g(at.BOT,b.id)?E.unshift(S):E.push(S)}return E})}),x(fp,f=>{const p=f.getParser();r(_=>{const E=[..._];if(E.findIndex(S=>S.botData.id===p.item.id)>=0)return _;const I={botData:p.item};return g(at.BOT,I.botData.id)?E.unshift(I):E.push(I),E})}),x(pp,f=>{const p=f.getParser();r(_=>{const E=[..._],C=E.findIndex(I=>I.botData.id===p.itemId);return C===-1?_:(E.splice(C,1),ia()===p.itemId&&(Ya(),Z("inventory/show")),E)})}),o.useEffect(()=>{!n||!n.length||a(f=>{let p=f;return p&&n.indexOf(p)===-1&&(p=null),p||(p=n[0]),p})},[n]),o.useEffect(()=>{if(c)return()=>{m(at.BOT)}},[c,m]),o.useEffect(()=>{!c||!i||(L(new Ip),e(!1))},[c,i]),{botItems:n,selectedBot:s,setSelectedBot:a,activate:u,deactivate:d}},ph=()=>lt(eT);let Di=null;const tT=()=>{const[i,e]=o.useState(!0),[n,r]=o.useState([]),[s,a]=o.useState(null),{isVisible:c=!1,activate:u=null,deactivate:d=null}=nl(),{isUnseen:g=null,resetCategory:m=null}=Pn(),f=E=>{if(!(!n||!n.length))return n.filter(C=>C.type===E)},p=E=>{if(!(!n||!n.length)){for(const C of n){const I=C.getItemById(E);if(I&&I.isWallItem)return C}return null}},_=E=>{if(!(!n||!n.length)){for(const C of n){const I=C.getItemById(E);if(I&&!I.isWallItem)return C}return null}};return x(fm,E=>{const C=E.getParser();r(I=>{const b=[...I];for(const S of C.items){let v=0,y=null;for(;v<b.length;){const R=b[v];let O=0;for(;O<R.items.length;){const F=R.items[O];if(F.id===S.itemId){F.update(S);const U=[...R.items];U[O]=F,R.items=U,y=R;break}O++}if(y)break;v++}if(y)y.hasUnseenItems=!0,b[v]=sn(y);else{const R=new za(S);Ou(b,R,g(at.FURNI,S.itemId)),yt(new Za(R.id,R.type,R.category))}}return b})}),x($l,E=>{const C=E.getParser();Di||(Di=new Array(C.totalFragments));const I=vS(C.fragment,C.totalFragments,C.fragmentNumber,Di);I&&(r(b=>{const S=[...b],v=wS(S);for(const y of v){if(I.get(y))continue;let R=0;for(;R<S.length;){const O=S[R],F=O.remove(y);if(!F){R++;continue}ia()===F.ref&&(Ya(),oa(O)||Z("inventory/show")),O.getTotalCount()<=0&&(S.splice(R,1),O.dispose());break}}for(const y of I.keys()){if(v.indexOf(y)>=0)continue;const R=I.get(y);if(!R)continue;const O=new za(R);Ou(S,O,g(at.FURNI,y)),yt(new Za(O.id,O.type,O.category))}return S}),Di=null)}),x(Ep,E=>{e(!0)}),x(pm,E=>{const C=E.getParser();r(I=>{const b=[...I];let S=0;for(;S<b.length;){const v=b[S],y=v.remove(C.itemId);if(!y){S++;continue}ia()===y.ref&&(Ya(),oa(v)||Z("inventory/show")),v.getTotalCount()<=0&&(b.splice(S,1),v.dispose());break}return b})}),x(Cp,E=>{}),o.useEffect(()=>{!n||!n.length||a(E=>{let C=E;return C&&n.indexOf(C)===-1&&(C=null),C||(C=n[0]),C})},[n]),o.useEffect(()=>{if(c)return()=>{m(at.FURNI)&&r(E=>{const C=[...E];for(const I of C)I.hasUnseenItems=!1;return C})}},[c,m]),o.useEffect(()=>{!c||!i||(L(new _p),e(!1))},[c,i]),{isVisible:c,groupItems:n,setGroupItems:r,selectedItem:s,setSelectedItem:a,activate:u,deactivate:d,getWallItemById:p,getFloorItemById:_,getItemsByType:f}},Ds=()=>lt(tT);let Pi=null;const nT=()=>{const[i,e]=o.useState(!0),[n,r]=o.useState([]),[s,a]=o.useState(null),{isVisible:c=!1,activate:u=null,deactivate:d=null}=nl(),{isUnseen:g=null,resetCategory:m=null}=Pn();return x(bp,f=>{const p=f.getParser();Pi||(Pi=new Array(p.totalFragments));const _=kS(p.fragment,p.totalFragments,p.fragmentNumber,Pi);_&&(r(E=>{const C=[...E];return yS(C,_,g),C}),Pi=null)}),x(Sp,f=>{const p=f.getParser();r(_=>{const E=[..._];return Km(p.pet,E,g(at.PET,p.pet.id)),E})}),x(Np,f=>{const p=f.getParser();r(_=>{const E=[..._];return Xm(p.petId,E),E})}),o.useEffect(()=>{!n||!n.length||a(f=>{let p=f;return p&&n.indexOf(p)===-1&&(p=null),p||(p=n[0]),p})},[n]),o.useEffect(()=>{if(c)return()=>{m(at.PET)}},[c,m]),o.useEffect(()=>{!c||!i||(L(new Tp),e(!1))},[c,i]),{petItems:n,selectedPet:s,setSelectedPet:a,activate:u,deactivate:d}},Ih=()=>lt(nT),rT=()=>{const[i,e]=o.useState(null),[n,r]=o.useState(null),[s,a]=o.useState(wt.TRADING_STATE_READY),{groupItems:c=[],setGroupItems:u=null,activate:d=null,deactivate:g=null}=Ds(),{simpleAlert:m=null,showTradeAlert:f=null}=ze(),p=s>=wt.TRADING_STATE_RUNNING,_=()=>{switch(s){case wt.TRADING_STATE_RUNNING:!n.itemCount&&!i.accepts&&m(h("inventory.trading.warning.other_not_offering"),null,null,null),i.accepts?L(new xp):L(new Fp);return;case wt.TRADING_STATE_CONFIRMING:L(new Up),a(wt.TRADING_STATE_CONFIRMED);return}},E=I=>{const b=I.getLastItem();b&&L(new Gp(b.id))},C=()=>{if(p)switch(s){case wt.TRADING_STATE_RUNNING:L(new Bp);return;default:L(new Vp);return}};return x(vp,I=>{const b=I.getParser();!i||!n||(i.userId===b.userID?e(S=>{const v=sn(S);return v.accepts=b.userAccepts,v}):n.userId===b.userID&&r(S=>{const v=sn(S);return v.accepts=b.userAccepts,v}))}),x(Rp,I=>{const b=I.getParser();b.reason===wp.ERROR_WHILE_COMMIT?f(cn.ERROR_WHILE_COMMIT):i&&b.userID!==i.userId&&f(cn.THEY_CANCELLED),e(null),r(null),a(wt.TRADING_STATE_READY)}),x(Op,I=>{I.getParser(),e(null),r(null),a(wt.TRADING_STATE_READY)}),x(yp,I=>{I.getParser(),a(wt.TRADING_STATE_COUNTDOWN)}),x(kp,I=>{const b=I.getParser(),S=Au(b.firstUserItemArray),v=Au(b.secondUserItemArray);e(y=>{const R=sn(y);R.userId===b.firstUserID?(R.creditsCount=b.firstUserNumCredits,R.itemCount=b.firstUserNumItems,R.userItems=S):(R.creditsCount=b.secondUserNumCredits,R.itemCount=b.secondUserNumItems,R.userItems=v);const O=[];for(const F of R.userItems.getValues()){let U=0;for(;U<F.getTotalCount();){const A=F.getItemByIndex(U);A&&O.push(A.ref),U++}}return u(F=>{const U=[...F];for(const A of U)A.lockItemIds(O);return U}),R}),r(y=>{const R=sn(y);return R.userId===b.firstUserID?(R.creditsCount=b.firstUserNumCredits,R.itemCount=b.firstUserNumItems,R.userItems=S):(R.creditsCount=b.secondUserNumCredits,R.itemCount=b.secondUserNumItems,R.userItems=v),R})}),x(Ap,I=>{I.getParser()}),x(Dp,I=>{const b=I.getParser(),S=new yu,v=Re().userDataManager.getUserData(b.userID);S.userItems=new Fa;const y=new yu,R=Re().userDataManager.getUserData(b.otherUserID);y.userItems=new Fa,v.webID===W().userId?(S.userId=v.webID,S.userName=v.name,S.canTrade=b.userCanTrade,y.userId=R.webID,y.userName=R.name,y.canTrade=b.otherUserCanTrade):R.webID===W().userId&&(S.userId=R.webID,S.userName=R.name,S.canTrade=b.otherUserCanTrade,y.userId=v.webID,y.userName=v.name,y.canTrade=b.userCanTrade),e(S),r(y),a(wt.TRADING_STATE_RUNNING)}),x(Pp,I=>{const b=I.getParser();f(b.reason,b.otherUserName)}),x(Lp,I=>{I.getParser(),f(cn.THEY_NOT_ALLOWED)}),x(Mp,I=>{I.getParser(),f(cn.YOU_NOT_ALLOWED)}),o.useEffect(()=>{if(s===wt.TRADING_STATE_READY)return;const I=d();return()=>g(I)},[s,d,g]),{ownUser:i,otherUser:n,tradeState:s,setTradeState:a,isTrading:p,groupItems:c,progressTrade:_,removeItem:E,stopTrading:C}},Eh=()=>lt(rT);class sT{constructor(e=0,n=20){this._data=[e,n]}getMessageArray(){return this._data}dispose(){this._data=null}}class aT{constructor(e){this._data=[e]}getMessageArray(){return this._data}dispose(){this._data=null}}class iT{constructor(e){this._data=[e]}getMessageArray(){return this._data}dispose(){this._data=null}}class oT{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){this._data=null}}const lT=()=>{const[i,e]=o.useState([]),[n,r]=o.useState(0),[s,a]=o.useState(0);Qe(uc.MENTIONS_LIST,m=>{e(m.mentions),a(m.totalCount)}),Qe(cc.MENTION_COUNT,m=>{r(m.unreadCount)}),Qe(lc.MENTION_ACTION,m=>{m.success&&(m.action==="delete"?e(f=>f.filter(p=>p.id!==m.mentionId)):m.action==="mark_read"?e(f=>f.map(p=>p.id===m.mentionId?{...p,isRead:!0}:p)):m.action==="mark_all_read"&&(e(f=>f.map(p=>({...p,isRead:!0}))),r(0)))});const c=(m=0,f=20)=>{L(new sT(m,f))},u=m=>{L(new aT(m))},d=m=>{L(new iT(m))},g=()=>{L(new oT)};return o.useEffect(()=>{c(0,20)},[]),{mentions:i,unreadCount:n,totalCount:s,requestMentionsList:c,markMentionAsRead:u,deleteMention:d,markAllMentionsAsRead:g}},Gc=()=>lt(lT),cT=()=>{const[i,e]=o.useState(null),[n,r]=o.useState([]),[s,a]=o.useState([]),[c,u]=o.useState([]),[d,g]=o.useState([]),[m,f]=o.useState([]),[p,_]=o.useState([]),{simpleAlert:E=null}=ze(),C=D=>{n.indexOf(D)>=0||r(V=>[...V,D])},I=D=>{r(V=>{const G=[...V],$=G.indexOf(D);return $>=0&&G.splice($),G})},b=D=>{n.indexOf(D)>=0?I(D):C(D)},S=D=>{s.indexOf(D)>=0||a(V=>[...V,D])},v=D=>{a(V=>{const G=[...V],$=G.indexOf(D);return $>=0&&G.splice($),G})},y=D=>{s.indexOf(D)>=0?v(D):S(D)},R=D=>{c.indexOf(D)>=0||u(V=>[...V,D])},O=D=>{u(V=>{const G=[...V],$=G.indexOf(D);return $>=0&&G.splice($),G})},F=D=>{c.indexOf(D)>=0?O(D):R(D)},U=D=>{d.indexOf(D)>=0||g(V=>[...V,D])},A=D=>{g(V=>{const G=[...V],$=G.indexOf(D);return $>=0&&G.splice($),G})},k=D=>{s.indexOf(D)>=0?A(D):U(D)};return x(Hp,D=>{const G=D.getParser().data;e(G),f(G.issues)}),x(Wp,D=>{const V=D.getParser();f(G=>{const $=[...G],X=$.findIndex(Y=>Y.issueId===V.issueData.issueId);return X>=0?$[X]=V.issueData:($.push(V.issueData),Sr(Nr.MODTOOLS_NEW_TICKET)),$})}),x(jp,D=>{D.getParser()}),x(qp,D=>{D.getParser()&&E("Failed to pick issue",ge.DEFAULT,null,null,"Error")}),x(zp,D=>{const V=D.getParser();f(G=>{const $=[...G],X=$.findIndex(Y=>Y.issueId===V.issueId);return X>=0&&$.splice(X,1),$})}),x(Yp,D=>{D.getParser().success?E("Moderation action was successfull",ge.MODERATION,null,null,"Success"):E("There was a problem applying tht moderation action",ge.MODERATION,null,null,"Error")}),x($p,D=>{const V=D.getParser();_(V.callForHelpCategories)}),x(Kp,D=>{D.getParser()}),{settings:i,openRooms:n,openRoomChatlogs:s,openUserChatlogs:d,openUserInfos:c,cfhCategories:p,tickets:m,openRoomInfo:C,closeRoomInfo:I,toggleRoomInfo:b,openRoomChatlog:S,closeRoomChatlog:v,toggleRoomChatlog:y,openUserInfo:R,closeUserInfo:O,toggleUserInfo:F,openUserChatlog:U,closeUserChatlog:A,toggleUserChatlog:k}},ua=()=>lt(cT),uT=()=>{const[i,e]=o.useState(null),[n,r]=o.useState(null),[s,a]=o.useState(null),[c,u]=o.useState(null),[d,g]=o.useState({roomInfo:null,state:He.NONE}),[m,f]=o.useState(null),[p,_]=o.useState({settingsReceived:!1,homeRoomId:0,enteredGuestRoom:null,currentRoomOwner:!1,currentRoomId:0,currentRoomIsStaffPick:!1,createdFlatId:0,avatarId:0,roomPicker:!1,eventMod:!1,currentRoomRating:0,canRate:!0}),{simpleAlert:E=null}=ze();return x(Xp,C=>{const I=C.getParser();L(new Ji(I.roomId,!1,!1))}),x(Qp,C=>{const I=C.getParser();I.canCreate||E(h(`navigator.cannotcreateevent.error.${I.errorCode}`),null,null,null,h("navigator.cannotcreateevent.title"))}),x(Em,C=>{L(new Jp),L(new Im)}),x(Zp,C=>{const I=C.getParser();_(b=>{const S={...b};return S.eventMod=I.securityLevel>=eo.MODERATOR,S.roomPicker=I.securityLevel>=eo.COMMUNITY,S})}),x(eI,C=>{const I=C.getParser();Sn(I.roomId)}),x(Cm,C=>{const I=C.getParser();_(b=>{const S={...b};return S.enteredGuestRoom=null,S.currentRoomOwner=I.isOwner,S.currentRoomId=I.roomId,S}),L(new Ji(I.roomId,!0,!1)),Va.available&&Va.call("legacyTrack","navigator","private",[I.roomId])}),x(ca,C=>{const I=C.getParser();if(I.roomEnter)g({roomInfo:null,state:He.NONE}),_(b=>{const S={...b};return S.enteredGuestRoom=I.data,S.currentRoomIsStaffPick=I.staffPick,!(S.createdFlatId===I.data.roomId)&&I.data.displayRoomEntryAd&&K("roomenterad.habblet.enabled",!1)&&ti.openRoomEnterAd(),S.createdFlatId=0,S.enteredGuestRoom&&S.enteredGuestRoom.habboGroupId>0,S});else if(I.roomForward){if(I.data.ownerName!==W().userName&&!I.isGroupMember)switch(I.data.doorMode){case rt.DOORBELL_STATE:g(b=>{const S={...b};return S.roomInfo=I.data,S.state=He.START_DOORBELL,S});return;case rt.PASSWORD_STATE:g(b=>{const S={...b};return S.roomInfo=I.data,S.state=He.START_PASSWORD,S});return}if(I.data.doorMode===rt.NOOB_STATE&&!W().isAmbassador&&!W().isRealNoob&&!W().isModerator)return;_s(I.data.roomId)}else _(b=>{const S={...b};return S.enteredGuestRoom=I.data,S.currentRoomIsStaffPick=I.staffPick,S})}),x(tI,C=>{const I=C.getParser();_(b=>{const S={...b};return S.currentRoomRating=I.totalLikes,S.canRate=I.canLike,S})}),x(nI,C=>{const I=C.getParser();(!I.userName||I.userName.length===0)&&g(b=>{const S={...b};return S.state=He.STATE_WAITING,S})}),x(rI,C=>{const I=C.getParser();(!I.userName||I.userName.length===0)&&g(b=>{const S={...b};return S.state=He.STATE_ACCEPTED,S})}),x(sI,C=>{const I=C.getParser();(!I.userName||I.userName.length===0)&&g(b=>{const S={...b};return S.state=He.STATE_NO_ANSWER,S})}),x(aI,C=>{switch(C.getParser().errorCode){case-100002:g(b=>{const S={...b};return S.state=He.STATE_WRONG_PASSWORD,S});return;case 4009:E(h("navigator.alert.need.to.be.vip"),ge.DEFAULT,null,null,h("generic.alert.title"));return;case 4010:E(h("navigator.alert.invalid_room_name"),ge.DEFAULT,null,null,h("generic.alert.title"));return;case 4011:E(h("navigator.alert.cannot_perm_ban"),ge.DEFAULT,null,null,h("generic.alert.title"));return;case 4013:E(h("navigator.alert.room_in_maintenance"),ge.DEFAULT,null,null,h("generic.alert.title"));return}}),x(iI,C=>{const I=C.getParser();u(I.topLevelContexts),a(I.topLevelContexts.length?I.topLevelContexts[0]:null)}),x(oI,C=>{const I=C.getParser();a(b=>{let S=b;if(S||(S=c&&c.length&&c[0]||null),!S)return null;if(I.result.code!==S.code&&c&&c.length)for(const v of c)v.code===I.result.code&&(S=v);for(const v of c)v.code===I.result.code&&(S=v);return S}),f(I.result)}),x(lI,C=>{const I=C.getParser();e(I.categories)}),x(cI,C=>{const I=C.getParser();r(I.categories)}),x(uI,C=>{const I=C.getParser();_s(I.roomId)}),x(dI,C=>{const I=C.getParser();let b=!1;if(_(y=>{b=y.settingsReceived;const R={...y};return R.homeRoomId=I.homeRoomId,R.settingsReceived=!0,R}),b)return;let S=-1,v=-1;K("friend.id")!==void 0&&parseInt(K("friend.id"))>0&&(S=0,L(new Wo(parseInt(K("friend.id"))))),K("forward.type")!==void 0&&K("forward.id")!==void 0&&(S=parseInt(K("forward.type")),v=parseInt(K("forward.id"))),S===2?Sn(v):S===-1&&I.roomIdToEnter>0&&(Z("navigator/close"),I.roomIdToEnter!==I.homeRoomId?_s(I.roomIdToEnter):_s(I.homeRoomId))}),x(mI,C=>{const I=C.getParser();switch(I.reason){case hl.REASON_FULL:E(h("navigator.guestroomfull.text"),ge.DEFAULT,null,null,h("navigator.guestroomfull.title"));break;case hl.REASON_QUEUE_ERROR:E(h(`room.queue.error.${I.parameter}`),ge.DEFAULT,null,null,h("room.queue.error.title"));break;case hl.REASON_BANNED:E(h("navigator.banned.text"),ge.DEFAULT,null,null,h("navigator.banned.title"));break;default:E(h("room.queue.error.title"),ge.DEFAULT,null,null,h("room.queue.error.title"));break}wc()}),x(hI,C=>Z("navigator/show")),{categories:i,doorData:d,setDoorData:g,topLevelContext:s,topLevelContexts:c,searchResult:m,navigatorData:p}},Yn=()=>lt(uT),dT=()=>{const[i,e]=o.useState(new Pc),n=o.useMemo(()=>K("hc.disabled",!1),[]),r=o.useMemo(()=>n||i.clubDays>0?fr.ACTIVE:i.pastVipDays>0||i.pastVipDays>0?fr.EXPIRED:fr.NONE,[i,n]),s=a=>{if(a===-1)return i.credits;for(const[c,u]of i.activityPoints.entries())if(c===a)return u;return 0};return x(gI,a=>{const c=a.getParser();e(u=>{const d=sn(u);return d.credits=parseFloat(c.credits),u.credits!==d.credits&&Sr(Nr.CREDITS),d})}),x(fI,a=>{const c=a.getParser();e(u=>{const d=sn(u);return d.activityPoints=c.currencies,d})}),x(lm,a=>{const c=a.getParser();e(u=>{const d=sn(u);return d.activityPoints=new Map(d.activityPoints),d.activityPoints.set(c.type,c.amount),c.type===0&&Sr(Nr.DUCKETS),d})}),x(II,a=>{const c=a.getParser(),u=c.productName;u!=="club_habbo"&&u!=="habbo_club"||e(d=>{const g=sn(d);return g.clubDays=Math.max(0,c.daysToPeriodEnd),g.clubPeriods=Math.max(0,c.periodsSubscribedAhead),g.isVip=c.isVip,g.pastClubDays=c.pastClubDays,g.pastVipDays=c.pastVipDays,g.isExpiring=c.responseType===pI.RESPONSE_TYPE_DISCOUNT_AVAILABLE,g.minutesUntilExpiration=c.minutesUntilExpiration,g.minutesSinceLastModified=c.minutesSinceLastModified,g})}),o.useEffect(()=>{if(n)return;L(new su("habbo_club"));const a=setInterval(()=>L(new su("habbo_club")),5e4);return()=>clearInterval(a)},[n]),o.useEffect(()=>{L(new EI)},[]),{purse:i,hcDisabled:n,clubStatus:r,getCurrencyAmount:s}},Ps=()=>lt(dT),mT=(i,e)=>{o.useEffect(()=>{if(!i)return;const n=r=>e(r);return br.addEventListener(Ve.FURNI_ADDED,n),()=>{br.removeEventListener(Ve.FURNI_ADDED,n)}},[i,e])},Ln=(i,e)=>{o.useEffect(()=>{if(!i)return;const n=r=>e(r);return br.addEventListener(Ve.FURNI_REMOVED,n),()=>{br.removeEventListener(Ve.FURNI_REMOVED,n)}},[i,e])},hT=i=>{Qe(Ve.OBJECT_DESELECTED,i)},gT=i=>{Qe(Ve.OBJECT_ROLL_OUT,i)},fT=i=>{Qe(Ve.OBJECT_ROLL_OVER,i)},Vc=i=>{Qe(Ve.OBJECT_SELECTED,i)},Ch=(i,e)=>{o.useEffect(()=>{if(!i)return;const n=r=>e(r);return br.addEventListener(Ve.USER_ADDED,n),()=>{br.removeEventListener(Ve.USER_ADDED,n)}},[i,e])},_h=(i,e)=>{o.useEffect(()=>{if(!i)return;const n=r=>e(r);return br.addEventListener(Ve.USER_REMOVED,n),()=>{br.removeEventListener(Ve.USER_REMOVED,n)}},[i,e])},pT=()=>{const[i,e]=o.useState(null),[n,r]=o.useState(!1);return x(CI,s=>{const a=s.getParser();a&&e(a)}),{promoteInformation:i,isExtended:n,setPromoteInformation:e,setIsExtended:r}},Bc=()=>lt(pT),IT=()=>{const[i,e]=o.useState(null),[n,r]=o.useState(null),[s,a]=o.useState(null),[c,u]=o.useState(0),d=(m,f,p,_=!1)=>{if(!n)return;const E=Cn.hslToRGB(((m&255)<<16)+((f&255)<<8)+(p&255));_&&u(E),!m&&!f&&!p?n.tint=0:n.tint=E},g=m=>{if(!s)return;const f=m>>16&255,p=m>>8&255,_=m&255;s.red=f/255,s.green=p/255,s.blue=_/255};return Qe(Jr.PREVIEW,m=>d(m.hue,m.saturation,m.lightness)),Qe(Jr.CLEAR_PREVIEW,m=>{n&&(n.tint=c)}),Ne(_I.ROOM_BACKGROUND_COLOR,m=>{Cs.isRoomPreviewerId(m.roomId)||(m.enable?d(m.hue,m.saturation,m.lightness,!0):d(0,0,0,!0))}),Ne(bI.ROOM_COLOR,m=>{if(Cs.isRoomPreviewerId(m.roomId))return;let f=0,p=255;m.bgOnly||(f=m.color,p=m.brightness),g(Cn.hslToRGB((Cn.rgbToHSL(f)&16776960)+p))}),Ne([yn.INITIALIZED,yn.DISPOSED],m=>{if(Cs.isRoomPreviewerId(m.roomId))return;const f=Re();if(f)switch(m.type){case yn.INITIALIZED:vu(m.roomId),e(f);return;case yn.DISPOSED:e(null);return}}),je([Kt.CREATED,Kt.ENDED],m=>{switch(m.type){case Kt.CREATED:pS(m.session);return;case Kt.ENDED:e(null);return}}),Ne([St.SELECTED,St.DESELECTED,St.ADDED,St.REMOVED,St.PLACED,St.REQUEST_MOVE,St.REQUEST_ROTATE,St.MOUSE_ENTER,St.MOUSE_LEAVE,St.DOUBLE_CLICK],m=>{if(Cs.isRoomPreviewerId(m.roomId))return;let f=null;switch(m.type){case St.SELECTED:ES(m)||(f=new Ve(Ve.OBJECT_SELECTED,m.objectId,m.category,m.roomId));break;case St.DESELECTED:f=new Ve(Ve.OBJECT_DESELECTED,m.objectId,m.category,m.roomId);break;case St.ADDED:{let p=null;switch(m.category){case J.FLOOR:case J.WALL:p=Ve.FURNI_ADDED;break;case J.UNIT:p=Ve.USER_ADDED;break}p&&(f=new Ve(p,m.objectId,m.category,m.roomId));break}case St.REMOVED:{let p=null;switch(m.category){case J.FLOOR:case J.WALL:p=Ve.FURNI_REMOVED;break;case J.UNIT:p=Ve.USER_REMOVED;break}p&&(f=new Ve(p,m.objectId,m.category,m.roomId));break}case St.REQUEST_MOVE:Ha(i,m.objectId,m.category)&&Hs(m.objectId,m.category,tr.OBJECT_MOVE);break;case St.REQUEST_ROTATE:Ha(i,m.objectId,m.category)&&Hs(m.objectId,m.category,tr.OBJECT_ROTATE_POSITIVE);break;case St.MOUSE_ENTER:f=new Ve(Ve.OBJECT_ROLL_OVER,m.objectId,m.category,m.roomId);break;case St.MOUSE_LEAVE:f=new Ve(Ve.OBJECT_ROLL_OUT,m.objectId,m.category,m.roomId);break;case St.DOUBLE_CLICK:f=new Ve(Ve.OBJECT_DOUBLE_CLICKED,m.objectId,m.category,m.roomId);break}f&&yt(f)}),o.useEffect(()=>{if(!i)return;const m=_e(),f=j(),p=i.roomId,_=1,E=Math.floor(window.innerWidth),C=Math.floor(window.innerHeight),I=m.application.renderer;I&&(I.view.style.width=`${E}px`,I.view.style.height=`${C}px`,I.resolution=window.devicePixelRatio,I.resize(E,C));const b=f.getRoomInstanceDisplay(p,_,E,C,SI.SCALE_ZOOMED_IN),S=j().getRoomInstanceRenderingCanvas(p,_);if(!b||!S)return;const v=new Xi(NI.WHITE),y=new TI,R=S.master;v.tint=0,v.width=E,v.height=C,R.addChildAt(v,0),R.filters=[y],r(v),a(y);const O=f.getRoomInstanceGeometry(p,_);if(O){const A=f.getRoomInstanceVariable(p,Ei.ROOM_MIN_X)||0,k=f.getRoomInstanceVariable(p,Ei.ROOM_MAX_X)||0,D=f.getRoomInstanceVariable(p,Ei.ROOM_MIN_Y)||0,V=f.getRoomInstanceVariable(p,Ei.ROOM_MAX_Y)||0;let G=(A+k)/2,$=(D+V)/2;const X=20;G=G+(X-1),$=$+(X-1);const Y=Math.sqrt(X*X+X*X)*Math.tan(30/180*Math.PI);O.location=new Ot(G,$,Y)}const F=m.application.stage;if(!F)return;F.addChild(b),vu(i.roomId);const U=A=>{const k=Math.floor(window.innerWidth),D=Math.floor(window.innerHeight);I.view.style.width=`${k}px`,I.view.style.height=`${D}px`,I.resolution=window.devicePixelRatio,I.resize(k,D),v.width=k,v.height=D,IS(k,D,1),m.application.render()};return window.addEventListener("resize",U),()=>{r(null),a(null),u(0),window.removeEventListener("resize",U)}},[i]),{roomSession:i}},Le=()=>lt(IT),ET=()=>{const[i,e]=o.useState(-1),[n,r]=o.useState(-1),[s,a]=o.useState(0),{roomSession:c=null}=Le(),u=()=>{const m=Cn.rgbToHSL(s),[f,p,_,E]=mn.int_to_8BitVals(m);L(new vI(i,p,_,E))},d=()=>c.useMultistateItem(i),g=()=>{yt(new Jr(Jr.CLEAR_PREVIEW)),e(-1),r(-1),a(0)};return Ne(ve.REQUEST_BACKGROUND_COLOR,m=>{if(!Ha(c,m.objectId,m.category))return;const p=j().getRoomObject(m.roomId,m.objectId,m.category).model;e(m.objectId),r(m.category);const _=parseInt(p.getValue(ee.FURNITURE_ROOM_BACKGROUND_COLOR_HUE)),E=parseInt(p.getValue(ee.FURNITURE_ROOM_BACKGROUND_COLOR_SATURATION)),C=parseInt(p.getValue(ee.FURNITURE_ROOM_BACKGROUND_COLOR_LIGHTNESS)),I=mn.eight_bitVals_to_int(0,_,E,C),b=Cn.hslToRGB(I);a(b)}),Ln(i!==-1&&n!==-1,m=>{m.id!==i||m.category!==n||g()}),o.useEffect(()=>{if(i===-1||n===-1)return;const m=Cn.rgbToHSL(s),[f,p,_,E]=mn.int_to_8BitVals(m);yt(new Jr(Jr.PREVIEW,p,_,E))},[i,n,s]),{objectId:i,color:s,setColor:a,applyToner:u,toggleToner:d,onClose:g}},CT=ET,_T=()=>{const[i,e]=o.useState(-1),[n,r]=o.useState(-1),[s,a]=o.useState("1"),[c,u]=o.useState(""),[d,g]=o.useState(""),[m,f]=o.useState(""),[p,_]=o.useState(""),{simpleAlert:E=null}=ze(),C=()=>{e(-1),r(-1),a("1"),u(""),g(""),f(""),_("")};return Ne([ve.REQUEST_BADGE_DISPLAY_ENGRAVING,ve.REQUEST_ACHIEVEMENT_RESOLUTION_ENGRAVING],I=>{const b=j().getRoomObject(I.roomId,I.objectId,I.category);if(!b)return;const S=new ni;S.initializeFromRoomObjectModel(b.model),e(I.objectId),r(I.category),a("1"),u(si(S.getValue(1))),g(yc(S.getValue(1))),f(S.getValue(2)),_(S.getValue(3))}),Ne(ve.REQUEST_ACHIEVEMENT_RESOLUTION_FAILED,I=>{const b=j().getRoomObject(I.roomId,I.objectId,I.category);!b||b.model.getValue(ee.FURNITURE_OWNER_ID)!==W().userId||E(`${h("resolution.failed.subtitle")} ${h("resolution.failed.text")}`,null,null,null,h("resolution.failed.title"))}),Ln(i!==-1&&n!==-1,I=>{I.id!==i||I.category!==n||C()}),{objectId:i,category:n,color:s,badgeName:c,badgeDesc:d,date:m,senderName:p,onClose:C}},bT=_T,dc="MONSTERPLANT_SEED_CONFIRMATION",mc="PURCHASABLE_CLOTHING_CONFIRMATION",bh="GROUP_FURNITURE",Sh="EFFECTBOX_OPEN",hc="MYSTERYTROPHY_OPEN_DIALOG",ST=()=>{const[i,e]=o.useState(-1),[n,r]=o.useState(null),[s,a]=o.useState(null),[c,u]=o.useState(-1),[d,g]=o.useState(null),[m,f]=o.useState(!1),[p,_]=o.useState(-1),{roomSession:E=null}=Le(),C=()=>{e(-1),g(null),f(!1),r(null)},I=()=>{a(null),u(-1)},b=S=>{if(S)switch(S){case"use_friend_furni":E.useMultistateItem(i);break;case"use_monsterplant_seed":a(dc),u(i);break;case"use_random_teleport":j().useRoomObject(i,J.FLOOR);break;case"use_purchaseable_clothing":a(mc),u(i);break;case"use_mystery_box":E.useMultistateItem(i);break;case"use_mystery_trophy":a(hc),u(i);break;case"join_group":Dc(d.guildId),f(!0);return;case"go_to_group_homeroom":d&&Sn(d.guildHomeRoomId);break}C()};return Ne([ve.OPEN_FURNI_CONTEXT_MENU,ve.CLOSE_FURNI_CONTEXT_MENU,ve.REQUEST_MONSTERPLANT_SEED_PLANT_CONFIRMATION_DIALOG,ve.REQUEST_PURCHASABLE_CLOTHING_CONFIRMATION_DIALOG,ve.REQUEST_EFFECTBOX_OPEN_DIALOG,ve.REQUEST_MYSTERYBOX_OPEN_DIALOG,ve.REQUEST_MYSTERYTROPHY_OPEN_DIALOG],S=>{const v=j().getRoomObject(E.roomId,S.objectId,S.category);if(v)switch(_(v.model.getValue(ee.FURNITURE_OWNER_ID)),S.type){case ve.REQUEST_MONSTERPLANT_SEED_PLANT_CONFIRMATION_DIALOG:if(!Yt(v))return;u(v.id),a(dc),C();return;case ve.REQUEST_EFFECTBOX_OPEN_DIALOG:if(!Yt(v))return;u(v.id),a(Sh),C();return;case ve.REQUEST_PURCHASABLE_CLOTHING_CONFIRMATION_DIALOG:if(!Yt(v))return;u(v.id),a(mc),C();return;case ve.REQUEST_MYSTERYBOX_OPEN_DIALOG:E.useMultistateItem(v.id),C();return;case ve.REQUEST_MYSTERYTROPHY_OPEN_DIALOG:if(!Yt(v))return;u(v.id),a(hc),C();return;case ve.OPEN_FURNI_CONTEXT_MENU:switch(e(v.id),S.contextMenu){case Ft.FRIEND_FURNITURE:r(Ft.FRIEND_FURNITURE);return;case Ft.MONSTERPLANT_SEED:Yt(v)&&r(Ft.MONSTERPLANT_SEED);return;case Ft.MYSTERY_BOX:r(Ft.MYSTERY_BOX);return;case Ft.MYSTERY_TROPHY:Yt(v)&&r(Ft.MYSTERY_TROPHY);return;case Ft.RANDOM_TELEPORT:r(Ft.RANDOM_TELEPORT);return;case Ft.PURCHASABLE_CLOTHING:Yt(v)&&r(Ft.PURCHASABLE_CLOTHING);return}return;case ve.CLOSE_FURNI_CONTEXT_MENU:v.id===i&&C();return}}),x(wI,S=>{const v=S.getParser();e(v.objectId),g(v),f(v.userIsMember),r(bh)}),{objectId:i,mode:n,confirmMode:s,confirmingObjectId:c,groupData:d,isGroupMember:m,objectOwnerId:p,closeConfirm:I,processAction:b,onClose:C}},NT=ST,TT=()=>{const[i,e]=o.useState(-1),[n,r]=o.useState([]),[s,a]=o.useState(null),[c,u]=o.useState([]),[d,g]=o.useState(null),[m,f]=o.useState(new Map),[p,_]=o.useState(!1),{groupItems:E=[],getItemsByType:C=null,activate:I=null,deactivate:b=null}=Ds(),{simpleAlert:S=null}=ze(),v=s&&m.get(s.name)||null,y=()=>{r([]),a(null),u([]),f(new Map)},R=()=>{e(-1),y()},O=()=>{_(!0),L(new PI(i,s.name))},F=U=>{a(U),m.get(U.name)||L(new LI(U.name))};return Ne(ve.OPEN_WIDGET,U=>{U.widget===RI.CRAFTING&&(e(U.objectId),y(),L(new OI(U.objectId)))}),x(yI,U=>{const A=U.getParser();if(!A.isActive()){e(-1);return}r(k=>{const D=[];for(const V of A.recipes){const G=j().roomContentLoader._activeObjectTypeIds.get(V.itemName),$=j().getFurnitureFloorIconUrl(G);D.push({name:V.recipeName,localizedName:h("roomItem.name."+G),iconUrl:$})}return D}),g(A.ingredients)}),x(kI,U=>{const A=U.getParser();f(k=>{const D=new Map(k);return D.set(s.name,A.ingredients),D})}),x(AI,U=>{a(null),_(!1),U.getParser().result&&S(h("crafting.info.result.ok"))}),x(DI,U=>{}),o.useEffect(()=>{!d||!d.length||u(U=>{const A=[];for(const k of d){const D=j().roomContentLoader._activeObjectTypeIds.get(k),V=j().getFurnitureFloorIconUrl(D),G=C(D);let $=0;if(G)for(const X of G)$+=X.items.length;A.push({name:k,iconUrl:V,count:$})}return A})},[E,d,C]),o.useEffect(()=>{if(i===-1)return;const U=I();return()=>b(U)},[i,I,b]),{objectId:i,recipes:n,ingredients:c,selectedRecipe:s,requiredIngredients:v,isCrafting:p,selectRecipe:F,craft:O,onClose:R}},vT=TT,wT=()=>{const[i,e]=o.useState([]),[n,r]=o.useState(0),[s,a]=o.useState(0),[c,u]=o.useState(0),[d,g]=o.useState(0),[m,f]=o.useState(16777215),[p,_]=o.useState(255),[E,C]=o.useState(0),[I,b]=o.useState(0),[S,v]=o.useState(0),{roomSession:y=null}=Le(),R=()=>y.isRoomOwner||y.controllerLevel>=nt.GUEST||W().isModerator,O=U=>{const A=i[U-1];A&&(r(A.id),C(A.type),b(A.color),v(A.light))},F=()=>{if(s===0)return;const U=n-1;if(n<1||n>i.length)return;const A=i[U];!A||E===A.type&&I===A.color&&S===A.light||(e(k=>{const D=[...k];return D[U]=new Gu(A.id,E,I,S),D}),Wn.savePreset(A.id,E,I,S,!0))};return Ne(ve.REQUEST_DIMMER,U=>{R()&&y.requestMoodlightSettings()}),je(MI.ROOM_DIMMER_PRESETS,U=>{const A=[];let k=0;for(;k<U.presetCount;){const D=U.getPreset(k);D&&A.push(new Gu(D.id,D.type,D.color,D.brightness)),k++}e(A),r(U.selectedPresetId)}),Ne(UI.ROOM_COLOR,U=>{Cs.isRoomPreviewerId(U.roomId)||(u(s),a(U.state),r(U.presetId),g(U.effectId),C(U.effectId),f(U.color),b(U.color),_(U.brightness),v(U.brightness))}),o.useEffect(()=>{s===0&&c===0||Wn.previewDimmer(I,S,E===2)},[s,c,I,S,E]),{presets:i,selectedPresetId:n,dimmerState:s,lastDimmerState:c,effectId:d,color:m,brightness:p,selectedEffectId:E,setSelectedEffectId:C,selectedColor:I,setSelectedColor:b,selectedBrightness:S,setSelectedBrightness:v,selectPresetId:O,applyChanges:F}},RT=wT,OT=()=>{const[i,e]=o.useState(-1),[n,r]=o.useState(-1),[s,a]=o.useState(0),c=()=>{e(-1),r(-1),a(0)},u=()=>{Re().connection.send(new xI(i)),c()};return Ne(ve.REQUEST_CREDITFURNI,d=>{const g=j().getRoomObject(d.roomId,d.objectId,d.category);!g||!Yt(g)||(e(d.objectId),r(d.category),a(g.model.getValue(ee.FURNITURE_CREDIT_VALUE)||0))}),Ln(i!==-1&&n!==-1,d=>{d.id!==i||d.category!==n||c()}),{objectId:i,value:s,redeem:u,onClose:c}},yT=OT,kT=()=>{const[i,e]=o.useState(-1),[n,r]=o.useState(-1),[s,a]=o.useState(-1),[c,u]=o.useState([]),{roomSession:d=null}=Le(),g=()=>{e(-1),r(-1),a(-1),u([])};return Ne(ve.REQUEST_EXTERNAL_IMAGE,m=>{const f=j().getRoomObject(m.roomId,m.objectId,m.category),p=j().getRoomObjects(d==null?void 0:d.roomId,J.WALL);if(!f)return;const _=[];p.forEach(C=>{if(C.type!=="external_image_wallitem_poster_small")return null;const I=C.model.getValue(ee.FURNITURE_DATA),b=JSON.parse(I);_.push(b)}),e(m.objectId),r(m.category),u(_);const E=JSON.parse(f.model.getValue(ee.FURNITURE_DATA));a(C=>{let I=0;return E&&(I=_.findIndex(b=>b.u===E.u)),I<0&&(I=0),I})}),Ln(i!==-1&&n!==-1,m=>{m.id!==i||m.category!==n||g()}),{objectId:i,currentPhotoIndex:s,currentPhotos:c,onClose:g}},AT=kT,DT=()=>{const[i,e]=o.useState(-1),[n,r]=o.useState(-1),[s,a]=o.useState(0),[c,u]=o.useState([]),[d,g]=o.useState([]),[m,f]=o.useState(null),[p,_]=o.useState(0),E=()=>{e(-1),r(-1),a(0),u([]),g([]),f(null)},C=I=>{Re().connection.send(new BI(i,I)),E()};return x(FI,I=>{const b=I.getParser();e(b.furniId),_(b.start?1:2)}),x(GI,I=>E()),x(VI,I=>E()),Ne(ve.REQUEST_FRIEND_FURNITURE_ENGRAVING,I=>{const b=j().getRoomObject(I.roomId,I.objectId,I.category);if(!b)return;const S=b.model.getValue(ee.FURNITURE_DATA),v=b.model.getValue(ee.FURNITURE_FRIENDFURNI_ENGRAVING);S[0]!=="1"||S.length!==6||(e(I.objectId),r(I.category),a(v),u([S[1],S[2]]),g([S[3],S[4]]),f(S[5]),_(0))}),Ln(i!==-1&&n!==-1,I=>{I.id!==i||I.category!==n||E()}),{objectId:i,type:s,usernames:c,figures:d,date:m,stage:p,onClose:E,respond:C}},PT=DT,LT=["perteam","mostwins","classic"],MT=["alltime","daily","weekly","monthly"],UT=()=>{const[i,e]=o.useState(new Map),{roomSession:n=null}=Le(),r=a=>LT[a],s=a=>MT[a];return Ne(ve.REQUEST_HIGH_SCORE_DISPLAY,a=>{const c=j().getRoomObject(a.roomId,a.objectId,a.category);if(!c)return;const u=c.model.getValue(ee.FURNITURE_DATA_FORMAT),d=im.getData(u);d.initializeFromRoomObjectModel(c.model),e(g=>{const m=new Map(g);return m.set(c.id,d),m})}),Ne(ve.REQUEST_HIDE_HIGH_SCORE_DISPLAY,a=>{a.roomId===n.roomId&&e(c=>{const u=new Map(c);return u.delete(a.objectId),u})}),{stuffDatas:i,getScoreType:r,getClearType:s}},xT=UT,FT="internalLink",GT=()=>(Ne(ve.REQUEST_INTERNAL_LINK,i=>{const e=j().getRoomObject(i.roomId,i.objectId,i.category);if(!e)return;let r=e.model.getValue(ee.FURNITURE_DATA)[FT];(!r||!r.length)&&(r=e.model.getValue(ee.FURNITURE_INTERNAL_LINK)),r&&r.length&&Z(r)}),{}),VT=GT,BT=()=>{const[i,e]=o.useState(-1),[n,r]=o.useState(-1),[s,a]=o.useState(null),[c,u]=o.useState(null),[d,g]=o.useState(bn.NO_CLUB),[m,f]=o.useState(null),p=()=>{e(-1),r(-1),a(null),u(null),f(null)},_=()=>{i!==-1&&(L(new HI(i)),p())},E=()=>{i!==-1&&(L(new Kl(i)),p())},C=()=>{i!==-1&&L(new WI(i,m))};return Ne(ve.REQUEST_MANNEQUIN,I=>{const b=j().getRoomObject(I.roomId,I.objectId,I.category);if(!b)return;const S=b.model,v=S.getValue(ee.FURNITURE_MANNEQUIN_FIGURE)||null,y=S.getValue(ee.FURNITURE_MANNEQUIN_GENDER)||null,R=kt().createFigureContainer(v),O=kt().getFigureClubLevel(R,y,ra.MANNEQUIN_CLOTHING_PART_TYPES);e(I.objectId),r(I.category),a(v),u(y),g(O),f(S.getValue(ee.FURNITURE_MANNEQUIN_NAME)||null)}),Ln(i!==-1&&n!==-1,I=>{I.id!==i||I.category!==n||p()}),{objectId:i,figure:s,gender:c,clubLevel:d,name:m,setName:f,saveFigure:_,wearFigure:E,saveName:C,onClose:p}},HT=BT,WT=()=>{const[i,e]=o.useState(-1),[n,r]=o.useState(-1),[s,a]=o.useState(-1),[c,u]=o.useState(new Fa),[d,g]=o.useState([]),{roomSession:m=null}=Le(),{showSingleBubble:f=null,simpleAlert:p=null}=ze(),_=()=>{e(-1),r(-1)},E=o.useCallback((S,v)=>L(new jI(S,v)),[]),C=o.useCallback(S=>L(new qI(S)),[]),I=o.useCallback((S,v)=>L(new Kl(S,v)),[]);Ne(ve.REQUEST_PLAYLIST_EDITOR,S=>{var y,R,O;const v=j().getRoomObject(S.roomId,S.objectId,S.category);if(v){if(Yt(v)){e(S.objectId),r(S.category),(y=_e().soundManager.musicController)==null||y.requestUserSongDisks(),(O=(R=_e().soundManager.musicController)==null?void 0:R.getRoomItemPlaylist())==null||O.requestPlayList();return}(m.isRoomOwner||m.controllerLevel>=nt.GUEST||W().isModerator)&&L(new Kl(S.objectId,-2))}}),Ln(i!==-1&&n!==-1,S=>{S.id!==i||S.category!==n||_()}),fs(_m.NPE_SONG_CHANGED,S=>{a(S.position)}),fs(zI.NOTIFY_PLAYED_SONG,S=>{f(h("soundmachine.notification.playing",["songname","songauthor"],[S.name,S.creator]),ft.SOUNDMACHINE)}),fs(YI.SDIR_SONG_DISK_INVENTORY_RECEIVENT_EVENT,S=>{var v;u((v=_e().soundManager.musicController)==null?void 0:v.songDiskInventory.clone())}),fs(au.PLUE_PLAY_LIST_UPDATED,S=>{var v,y;g((y=(v=_e().soundManager.musicController)==null?void 0:v.getRoomItemPlaylist())==null?void 0:y.entries.concat())}),fs(au.PLUE_PLAY_LIST_FULL,S=>{p(h("playlist.editor.alert.playlist.full"),ge.ALERT,"","",h("playlist.editor.alert.playlist.full.title"))});const b=S=>{var v,y;i!==-1&&(S instanceof $l?S.getParser().fragmentNumber===0&&((v=_e().soundManager.musicController)==null||v.requestUserSongDisks()):(y=_e().soundManager.musicController)==null||y.requestUserSongDisks())};return x($l,b),x(pm,b),x(fm,b),{objectId:i,diskInventory:c,playlist:d,currentPlayingIndex:s,onClose:_,addToPlaylist:E,removeFromPlaylist:C,togglePlayPause:I}},jT=WT,Xu="floor",qT="wallpaper",Qu="landscape",zT="poster",YT=()=>{const[i,e]=o.useState(-1),[n,r]=o.useState(-1),[s,a]=o.useState(null),[c,u]=o.useState(null),[d,g]=o.useState(!1),[m,f]=o.useState(null),[p,_]=o.useState(null),[E,C]=o.useState(-1),[I,b]=o.useState(null),[S,v]=o.useState(!1),[y,R]=o.useState(null),{roomSession:O=null}=Le(),F=()=>{e(-1),r(-1),a(null),u(null),g(!1),f(null),_(null),C(-1),b(null),v(!1),R(null)},U=()=>{i!==-1&&(O.openGift(i),j().changeObjectModelData(j().activeRoomId,i,J.FLOOR,ee.FURNITURE_DISABLE_PICKING_ANIMATION,1))},A=o.useMemo(()=>({imageReady:(k,D,V)=>{!V&&D&&(V=_r.generateImage(D)),R(V.src)},imageFailed:null}),[]);return je($I.RSPE_PRESENT_OPENED,k=>{let D=null;k.itemType===fe.FLOOR?D=W().getFloorItemData(k.classId):k.itemType===fe.WALL&&(D=W().getWallItemData(k.classId));let V=!1;if(k.placedInRoom){const G=j().getRoomObject(O.roomId,k.placedItemId,J.FLOOR);G&&(V=Yt(G))}switch(k.itemType){case fe.WALL:{if(D)switch(D.className){case Xu:case Qu:case qT:let G=null;D.className===Xu?G=h("inventory.furni.item.floor.name"):D.className===Qu?G=h("inventory.furni.item.landscape.name"):G=h("inventory.furni.item.wallpaper.name"),u(G);break;case zT:{const $=k.productCode;let X=null;$.indexOf("poster")===0&&(X=$.replace("poster",""));const Y=W().getProductData($);let Ee=null;Y?Ee=Y.name:D&&(Ee=D.name),u(Ee),R(j().getFurnitureWallIconUrl(k.classId,X));break}default:{u(D.name||null),R(j().getFurnitureWallIconUrl(k.classId));break}}break}case fe.HABBO_CLUB:u(h("widget.furni.present.hc"));break;default:{if(k.placedItemType===fe.PET){const $=k.petFigureString;if($&&$.length){const X=new sa($),Y=j().getRoomObjectPetImage(X.typeId,X.paletteId,X.color,new Ot(90),64,A,!0,0,X.customParts);Y&&R(Y.getImage().src)}}else{const $=j().getFurnitureFloorImage(k.classId,new Ot(90),64,A);$&&R($.getImage().src)}const G=W().getProductData(k.productCode);u(G&&G.name||D.name);break}}e(0),r(k.classId),a(k.itemType),g(V),C(k.placedItemId),b(k.placedItemType),v(k.placedInRoom)}),Ne(ve.REQUEST_PRESENT,k=>{const D=j().getRoomObject(k.roomId,k.objectId,k.category);if(!D)return null;F(),e(k.objectId),r(-1),u(D.model.getValue(ee.FURNITURE_DATA)||""),g(Yt(D)),f(D.model.getValue(ee.FURNITURE_PURCHASER_NAME)||null),_(D.model.getValue(ee.FURNITURE_PURCHASER_FIGURE)||null)}),Ln(i!==-1,k=>{k.id===i&&F(),k.id===E&&S&&v(!1)}),{objectId:i,classId:n,itemType:s,text:c,isOwnerOfFurniture:d,senderName:m,senderFigure:p,placedItemId:E,placedItemType:I,placedInRoom:S,imageUrl:y,openPresent:U,onClose:F}},$T=YT,KT="internalLink",XT=()=>{const[i,e]=o.useState(0);return Ne(ve.REQUEST_ROOM_LINK,n=>{const r=j().getRoomObject(n.roomId,n.objectId,n.category);if(!r)return;let a=r.model.getValue(ee.FURNITURE_DATA)[KT];(!a||!a.length)&&(a=r.model.getValue(ee.FURNITURE_INTERNAL_LINK)),!(!a||!a.length)&&(a=parseInt(a,10),!isNaN(a)&&(e(a),L(new Ji(a,!1,!1))))}),x(ca,n=>{!i||n.getParser().data.roomId!==i||e(0)}),{}},QT=XT,JT=()=>{const[i,e]=o.useState(-1),[n,r]=o.useState(-1),[s,a]=o.useState(""),[c,u]=o.useState(""),[d,g]=o.useState("0"),[m,f]=o.useState(""),[p,_]=o.useState(!1),{getWallItemById:E=null}=Ds(),C=()=>{L(new XI(i,c,d,m)),e(-1),r(-1),a(""),u(""),g("0"),f(""),_(!1)};return x(KI,I=>{const b=I.getParser();e(b.itemId),r(J.WALL);const S=E(b.itemId);let v="post_it";if(S){const y=j().getFurnitureWallName(S.type);y.match("post_it_")&&(v=y)}a(v),u(b.location),g("FFFF33"),f(""),_(!0)}),{objectId:i,color:d,setColor:g,text:m,setText:f,canModify:p,onClose:C}},ZT=JT,vl=40,ev=()=>{const[i,e]=o.useState(-1),[n,r]=o.useState(-1),[s,a]=o.useState(0),[c,u]=o.useState(-1),d=()=>{e(-1),r(-1),a(0),u(-1)},g=(m,f=!1)=>{m||(m=0),m=Math.abs(m),f||m>vl&&(m=vl),a(parseFloat(m.toFixed(2))),f||u(m*100)};return x(QI,m=>{const f=m.getParser();i===f.furniId&&g(f.height,!0)}),Ne(ve.REQUEST_STACK_HEIGHT,m=>{if(!Ha(Re(),m.objectId,m.category))return;const f=j().getRoomObject(m.roomId,m.objectId,m.category);f&&(e(m.objectId),r(m.category),a(f.getLocation().z),u(-1))}),Ln(i!==-1&&n!==-1,m=>{m.id!==i||m.category!==n||d()}),o.useEffect(()=>{if(i===-1||c===-1)return;const m=setTimeout(()=>L(new Xl(i,~~c)),10);return()=>clearTimeout(m)},[i,c]),{objectId:i,height:s,maxHeight:vl,onClose:d,updateHeight:g}},tv=ev,nv=()=>{const[i,e]=o.useState(-1),[n,r]=o.useState(-1),[s,a]=o.useState("0"),[c,u]=o.useState(""),[d,g]=o.useState(""),[m,f]=o.useState(!1),p=()=>{e(-1),r(-1),a("0"),u(""),g(""),f(!1)},_=I=>{I!==s&&(a(I),j().modifyRoomObjectData(i,n,I,c))},E=I=>{u(I),j().modifyRoomObjectData(i,n,s,I)},C=()=>j().deleteRoomObject(i,n);return Ne(ve.REQUEST_STICKIE,I=>{const b=j().getRoomObject(I.roomId,I.objectId,I.category);if(!b)return;const S=b.model.getValue(ee.FURNITURE_ITEMDATA);if(S.length<6)return;let v=null,y=null;S.indexOf(" ")>0?(v=S.slice(0,S.indexOf(" ")),y=S.slice(S.indexOf(" ")+1,S.length)):v=S,e(I.objectId),r(I.category),a(v||"0"),u(y||""),g(b.type||"post_it"),f(Re().isRoomOwner||W().isModerator||Yt(b))}),Ln(i!==-1&&n!==-1,I=>{I.id!==i||I.category!==n||p()}),{objectId:i,color:s,text:c,type:d,canModify:m,updateColor:_,updateText:E,trash:C,onClose:p}},rv=nv,sv=()=>{const[i,e]=o.useState(-1),[n,r]=o.useState(-1),[s,a]=o.useState("1"),[c,u]=o.useState(""),[d,g]=o.useState(""),[m,f]=o.useState(""),p=()=>{e(-1),r(-1),a("1"),u(""),g(""),f("")};return Ne(ve.REQUEST_TROPHY,_=>{const E=j().getRoomObject(_.roomId,_.objectId,_.category);if(!E)return;let C=E.model.getValue(ee.FURNITURE_DATA);E.model.getValue(ee.FURNITURE_EXTRAS),e(_.objectId),r(_.category),a(E.model.getValue(ee.FURNITURE_COLOR)||"1");const I=C.substring(0,C.indexOf("	"));C=C.substring(I.length+1,C.length);const b=C.substring(0,C.indexOf("	")),S=C.substr(b.length+1,C.length);u(I),g(b),f(S)}),Ln(i!==-1&&n!==-1,_=>{_.id!==i||_.category!==n||p()}),{objectId:i,color:s,senderName:c,date:d,message:m,onClose:p}},av=sv,iv=0,ov=1,lv=2,cv=3,uv=()=>{const[i,e]=o.useState(-1),[n,r]=o.useState(-1),[s,a]=o.useState(null),[c,u]=o.useState(null),[d,g]=o.useState(null),[m,f]=o.useState(-1),[p,_]=o.useState(null),[E,C]=o.useState(null),[I,b]=o.useState(!1),S=()=>{e(-1),r(-1),a(null),u(null),g(null),f(-1),_(null),C(null),b(!1)},v=()=>L(new Ci(i,iv)),y=()=>L(new Ci(i,ov)),R=()=>I&&s&&s.length&&L(new Ci(i,lv)),O=()=>I&&s&&s.length&&L(new Ci(i,cv)),F=U=>{if(p===U){_(null),L(new iu(i,""));return}_(U),L(new iu(i,U))};return Ne(ve.REQUEST_YOUTUBE,U=>{if(Cs.isRoomPreviewerId(U.roomId))return;const A=j().getRoomObject(U.roomId,U.objectId,U.category);A&&(e(U.objectId),r(U.category),b(W().hasSecurity(eo.EMPLOYEE)||Yt(A)),L(new JI(U.objectId)))}),x(ZI,U=>{const A=U.getParser();i===-1||i!==A.furniId||(a(A.videoId),u(A.startAtSeconds),g(A.endAtSeconds),f(A.state))}),x(eE,U=>{const A=U.getParser();i===-1||i!==A.furniId||(C(A.playlists),_(A.selectedPlaylistId),a(null),f(-1),g(null),u(null))}),x(tE,U=>{const A=U.getParser();if(!(i===-1||i!==A.furniId))switch(A.commandId){case 1:f(Zr.PLAYING);break;case 2:f(Zr.PAUSED);break}}),Ln(i!==-1&&n!==-1,U=>{U.id!==i||U.category!==n||S()}),{objectId:i,videoId:s,videoStart:c,videoEnd:d,currentVideoState:m,selectedVideo:p,playlists:E,onClose:S,previous:v,next:y,pause:R,play:O,selectVideo:F}},dv=uv,mv=()=>{const[i,e]=o.useState(null),[n,r]=o.useState([]),[s,a]=o.useState(""),[c,u]=o.useState([]),[d,g]=o.useState(0),[m,f]=o.useState(de.STUFF_SELECTION_OPTION_NONE),{showConfirm:p=null}=ze(),_=()=>{const C=I=>{I&&(I instanceof bm?L(new iE(I.id,n,s,c,d,I.stuffTypeSelectionCode)):I instanceof Sm?L(new oE(I.id,n,s,c,I.stuffTypeSelectionCode)):I instanceof Nm&&L(new lE(I.id,n,s,c,I.stuffTypeSelectionCode)))};gS(i.id)?C(i):p(h("wiredfurni.nonowner.change.confirm.body"),()=>{C(i)},null,null,null,h("wiredfurni.nonowner.change.confirm.title"))},E=(C,I)=>{!i||!m||C<=0||u(b=>{const S=[...b],v=b.indexOf(C);return v>=0?(S.splice(v,1),Ts.hide(C)):S.length<i.maximumItemSelectionCount&&(S.push(C),Ts.show(C)),S})};return x(nE,C=>{C.getParser(),e(null)}),x(rE,C=>{const I=C.getParser();e(I.definition)}),x(sE,C=>{const I=C.getParser();e(I.definition)}),x(aE,C=>{const I=C.getParser();e(I.definition)}),o.useEffect(()=>{if(i)return()=>{r([]),a(""),g(0),u(C=>(C&&C.length&&Ts.clearSelectionShaderFromFurni(C),[])),f(de.STUFF_SELECTION_OPTION_NONE)}},[i]),{trigger:i,setTrigger:e,intParams:n,setIntParams:r,stringParam:s,setStringParam:a,furniIds:c,setFurniIds:u,actionDelay:d,setActionDelay:g,setAllowsFurni:f,saveWired:_,selectObjectForWired:E}},Te=()=>lt(mv),hv=()=>{const[i,e]=o.useState(null),[n,r]=o.useState(null),[s,a]=o.useState([]),[c,u]=o.useState([]),[d,g]=o.useState(null),[m,f]=o.useState(-1),[p,_]=o.useState(!1),{friends:E=[]}=Nn(),{selectObjectForWired:C=null}=Te(),{roomSession:I=null}=Le(),b=O=>{a(F=>{const U=[...F];return U.splice(O,1),U})},S=O=>{u(F=>{const U=[...F],A=U.splice(O,1)[0];return d===A&&g(null),U})},v=O=>{g(O),u([])},y=(O,F)=>{const U=Fs.getObjectName(O,F);U&&(r(U),F!==J.UNIT&&u([]))},R=(O,F)=>{let U=null;switch(F){case J.FLOOR:case J.WALL:U=Fs.getFurniInfo(O,F),U&&C(O,F);break;case J.UNIT:{const A=I.userDataManager.getUserDataByIndex(O);if(!A)break;switch(A.type){case pt.PET:I.userDataManager.requestPetInfo(A.webID),f(A.webID);break;case pt.USER:U=Fs.getUserInfo(F,A);break;case pt.BOT:U=Fs.getBotInfo(F,A);break;case pt.RENTABLE_BOT:U=Fs.getRentableBotInfo(F,A);break}}}U&&e(U)};return je(cE.USER_DATA_UPDATED,O=>{if(!O.addedUsers.length)return;let F=[];O.addedUsers.forEach(U=>{U.webID!==W().userId&&E.find(A=>A.id===U.webID)&&F.push(new nh(U.roomIndex,J.UNIT,U.webID,U.name,U.type,!0))}),F.length&&a(U=>{const A=[...U];return F.forEach(k=>{const D=A.findIndex(V=>V.id===k.id);D>-1&&A.splice(D,1),A.push(k)}),A})}),je(uE.PET_INFO,O=>{const F=O.petInfo;if(!F||F.id!==m)return;const U=Fs.getPetInfo(F);U&&(e(U),f(-1))}),je(dE.PET_STATUS_UPDATE,O=>{}),Ne(ou.USE_PRODUCT_FROM_INVENTORY,O=>{}),Ne(ou.USE_PRODUCT_FROM_ROOM,O=>{const F=j().getRoomObject(I.roomId,O.objectId,J.FLOOR);if(!F||!Yt(F))return;const U=F.model.getValue(ee.FURNITURE_OWNER_ID),A=F.model.getValue(ee.FURNITURE_TYPE_ID),k=W().getFloorItemData(A),D=k.customParams.split(" "),V=D.length?parseInt(D[0]):-1;if(V===-1)return;const G=[],$=j().getRoomObjects(I.roomId,J.UNIT);for(const X of $){const Y=I.userDataManager.getUserDataByIndex(X.id);let Ee=!1;if(!(!Y||Y.type!==pt.PET)){if(Y.ownerId===U){Y.hasSaddle&&k.specialType===me.PET_SADDLE&&(Ee=!0);const ue=Y.figure.split(" ");if((ue.length?parseInt(ue[0]):-1)===V){if(k.specialType===me.MONSTERPLANT_REVIVAL&&!Y.canRevive||k.specialType===me.MONSTERPLANT_REBREED&&(Y.petLevel<7||Y.canRevive||Y.canBreed)||k.specialType===me.MONSTERPLANT_FERTILIZE&&(Y.petLevel>=7||Y.canRevive))continue;G.push(new cN(Y.roomIndex,J.UNIT,Y.name,O.objectId,X.id,-1,Ee))}}}}g(null),G.length&&u(G)}),Ne(St.REQUEST_MANIPULATION,O=>{Ha(I,O.objectId,O.category)&&_(!0)}),Vc(O=>{R(O.id,O.category)}),hT(O=>{e(null),u([])}),fT(O=>{i||O.category!==J.UNIT||y(O.id,O.category)}),gT(O=>{!n||O.category!==J.UNIT||n.roomIndex!==O.id||r(null)}),Qe([Ve.FURNI_REMOVED,Ve.USER_REMOVED],O=>{if(n&&n.category===O.category&&n.roomIndex===O.id&&r(null),O.category===J.UNIT){let F=s.findIndex(U=>U.roomIndex===O.id);F>-1&&a(U=>U.filter(A=>A.roomIndex===O.id)),F=c.findIndex(U=>U.id===O.id),F>-1&&u(U=>U.filter(A=>A.id!==O.id))}else O.category===J.FLOOR&&c.findIndex(U=>U.id===O.id)>-1&&u(U=>U.filter(A=>A.requestRoomObjectId!==O.id));i&&(i instanceof vs?i.id===O.id&&e(null):(i instanceof vt||i instanceof Rs||i instanceof ws)&&i.roomIndex===O.id&&e(null))}),o.useEffect(()=>{i&&(r(null),a([]),u([]))},[i]),o.useEffect(()=>{n&&a([])},[n]),o.useEffect(()=>{I.isDecorating=p},[I,p]),{avatarInfo:i,setAvatarInfo:e,activeNameBubble:n,setActiveNameBubble:r,nameBubbles:s,productBubbles:c,confirmingProduct:d,isDecorating:p,setIsDecorating:_,removeNameBubble:b,removeProductBubble:S,updateConfirmingProduct:v,getObjectName:y}},gv=hv,fv=()=>{const[i,e]=o.useState(""),[n,r]=o.useState(!1),[s,a]=o.useState(!1),[c,u]=o.useState(!1),[d,g]=o.useState(!1),[m,f]=o.useState(0),{showNitroAlert:p=null,showConfirm:_=null}=ze(),{roomSession:E=null}=Le(),C=(I,b,S="",v=0)=>{if(I==="")return null;const y=I.split(" ");if(y.length>0){const R=y[0];let O="";if(y.length>1&&(O=y[1]),R.charAt(0)===":"&&O==="x"){const F=j().selectedAvatarId;if(F>-1){const U=E.userDataManager.getUserDataByIndex(F);U&&(O=U.name,I=I.replace(" x"," "+U.name))}}switch(R.toLowerCase()){case":shake":return cu.init(2500,5e3),cu.turnVisualizationOn(),null;case":rotate":return lu.init(2500,5e3),lu.turnVisualizationOn(),null;case":d":case";d":kn()===bn.VIP&&E.sendExpressionMessage(hr.LAUGH.ordinal);break;case"o/":case"_o/":return E.sendExpressionMessage(hr.WAVE.ordinal),null;case":kiss":if(kn()===bn.VIP)return E.sendExpressionMessage(hr.BLOW.ordinal),null;break;case":jump":if(kn()===bn.VIP)return E.sendExpressionMessage(hr.JUMP.ordinal),null;break;case":idle":return E.sendExpressionMessage(hr.IDLE.ordinal),null;case"_b":return E.sendExpressionMessage(hr.RESPECT.ordinal),null;case":sign":return E.sendSignMessage(parseInt(O)),null;case":iddqd":case":flip":return j().events.dispatchEvent(new Ql(E.roomId,-1,!0)),null;case":zoom":return j().events.dispatchEvent(new Ql(E.roomId,parseFloat(O),!1)),null;case":screenshot":const F=j().createTextureFromRoom(E.roomId,1),U=new Image;return U.src=_r.generateImageUrl(F),window.open("").document.write(U.outerHTML),null;case":pickall":return(E.isRoomOwner||W().isModerator)&&_(h("room.confirm.pick_all"),()=>{W().sendSpecialCommandMessage(":pickall")},null,null,null,h("generic.alert.title")),null;case":ejectall":return(E.isRoomOwner||W().isModerator||E.controllerLevel>=nt.GUEST)&&_(h("room.confirm.eject_all"),()=>{W().sendSpecialCommandMessage(":ejectall")},null,null,null,h("generic.alert.title")),null;case":furni":return Z("furni-chooser/"),null;case":chooser":return Z("user-chooser/"),null;case":floor":case":bcfloor":return E.controllerLevel>=nt.ROOM_OWNER&&Z("floor-editor/show"),null;case":togglefps":return Vr().maxFPS>0?Vr().maxFPS=0:Vr().maxFPS=K("system.animation.fps"),null;case":client":case":nitro":case":billsonnn":return p(),null;case":settings":return(E.isRoomOwner||W().isModerator)&&L(new Tm(E.roomId)),null}}switch(b){case pr.CHAT_DEFAULT:E.sendChatMessage(I,v);break;case pr.CHAT_SHOUT:E.sendShoutMessage(I,v);break;case pr.CHAT_WHISPER:E.sendWhisperMessage(S,I,v);break}};return je(Gn.FLOOD_EVENT,I=>{g(!0),f(parseFloat(I.message))}),Vc(I=>{if(I.category!==J.UNIT)return;const b=E.userDataManager.getUserDataByIndex(I.id);b&&e(b.name)}),Ne(St.DESELECTED,I=>e("")),o.useEffect(()=>{if(!d)return;let I=0;const b=setInterval(()=>{f(S=>(I=(S||0)-1,I)),I<0&&(clearInterval(b),g(!1))},1e3);return()=>clearInterval(b)},[d]),o.useEffect(()=>{if(!c)return;let I=null;return c&&(I=setTimeout(()=>{u(!1),r(!1)},1e4)),()=>clearTimeout(I)},[c]),o.useEffect(()=>{n?s||(a(!0),E.sendChatTypingMessage(n)):s&&(a(!1),E.sendChatTypingMessage(n))},[E,n,s]),{selectedUsername:i,floodBlocked:d,floodBlockedSeconds:m,setIsTyping:r,setIsIdle:u,sendChat:C}},pv=fv,Ju=new Map,Zu=new Map,ed=new Map,Iv=()=>{const[i,e]=o.useState([]),[n,r]=o.useState({mode:Nt.CHAT_MODE_FREE_FLOW,weight:Nt.CHAT_BUBBLE_WIDTH_NORMAL,speed:Nt.CHAT_SCROLL_SPEED_NORMAL,distance:50,protection:Nt.FLOOD_FILTER_NORMAL}),{roomSession:s=null}=Le(),{addChatEntry:a}=el(),c=o.useRef(!1),u=o.useMemo(()=>{if(!n)return 6e3;switch(n.speed){case Nt.CHAT_SCROLL_SPEED_FAST:return 3e3;case Nt.CHAT_SCROLL_SPEED_NORMAL:return 6e3;case Nt.CHAT_SCROLL_SPEED_SLOW:return 12e3}},[n]),d=f=>{const p=kt().createAvatarImage(f,Nc.LARGE,null,{resetFigure:C=>{c.current||d(C)},dispose:()=>{},disposed:!1});if(!p)return;const _=p.getCroppedImage(Qi.HEAD),E=p.getPartColor(Fe.CHEST);return Ju.set(f,E&&E.rgb||16777215),p.dispose(),Zu.set(f,_.src),_.src},g=f=>{let p=Zu.get(f);return p||(p=d(f)),p},m=(f,p,_,E=64,C=null)=>{let I=ed.get(f+C);if(I)return I;const b=new sa(f),S=b.typeId,v=j().getRoomObjectPetImage(S,b.paletteId,b.color,new Ot(p*45),E,null,!1,0,b.customParts,C);return v&&(I=_r.generateImageUrl(v.data),ed.set(f+C,I)),I};return je(Gn.CHAT_EVENT,f=>{const p=j().getRoomObject(s.roomId,f.objectId,J.UNIT),_=p?jm(s.roomId,p==null?void 0:p.id,J.UNIT):new es,E=p?s.userDataManager.getUserDataByIndex(f.objectId):new mE(-1);let C="",I=0,b=null,S=f.chatType,v=f.style,y=0,R=f.message;if(E){y=E.type;const A=E.figure;switch(y){case pt.PET:b=m(A,2,!0,64,p.model.getValue(ee.FIGURE_POSTURE)),new sa(A).typeId;break;case pt.USER:b=g(A);break;case pt.RENTABLE_BOT:case pt.BOT:v=fE.BOT;break}I=Ju.get(A),C=E.name}switch(S){case Gn.CHAT_TYPE_RESPECT:R=h("widgets.chatbubble.respect",["username"],[C]),K("respect.options").enabled&&Sr(K("respect.options").sound);break;case Gn.CHAT_TYPE_PETREVIVE:case Gn.CHAT_TYPE_PET_REBREED_FERTILIZE:case Gn.CHAT_TYPE_PET_SPEED_FERTILIZE:{let A="widget.chatbubble.petrevived";S===Gn.CHAT_TYPE_PET_REBREED_FERTILIZE?A="widget.chatbubble.petrefertilized;":S===Gn.CHAT_TYPE_PET_SPEED_FERTILIZE&&(A="widget.chatbubble.petspeedfertilized");let k=null;if(j().getRoomObject(s.roomId,f.extraParam,J.UNIT)){const V=s.userDataManager.getUserDataByIndex(p.id);V&&(k=V.name)}R=h(A,["petName","userName"],[C,k]);break}case Gn.CHAT_TYPE_PETRESPECT:R=h("widget.chatbubble.petrespect",["petname"],[C]);break;case Gn.CHAT_TYPE_PETTREAT:R=h("widget.chatbubble.pettreat",["petname"],[C]);break;case Gn.CHAT_TYPE_HAND_ITEM_RECEIVED:R=h("widget.chatbubble.handitem",["username","handitem"],[C,h("handitem"+f.extraParam)]);break;case Gn.CHAT_TYPE_MUTE_REMAINING:{const A=(f.extraParam>0?Math.floor(f.extraParam/3600):0).toString(),k=(f.extraParam>0?Math.floor(f.extraParam%3600/60):0).toString(),D=(f.extraParam%60).toString();R=h("widget.chatbubble.mutetime",["hours","minutes","seconds"],[A,k,D]);break}}const O=PS(R),F=I&&("#"+I.toString(16).padStart(6,"0")||null),U=new oc(E.roomIndex,J.UNIT,s.roomId,R,O,C,new es(_.x,_.y),S,v,b,F);e(A=>[...A,U]),a({id:-1,webId:E.webID,entityId:E.roomIndex,name:C,imageUrl:b,style:v,chatType:S,entityType:E.type,message:O,timestamp:Jm(),type:rr.TYPE_CHAT,roomId:s.roomId,color:F})}),Ne(hE.ROOM_DRAG,f=>{if(!i.length||f.roomId!==s.roomId)return;const p=f.offsetX;i.forEach(_=>_.elementRef&&(_.left+=p))}),x(ca,f=>{const p=f.getParser();p.roomEnter&&r(p.chat)}),x(gE,f=>{const p=f.getParser();r(p.chat)}),o.useEffect(()=>(c.current=!1,()=>{c.current=!0}),[]),{chatMessages:i,setChatMessages:e,chatSettings:n,getScrollSpeed:u}},Ev=Iv,Cv=()=>{const[i,e]=o.useState([]),n=a=>{i.indexOf(a)>=0||e([...i,a])},r=a=>{const c=i.indexOf(a);if(c===-1)return;const u=[...i];u.splice(c,1),e(u)},s=(a,c)=>{Re().sendDoorbellApprovalMessage(a,c),r(a)};return je(gl.DOORBELL,a=>n(a.userName)),je(gl.RSDE_REJECTED,a=>r(a.userName)),je(gl.RSDE_ACCEPTED,a=>r(a.userName)),{users:i,addUser:n,removeUser:r,answer:s}},_v=Cv,bv=()=>{const[i,e]=o.useState(null),[n,r]=o.useState(!1),s=()=>r(!1);return x(pE,a=>{const c=a.getParser();r(!0),e(c.words)}),{wordsFilter:i,isVisible:n,setWordsFilter:e,onClose:s}},Sv=bv,Nv=()=>{const[i,e]=o.useState([]),{requests:n=[],dismissedRequestIds:r=[],setDismissedRequestIds:s=null}=Nn(),a=o.useMemo(()=>i.filter(u=>r.indexOf(u.request.requesterUserId)===-1),[i,r]),c=u=>{s(d=>{if(d.indexOf(u)>=0)return d;const g=[...d];return g.push(u),g})};return Ch(!0,u=>{if(u.category!==J.UNIT)return;const d=Re().userDataManager.getUserDataByIndex(u.id);if(!d||d.type!==uu.getTypeNumber(uu.USER))return;const g=n.find(f=>f.requesterUserId===d.webID);if(!g||i.find(f=>f.request.requesterUserId===d.webID))return;const m=[...i];m.push({roomIndex:d.roomIndex,request:g}),e(m)}),_h(!0,u=>{if(u.category!==J.UNIT)return;const d=i.findIndex(m=>m.roomIndex===u.id);if(d===-1)return;const g=[...i];g.splice(d,1),e(g)}),o.useEffect(()=>{const u=[];for(const d of n){const g=Re().userDataManager.getUserData(d.requesterUserId);g&&u.push({roomIndex:g.roomIndex,request:d})}e(u)},[n]),{displayedRequests:a,hideFriendRequest:c}},Tv=Nv,vv=()=>{const[i,e]=o.useState(null),{roomSession:n=null}=Le(),r=()=>e(null),s=c=>c&&j().selectRoomObject(Re().roomId,c.id,c.category),a=()=>{const c=W(),u=j().getRoomObjects(n.roomId,J.WALL),d=j().getRoomObjects(n.roomId,J.FLOOR),g=u.map(f=>{if(f.id<0)return null;let p=f.type;if(p.startsWith("poster"))p=h(`poster_${p.replace("poster","")}_name`);else{const _=f.model.getValue(ee.FURNITURE_TYPE_ID),E=c.getWallItemData(_);E&&E.name.length&&(p=E.name)}return new Ws(f.id,J.WALL,p)}),m=d.map(f=>{if(f.id<0)return null;let p=f.type;const _=f.model.getValue(ee.FURNITURE_TYPE_ID),E=c.getFloorItemData(_);return E&&E.name.length&&(p=E.name),new Ws(f.id,J.FLOOR,p)});e([...g,...m].sort((f,p)=>f.name<p.name?-1:1))};return mT(!!i,c=>{if(c.id<0)return;const u=j().getRoomObject(Re().roomId,c.id,c.category);if(!u)return;let d=null;switch(c.category){case J.WALL:{let g=u.type;if(g.startsWith("poster"))g=h(`poster_${g.replace("poster","")}_name`);else{const m=u.model.getValue(ee.FURNITURE_TYPE_ID),f=W().getWallItemData(m);f&&f.name.length&&(g=f.name)}d=new Ws(u.id,J.WALL,g);break}case J.FLOOR:{let g=u.type;const m=u.model.getValue(ee.FURNITURE_TYPE_ID),f=W().getFloorItemData(m);f&&f.name.length&&(g=f.name),d=new Ws(u.id,J.FLOOR,g)}}e(g=>[...g,d].sort((m,f)=>m.name<f.name?-1:1))}),Ln(!!i,c=>{c.id<0||e(u=>{const d=[...u];for(let g=0;g<d.length;g++){const m=d[g];if(!(m.id!==c.id||m.category!==c.category)){d.splice(g,1);break}}return d})}),{items:i,onClose:r,selectItem:s,populateChooser:a}},wv=vv,Rv=()=>{const[i,e]=o.useState(!1),[n,r]=o.useState(-1),[s,a]=o.useState(""),[c,u]=o.useState(""),[d,g]=o.useState(""),m=()=>{g(""),u(""),a(""),r(-1),e(!1)},f=()=>{L(new IE(n,c))},p=E=>{u(E),d.length>0&&g("")},_=E=>{if(!(!E||E===0))switch(E){case 1:return h("catalog.alert.petname.long");case 2:return h("catalog.alert.petname.short");case 3:return h("catalog.alert.petname.chars");case 4:default:return h("catalog.alert.petname.bobba")}};return je(du.RSOPPE_OPEN_PET_PACKAGE_REQUESTED,E=>{if(!E)return;const C=j().getRoomObject(E.session.roomId,E.objectId,J.FLOOR);r(E.objectId),a(C.type),e(!0)}),je(du.RSOPPE_OPEN_PET_PACKAGE_RESULT,E=>{E&&(E.nameValidationStatus===0&&m(),E.nameValidationStatus!==0&&g(_(E.nameValidationStatus)))}),{isVisible:i,errorResult:d,petName:c,objectType:s,onChangePetName:p,onConfirm:f,onClose:m}},Ov=Rv,yv=()=>{const{roomSession:i=null}=Le(),e=s=>i.sendPollStartMessage(s),n=s=>i.sendPollRejectMessage(s),r=(s,a,c)=>i.sendPollAnswerMessage(s,a,c);return je(fl.OFFER,s=>{const a=new $r($r.OFFER,s.id);a.summary=s.summary,a.headline=s.headline,yt(a)}),je(fl.ERROR,s=>{const a=new $r($r.ERROR,s.id);a.summary=s.summary,a.headline=s.headline,yt(a)}),je(fl.CONTENT,s=>{const a=new $r($r.CONTENT,s.id);a.startMessage=s.startMessage,a.endMessage=s.endMessage,a.numQuestions=s.numQuestions,a.questionArray=s.questionArray,a.npsPoll=s.npsPoll,yt(a)}),{startPoll:e,rejectPoll:n,answerPoll:r}},kv=yv,Av=()=>{const[i,e]=o.useState(null);Le();const n=()=>e(null),r=a=>a&&j().selectRoomObject(Re().roomId,a.id,a.category),s=()=>{const a=Re(),c=j().getRoomObjects(a.roomId,J.UNIT);e(c.map(u=>{if(u.id<0)return null;const d=a.userDataManager.getUserDataByIndex(u.id);return d?new Ws(d.roomIndex,J.UNIT,d.name):null}).sort((u,d)=>u.name<d.name?-1:1))};return Ch(!!i,a=>{if(a.id<0)return;const c=Re().userDataManager.getUserDataByIndex(a.id);c&&e(u=>{const d=[...u];return d.push(new Ws(c.roomIndex,J.UNIT,c.name)),d.sort((g,m)=>g.name<m.name?-1:1),d})}),_h(!!i,a=>{a.id<0||e(c=>{const u=[...c];for(let d=0;d<u.length;d++){const g=u[d];if(!(g.id!==a.id||g.category!==a.category)){u.splice(d,1);break}}return u})}),{items:i,onClose:n,selectItem:r,populateChooser:s}},Dv=Av,td=4e3,Pv=3,Lv=()=>{const[i,e]=o.useState(-1),[n,r]=o.useState(null),[s,a]=o.useState(!1),[c,u]=o.useState(null),[d,g]=o.useState(new Map),[m,f]=o.useState(new Map),{answerPoll:p=null}=kv(),{roomSession:_=null}=Le(),E=()=>{e(-1),r(null)},C=I=>{s||!n||(p(i,n.id,[I]),a(!0))};return je(pl.ANSWERED,I=>{const b=_.userDataManager.getUserData(I.userId);b&&(g(I.answerCounts),f(S=>{if(!S.has(b.roomIndex)){const v=new Map(m);return v.set(b.roomIndex,{value:I.value,secondsLeft:Pv}),v}return S}),j().updateRoomObjectUserGesture(_.roomId,b.roomIndex,ta.getGestureId(I.value==="0"?ta.GESTURE_SAD:ta.GESTURE_SMILE)))}),je(pl.FINISHED,I=>{n&&n.id===I.questionId&&(g(I.answerCounts),a(!0),u(b=>(b&&clearTimeout(b),setTimeout(()=>E(),td)))),f(new Map)}),je(pl.QUESTION,I=>{e(I.id),r(I.question),a(!1),g(new Map),f(new Map),u(b=>{if(b&&clearTimeout(b),I.duration>0){const S=I.duration<1e3?td:I.duration;return setTimeout(()=>E(),S)}return null})}),o.useEffect(()=>{const I=()=>{f(S=>{const v=[];if(S.forEach((R,O)=>{R.secondsLeft--,R.secondsLeft<=0&&v.push(O)}),v.length===0)return S;const y=new Map(S);return v.forEach(R=>y.delete(R)),y})},b=setInterval(()=>I(),1e3);return()=>clearInterval(b)},[]),o.useEffect(()=>()=>{u(I=>(I&&clearTimeout(I),null))},[]),{question:n,answerSent:s,answerCounts:d,userAnswers:m,vote:C}},Mv=Lv,Uv=()=>{const[i,e]=o.useState(null),[n,r]=o.useState(null),[s,a]=o.useState(0),[c,u]=o.useState(0),[d,g]=o.useState(0),[m,f]=Zo("nitro.screensize",{width:window.innerWidth,height:window.innerHeight}),p=C=>{a(C),L(new CE(C))},_=C=>{W().giveRespect(C),u(W().respectsLeft)},E=C=>{W().givePetRespect(C),g(W().respectsPetLeft)};return x(Em,C=>{const I=C.getParser();e(I.userInfo),r(I.userInfo.figure),u(I.userInfo.respectsRemaining),g(I.userInfo.respectsPetRemaining)}),x(EE,C=>{const I=C.getParser();r(I.figure)}),x(vm,C=>{const I=C.getParser();a(I.chatType)}),o.useEffect(()=>{const C=so("nitro.screensize");if(C&&(C.width!==window.innerWidth||C.height!==window.innerHeight)){let b=window.localStorage.length;for(;b>0;){const S=window.localStorage.key(b);S&&S.startsWith("nitro.window")&&window.localStorage.removeItem(S),b--}}const I=b=>f({width:window.innerWidth,height:window.innerHeight});return window.addEventListener("resize",I),()=>{window.removeEventListener("resize",I)}},[f]),{userInfo:i,userFigure:n,chatStyleId:s,userRespectRemaining:c,petRespectRemaining:d,respectUser:_,respectPet:E,updateChatStyleId:p}},Wr=()=>lt(Uv),xv=i=>o.useEffect(i,[]),Nh=i=>xv(()=>i()),Th=i=>{const{achievement:e=null,scale:n=1,...r}=i;return e?t(We,{badgeCode:_n.getAchievementBadgeCode(e),isGrayscale:!_n.getAchievementHasStarted(e),scale:n,...r}):null},Fv=i=>{const{achievement:e=null}=i,{selectedAchievement:n=null,setSelectedAchievementId:r=null}=Jo();return e?t(be,{itemActive:n===e,itemUnseen:e.unseen>0,onClick:s=>r(e.achievementId),children:t(Th,{achievement:e})}):null},Gv=i=>{const{achievements:e=null}=i;return t(De,{columnCount:6,columnMinWidth:50,columnMinHeight:50,children:e&&e.length>0&&e.map((n,r)=>t(Fv,{achievement:n},r))})},Vv=i=>{const{achievement:e=null}=i;return e?l(w,{shrink:!0,className:"bg-muted rounded p-2 text-black",gap:2,overflow:"hidden",children:[l(T,{center:!0,gap:1,children:[t(Th,{className:"nitro-achievements-badge-image",achievement:e,scale:2}),t(N,{fontWeight:"bold",children:h("achievements.details.level",["level","limit"],[_n.getAchievementLevel(e).toString(),e.levelCount.toString()])})]}),l(T,{fullWidth:!0,justifyContent:"center",overflow:"hidden",children:[l(T,{gap:1,children:[t(N,{fontWeight:"bold",truncate:!0,children:si(_n.getAchievementBadgeCode(e))}),t(N,{textBreak:!0,children:yc(_n.getAchievementBadgeCode(e))})]}),(e.levelRewardPoints>0||e.scoreLimit>0)&&l(T,{gap:1,children:[e.levelRewardPoints>0&&l(w,{alignItems:"center",gap:1,children:[t(N,{truncate:!0,className:"small",children:h("achievements.details.reward")}),l(w,{center:!0,className:"fw-bold small",gap:1,children:[e.levelRewardPoints,t(dt,{type:e.levelRewardPointType})]})]}),e.scoreLimit>0&&t(xc,{text:h("achievements.details.progress",["progress","limit"],[(e.currentPoints+e.scoreAtStartOfLevel).toString(),(e.scoreLimit+e.scoreAtStartOfLevel).toString()]),progress:e.currentPoints+e.scoreAtStartOfLevel,maxProgress:e.scoreLimit+e.scoreAtStartOfLevel})]})]})]}):null},Bv=i=>{const{category:e=null}=i,{selectedAchievement:n=null,setSelectedAchievementId:r=null}=Jo();return o.useEffect(()=>{var s,a;e&&(n||r((a=(s=e==null?void 0:e.achievements)==null?void 0:s[0])==null?void 0:a.achievementId))},[e,n,r]),e?l(T,{fullHeight:!0,justifyContent:"between",children:[t(Gv,{achievements:e.achievements}),!!n&&t(Vv,{achievement:n})]}):null},Hv=i=>{const{category:e=null,selectedCategoryCode:n=null,setSelectedCategoryCode:r=null}=i;if(!e)return null;const s=_n.getAchievementCategoryProgress(e),a=_n.getAchievementCategoryMaxProgress(e),c=_n.getAchievementCategoryImageUrl(e,s),u=_n.getAchievementCategoryTotalUnseen(e);return l(be,{itemActive:n===e.code,itemCount:u,itemCountMinimum:0,gap:1,onClick:d=>r(e.code),children:[t(N,{fullWidth:!0,center:!0,small:!0,className:"pt-1",children:h(`quests.${e.code}.name`)}),t(lh,{position:"relative",imageUrl:c,children:l(N,{fullWidth:!0,center:!0,position:"absolute",variant:"white",style:{fontSize:12,bottom:9},children:[s," / ",a]})})]})},Wv=i=>{const{categories:e=null,selectedCategoryCode:n=null,setSelectedCategoryCode:r=null}=i;return t(De,{columnCount:3,columnMinWidth:90,columnMinHeight:100,children:e&&e.length>0&&e.map((s,a)=>t(Hv,{category:s,selectedCategoryCode:n,setSelectedCategoryCode:r},a))})},jv=i=>{const[e,n]=o.useState(!1),{achievementCategories:r=[],selectedCategoryCode:s=null,setSelectedCategoryCode:a=null,achievementScore:c=0,getProgress:u=0,getMaxProgress:d=0,selectedCategory:g=null}=Jo();return o.useEffect(()=>{const m={linkReceived:f=>{const p=f.split("/");if(!(p.length<2))switch(p[1]){case"show":n(!0);return;case"hide":n(!1);return;case"toggle":n(_=>!_);return}},eventUrlPrefix:"achievements/"};return It(m),()=>Et(m)},[]),e?l(ie,{uniqueKey:"achievements",className:"nitro-achievements",theme:"primary-slim",children:[t(ae,{headerText:h("inventory.achievements"),onCloseClick:m=>n(!1)}),g&&l(oh,{position:"relative",className:"justify-content-center align-items-center cursor-pointer",gap:3,children:[t(P,{onClick:m=>a(null),className:"nitro-achievements-back-arrow"}),l(T,{grow:!0,gap:0,children:[t(N,{fontSize:4,fontWeight:"bold",className:"text-small",children:h(`quests.${g.code}.name`)}),t(N,{children:h("achievements.details.categoryprogress",["progress","limit"],[g.getProgress().toString(),g.getMaxProgress().toString()])})]}),t(vr,{imageUrl:_n.getAchievementCategoryImageUrl(g,null,!0)})]}),l(re,{gap:1,children:[!g&&l(B,{children:[t(Wv,{categories:r,selectedCategoryCode:s,setSelectedCategoryCode:a}),l(T,{grow:!0,justifyContent:"end",gap:1,children:[t(N,{small:!0,center:!0,children:h("achievements.categories.score",["score"],[c.toString()])}),t(xc,{text:h("achievements.categories.totalprogress",["progress","limit"],[u.toString(),d.toString()]),progress:u,maxProgress:d})]})]}),g&&t(Bv,{category:g})]})]}):null},ns=i=>{const{icon:e=null,selected:n=!1,classNames:r=[],children:s=null,...a}=i,c=o.useMemo(()=>{const u=["nitro-avatar-editor-spritesheet"];return e&&e.length&&u.push(e+"-icon"),n&&u.push("selected"),r.length&&u.push(...r),u},[e,n,r]);return t(P,{classNames:c,...a})},qv=i=>{const{figureData:e=null}=i,[n,r]=o.useState(-1),s=a=>{a<_i.MIN_DIRECTION&&(a=_i.MAX_DIRECTION+(a+1)),a>_i.MAX_DIRECTION&&(a=a-(_i.MAX_DIRECTION+1)),e.direction=a};return o.useEffect(()=>{if(e)return e.notify=()=>r(a=>a+1),()=>{e.notify=null}},[e]),l(T,{className:"figure-preview-container",overflow:"hidden",position:"relative",children:[t(it,{figure:e.getFigureString(),direction:e.direction,scale:2}),t(ns,{className:"avatar-spotlight",icon:"spotlight"}),t(P,{className:"avatar-shadow"}),l(P,{className:"arrow-container",children:[t(ns,{pointer:!0,icon:"arrow-left",onClick:a=>s(e.direction+1)}),t(ns,{pointer:!0,icon:"arrow-right",onClick:a=>s(e.direction-1)})]})]})},zv=i=>{const{partItem:e=null,children:n=null,...r}=i,[s,a]=o.useState(-1),c=K("hc.disabled",!1);return o.useEffect(()=>{const u=()=>a(d=>d+1);return e.notify=u,()=>e.notify=null},[e]),l(be,{itemImage:e.isClear?void 0:e.imageUrl,itemActive:e.isSelected,...r,children:[!c&&e.isHC&&t(dt,{className:"position-absolute end-1 bottom-1",type:"hc"}),e.isClear&&t(ns,{icon:"clear"}),e.isSellable&&t(ns,{icon:"sellable",position:"absolute",className:"end-1 bottom-1"}),n]})},Yv=i=>{const{model:e=null,category:n=null,setMaxPaletteCount:r=null}=i,s=o.useRef(null),a=o.useCallback(c=>{const u=n.parts.indexOf(c);if(u===-1)return;e.selectPart(n.name,u);const d=n.getCurrentPart();r(d.maxColorIndex||1)},[e,n,r]);return o.useEffect(()=>{!e||!n||!s||!s.current||(s.current.scrollTop=0)},[e,n]),t(De,{innerRef:s,columnCount:3,columnMinHeight:50,children:n.parts.length>0&&n.parts.map((c,u)=>t(zv,{partItem:c,onClick:d=>a(c)},u))})},$v=i=>{const{colorItem:e=null,children:n=null,...r}=i,[s,a]=o.useState(-1),c=K("hc.disabled",!1);return o.useEffect(()=>{const u=()=>a(d=>d+1);return e.notify=u,()=>e.notify=null},[e]),l(be,{itemHighlight:!0,itemColor:e.color,itemActive:e.isSelected,className:"clear-bg",...r,children:[!c&&e.isHC&&t(dt,{className:"position-absolute end-1 bottom-1",type:"hc"}),n]})},nd=i=>{const{model:e=null,category:n=null,paletteSet:r=[],paletteIndex:s=-1}=i,a=o.useRef(null),c=o.useCallback(u=>{const d=r.indexOf(u);d!==-1&&e.selectColor(n.name,d,s)},[e,n,r,s]);return o.useEffect(()=>{!e||!n||!a||!a.current||(a.current.scrollTop=0)},[e,n]),t(De,{innerRef:a,gap:1,columnCount:5,columnMinWidth:30,children:r.length>0&&r.map((u,d)=>t($v,{colorItem:u,onClick:g=>c(u)},d))})},Kv=i=>{const{model:e=null,gender:n=null,setGender:r=null}=i,[s,a]=o.useState(null),[c,u]=o.useState(1),d=o.useCallback(g=>{const m=e.categories.get(g);if(m){m.init(),a(m);for(const f of m.parts)if(!(!f||!f.isSelected)){u(f.maxColorIndex||1);break}}},[e]);return o.useEffect(()=>{e.init();for(const g of e.categories.keys()){d(g);break}},[e,d]),!e||!s?null:l(ne,{children:[l(T,{size:2,children:[e.canSetGender&&l(B,{children:[t(w,{center:!0,pointer:!0,className:"category-item",onClick:g=>r(we.MALE),children:t(ns,{icon:"male",selected:n===we.MALE})}),t(w,{center:!0,pointer:!0,className:"category-item",onClick:g=>r(we.FEMALE),children:t(ns,{icon:"female",selected:n===we.FEMALE})})]}),!e.canSetGender&&e.categories&&e.categories.size>0&&Array.from(e.categories.keys()).map(g=>{const m=e.categories.get(g);return t(w,{center:!0,pointer:!0,className:"category-item",onClick:f=>d(g),children:t(ns,{icon:m.name,selected:s===m})},g)})]}),t(T,{size:5,overflow:"hidden",children:t(Yv,{model:e,category:s,setMaxPaletteCount:u})}),l(T,{size:5,overflow:"hidden",children:[c>=1&&t(nd,{model:e,category:s,paletteSet:s.getPalette(0),paletteIndex:0}),c===2&&t(nd,{model:e,category:s,paletteSet:s.getPalette(1),paletteIndex:1})]})]})},Xv=i=>{const{figureData:e=null,savedFigures:n=[],setSavedFigures:r=null,loadAvatarInEditor:s=null}=i,a=K("hc.disabled",!1),c=o.useCallback(g=>{if(g>=n.length||g<0)return;const[m,f]=n[g];s(m.getFigureString(),f)},[n,s]),u=o.useCallback(g=>{if(!e||g>=n.length||g<0)return;const m=[...n],f=e.getFigureString(),p=e.gender;m[g]=[kt().createFigureContainer(f),p],r(m),L(new _E(g+1,f,p))},[e,n,r]),d=o.useMemo(()=>{if(!n||!n.length)return[];const g=[];return n.forEach(([m,f],p)=>{let _=0;m&&(_=kt().getFigureClubLevel(m,f)),g.push(l(be,{position:"relative",overflow:"hidden",className:"nitro-avatar-editor-wardrobe-figure-preview",children:[m&&t(it,{figure:m.getFigureString(),gender:f,direction:2}),t(P,{className:"avatar-shadow"}),!a&&_>0&&t(dt,{className:"position-absolute top-1 start-1",type:"hc"}),l(w,{gap:1,className:"button-container",children:[t(M,{variant:"link",fullWidth:!0,onClick:E=>u(p),children:h("avatareditor.wardrobe.save")}),m&&t(M,{variant:"link",fullWidth:!0,onClick:E=>c(p),disabled:_>kn(),children:h("generic_usable.button.use")})]})]},p))}),g},[n,a,u,c]);return t(De,{columnCount:5,columnMinWidth:80,columnMinHeight:140,children:d})},Qv="hr-100.hd-180-7.ch-215-66.lg-270-79.sh-305-62.ha-1002-70.wa-2007",Jv="hr-515-33.hd-600-1.ch-635-70.lg-716-66-62.sh-735-68",Zv=i=>{const[e,n]=o.useState(!1),[r,s]=o.useState(null),[a,c]=o.useState(null),[u,d]=o.useState(null),[g,m]=o.useState(null),[f,p]=o.useState([]),[_,E]=o.useState([]),[C,I]=o.useState([]),[b,S]=o.useState(!1),[v,y]=o.useState(null),[R,O]=o.useState(null),[F,U]=o.useState(!0),[A,k]=o.useState(!1),D=o.useMemo(()=>K("avatar.wardrobe.max.slots",10),[]);x(bE,ue=>{const ye=ue.getParser();p(ye.figureSetIds),E(ye.boundsFurnitureNames)}),x(SE,ue=>{const ye=ue.getParser(),Ye=[];let Ct=0;for(;Ct<D;)Ye.push([null,null]),Ct++;for(let[Je,[Wt,Be]]of ye.looks.entries()){const Xt=kt().createFigureContainer(Wt);Ye[Je-1]=[Xt,Be]}I(Ye)});const V=o.useCallback(ue=>{u&&m(u.get(ue))},[u]),G=o.useCallback(()=>{const ue=new Map;ue.set(xr.GENERIC,new _S),ue.set(xr.HEAD,new GS),ue.set(xr.TORSO,new BS),ue.set(xr.LEGS,new VS),d(ue)},[]),$=o.useCallback(()=>{const ue=new Map,ye=new we,Ye=new we;ye.loadAvatarData(Qv,we.MALE),Ye.loadAvatarData(Jv,we.FEMALE),ue.set(we.MALE,ye),ue.set(we.FEMALE,Ye),s(ue),c(ue.get(we.MALE))},[]),X=o.useCallback((ue,ye,Ye=!0)=>{ye=Rt.getGender(ye);let Ct=a;ye!==Ct.gender&&(Ct=r.get(ye)),ue!==Ct.getFigureString()&&Ct.loadAvatarData(ue,ye),Ct!==a&&c(Ct),Ye&&(y(a.getFigureString()),O(a.gender))},[r,a]),Y=o.useCallback(ue=>{switch(ue){case or.ACTION_CLEAR:X(a.getFigureStringWithFace(0,!1),a.gender,!1),G();return;case or.ACTION_RESET:X(v,R),G();return;case or.ACTION_RANDOMIZE:const ye=FS(a,a.gender,kn(),f,[we.FACE]);X(ye,a.gender,!1),G();return;case or.ACTION_SAVE:L(new wm(a.gender,a.getFigureString())),n(!1);return}},[a,v,R,f,X,G]),Ee=o.useCallback(ue=>{ue=Rt.getGender(ue),c(r.get(ue))},[r]);return o.useEffect(()=>{const ue={linkReceived:ye=>{const Ye=ye.split("/");if(!(Ye.length<2))switch(Ye[1]){case"show":n(!0);return;case"hide":n(!1);return;case"toggle":n(Ct=>!Ct);return}},eventUrlPrefix:"avatar-editor/"};return It(ue),()=>Et(ue)},[]),o.useEffect(()=>{I(new Array(D))},[D]),o.useEffect(()=>{b&&(m(null),L(new NE))},[b]),o.useEffect(()=>{g&&S(!1)},[g]),o.useEffect(()=>{u&&V(xr.GENERIC)},[u,V]),o.useEffect(()=>{if(a)return Rt.CURRENT_FIGURE=a,G(),()=>Rt.CURRENT_FIGURE=null},[a,G]),o.useEffect(()=>(Rt.FIGURE_SET_IDS=f,Rt.BOUND_FURNITURE_NAMES=_,G(),()=>{Rt.FIGURE_SET_IDS=null,Rt.BOUND_FURNITURE_NAMES=null}),[f,_,G]),o.useEffect(()=>{if(e&&!r){$(),k(!0);return}},[e,r,$]),o.useEffect(()=>{!e||!A||!F||(X(W().figure,W().gender),U(!1))},[e,A,F,X]),o.useEffect(()=>{if(!e)return()=>{U(!0)}},[e]),!e||!a?null:l(ie,{uniqueKey:"avatar-editor",className:"nitro-avatar-editor",children:[t(ae,{headerText:h("avatareditor.title"),onCloseClick:ue=>n(!1)}),l(Br,{children:[u&&u.size>0&&Array.from(u.keys()).map(ue=>{const ye=g&&g.name===ue;return t(sr,{isActive:ye,onClick:Ye=>V(ue),children:h(`avatareditor.category.${ue}`)},ue)}),t(sr,{isActive:b,onClick:ue=>S(!0),children:h("avatareditor.category.wardrobe")})]}),t(re,{children:l(ne,{children:[l(T,{size:9,overflow:"hidden",children:[g&&!b&&t(Kv,{model:g,gender:a.gender,setGender:Ee}),b&&t(Xv,{figureData:a,savedFigures:C,setSavedFigures:I,loadAvatarInEditor:X})]}),l(T,{size:3,overflow:"hidden",children:[t(qv,{figureData:a}),l(T,{grow:!0,gap:1,children:[l(Cr,{children:[t(M,{variant:"secondary",onClick:ue=>Y(or.ACTION_RESET),children:t(Jh,{className:"fa-icon"})}),t(M,{variant:"secondary",onClick:ue=>Y(or.ACTION_CLEAR),children:t(Ec,{className:"fa-icon"})}),t(M,{variant:"secondary",onClick:ue=>Y(or.ACTION_RANDOMIZE),children:t(Zh,{className:"fa-icon"})})]}),t(M,{className:"w-100",variant:"success",onClick:ue=>Y(or.ACTION_SAVE),children:h("avatareditor.save")})]})]})]})})]})},ew=5,tw=i=>{const{onClose:e=null,onEdit:n=null,onDelete:r=null}=i,{cameraRoll:s=null,setCameraRoll:a=null,selectedPictureIndex:c=-1,setSelectedPictureIndex:u=null}=mh(),{simpleAlert:d=null}=ze(),g=o.useRef(),m=c>-1?s[c]:null,f=()=>{if(!g||!g.current)return null;const _=g.current.getBoundingClientRect();return new om(Math.floor(_.x),Math.floor(_.y),Math.floor(_.width),Math.floor(_.height))},p=()=>{if(c>-1){u(-1);return}const _=j().createTextureFromRoom(Re().roomId,1,f()),E=[...s];E.length>=ew&&(d(h("camera.full.body")),E.pop()),Sr(Nr.CAMERA_SHUTTER),E.push(new HS(_,_r.generateImageUrl(_))),a(E)};return t(as,{uniqueKey:"nitro-camera-capture",children:l(T,{center:!0,className:"nitro-camera-capture",gap:0,children:[m&&t("img",{alt:"",className:"camera-area",src:m.imageUrl}),l("div",{className:"camera-canvas drag-handler",children:[t("div",{className:"position-absolute header-close",onClick:e,children:t(Dn,{className:"fa-icon"})}),!m&&t("div",{ref:g,className:"camera-area camera-view-finder"}),m&&t("div",{className:"camera-area camera-frame",children:l("div",{className:"camera-frame-preview-actions w-100 position-absolute bottom-0 py-2 text-center",children:[t("button",{className:"btn btn-success me-3",title:h("camera.editor.button.tooltip"),onClick:n,children:h("camera.editor.button.text")}),t("button",{className:"btn btn-danger",onClick:r,children:h("camera.delete.button.text")})]})}),t("div",{className:"d-flex justify-content-center",children:t("div",{className:"camera-button",title:h("camera.take.photo.button.tooltip"),onClick:p})})]}),s.length>0&&t(w,{gap:2,justifyContent:"center",className:"camera-roll d-flex justify-content-center py-2",children:s.map((_,E)=>t("img",{alt:"",src:_.imageUrl,onClick:C=>u(E)},E))})]})})},nw=i=>{const{base64Url:e=null,onCloseClick:n=null,onCancelClick:r=null,price:s=null}=i,[a,c]=o.useState(null),[u,d]=o.useState(null),[g,m]=o.useState(0),[f,p]=o.useState(!1),[_,E]=o.useState(!1),[C,I]=o.useState(0),b=o.useMemo(()=>K("camera.publish.disabled",!1),[]);x(TE,v=>{m(y=>y+1),E(!1)}),x(vE,v=>{const y=v.getParser();d(y.extraDataId),I(y.secondsToWait),p(y.ok),E(!1)}),x(wE,v=>{const y=v.getParser();c(K("camera.url")+"/"+y.url)});const S=(v,y=null)=>{switch(v){case"close":n();return;case"buy":if(_)return;E(!0),L(new OE(""));return;case"publish":if(_)return;E(!0),L(new RE);return;case"cancel":r();return}};return o.useEffect(()=>{e&&j().saveBase64AsScreenshot(e)},[e]),s?l(ie,{className:"nitro-camera-checkout",theme:"primary-slim",children:[t(ae,{headerText:h("camera.confirm_phase.title"),onCloseClick:v=>S("close")}),l(re,{children:[l(w,{center:!0,children:[a&&a.length&&t(vr,{className:"picture-preview border",imageUrl:a}),(!a||!a.length)&&t(w,{center:!0,className:"picture-preview border",children:t(N,{bold:!0,children:h("camera.loading")})})]}),l(w,{justifyContent:"between",alignItems:"center",className:"bg-muted rounded p-2",children:[l(T,{size:b?10:6,gap:1,children:[t(N,{bold:!0,children:h("camera.purchase.header")}),(s.credits>0||s.duckets>0)&&l(w,{gap:1,children:[t(N,{children:h("catalog.purchase.confirmation.dialog.cost")}),s.credits>0&&l(w,{gap:1,children:[t(N,{bold:!0,children:s.credits}),t(dt,{type:-1})]}),s.duckets>0&&l(w,{gap:1,children:[t(N,{bold:!0,children:s.duckets}),t(dt,{type:5})]})]}),g>0&&l(N,{children:[t(N,{bold:!0,children:h("camera.purchase.count.info")})," ",g,t("u",{className:"ms-1 cursor-pointer",onClick:()=>Z("inventory/toggle"),children:h("camera.open.inventory")})]})]}),t(w,{alignItems:"center",children:t(M,{variant:"success",disabled:_,onClick:v=>S("buy"),children:h(g?"camera.buy.another.button.text":"buy")})})]}),!b&&l(w,{justifyContent:"between",alignItems:"center",className:"bg-muted rounded p-2",children:[l(T,{gap:1,children:[t(N,{bold:!0,children:h(f?"camera.publish.successful":"camera.publish.explanation")}),t(N,{children:h(f?"camera.publish.success.short.info":"camera.publish.detailed.explanation")}),f&&t("a",{href:u,rel:"noreferrer",target:"_blank",children:h("camera.link.to.published")}),!f&&s.publishDucketPrice>0&&l(w,{gap:1,children:[t(N,{children:h("catalog.purchase.confirmation.dialog.cost")}),l(w,{gap:1,children:[t(N,{bold:!0,children:s.publishDucketPrice}),t(dt,{type:5})]})]}),C>0&&t("div",{className:"mt-1 text-center fw-bold",children:h("camera.publish.wait",["minutes"],[Math.ceil(C/60).toString()])})]}),!f&&t(w,{className:"d-flex align-items-end",children:t(M,{variant:"success",disabled:_||C>0,onClick:v=>S("publish"),children:h("camera.publish.button.text")})})]}),t(N,{center:!0,children:h("camera.warning.disclaimer")}),t(w,{justifyContent:"end",children:t(M,{onClick:v=>S("cancel"),children:h("generic.cancel")})})]})]}):null},rw=i=>{const{effect:e=null,thumbnailUrl:n=null,isActive:r=!1,isLocked:s=!1,selectEffect:a=null,removeEffect:c=null}=i;return l(be,{title:h(s?`camera.effect.required.level ${e.minLevel}`:`camera.effect.name.${e.name}`),itemActive:r,onClick:u=>!r&&a(),children:[r&&t(M,{variant:"danger",className:"rounded-circle remove-effect",onClick:c,children:t(Dn,{className:"fa-icon"})}),!s&&n&&n.length>0&&t("div",{className:"effect-thumbnail-image border",children:t("img",{alt:"",src:n})}),s&&l(N,{center:!0,bold:!0,children:[t("div",{children:t(Jd,{className:"fa-icon"})}),e.minLevel]})]})},sw=i=>{const{myLevel:e=0,selectedEffects:n=[],effects:r=[],thumbnails:s=[],processAction:a=null}=i;return t(ne,{columnCount:3,overflow:"auto",children:r&&r.length>0&&r.map((c,u)=>{const d=s.find(m=>m.effectName===c.name),g=n.findIndex(m=>m.effect.name===c.name)>-1;return t(rw,{effect:c,thumbnailUrl:d&&d.thumbnailUrl||null,isActive:g,isLocked:c.minLevel>e,selectEffect:()=>a("select_effect",c.name),removeEffect:()=>a("remove_effect",c.name)},u)})})},rd=[$a.COLORMATRIX,$a.COMPOSITE],aw=i=>{const{picture:e=null,availableEffects:n=null,myLevel:r=1,onClose:s=null,onCancel:a=null,onCheckout:c=null}=i,[u,d]=o.useState(rd[0]),[g,m]=o.useState(null),[f,p]=o.useState([]),[_,E]=o.useState([]),[C,I]=o.useState(!1),b=o.useMemo(()=>n.filter(k=>k.colorMatrix),[n]),S=o.useMemo(()=>n.filter(k=>k.texture),[n]),v=o.useCallback(()=>u===$a.COLORMATRIX?b:S,[u,b,S]),y=o.useCallback(k=>!k||!k.length||!f||!f.length?-1:f.findIndex(D=>D.effect.name===k),[f]),R=o.useMemo(()=>y(g),[g,y]),O=o.useMemo(()=>g&&f[R]||null,[g,R,f]),F=o.useCallback(k=>{const D=R;D!==-1&&p(V=>{const G=[...V],$=G[D];return G[R]=new Il($.effect,k),G})},[R,p]),U=o.useMemo(()=>_a().applyEffects(e.texture,f,C).src,[e,f,C]),A=o.useCallback((k,D=null)=>{switch(k){case"close":s();return;case"cancel":a();return;case"checkout":c(U);return;case"change_tab":d(String(D));return;case"select_effect":{if(y(D)>=0)return;const G=n.find($=>$.name===D);if(!G)return;p($=>[...$,new Il(G,1)]),m(G.name);return}case"remove_effect":{let V=y(D);if(V===-1)return;p(G=>{const $=[...G];return $.splice(V,1),$}),g===D&&m(null);return}case"clear_effects":m(null),p([]);return;case"download":{const V=new Image;V.src=U,window.open("").document.write(V.outerHTML);return}case"zoom":I(!C);return}},[C,n,g,U,y,a,c,s,I,p]);return o.useEffect(()=>{const k=[];for(const D of n)k.push(new WS(D.name,_a().applyEffects(e.texture,[new Il(D,1)],!1).src));E(k)},[e,n]),l(ie,{className:"nitro-camera-editor",children:[t(ae,{headerText:h("camera.editor.button.text"),onCloseClick:k=>A("close")}),t(Br,{children:rd.map(k=>t(sr,{isActive:u===k,onClick:D=>A("change_tab",k),children:t("i",{className:"icon icon-camera-"+k})},k))}),t(re,{children:l(ne,{children:[t(T,{size:5,overflow:"hidden",children:t(sw,{myLevel:r,selectedEffects:f,effects:v(),thumbnails:_,processAction:A})}),l(T,{size:7,justifyContent:"between",overflow:"hidden",children:[l(T,{center:!0,children:[t(vr,{imageUrl:U,className:"picture-preview"}),g&&l(T,{center:!0,fullWidth:!0,gap:1,children:[t(N,{children:h("camera.effect.name."+g)}),t(Mt,{className:"nitro-slider",min:0,max:1,step:.01,value:O.alpha,onChange:k=>F(k),renderThumb:(k,D)=>t("div",{...k,children:D.valueNow})})]})]}),l(w,{justifyContent:"between",children:[l(Cr,{children:[t(M,{onClick:k=>A("clear_effects"),children:t(Ec,{className:"fa-icon"})}),t(M,{onClick:k=>A("download"),children:t(eg,{className:"fa-icon"})}),l(M,{onClick:k=>A("zoom"),children:[C&&t(tg,{className:"fa-icon"}),!C&&t(ng,{className:"fa-icon"})]})]}),l(w,{gap:1,children:[t(M,{onClick:k=>A("cancel"),children:h("generic.cancel")}),t(M,{onClick:k=>A("checkout"),children:h("camera.preview.button.text")})]})]})]})]})})]})},Gs=0,Li=1,sd=2,ad=3,iw=i=>{const[e,n]=o.useState(Gs),[r,s]=o.useState(null),{availableEffects:a=[],selectedPictureIndex:c=-1,cameraRoll:u=[],setCameraRoll:d=null,myLevel:g=0,price:m={credits:0,duckets:0,publishDucketPrice:0}}=mh(),f=_=>{switch(_){case"close":n(Gs);return;case"edit":n(sd);return;case"delete":d(E=>{const C=[...E];return C.splice(c,1),C});return;case"editor_cancel":n(Li);return}},p=_=>{s(_),n(ad)};return je(Kt.ENDED,_=>n(Gs)),o.useEffect(()=>{const _={linkReceived:E=>{const C=E.split("/");if(!(C.length<2))switch(C[1]){case"show":n(Li);return;case"hide":n(Gs);return;case"toggle":n(I=>I?Gs:Li);return}},eventUrlPrefix:"camera/"};return It(_),()=>Et(_)},[]),e===Gs?null:l(B,{children:[e===Li&&t(tw,{onClose:()=>f("close"),onEdit:()=>f("edit"),onDelete:()=>f("delete")}),e===sd&&t(aw,{picture:u[c],myLevel:g,onClose:()=>f("close"),onCancel:()=>f("editor_cancel"),onCheckout:p,availableEffects:a}),e===ad&&t(nw,{base64Url:r,onCloseClick:()=>f("close"),onCancelClick:()=>f("editor_cancel"),price:m})]})},ow=i=>{const{itemId:e=-1,state:n=null,product:r=null,active:s=!1,onClick:a=null}=i,c=u=>{let d=W().getFloorItemDataByName(u),g=null;return d?g=j().getFurnitureFloorIconUrl(d.id):(d=W().getWallItemDataByName(u),d&&(g=j().getFurnitureWallIconUrl(d.id))),g};return l(T,{fit:!0,center:!0,pointer:!0,className:`campaign-spritesheet campaign-day-generic-bg rounded calendar-item ${s?"active":""}`,onClick:()=>a(e),children:[n===nn.STATE_UNLOCKED&&t(w,{center:!0,className:"campaign-spritesheet unlocked-bg",children:t(w,{center:!0,className:"campaign-spritesheet campaign-opened",children:r&&t(vr,{imageUrl:r.customImage?K("image.library.url")+r.customImage:c(r.productName)})})}),n!==nn.STATE_UNLOCKED&&l(w,{center:!0,className:"campaign-spritesheet locked-bg",children:[n===nn.STATE_LOCKED_AVAILABLE&&t(P,{className:"campaign-spritesheet available"}),(n===nn.STATE_LOCKED_EXPIRED||n===nn.STATE_LOCKED_FUTURE)&&t(P,{className:"campaign-spritesheet unavailable"})]})]})},wl=5,lw=i=>{const{onClose:e=null,campaignName:n=null,currentDay:r=null,numDays:s=null,missedDays:a=null,openedDays:c=null,openPackage:u=null,receivedProducts:d=null}=i,[g,m]=o.useState(r),[f,p]=o.useState(Math.max(0,g-1)),_=v=>c.includes(v)?nn.STATE_UNLOCKED:v>r?nn.STATE_LOCKED_FUTURE:a.includes(v)?nn.STATE_LOCKED_EXPIRED:nn.STATE_LOCKED_AVAILABLE,E=v=>{switch(_(v)){case nn.STATE_UNLOCKED:return h("campaign.calendar.info.unlocked");case nn.STATE_LOCKED_FUTURE:return h("campaign.calendar.info.future");case nn.STATE_LOCKED_EXPIRED:return h("campaign.calendar.info.expired");default:return h("campaign.calendar.info.available.desktop")}},C=()=>{const v=g+1;v!==s&&(m(v),f+wl<v+1&&p(f+1))},I=()=>{const v=g-1;v<0||(m(v),f>v&&p(f-1))},b=v=>{if(g===v){_(v)===nn.STATE_LOCKED_AVAILABLE&&u(v,!1);return}m(v)},S=()=>{const v=g;_(v)!==nn.STATE_UNLOCKED&&u(v,!0)};return l(ie,{className:"nitro-campaign-calendar",theme:"primary-slim",children:[t(ae,{headerText:h(`campaign.calendar.${n}.title`),onCloseClick:e}),l(re,{children:[l(ne,{fullHeight:!1,justifyContent:"between",alignItems:"center",children:[t(T,{size:1}),t(T,{size:10,children:l(w,{justifyContent:"between",alignItems:"center",gap:1,children:[l(T,{gap:1,children:[t(N,{fontSize:3,children:h("campaign.calendar.heading.day",["number"],[(g+1).toString()])}),t(N,{children:E(g)})]}),t("div",{children:W().isModerator&&t(M,{variant:"danger",onClick:S,children:"Force open"})})]})}),t(T,{size:1})]}),l(w,{fullHeight:!0,gap:2,children:[t(w,{center:!0,children:t(P,{pointer:!0,className:"campaign-spritesheet prev",onClick:I})}),t(T,{center:!0,fullWidth:!0,children:t(ne,{fit:!0,columnCount:wl,gap:1,children:[...Array(wl)].map((v,y)=>{const R=f+y;return t(T,{overflow:"hidden",children:t(ow,{itemId:R,state:_(R),active:g===R,product:d.has(R)?d.get(R):null,onClick:b})},y)})})}),t(w,{center:!0,children:t(P,{pointer:!0,className:"campaign-spritesheet next",onClick:C})})]})]})]})},cw=i=>{const[e,n]=o.useState(null),[r,s]=o.useState(-1),[a,c]=o.useState(new Map),[u,d]=o.useState(!1),g=(m,f=!1)=>{e&&(s(m),L(f?new yE(e.campaignName,m):new kE(e.campaignName,m)))};return x(AE,m=>{const f=m.getParser();f&&n(f.calendarData)}),x(DE,m=>{const f=m.getParser();if(!f)return;const p=r;f.doorOpened&&(n(_=>{const E=_.clone();return E.openedDays.push(r),E}),c(_=>{const E=new Map(_);return E.set(p,new jS(f.productName,f.customImage,f.furnitureClassName)),E})),s(-1)}),o.useEffect(()=>{const m={linkReceived:f=>{const p=f.split("/");if(!(p.length<2))switch(p[1]){case"calendar":d(!0);break}},eventUrlPrefix:"openView/"};return It(m),()=>Et(m)},[]),t(B,{children:e&&u&&t(lw,{onClose:()=>d(!1),campaignName:e.campaignName,currentDay:e.currentDay,numDays:e.campaignDays,openedDays:e.openedDays,missedDays:e.missedDays,openPackage:g,receivedProducts:a})})},vh=i=>{const{icon:e=0}=i,n=o.useMemo(()=>K("catalog.asset.icon.url").replace("%name%",e.toString()),[e]);return t(vr,{imageUrl:n,style:{width:20,height:20}})},uw=i=>{const[e,n]=o.useState(!1),[r,s]=o.useState(0),[a,c]=o.useState(0),[u,d]=o.useState(""),[g,m]=o.useState(""),[f,p]=o.useState(!0),[_,E]=o.useState(""),[C,I]=o.useState([]),[b,S]=o.useState(0),[v,y]=o.useState(0),[R,O]=o.useState(0),[F,U]=o.useState(0),[A,k]=o.useState(0),[D,V]=o.useState(!1),{catalogOptions:G=null}=Pe(),{friends:$}=Nn(),{giftConfiguration:X=null}=G,[Y,Ee]=o.useState([]),[ue,ye]=o.useState([]),[Ye,Ct]=o.useState(!0),Je=o.useCallback(()=>{n(!1),s(0),c(0),d(""),m(""),p(!0),E(""),S(0),y(0),Ct(!1),ye([]),C.length&&O(C[0].id)},[C]),Wt=o.useMemo(()=>X?X.defaultStuffTypes.findIndex(Ce=>Ce===Y[b])>-1:!1,[Y,X,b]),Be=o.useMemo(()=>X?(Y[b]*1e3+X.ribbonTypes[v]).toString():"",[X,b,v,Y]),Xt=o.useMemo(()=>{if(!X||Wt)return!1;const Ce=Y[b];return!(Ce===8||Ce>=3&&Ce<=6)},[X,b,Wt,Y]),on=o.useMemo(()=>Wt?Y[b]:R,[Wt,Y,b,R]),Me=$.filter(Ce=>Ce.id!==-1),pe=Ce=>{const Ue=Ce.target.value;let Un=[];Ue.length>0&&(Un=Me.sort().filter(ma=>ma.name.includes(Ue))),m(Ue),Ct(!0),ye(Un)},ht=Ce=>{m(Ce),Ct(!1)},Ut=o.useCallback(Ce=>{switch(Ce){case"prev_box":S(Ue=>Ue===0?F:Ue-1);return;case"next_box":S(Ue=>Ue===F?0:Ue+1);return;case"prev_ribbon":y(Ue=>Ue===0?A:Ue-1);return;case"next_ribbon":y(Ue=>Ue===A?0:Ue+1);return;case"buy":if(!g||g.length===0){V(!0);return}L(new PE(r,a,u,g,_,on,b,v,f));return}},[on,u,F,A,_,a,r,g,b,v,f]);x(LE,Ce=>V(!0)),Qe([Tr.PURCHASE_SUCCESS,Os.INIT_GIFT],Ce=>{switch(Ce.type){case Tr.PURCHASE_SUCCESS:Je();return;case Os.INIT_GIFT:const Ue=Ce;Je(),s(Ue.pageId),c(Ue.offerId),d(Ue.extraData),n(!0);return}}),o.useEffect(()=>{V(!1)},[g]);const Mn=o.useCallback(()=>{X&&Ee(Ce=>{let Ue=[...X.boxTypes];return Ue.push(X.defaultStuffTypes[Math.floor(Math.random()*(X.defaultStuffTypes.length-1))]),U(Ue.length-1),k(Ue.length-1),Ue})},[X]);if(o.useEffect(()=>{if(!X)return;const Ce=[];for(const Ue of X.stuffTypes){const Un=W().getFloorItemData(Ue);Un&&Un.colors&&Un.colors.length>0&&Ce.push({id:Ue,color:mn.makeColorNumberHex(Un.colors[0])})}Mn(),Ce.length&&(O(Ce[0].id),I(Ce))},[X,Mn]),o.useEffect(()=>{e&&Mn()},[Mn,e]),!X||!X.isEnabled||!e)return null;const da="catalog.gift_wrapping_new.box."+(Wt?"default":Y[b]),Ls=`catalog.gift_wrapping_new.ribbon.${v}`,vn="catalog.gift_wrapping_new."+(Wt?"freeprice":"price");return l(ie,{uniqueKey:"catalog-gift",className:"nitro-catalog-gift",theme:"primary-slim",children:[t(ae,{headerText:h("catalog.gift_wrapping.title"),onCloseClick:Je}),l(re,{className:"text-black",children:[l(TN,{column:!0,children:[t(N,{children:h("catalog.gift_wrapping.receiver")}),t("input",{type:"text",className:zt("form-control form-control-sm",D&&"is-invalid"),value:g,onChange:Ce=>pe(Ce)}),ue.length>0&&Ye&&t(T,{className:"autocomplete-gift-container",children:ue.map(Ce=>t(P,{className:"autocomplete-gift-item",onClick:Ue=>ht(Ce.name),children:Ce.name},Ce.id))}),D&&t(P,{className:"invalid-feedback",children:h("catalog.gift_wrapping.receiver_not_found.title")})]}),t(ch,{figure:W().figure,userName:W().userName,message:_,editable:!0,onChange:Ce=>E(Ce)}),l(P,{className:"form-check",children:[t("input",{className:"form-check-input",type:"checkbox",name:"showMyFace",checked:f,onChange:Ce=>p(Ue=>!Ue)}),t("label",{className:"form-check-label",children:h("catalog.gift_wrapping.show_face.title")})]}),l(w,{alignItems:"center",gap:2,children:[R&&t(P,{className:"gift-preview",children:t(Lc,{productType:fe.FLOOR,productClassId:on,extraData:Be})}),l(T,{gap:1,children:[l(w,{gap:2,children:[l(Cr,{children:[t(M,{variant:"primary",onClick:()=>Ut("prev_box"),children:t(In,{className:"fa-icon"})}),t(M,{variant:"primary",onClick:()=>Ut("next_box"),children:t(En,{className:"fa-icon"})})]}),l(T,{gap:1,children:[t(N,{fontWeight:"bold",children:h(da)}),l(w,{alignItems:"center",gap:1,children:[h(vn,["price"],[X.price.toString()]),t(dt,{type:-1})]})]})]}),l(w,{alignItems:"center",gap:2,className:Xt?"":"opacity-50 pointer-events-none",children:[l(Cr,{children:[t(M,{variant:"primary",onClick:()=>Ut("prev_ribbon"),children:t(In,{className:"fa-icon"})}),t(M,{variant:"primary",onClick:()=>Ut("next_ribbon"),children:t(En,{className:"fa-icon"})})]}),t(N,{fontWeight:"bold",children:h(Ls)})]})]})]}),l(T,{gap:1,className:Xt?"":"opacity-50 pointer-events-none",children:[t(N,{fontWeight:"bold",children:h("catalog.gift_wrapping.pick_color")}),t(Cr,{fullWidth:!0,children:C.map(Ce=>t(M,{variant:"dark",active:Ce.id===R,disabled:!Xt,style:{backgroundColor:Ce.color},onClick:()=>O(Ce.id)},Ce.id))})]}),l(w,{justifyContent:"between",alignItems:"center",children:[t(M,{variant:"link",onClick:Je,className:"text-black",children:h("cancel")}),t(M,{variant:"success",onClick:()=>Ut("buy"),children:h("catalog.gift_wrapping.give_gift")})]})]})]})},dw=i=>{const[e,n]=o.useState(""),{currentType:r=null,rootNode:s=null,offersToNodes:a=null,searchResult:c=null,setSearchResult:u=null,setCurrentPage:d=null}=Pe();return o.useEffect(()=>{let g=e==null?void 0:e.toLocaleLowerCase().replace(" ","");if(!g||!g.length){u(null);return}const m=setTimeout(()=>{const f=W().getAllFurnitureData({loadFurnitureData:null});if(!f||!f.length)return;const p=[],_=[];for(const I of f){if(r===jn.BUILDER&&!I.availableForBuildersClub||r===jn.NORMAL&&I.excludeDynamic)continue;const b=[I.className,I.name,I.description].join(" ").replace(/ /gi,"").toLowerCase();if(r===jn.BUILDER&&I.purchaseOfferId===-1&&I.rentOfferId===-1)I.furniLine!==""&&_.indexOf(I.furniLine)<0&&b.indexOf(g)>=0&&_.push(I.furniLine);else if([...Tu(a,I.purchaseOfferId),...Tu(a,I.rentOfferId)].length&&(b.indexOf(g)>=0&&p.push(I),p.length===250))break}const E=[];for(const I of p)E.push(new lS(I));let C=[];Hm(g,_,s,C),u(new mS(g,E,C.filter(I=>I.isVisible))),d(new to(-1,"default_3x3",new Wm([],[]),E,!1,1))},300);return()=>clearTimeout(m)},[a,r,s,e,d,u]),l(w,{gap:1,children:[t(w,{fullWidth:!0,alignItems:"center",position:"relative",children:t("input",{type:"text",className:"form-control form-control-sm",placeholder:h("generic.search"),value:e,onChange:g=>n(g.target.value)})}),(!e||!e.length)&&t(M,{variant:"primary",className:"catalog-search-button",children:t(Cc,{className:"fa-icon"})}),e&&!!e.length&&t(M,{variant:"primary",className:"catalog-search-button",onClick:g=>n(""),children:t(Dn,{className:"fa-icon"})})]})},wh=i=>{const{node:e=null,child:n=!1}=i;return t(B,{children:e&&e.children.length>0&&e.children.map((r,s)=>r.isVisible?t(Rh,{node:r,child:n},s):null)})},Rh=i=>{const{node:e=null,child:n=!1}=i,{activateNode:r=null}=Pe();return l(P,{className:"nitro-catalog-navigation-section",children:[l(be,{gap:1,column:!1,itemActive:e.isActive,onClick:s=>r(e),className:n?"inset":"",children:[t(vh,{icon:e.iconId}),t(N,{grow:!0,truncate:!0,children:e.localization}),e.isBranch&&l(B,{children:[e.isOpen&&t(fc,{className:"fa-icon"}),!e.isOpen&&t(pc,{className:"fa-icon"})]})]}),e.isOpen&&e.isBranch&&t(wh,{node:e,child:!0})]})},mw=i=>{const{node:e=null}=i,{searchResult:n=null}=Pe();return l(B,{children:[t(dw,{}),t(T,{fullHeight:!0,className:"nitro-catalog-navigation-grid-container rounded p-1",overflow:"hidden",children:l(De,{id:"nitro-catalog-main-navigation",gap:1,columnCount:1,children:[n&&n.filteredNodes.length>0&&n.filteredNodes.map((r,s)=>t(Rh,{node:r},s)),!n&&t(wh,{node:e})]})})]})},hw=i=>{const{columnCount:e=5,...n}=i,[r,s]=o.useState(!1),[a,c]=o.useState(null),{currentOffer:u=null,setPurchaseOptions:d=null}=Pe(),{badgeCodes:g=[],activate:m=null,deactivate:f=null}=rl(),p=o.useMemo(()=>{if(!a)return null;const _=new ni;return _.setValue(["0",a,"",""]),_},[a]);return o.useEffect(()=>{u&&d(_=>{const E={..._};return E.extraParamRequired=!0,E.extraData=p&&p.getValue(1)||null,E.previewStuffData=p,E})},[u,p,d]),o.useEffect(()=>{if(!r)return;const _=m();return()=>f(_)},[r,m,f]),o.useEffect(()=>(s(!0),()=>s(!1)),[]),t(De,{columnCount:e,...n,children:g&&g.length>0&&g.map((_,E)=>t(be,{itemActive:a===_,onClick:C=>c(_),children:t(We,{badgeCode:_})},E))})},sl=i=>{const{currentPage:e=null,setCurrentOffer:n=null}=Pe();return o.useEffect(()=>{!e||!e.offers.length||n(e.offers[0])},[e,n]),null},Hc=i=>{const{offer:e=null,selectOffer:n=null,itemActive:r=!1,...s}=i,[a,c]=o.useState(!1),{requestOfferToMover:u=null}=Pe(),{isVisible:d=!1}=Ds(),g=o.useMemo(()=>e.pricingModel===Vt.PRICING_MODEL_BUNDLE?null:e.product.getIconUrl(e),[e]),m=p=>{switch(p.type){case Oe.MOUSE_DOWN:n(e),c(!0);return;case Oe.MOUSE_UP:c(!1);return;case Oe.ROLL_OUT:if(!a||!r||!d)return;u(e);return}},f=e.product;return f?t(be,{itemImage:g,itemCount:e.pricingModel===Vt.PRICING_MODEL_MULTI?f.productCount:1,itemUniqueSoldout:f.uniqueLimitedItemSeriesSize&&!f.uniqueLimitedItemsLeft,itemUniqueNumber:f.uniqueLimitedItemSeriesSize,itemActive:r,onMouseDown:m,onMouseUp:m,onMouseOut:m,...s,children:e.product.productType===fe.ROBOT&&t(it,{figure:e.product.extraParam,headOnly:!0,direction:3})}):null},di=i=>{const{columnCount:e=5,children:n=null,...r}=i,{currentOffer:s=null,setCurrentOffer:a=null,currentPage:c=null,setPurchaseOptions:u=null}=Pe(),d=o.useRef();if(o.useEffect(()=>{d&&d.current&&(d.current.scrollTop=0)},[c]),!c)return null;const g=m=>{m.activate(),!m.isLazy&&(a(m),m.product&&m.product.productType===fe.WALL&&u(f=>{const p={...f};return p.extraData=m.product.extraParam||null,p}))};return l(De,{innerRef:d,columnCount:e,...r,children:[c.offers&&c.offers.length>0&&c.offers.map((m,f)=>t(Hc,{itemActive:s&&s.offerId===m.offerId,offer:m,selectOffer:g},f)),n]})},al=i=>{const{children:e=null,...n}=i,{currentOffer:r=null}=Pe();return!r||r.pricingModel!==Vt.PRICING_MODEL_SINGLE||!r.product.isUniqueLimitedItem?null:l(P,{...n,children:[t(bN,{className:"mx-auto",uniqueLimitedItemsLeft:r.product.uniqueLimitedItemsLeft,uniqueLimitedSeriesSize:r.product.uniqueLimitedItemSeriesSize}),e]})},ar=i=>{const{noGiftOption:e=!1,purchaseCallback:n=null}=i;o.useState(!1);const[r,s]=o.useState(Xe.NONE);Zo(qa.CATALOG_SKIP_PURCHASE_CONFIRMATION,!1);const{currentOffer:a=null,currentPage:c=null,purchaseOptions:u=null,setPurchaseOptions:d=null}=Pe(),{getCurrencyAmount:g=null}=Ps(),m=o.useCallback(E=>{switch(E.type){case Tr.PURCHASE_SUCCESS:s(Xe.NONE);return;case rs.PURCHASE_FAILED:s(Xe.FAILED);return;case Xa.NOT_ALLOWED:s(Xe.FAILED);return;case Qa.SOLD_OUT:s(Xe.SOLD_OUT);return}},[]);Qe(Tr.PURCHASE_SUCCESS,m),Qe(rs.PURCHASE_FAILED,m),Qe(Xa.NOT_ALLOWED,m),Qe(Qa.SOLD_OUT,m);const f=o.useMemo(()=>{if(!a||u.extraParamRequired&&(!u.extraData||!u.extraData.length))return!1;if(a.pricingModel===Vt.PRICING_MODEL_SINGLE){const E=a.product;if(E&&E.isUniqueLimitedItem)return!E.uniqueLimitedItemsLeft}return!1},[a,u]),p=(E=!1)=>{if(!a)return;if(kn()<a.clubLevel){Z("habboUI/open/hccenter");return}if(E){yt(new DN(a.page.pageId,a.offerId,u.extraData));return}if(s(Xe.PURCHASE),n){n();return}let C=a.page.pageId;L(new Ho(C,a.offerId,u.extraData,u.quantity))};return o.useEffect(()=>{a&&s(Xe.NONE)},[a,d]),o.useEffect(()=>{let E=null;return(r===Xe.CONFIRM||r===Xe.FAILED)&&(E=setTimeout(()=>s(Xe.NONE),3e3)),()=>{E&&clearTimeout(E)}},[r]),a?l(B,{children:[t(()=>{const E=a.priceInCredits*u.quantity,C=a.priceInActivityPoints*u.quantity;if(kn()<a.clubLevel)return t(M,{variant:"danger",disabled:!0,children:h("catalog.alert.hc.required")});if(f)return t(M,{variant:"danger",disabled:!0,children:h("catalog.alert.limited_edition_sold_out.title")});if(E>g(-1))return t(M,{variant:"danger",disabled:!0,children:h("catalog.alert.notenough.title")});if(C>g(a.activityPointType))return t(M,{variant:"danger",disabled:!0,children:h("catalog.alert.notenough.activitypoints.title."+a.activityPointType)});switch(r){case Xe.CONFIRM:return t(M,{variant:"warning",onClick:I=>p(),children:h("catalog.marketplace.confirm_title")});case Xe.PURCHASE:return t(M,{disabled:!0,children:t(Mc,{})});case Xe.FAILED:return t(M,{variant:"danger",children:h("generic.failed")});case Xe.SOLD_OUT:return t(M,{variant:"danger",children:h("generic.failed")+" - "+h("catalog.alert.limited_edition_sold_out.title")});case Xe.NONE:default:return t(M,{disabled:u.extraParamRequired&&(!u.extraData||!u.extraData.length),onClick:I=>s(Xe.CONFIRM),children:h("catalog.purchase_confirmation."+(a.isRentOffer?"rent":"buy"))})}},{}),!e&&!a.isRentOffer&&t(M,{disabled:u.quantity>1||!a.giftable||f||u.extraParamRequired&&(!u.extraData||!u.extraData.length),onClick:E=>p(!0),children:h("catalog.purchase_confirmation.gift")})]}):null},Oh=i=>{const{offer:e=null,separator:n=!1}=i,{purchaseOptions:r=null}=Pe(),{quantity:s=1}=r;return e?l(B,{children:[e.priceInCredits>0&&l(w,{alignItems:"center",gap:1,children:[t(N,{bold:!0,children:e.priceInCredits*s}),t(dt,{type:-1})]}),n&&e.priceInCredits>0&&e.priceInActivityPoints>0&&t(ei,{size:"xs",color:"black",className:"fa-icon"}),e.priceInActivityPoints>0&&l(w,{alignItems:"center",gap:1,children:[t(N,{bold:!0,children:e.priceInActivityPoints*s}),t(dt,{type:e.activityPointType})]})]}):null},jr=i=>{const{gap:e=1,...n}=i,{currentOffer:r=null}=Pe();return t(T,{gap:e,...n,children:t(Oh,{offer:r})})},is=i=>{const{currentOffer:e=null,roomPreviewer:n=null,purchaseOptions:r=null}=Pe(),{previewStuffData:s=null}=r;return o.useEffect(()=>{if(!e||e.pricingModel===Vt.PRICING_MODEL_BUNDLE||!n)return;const a=e.product;if(a)switch(n.reset(!1),a.productType){case fe.FLOOR:{if(!a.furnitureData)return;if(a.furnitureData.specialType===me.FIGURE_PURCHASABLE_SET){const u=W().getFloorItemData(a.furnitureData.id).customParams.split(",").map(m=>parseInt(m)),d=[];for(const m of u)kt().isValidFigureSetForGender(m,W().gender)&&d.push(m);const g=kt().getFigureStringWithFigureIds(W().figure,W().gender,d);n.addAvatarIntoRoom(g,a.productClassId)}else n.addFurnitureIntoRoom(a.productClassId,new Ot(90),s,a.extraParam);return}case fe.WALL:{if(!a.furnitureData)return;switch(a.furnitureData.specialType){case me.FLOOR:n.updateObjectRoom(a.extraParam);return;case me.WALL_PAPER:n.updateObjectRoom(null,a.extraParam);return;case me.LANDSCAPE:{n.updateObjectRoom(null,null,a.extraParam);const c=W().getWallItemDataByName("window_double_default");c&&n.addWallItemIntoRoom(c.id,new Ot(90),c.customParams);return}default:n.updateObjectRoom("default","default","default"),n.addWallItemIntoRoom(a.productClassId,new Ot(90),a.extraParam);return}}case fe.ROBOT:n.addAvatarIntoRoom(a.extraParam,0);return;case fe.EFFECT:n.addAvatarIntoRoom(W().figure,a.productClassId);return}},[e,s,n]),e?e.pricingModel===Vt.PRICING_MODEL_BUNDLE?t(T,{fit:!0,overflow:"hidden",className:"bg-muted p-2 rounded",children:t(De,{fullWidth:!0,columnCount:4,className:"nitro-catalog-layout-bundle-grid",children:e.products.length>0&&e.products.map((a,c)=>t(be,{itemImage:a.getIconUrl(e),itemCount:a.productCount},c))})}):t(Ko,{roomPreviewer:n,height:140}):null},gw=i=>{const{page:e=null}=i,{currentOffer:n=null}=Pe();return l(B,{children:[t(sl,{}),l(ne,{children:[l(T,{size:7,overflow:"hidden",children:[t(di,{shrink:!0}),l(T,{gap:1,overflow:"hidden",children:[t(N,{truncate:!0,shrink:!0,fontWeight:"bold",children:h("catalog_selectbadge")}),t(hw,{})]})]}),l(T,{center:!n,size:5,overflow:"hidden",children:[!n&&l(B,{children:[!!e.localization.getImage(1)&&t("img",{alt:"",src:e.localization.getImage(1)}),t(N,{center:!0,dangerouslySetInnerHTML:{__html:e.localization.getText(0)}})]}),n&&l(B,{children:[t(P,{position:"relative",overflow:"hidden",children:t(is,{})}),l(T,{grow:!0,gap:1,children:[t(al,{fullWidth:!0}),t(N,{grow:!0,truncate:!0,children:n.localizationName}),t(w,{justifyContent:"end",children:t(jr,{alignItems:"end"})}),t(ar,{})]})]})]})]})]})},ss=i=>{const{...e}=i,{currentOffer:n=null}=Pe();return!n||!n.badgeCode||!n.badgeCode.length?null:t(We,{badgeCode:n.badgeCode,...e})},fw=1,pw=100,Wc=i=>{const{currentOffer:e=null,purchaseOptions:n=null,setPurchaseOptions:r=null}=Pe(),{quantity:s=1}=n,a=c=>{isNaN(c)&&(c=1),c=Math.max(c,fw),c=Math.min(c,pw),c!==s&&r(u=>{const d={...u};return d.quantity=c,d})};return!e||!e.bundlePurchaseAllowed?null:l(B,{children:[t(N,{children:h("catalog.bundlewidget.spinner.select.amount")}),l(w,{alignItems:"center",gap:1,children:[t(Zd,{className:"text-black cursor-pointer fa-icon",onClick:c=>a(s-1)}),t("input",{type:"number",className:"form-control form-control-sm quantity-input",value:s,onChange:c=>a(c.target.valueAsNumber)}),t(em,{className:"text-black cursor-pointer fa-icon",onClick:c=>a(s+1)})]})]})},Iw=i=>{const{page:e=null}=i,[n,r]=o.useState(new Map),{currentOffer:s=null,setCurrentOffer:a=null}=Pe(),[c,u]=o.useState(!1),d=(_,E)=>!_.product.furnitureData.colorIndex||!E.product.furnitureData.colorIndex||_.product.furnitureData.colorIndex>E.product.furnitureData.colorIndex?1:_==E?0:-1,g=(_,E)=>_.product.furnitureData.className>E.product.furnitureData.className?1:_==E?0:-1,m=_=>{_.activate(),a(_)},f=(_,E)=>{const C=`${E}*${_}`,I=e.offers.findIndex(b=>b.product.furnitureData.fullName===C);I>-1&&m(e.offers[I])},p=o.useMemo(()=>{const _=[],E=new Map,C=new Map;return e.offers.sort(d),e.offers.forEach(I=>{if(!I.product)return;const b=I.product.furnitureData;if(!b||!b.hasIndexedColor)_.push(I);else{const S=b.className,v=b.colorIndex;C.has(S)||C.set(S,[]);let y=16777215;if(b.colors){for(let R of b.colors)R!==16777215&&(y=R);C.get(S).indexOf(y)===-1&&(C.get(S)[v]=y)}E.has(S)||(_.push(I),E.set(S,!0))}}),_.sort(g),r(C),_},[e.offers]);return l(ne,{children:[t(T,{size:7,overflow:"hidden",children:l(De,{columnCount:5,children:[(!c||!s||!n.has(s.product.furnitureData.className))&&p.map((_,E)=>t(Hc,{itemActive:s&&(s.product.furnitureData.hasIndexedColor?s.product.furnitureData.className===_.product.furnitureData.className:s.offerId===_.offerId),offer:_,selectOffer:m},E)),c&&s&&n.has(s.product.furnitureData.className)&&n.get(s.product.furnitureData.className).map((_,E)=>t(be,{itemHighlight:!0,itemActive:s.product.furnitureData.colorIndex===E,itemColor:Cn.int2rgb(_),className:"clear-bg",onClick:C=>f(E,s.product.furnitureData.className)},E))]})}),l(T,{center:!s,size:5,overflow:"hidden",children:[!s&&l(B,{children:[!!e.localization.getImage(1)&&t("img",{alt:"",src:e.localization.getImage(1)}),t(N,{center:!0,dangerouslySetInnerHTML:{__html:e.localization.getText(0)}})]}),s&&l(B,{children:[l(P,{position:"relative",overflow:"hidden",children:[t(is,{}),t(ss,{position:"absolute",className:"bg-muted rounded bottom-1 end-1"}),s.product.furnitureData.hasIndexedColor&&t(M,{position:"absolute",className:"bottom-1 start-1",onClick:_=>u(E=>!E),children:t(tm,{className:"fa-icon"})})]}),l(T,{grow:!0,gap:1,children:[t(al,{fullWidth:!0}),t(N,{grow:!0,truncate:!0,children:s.localizationName}),l(w,{justifyContent:"between",children:[t(T,{gap:1,children:t(Wc,{})}),t(jr,{justifyContent:"end",alignItems:"end"})]}),t(ar,{})]})]})]})]})},yh=i=>{const{imageUrl:e=null}=i,[n,r]=o.useState("");return o.useEffect(()=>{r(e??K("catalog.asset.image.url").replace("%name%","catalog_header_roombuilder"))},[e]),t(w,{center:!0,fullWidth:!0,className:"nitro-catalog-header",children:t("img",{src:n,onError:({currentTarget:s})=>{s.src=K("catalog.asset.image.url").replace("%name%","catalog_header_roombuilder")}})})},Ew=i=>{const{page:e=null}=i,{currentOffer:n=null,currentPage:r=null}=Pe();return t(B,{children:l(ne,{children:[l(T,{size:7,overflow:"hidden",children:[K("catalog.headers")&&t(yh,{imageUrl:r.localization.getImage(0)}),t(di,{})]}),l(T,{center:!n,size:5,overflow:"hidden",children:[!n&&l(B,{children:[!!e.localization.getImage(1)&&t(vr,{imageUrl:e.localization.getImage(1)}),t(N,{center:!0,dangerouslySetInnerHTML:{__html:e.localization.getText(0)}})]}),n&&l(B,{children:[l(w,{center:!0,overflow:"hidden",style:{height:140},children:[n.product.productType!==fe.BADGE&&l(B,{children:[t(is,{}),t(ss,{className:"bg-muted rounded bottom-1 end-1"})]}),n.product.productType===fe.BADGE&&t(ss,{className:"scale-2"})]}),l(T,{grow:!0,gap:1,children:[t(al,{fullWidth:!0}),t(N,{grow:!0,truncate:!0,children:n.localizationName}),l(w,{justifyContent:"between",children:[t(T,{gap:1,children:t(Wc,{})}),t(jr,{justifyContent:"end",alignItems:"end"})]}),t(ar,{})]})]})]})]})})},Cw=i=>{const{...e}=i,{currentOffer:n=null,purchaseOptions:r=null}=Pe(),{previewStuffData:s=null}=r,a=o.useMemo(()=>{if(!n||!s)return null;const c=s.getValue(2);return!c||!c.length?null:c},[n,s]);return a?t(We,{badgeCode:a,isGroup:!0,...e}):null},kh=i=>{const[e,n]=o.useState(0),{currentOffer:r=null,catalogOptions:s=null,setPurchaseOptions:a=null}=Pe(),{groups:c=null}=s,u=o.useMemo(()=>{if(!c||!c.length)return null;const g=c[e];if(!g)return null;const m=new ni;return m.setValue(["0",g.groupId.toString(),g.badgeCode,g.colorA,g.colorB]),m},[e,c]);if(o.useEffect(()=>{r&&a(g=>{const m={...g};return m.extraParamRequired=!0,m.extraData=u&&u.getValue(1)||null,m.previewStuffData=u,m})},[r,u,a]),o.useEffect(()=>{L(new Rm)},[]),!c||!c.length)return l(P,{className:"bg-muted rounded p-1 text-black text-center",children:[h("catalog.guild_selector.members_only"),t(M,{className:"mt-1",children:h("catalog.guild_selector.find_groups")})]});const d=c[e];return l(w,{gap:1,children:[!!d&&l(w,{overflow:"hidden",className:"rounded border",children:[t(P,{fullHeight:!0,style:{width:"20px",backgroundColor:"#"+d.colorA}}),t(P,{fullHeight:!0,style:{width:"20px",backgroundColor:"#"+d.colorB}})]}),t("select",{className:"form-select form-select-sm",value:e,onChange:g=>n(parseInt(g.target.value)),children:c.map((g,m)=>t("option",{value:m,children:g.groupName},m))})]})},_w=i=>{const{page:e=null}=i,{currentOffer:n=null}=Pe();return l(ne,{children:[t(T,{size:7,overflow:"hidden",children:t(di,{})}),l(T,{center:!n,size:5,overflow:"hidden",children:[!n&&l(B,{children:[!!e.localization.getImage(1)&&t("img",{alt:"",src:e.localization.getImage(1)}),t(N,{center:!0,dangerouslySetInnerHTML:{__html:e.localization.getText(0)}})]}),n&&l(B,{children:[l(P,{position:"relative",overflow:"hidden",children:[t(is,{}),t(Cw,{position:"absolute",className:"bottom-1 end-1"})]}),l(T,{grow:!0,gap:1,children:[t(N,{truncate:!0,children:n.localizationName}),t(P,{grow:!0,children:t(kh,{})}),t(w,{justifyContent:"end",children:t(jr,{alignItems:"end"})}),t(ar,{})]})]})]})]})},bw=i=>{const{page:e=null}=i;o.useState(0);const{currentOffer:n=null,setCurrentOffer:r=null,catalogOptions:s=null}=Pe();return o.useEffect(()=>{L(new Rm)},[e]),l(B,{children:[t(sl,{}),l(ne,{children:[t(T,{className:"bg-muted rounded p-2 text-black",size:7,overflow:"hidden",children:t(P,{className:"overflow-auto",dangerouslySetInnerHTML:{__html:e.localization.getText(1)}})}),t(T,{size:5,overflow:"hidden",gap:1,children:!!n&&t(B,{children:l(T,{grow:!0,gap:1,children:[t(N,{truncate:!0,children:n.localizationName}),t(P,{grow:!0,children:t(kh,{})}),t(w,{justifyContent:"end",children:t(jr,{alignItems:"end"})}),t(ar,{noGiftOption:!0})]})})})]})]})},Sw=i=>{const{page:e=null}=i;return l(ne,{children:[l(T,{size:7,overflow:"hidden",className:"bg-muted rounded p-2 text-black",children:[t(P,{dangerouslySetInnerHTML:{__html:e.localization.getText(2)}}),t(P,{overflow:"auto",dangerouslySetInnerHTML:{__html:e.localization.getText(0)}}),t(P,{dangerouslySetInnerHTML:{__html:e.localization.getText(1)}})]}),l(T,{center:!0,size:5,overflow:"hidden",children:[t(vr,{imageUrl:e.localization.getImage(1)}),t(M,{onClick:()=>Z("groups/create"),children:h("catalog.start.guild.purchase.button")})]})]})},Nw=i=>{const{page:e=null}=i;return t("div",{className:"h-100 nitro-catalog-layout-info-loyalty text-black d-flex flex-row",children:t("div",{className:"overflow-auto h-100 d-flex flex-column info-loyalty-content",children:t("div",{dangerouslySetInnerHTML:{__html:e.localization.getText(0)}})})})},Ah=i=>{const{page:e=null}=i,n=e.localization.getImage(1);return l(T,{grow:!0,className:"bg-muted rounded text-black p-2",overflow:"hidden",children:[l(w,{alignItems:"center",gap:2,children:[n&&t("img",{alt:"",src:n}),t(P,{className:"fs-5",dangerouslySetInnerHTML:{__html:e.localization.getText(1)}})]}),t(T,{grow:!0,alignItems:"center",overflow:"auto",children:t(P,{dangerouslySetInnerHTML:{__html:e.localization.getText(2)}})}),t(w,{alignItems:"center",children:t(P,{className:"fw-bold",dangerouslySetInnerHTML:{__html:e.localization.getText(3)}})})]})},Tw=i=>t(Ah,{...i}),vw=i=>{const{page:e=null}=i,[n,r]=o.useState(""),[s,a]=o.useState(""),[c,u]=o.useState(-1),[d,g]=o.useState([]),[m,f]=o.useState(!1),[p,_]=o.useState(1),{categories:E=null}=Yn(),{setIsVisible:C=null}=Pe(),{promoteInformation:I,isExtended:b,setIsExtended:S}=Bc();o.useEffect(()=>{b&&(u(I.data.flatId),r(I.data.eventName),a(I.data.eventDescription),_(I.data.categoryId),f(b),S(!1))},[b,n,s,p]);const v=()=>{u(-1),r(""),a(""),_(1),S(!1),C(!1)},y=()=>{const R=e.pageId,O=e.offers.length>=1?e.offers[0].offerId:-1,F=c,U=n,A=s,k=p;L(new xE(R,O,F,U,m,A,k)),v()};return x(ME,R=>{const O=R.getParser();O&&g(O.rooms)}),o.useEffect(()=>{L(new UE),L(new Im)},[]),l(B,{children:[t(N,{bold:!0,center:!0,children:h("roomad.catalog_header")}),l(T,{size:12,overflow:"hidden",className:"text-black",children:[t(P,{children:h("roomad.catalog_text",["duration"],["120"])}),l(P,{className:"bg-muted rounded p-1",children:[l(T,{gap:2,children:[t(N,{bold:!0,children:h("navigator.category")}),t("select",{className:"form-select form-select-sm",value:p,onChange:R=>_(parseInt(R.target.value)),disabled:m,children:E&&E.map((R,O)=>t("option",{value:R.id,children:h(R.name)},O))})]}),l(T,{gap:1,children:[t(N,{bold:!0,children:h("roomad.catalog_name")}),t("input",{type:"text",className:"form-control form-control-sm",maxLength:64,value:n,onChange:R=>r(R.target.value),readOnly:m})]}),l(T,{gap:1,children:[t(N,{bold:!0,children:h("roomad.catalog_description")}),t("textarea",{className:"form-control form-control-sm",maxLength:64,value:s,onChange:R=>a(R.target.value),readOnly:m})]}),l(T,{gap:1,children:[t(N,{bold:!0,children:h("roomad.catalog_roomname")}),l("select",{className:"form-select form-select-sm",value:c,onChange:R=>u(parseInt(R.target.value)),disabled:m,children:[t("option",{value:-1,disabled:!0,children:h("roomad.catalog_roomname")}),d&&d.map((R,O)=>t("option",{value:R.roomId,children:R.roomName},O))]})]}),t(T,{gap:1,children:t(M,{variant:!n||!s||c===-1?"danger":"success",onClick:y,disabled:!n||!s||c===-1,children:h(m?"roomad.extend.event":"buy")})})]})]})]})},Dh=i=>{const{columnCount:e=5,children:n=null,...r}=i,{currentOffer:s=null}=Pe(),a=o.useRef();return o.useEffect(()=>{a&&a.current&&(a.current.scrollTop=0)},[s]),s?l(De,{innerRef:a,columnCount:5,...r,children:[s.products&&s.products.length>0&&s.products.map((c,u)=>t(be,{itemImage:c.getIconUrl(),itemCount:c.productCount},u)),n]}):null},Ph=i=>{const{gap:e=1,...n}=i,{currentOffer:r=null}=Pe();return t(w,{gap:e,alignItems:"center",classNames:["bg-muted","p-1","rounded"],...n,children:t(Oh,{separator:!0,offer:r})})},ww=i=>{const{page:e=null}=i;return l(B,{children:[t(sl,{}),l(ne,{children:[l(T,{size:7,overflow:"hidden",children:[!!e.localization.getText(2)&&t(N,{dangerouslySetInnerHTML:{__html:e.localization.getText(2)}}),t(T,{grow:!0,overflow:"hidden",className:"bg-muted p-2 rounded",children:t(Dh,{fullWidth:!0,className:"nitro-catalog-layout-bundle-grid"})})]}),l(T,{size:5,overflow:"hidden",gap:1,children:[!!e.localization.getText(1)&&t(N,{center:!0,small:!0,overflow:"auto",children:e.localization.getText(1)}),l(T,{grow:!0,position:"relative",overflow:"hidden",gap:0,children:[!!e.localization.getImage(1)&&t("img",{alt:"",className:"flex-grow-1",src:e.localization.getImage(1)}),t(ss,{position:"absolute",className:"bg-muted rounded bottom-0 start-0"}),t(Ph,{position:"absolute",className:"bottom-0 end-0"})]}),t(T,{gap:1,children:t(ar,{})})]})]})]})},Rw=i=>{const{page:e=null}=i;return l(B,{children:[t(sl,{}),l(ne,{children:[l(T,{size:7,overflow:"hidden",children:[!!e.localization.getText(2)&&t(N,{dangerouslySetInnerHTML:{__html:e.localization.getText(2)}}),t(T,{grow:!0,overflow:"hidden",className:"bg-muted p-2 rounded",children:t(Dh,{fullWidth:!0,className:"nitro-catalog-layout-bundle-grid"})})]}),l(T,{size:5,overflow:"hidden",gap:1,children:[!!e.localization.getText(1)&&t(N,{center:!0,small:!0,overflow:"auto",children:e.localization.getText(1)}),l(T,{grow:!0,position:"relative",overflow:"hidden",gap:0,children:[!!e.localization.getImage(1)&&t("img",{alt:"",className:"flex-grow-1",src:e.localization.getImage(1)}),t(ss,{position:"absolute",className:"bg-muted rounded bottom-0 start-0"}),t(Ph,{position:"absolute",className:"bottom-0 end-0"})]}),t(T,{gap:1,children:t(ar,{})})]})]})]})},Ow=i=>{const{page:e=null}=i,[n,r]=o.useState(-1),[s,a]=o.useState(""),{currentOffer:c=null,currentPage:u=null}=Pe(),d=g=>{var m;return(m=_e().soundManager.musicController)==null?void 0:m.playSong(g,Ca.PRIORITY_PURCHASE_PREVIEW,15,0,0,0)};return x(FE,g=>{const m=g.getParser();m.officialSongId===s&&r(m.songId)}),o.useEffect(()=>{if(!c)return;const g=c.product;if(g){if(g.extraParam.length>0){const m=parseInt(g.extraParam);m>0?r(m):(a(g.extraParam),L(new GE(g.extraParam)))}else a(""),r(-1);return()=>{var m;return(m=_e().soundManager.musicController)==null?void 0:m.stop(Ca.PRIORITY_PURCHASE_PREVIEW)}}},[c]),o.useEffect(()=>()=>{var g;return(g=_e().soundManager.musicController)==null?void 0:g.stop(Ca.PRIORITY_PURCHASE_PREVIEW)},[]),t(B,{children:l(ne,{children:[l(T,{size:7,overflow:"hidden",children:[K("catalog.headers")&&t(yh,{imageUrl:u.localization.getImage(0)}),t(di,{})]}),l(T,{center:!c,size:5,overflow:"hidden",children:[!c&&l(B,{children:[!!e.localization.getImage(1)&&t(vr,{imageUrl:e.localization.getImage(1)}),t(N,{center:!0,dangerouslySetInnerHTML:{__html:e.localization.getText(0)}})]}),c&&l(B,{children:[l(w,{center:!0,overflow:"hidden",style:{height:140},children:[c.product.productType!==fe.BADGE&&l(B,{children:[t(is,{}),t(ss,{className:"bg-muted rounded bottom-1 end-1"})]}),c.product.productType===fe.BADGE&&t(ss,{className:"scale-2"})]}),l(T,{grow:!0,gap:1,children:[t(al,{fullWidth:!0}),t(N,{grow:!0,truncate:!0,children:c.localizationName}),n>-1&&t(M,{onClick:()=>d(n),children:h("play_preview_button")}),l(w,{justifyContent:"between",children:[t(T,{gap:1,children:t(Wc,{})}),t(jr,{justifyContent:"end",alignItems:"end"})]}),t(ar,{})]})]})]})]})})},yw=["floors","walls","views"],kw=i=>{const{columnCount:e=5,children:n=null,...r}=i,[s,a]=o.useState(null),[c,u]=o.useState(-1),[d,g]=o.useState(null),{currentPage:m=null,currentOffer:f=null,setCurrentOffer:p=null,setPurchaseOptions:_=null}=Pe(),E=o.useRef(),C=b=>{b&&g(S=>{const v=[...S];return v[c]=b,v})};if(o.useEffect(()=>{if(!m)return;const b=[[],[],[]];for(const S of m.offers){if(S.pricingModel!==Vt.PRICING_MODEL_SINGLE&&S.pricingModel!==Vt.PRICING_MODEL_MULTI)continue;const v=S.product;if(!v||v.productType!==fe.WALL&&v.productType!==fe.FLOOR||!v.furnitureData)continue;switch(v.furnitureData.className){case"floor":b[0].push(S);break;case"wallpaper":b[1].push(S);break;case"landscape":b[2].push(S);break}}a(b),u(0),g([b[0][0],b[1][0],b[2][0]])},[m]),o.useEffect(()=>{c===-1||!d||p(d[c])},[c,d,p]),o.useEffect(()=>{c===-1||!d||!f||_(b=>{const S={...b};return S.extraData=d[c].product.extraParam,S.extraParamRequired=!0,S})},[f,c,d,_]),o.useEffect(()=>{E&&E.current&&(E.current.scrollTop=0)},[c]),!s||c===-1)return null;const I=s[c];return l(B,{children:[t(Cr,{children:yw.map((b,S)=>t(M,{active:c===S,onClick:v=>u(S),children:h(`catalog.spaces.tab.${b}`)},S))}),l(De,{innerRef:E,columnCount:e,...r,children:[I&&I.length>0&&I.map((b,S)=>t(Hc,{itemActive:f&&f===b,offer:b,selectOffer:v=>C(v)},S)),n]})]})},Aw=i=>{const{page:e=null}=i,{currentOffer:n=null,roomPreviewer:r=null}=Pe();return o.useEffect(()=>{r.updatePreviewObjectBoundingRectangle(new es)},[r]),l(ne,{children:[t(T,{size:7,overflow:"hidden",children:t(kw,{})}),l(T,{center:!n,size:5,overflow:"hidden",children:[!n&&l(B,{children:[!!e.localization.getImage(1)&&t("img",{alt:"",src:e.localization.getImage(1)}),t(N,{center:!0,dangerouslySetInnerHTML:{__html:e.localization.getText(0)}})]}),n&&l(B,{children:[t(P,{position:"relative",overflow:"hidden",children:t(is,{})}),l(T,{grow:!0,gap:1,children:[t(N,{grow:!0,truncate:!0,children:n.localizationName}),t(w,{justifyContent:"end",children:t(jr,{alignItems:"end"})}),t(ar,{})]})]})]})]})},Dw=i=>{const{page:e=null}=i,[n,r]=o.useState(""),{currentOffer:s=null,setPurchaseOptions:a=null}=Pe();return o.useEffect(()=>{s&&a(c=>{const u={...c};return u.extraData=n,u})},[s,n,a]),l(ne,{children:[l(T,{size:7,overflow:"hidden",children:[t(di,{}),t("textarea",{className:"flex-grow-1 form-control w-100",defaultValue:n||"",onChange:c=>r(c.target.value)})]}),l(T,{center:!s,size:5,overflow:"hidden",children:[!s&&l(B,{children:[!!e.localization.getImage(1)&&t("img",{alt:"",src:e.localization.getImage(1)}),t(N,{center:!0,dangerouslySetInnerHTML:{__html:e.localization.getText(0)}})]}),s&&l(B,{children:[t(is,{}),l(T,{grow:!0,gap:1,children:[t(N,{grow:!0,truncate:!0,children:s.localizationName}),t(w,{justifyContent:"end",children:t(jr,{alignItems:"end"})}),t(ar,{})]})]})]})]})},Pw=i=>{const[e,n]=o.useState(null),[r,s]=o.useState(Xe.NONE),{currentPage:a=null,catalogOptions:c=null}=Pe(),{purse:u=null,getCurrencyAmount:d=null}=Ps(),{clubOffers:g=null}=c,m=o.useCallback(S=>{switch(S.type){case Tr.PURCHASE_SUCCESS:s(Xe.NONE);return;case rs.PURCHASE_FAILED:s(Xe.FAILED);return}},[]);Qe(Tr.PURCHASE_SUCCESS,m),Qe(rs.PURCHASE_FAILED,m);const f=o.useCallback(S=>{let v="";return S.months>0&&(v=h("catalog.vip.item.header.months",["num_months"],[S.months.toString()])),S.extraDays>0&&(v!==""&&(v+=" "),v+=" "+h("catalog.vip.item.header.days",["num_days"],[S.extraDays.toString()])),v},[]),p=o.useCallback(()=>{if(!u)return"";const S=u.clubDays>0||u.clubPeriods>0?"extension.":"subscription.",v=e.months===0?"days":"months",y=e.months===0?e.extraDays:e.months;return h("catalog.vip.buy.confirm."+S+v).replace("%NUM_"+v.toUpperCase()+"%",y.toString())},[e,u]),_=o.useCallback(()=>{let S=h("catalog.vip.buy.confirm.end_date");return S=S.replace("%month%",e.month.toString()),S=S.replace("%day%",e.day.toString()),S=S.replace("%year%",e.year.toString()),S},[e]),E=o.useMemo(()=>{const S=u.clubDays,y=u.clubPeriods*31+S;return h("catalog.vip.extend.info",["days"],[y.toString()])},[u]),C=o.useCallback(()=>{e&&(s(Xe.PURCHASE),L(new Ho(a.pageId,e.offerId,null,1)))},[e,a]),I=o.useCallback(S=>{s(Xe.NONE),n(S)},[]),b=o.useCallback(()=>{if(!e)return null;if(e.priceCredits>d(-1))return t(M,{fullWidth:!0,variant:"danger",children:h("catalog.alert.notenough.title")});if(e.priceActivityPoints>d(e.priceActivityPointsType))return t(M,{fullWidth:!0,variant:"danger",children:h("catalog.alert.notenough.activitypoints.title."+e.priceActivityPointsType)});switch(r){case Xe.CONFIRM:return t(M,{fullWidth:!0,variant:"warning",onClick:C,children:h("catalog.marketplace.confirm_title")});case Xe.PURCHASE:return t(M,{fullWidth:!0,variant:"primary",disabled:!0,children:t(Mc,{})});case Xe.FAILED:return t(M,{fullWidth:!0,variant:"danger",disabled:!0,children:h("generic.failed")});case Xe.NONE:default:return t(M,{fullWidth:!0,variant:"success",onClick:()=>s(Xe.CONFIRM),children:h("buy")})}},[e,r,C,d]);return o.useEffect(()=>{g||L(new VE(1))},[g]),l(ne,{children:[l(T,{fullHeight:!0,size:7,overflow:"hidden",justifyContent:"between",children:[t(De,{columnCount:1,className:"nitro-catalog-layout-vip-buy-grid",children:g&&g.length>0&&g.map((S,v)=>l(be,{column:!1,center:!1,alignItems:"center",justifyContent:"between",itemActive:e===S,className:"p-1",onClick:()=>I(S),children:[t("i",{className:"icon-hc-banner"}),l(T,{justifyContent:"end",gap:0,children:[t(N,{textEnd:!0,children:f(S)}),l(w,{justifyContent:"end",gap:1,children:[S.priceCredits>0&&l(w,{alignItems:"center",justifyContent:"end",gap:1,children:[t(N,{children:S.priceCredits}),t(dt,{type:-1})]}),S.priceActivityPoints>0&&l(w,{alignItems:"center",justifyContent:"end",gap:1,children:[t(N,{children:S.priceActivityPoints}),t(dt,{type:S.priceActivityPointsType})]})]})]})]},v))}),t(N,{center:!0,dangerouslySetInnerHTML:{__html:h("catalog.vip.buy.hccenter")}})]}),l(T,{size:5,overflow:"hidden",children:[l(T,{fullHeight:!0,center:!0,overflow:"hidden",children:[a.localization.getImage(1)&&t("img",{alt:"",src:a.localization.getImage(1)}),t(N,{center:!0,overflow:"auto",dangerouslySetInnerHTML:{__html:E}})]}),e&&l(T,{fullWidth:!0,grow:!0,justifyContent:"end",children:[l(w,{alignItems:"end",children:[l(T,{grow:!0,gap:0,children:[t(N,{fontWeight:"bold",children:p()}),t(N,{children:_()})]}),l(T,{gap:1,children:[e.priceCredits>0&&l(w,{alignItems:"center",justifyContent:"end",gap:1,children:[t(N,{children:e.priceCredits}),t(dt,{type:-1})]}),e.priceActivityPoints>0&&l(w,{alignItems:"center",justifyContent:"end",gap:1,children:[t(N,{children:e.priceActivityPoints}),t(dt,{type:e.priceActivityPointsType})]})]})]}),b()]})]})]})},Lw=i=>{const{text:e=null}=i,[n,r]=o.useState(""),[s,a]=o.useState(!1),{simpleAlert:c=null}=ze(),u=()=>{!n||!n.length||s||(L(new WE(n)),a(!0))};return x(BE,d=>{const g=d.getParser();let m=h("catalog.alert.voucherredeem.ok.description");g.productName&&(m=h("catalog.alert.voucherredeem.ok.description.furni",["productName","productDescription"],[g.productName,g.productDescription])),c(m,null,null,null,h("catalog.alert.voucherredeem.ok.title")),a(!1),r("")}),x(HE,d=>{const g=d.getParser();c(h(`catalog.alert.voucherredeem.error.description.${g.errorCode}`),null,null,null,h("catalog.alert.voucherredeem.error.title")),a(!1)}),l(w,{gap:1,children:[t("input",{type:"text",className:"form-control form-control-sm",placeholder:e,value:n,onChange:d=>r(d.target.value)}),t(M,{variant:"primary",onClick:u,disabled:s,children:t(rg,{className:"fa-icon"})})]})},Mi=i=>{const{item:e=null,position:n="relative",pointer:r=!0,overflow:s="hidden",fullHeight:a=!0,classNames:c=[],children:u=null,...d}=i,g=o.useMemo(()=>{const f=["rounded","nitro-front-page-item"];return c.length&&f.push(...c),f},[c]);if(!e)return null;const m=K("image.library.url")+e.itemPromoImage;return l(lh,{imageUrl:m,classNames:g,position:n,fullHeight:a,pointer:r,overflow:s,...d,children:[t(N,{position:"absolute",variant:"white",className:"bg-dark rounded p-2 m-2 bottom-0",children:e.itemName}),u]})},Mw=i=>{const{page:e=null,hideNavigation:n=null}=i,{frontPageItems:r=[]}=Pe(),s=o.useCallback(a=>{switch(a.type){case mu.ITEM_CATALOGUE_PAGE:Z(`catalog/open/${a.catalogPageLocation}`);return;case mu.ITEM_PRODUCT_OFFER:Z(`catalog/open/${a.productOfferId}`);return}},[]);return o.useEffect(()=>{n()},[e,n]),l(ne,{children:[t(T,{size:4,children:r[0]&&t(Mi,{item:r[0],onClick:a=>s(r[0])})}),l(T,{size:8,children:[r[1]&&t(Mi,{item:r[1],onClick:a=>s(r[1])}),r[2]&&t(Mi,{item:r[2],onClick:a=>s(r[2])}),r[3]&&t(Mi,{item:r[3],onClick:a=>s(r[3])}),t(Lw,{text:e.localization.getText(1)})]})]})},gc=1,Ki=2,Lh=i=>{const{offerData:e=null,type:n=Ki,onClick:r=null}=i,s=o.useMemo(()=>e?h((e.furniType===2?"wallItem":"roomItem")+`.name.${e.furniId}`):"",[e]),a=o.useCallback(()=>{if(!e)return"";if(e.status===ja.SOLD)return h("catalog.marketplace.offer.sold");if(e.timeLeftMinutes<=0)return h("catalog.marketplace.offer.expired");const c=Math.max(1,e.timeLeftMinutes),u=Math.floor(c/60);let g=c-u*60+" "+h("catalog.marketplace.offer.minutes");return u>0&&(g=u+" "+h("catalog.marketplace.offer.hours")+" "+g),h("catalog.marketplace.offer.time_left",["time"],[g])},[e]);return l(be,{shrink:!0,center:!1,column:!1,alignItems:"center",className:"p-1",children:[t(T,{style:{width:40,height:40},children:t(be,{column:!1,itemImage:cS(e.furniType===Wa.TYPE_FLOOR?fe.FLOOR:fe.WALL,e.furniId,e.extraData),itemUniqueNumber:e.isUniqueLimitedItem?e.stuffData.uniqueNumber:0})}),l(T,{grow:!0,gap:0,children:[t(N,{fontWeight:"bold",children:s}),n===gc&&l(B,{children:[t(N,{children:h("catalog.marketplace.offer.price_own_item",["price"],[e.price.toString()])}),t(N,{children:a()})]}),n===Ki&&l(B,{children:[t(N,{children:h("catalog.marketplace.offer.price_public_item",["price","average"],[e.price.toString(),e.averagePrice>0?e.averagePrice.toString():"-"])}),t(N,{children:h("catalog.marketplace.offer_count",["count"],[e.offerCount.toString()])})]})]}),l(T,{gap:1,children:[n===gc&&e.status!==ja.SOLD&&t(M,{variant:"secondary",onClick:()=>r(e),children:h("catalog.marketplace.offer.pick")}),n===Ki&&l(B,{children:[t(M,{variant:"secondary",onClick:()=>r(e),children:h("buy")}),t(M,{variant:"secondary",disabled:!0,children:h("catalog.marketplace.view_more")})]})]})]})},Uw=i=>{const[e,n]=o.useState(0),[r,s]=o.useState([]),{simpleAlert:a=null}=ze();x(jE,g=>{const m=g.getParser();if(!m)return;const f=m.offers.map(p=>{const _=new Wa(p.offerId,p.furniId,p.furniType,p.extraData,p.stuffData,p.price,p.status,p.averagePrice,p.offerCount);return _.timeLeftMinutes=p.timeLeftMinutes,_});n(m.creditsWaiting),s(f)}),x(qE,g=>{const m=g.getParser();if(m){if(!m.success){a(h("catalog.marketplace.cancel_failed"),ge.DEFAULT,null,null,h("catalog.marketplace.operation_failed.topic"));return}s(f=>f.filter(p=>p.offerId!==m.offerId))}});const c=o.useMemo(()=>r.filter(g=>g.status===ja.SOLD),[r]),u=o.useCallback(()=>{s(g=>{const m=c.map(f=>f.offerId);return g.filter(f=>m.indexOf(f.offerId)===-1)}),L(new zE)},[c]),d=g=>{L(new $E(g.offerId))};return o.useEffect(()=>{L(new YE)},[]),l(T,{overflow:"hidden",children:[e<=0&&t(N,{center:!0,className:"bg-muted rounded p-1",children:h("catalog.marketplace.redeem.no_sold_items")}),e>0&&l(T,{center:!0,gap:1,className:"bg-muted rounded p-2",children:[t(N,{children:h("catalog.marketplace.redeem.get_credits",["count","credits"],[c.length.toString(),e.toString()])}),t(M,{className:"mt-1",onClick:u,children:h("catalog.marketplace.offer.redeem")})]}),l(T,{gap:1,overflow:"hidden",children:[t(N,{truncate:!0,shrink:!0,fontWeight:"bold",children:h("catalog.marketplace.items_found",["count"],[r.length.toString()])}),t(T,{overflow:"auto",className:"nitro-catalog-layout-marketplace-grid",children:r.length>0&&r.map(g=>t(Lh,{offerData:g,type:gc,onClick:d},g.offerId))})]})]})},xw=i=>{const{searchType:e=null,sortTypes:n=null,onSearch:r=null}=i,[s,a]=o.useState(n?n[0]:3),[c,u]=o.useState(""),[d,g]=o.useState(0),[m,f]=o.useState(0),p=o.useCallback(E=>{a(E),(e===qt.BY_ACTIVITY||e===qt.BY_VALUE)&&r({minPrice:-1,maxPrice:-1,query:"",type:E})},[r,e]),_=o.useCallback(()=>{const E=d>0?d:-1,C=m>0?m:-1;r({minPrice:E,maxPrice:C,type:s,query:c})},[m,d,r,c,s]);return o.useEffect(()=>{if(!n||!n.length)return;const E=n[0];a(E),(e===qt.BY_ACTIVITY||qt.BY_VALUE===e)&&r({minPrice:-1,maxPrice:-1,query:"",type:E})},[r,e,n]),l(T,{gap:1,children:[l(w,{alignItems:"center",gap:1,children:[t(N,{className:"col-3",children:h("catalog.marketplace.sort_order")}),t("select",{className:"form-select form-select-sm",value:s,onChange:E=>p(parseInt(E.target.value)),children:n.map(E=>t("option",{value:E,children:h(`catalog.marketplace.sort.${E}`)},E))})]}),e===qt.ADVANCED&&l(B,{children:[l(w,{alignItems:"center",gap:1,children:[t(N,{className:"col-3",children:h("catalog.marketplace.search_name")}),t("input",{className:"form-control form-control-sm",type:"text",value:c,onChange:E=>u(E.target.value)})]}),l(w,{alignItems:"center",gap:1,children:[t(N,{className:"col-3",children:h("catalog.marketplace.search_price")}),l(w,{fullWidth:!0,gap:1,children:[t("input",{className:"form-control form-control-sm",type:"number",min:0,value:d,onChange:E=>g(E.target.valueAsNumber)}),t("input",{className:"form-control form-control-sm",type:"number",min:0,value:m,onChange:E=>f(E.target.valueAsNumber)})]})]}),t(M,{variant:"secondary",className:"mx-auto",onClick:_,children:h("generic.search")})]})]})},Fw=[1,2],Gw=[3,4,5,6],Vw=[1,2,3,4,5,6],Bw=i=>{const[e,n]=o.useState(qt.BY_ACTIVITY),[r,s]=o.useState(0),[a,c]=o.useState(new Map),[u,d]=o.useState({minPrice:-1,maxPrice:-1,query:"",type:3}),{getCurrencyAmount:g=null}=Ps(),{simpleAlert:m=null,showConfirm:f=null}=ze(),p=o.useCallback(C=>{d(C),L(new KE(C.minPrice,C.maxPrice,C.query,C.type))},[]),_=o.useMemo(()=>{switch(e){case qt.BY_ACTIVITY:return Gw;case qt.BY_VALUE:return Fw;case qt.ADVANCED:return Vw}return[]},[e]),E=o.useCallback(C=>{if(C.price>g(-1)){m(h("catalog.alert.notenough.credits.description"),ge.DEFAULT,null,null,h("catalog.alert.notenough.title"));return}const I=C.offerId;f(h("catalog.marketplace.confirm_header"),()=>{L(new hu(I))},null,null,null,h("catalog.marketplace.confirm_title"))},[g,m,f]);return x(XE,C=>{const I=C.getParser();if(!I)return;const b=new Map;I.offers.forEach(S=>{const v=new Wa(S.offerId,S.furniId,S.furniType,S.extraData,S.stuffData,S.price,S.status,S.averagePrice,S.offerCount);v.timeLeftMinutes=S.timeLeftMinutes,b.set(S.offerId,v)}),s(I.totalItemsFound),c(b)}),x(QE,C=>{const I=C.getParser();if(I)switch(I.result){case 1:p(u);break;case 2:c(b=>{const S=new Map(b);return S.delete(I.requestedOfferId),S}),m(h("catalog.marketplace.not_available_header"),ge.DEFAULT,null,null,h("catalog.marketplace.not_available_title"));break;case 3:c(b=>{const S=new Map(b),v=S.get(I.requestedOfferId);return v&&(v.offerId=I.offerId,v.price=I.newPrice,v.offerCount--,S.set(v.offerId,v)),S.delete(I.requestedOfferId),S}),f(h("catalog.marketplace.confirm_higher_header")+`
`+h("catalog.marketplace.confirm_price",["price"],[I.newPrice.toString()]),()=>{L(new hu(I.offerId))},null,null,null,h("catalog.marketplace.confirm_higher_title"));break;case 4:m(h("catalog.alert.notenough.credits.description"),ge.DEFAULT,null,null,h("catalog.alert.notenough.title"));break}}),l(B,{children:[l(Cr,{children:[t(M,{active:e===qt.BY_ACTIVITY,onClick:()=>n(qt.BY_ACTIVITY),children:h("catalog.marketplace.search_by_activity")}),t(M,{active:e===qt.BY_VALUE,onClick:()=>n(qt.BY_VALUE),children:h("catalog.marketplace.search_by_value")}),t(M,{active:e===qt.ADVANCED,onClick:()=>n(qt.ADVANCED),children:h("catalog.marketplace.search_advanced")})]}),t(xw,{sortTypes:_,searchType:e,onSearch:p}),l(T,{gap:1,overflow:"hidden",children:[t(N,{truncate:!0,shrink:!0,fontWeight:"bold",children:h("catalog.marketplace.items_found",["count"],[a.size.toString()])}),t(T,{className:"nitro-catalog-layout-marketplace-grid",overflow:"auto",children:Array.from(a.values()).map((C,I)=>t(Lh,{offerData:C,type:Ki,onClick:E},I))})]})]})},Hw=i=>{const{page:e=null}=i,[n,r]=o.useState(-1),[s,a]=o.useState([]),[c,u]=o.useState(-1),[d,g]=o.useState([]),[m,f]=o.useState(-1),[p,_]=o.useState(!1),[E,C]=o.useState("");o.useState(!0);const[I,b]=o.useState(-1),{currentOffer:S=null,setCurrentOffer:v=null,setPurchaseOptions:y=null,catalogOptions:R=null,roomPreviewer:O=null}=Pe(),{petPalettes:F=null}=R,U=o.useMemo(()=>!d.length||m===-1?16777215:d[m][0],[d,m]),A=o.useMemo(()=>n===-1||!s.length||c===-1?"":h(`pet.breed.${n}.${s[c].breedId}`),[n,s,c]),k=o.useMemo(()=>{if(!s.length||c===-1)return"";const G=s[c].paletteId;let $=16777215;if(n<=7){if(m===-1)return"";$=d[m][0]}let X=$.toString(16).toUpperCase();for(;X.length<6;)X="0"+X;return`${G}
${X}`},[s,c,n,d,m]),D=o.useMemo(()=>{let G="";switch(I){case 1:G="catalog.alert.petname.long";break;case 2:G="catalog.alert.petname.short";break;case 3:G="catalog.alert.petname.chars";break;case 4:G="catalog.alert.petname.bobba";break}return!G||!G.length?"":h(G)},[I]),V=o.useCallback(()=>{if(I===-1){L(new JE(E,1));return}if(I===0){L(new Ho(e.pageId,S.offerId,`${E}
${k}`,1));return}},[e,S,E,k,I]);return x(ZE,G=>{const $=G.getParser();b($.result),$.result===0?V():yt(new rs(-1))}),o.useEffect(()=>{if(!e||!e.offers.length)return;const G=e.offers[0];v(G),r(iS(G.localizationId)),_(!1)},[e,v]),o.useEffect(()=>{if(!S)return;const G=S.product.productData;if(G){if(F)for(const $ of F){if($.breed!==G.type)continue;const X=[];for(const Y of $.palettes)Y.sellable&&X.push(Y);u(X.length?0:-1),a(X);return}u(-1),a([]),L(new eC(G.type))}},[S,F]),o.useEffect(()=>{if(n===-1)return;const G=oS(n,s);f(G.length?0:-1),g(G)},[n,s]),o.useEffect(()=>{if(!O||(O.reset(!1),n===-1||!s.length||c===-1))return;let G=`${n} ${s[c].paletteId}`;n<=7&&(G+=` ${U.toString(16)}`),O.addPetIntoRoom(G)},[O,n,s,c,U]),o.useEffect(()=>{b(-1)},[E]),S?l(ne,{children:[t(T,{size:7,overflow:"hidden",children:l(De,{columnCount:5,children:[!p&&s.length>0&&s.map((G,$)=>t(be,{itemActive:c===$,onClick:X=>u($),children:t(Ir,{typeId:n,paletteId:G.paletteId,direction:2,headOnly:!0})},$)),p&&d.length>0&&d.map((G,$)=>t(be,{itemHighlight:!0,itemActive:m===$,itemColor:Cn.int2rgb(G[0]),className:"clear-bg",onClick:X=>f($)},$))]})}),l(T,{center:!S,size:5,overflow:"hidden",children:[!S&&l(B,{children:[!!e.localization.getImage(1)&&t("img",{alt:"",src:e.localization.getImage(1)}),t(N,{center:!0,dangerouslySetInnerHTML:{__html:e.localization.getText(0)}})]}),S&&l(B,{children:[l(P,{position:"relative",overflow:"hidden",children:[t(is,{}),t(ss,{position:"absolute",className:"bg-muted rounded bottom-1 end-1"}),n>-1&&n<=7&&t(M,{position:"absolute",className:"bottom-1 start-1",onClick:G=>_(!p),children:t(tm,{className:"fa-icon"})})]}),l(T,{grow:!0,gap:1,children:[t(N,{truncate:!0,children:A}),l(T,{grow:!0,gap:1,children:[t("input",{type:"text",className:"form-control form-control-sm w-100",placeholder:h("widgets.petpackage.name.title"),value:E,onChange:G=>C(G.target.value)}),I>0&&t(P,{className:"invalid-feedback d-block m-0",children:D})]}),t(w,{justifyContent:"end",children:t(jr,{justifyContent:"end",alignItems:"end"})}),t(ar,{purchaseCallback:V})]})]})]})]}):null},Ww=i=>{const{offer:e=null,isAvailable:n=!1,daysRequired:r=0,onSelect:s=null}=i,a=o.useCallback(()=>{if(!e||!e.products.length)return"";const u=e.products[0];return $i.getProductImageUrl(u.productType,u.furniClassId,u.extraParam)},[e]),c=o.useCallback(()=>{if(!e||!e.products.length)return"";const u=e.products[0],d=$i.getProductCategory(u.productType,u.furniClassId)===2?"wallItem.name."+u.furniClassId:"roomItem.name."+u.furniClassId;return h(d)},[e]);return o.useCallback(()=>{if(!e||!e.products.length)return"";const u=e.products[0],d=$i.getProductCategory(u.productType,u.furniClassId)===2?"wallItem.desc."+u.furniClassId:"roomItem.desc."+u.furniClassId;return h(d)},[e]),o.useCallback(()=>Math.floor(r/31),[r]),l(be,{center:!1,column:!1,alignItems:"center",className:"p-1",children:[t(vr,{imageUrl:a()}),t(N,{grow:!0,fontWeight:"bold",children:c()}),t(M,{variant:"secondary",onClick:()=>s(e.localizationId),disabled:!n,children:h("catalog.club_gift.select")})]})},jw=i=>{const{purse:e=null}=Ps(),{catalogOptions:n=null,setCatalogOptions:r=null}=Pe(),{clubGifts:s=null}=n,{showConfirm:a=null}=ze(),c=o.useCallback(()=>s?s.giftsAvailable>0?h("catalog.club_gift.available",["amount"],[s.giftsAvailable.toString()]):s.daysUntilNextGift>0?h("catalog.club_gift.days_until_next",["days"],[s.daysUntilNextGift.toString()]):e.isVip?h("catalog.club_gift.not_available"):h("catalog.club_gift.no_club"):"",[s,e]),u=o.useCallback(g=>{a(h("catalog.club_gift.confirm"),()=>{L(new tC(g)),r(m=>(m.clubGifts.giftsAvailable--,{...m}))},null)},[r,a]),d=o.useMemo(()=>s.offers.sort((m,f)=>s.getOfferExtraData(m.offerId).daysRequired-s.getOfferExtraData(f.offerId).daysRequired),[s]);return l(B,{children:[t(N,{truncate:!0,shrink:!0,fontWeight:"bold",children:c()}),t(De,{columnCount:1,className:"nitro-catalog-layout-vip-gifts-grid",children:s.offers.length>0&&d.map(g=>t(Ww,{offer:g,isAvailable:s.getOfferExtraData(g.offerId).isSelectable&&s.giftsAvailable>0,onSelect:u,daysRequired:s.getOfferExtraData(g.offerId).daysRequired},g.offerId))})]})},qw=(i,e)=>{if(!i)return null;const n={page:i,hideNavigation:e};switch(i.layoutCode){case"frontpage_featured":return null;case"frontpage4":return t(Mw,{...n});case"pets":return t(Hw,{...n});case"pets2":return t(Tw,{...n});case"pets3":return t(Ah,{...n});case"vip_buy":return t(Pw,{...n});case"guild_frontpage":return t(Sw,{...n});case"guild_forum":return t(bw,{...n});case"guild_custom_furni":return t(_w,{...n});case"club_gifts":return t(jw,{...n});case"marketplace_own_items":return t(Uw,{...n});case"marketplace":return t(Bw,{...n});case"single_bundle":return t(Rw,{...n});case"room_bundle":return t(ww,{...n});case"spaces_new":return t(Aw,{...n});case"trophies":return t(Dw,{...n});case"info_loyalty":return t(Nw,{...n});case"badge_display":return t(gw,{...n});case"roomads":return t(vw,{...n});case"default_3x3_color_grouping":return t(Iw,{...n});case"soundmachine":return t(Ow,{...n});case"bots":case"default_3x3":default:return t(Ew,{...n})}},zw=i=>{const[e,n]=o.useState(null),[r,s]=o.useState(0),[a,c]=o.useState("0"),{catalogOptions:u=null,setCatalogOptions:d=null}=Pe(),{marketplaceConfiguration:g=null}=u,{showConfirm:m=null}=ze(),f=I=>{c(I);const b=parseInt(I);isNaN(b)||b===r||s(parseInt(I))};if(x(nC,I=>{const b=I.getParser();d(S=>{const v={...S};return v.marketplaceConfiguration=b,v})}),Qe(fo.POST_MARKETPLACE,I=>n(I.item)),o.useEffect(()=>{!e||g||L(new rC)},[e,g]),o.useEffect(()=>{if(e)return()=>s(0)},[e]),!g||!e)return null;const p=e?h(e.isWallItem?"wallItem.name."+e.type:"roomItem.name."+e.type):"",_=e?h(e.isWallItem?"wallItem.desc."+e.type:"roomItem.desc."+e.type):"",E=()=>Math.max(Math.ceil(g.commission*.01*r),1),C=()=>{!e||r<g.minimumPrice||m(h("inventory.marketplace.confirm_offer.info",["furniname","price"],[p,r.toString()]),()=>{L(new sC(r,e.isWallItem?2:1,e.id)),n(null)},()=>{n(null)},null,null,h("inventory.marketplace.confirm_offer.title"))};return l(ie,{className:"nitro-catalog-layout-marketplace-post-offer",theme:"primary-slim",children:[t(ae,{headerText:h("inventory.marketplace.make_offer.title"),onCloseClick:I=>n(null)}),t(re,{overflow:"hidden",children:l(ne,{fullHeight:!0,children:[t(T,{center:!0,className:"bg-muted rounded p-2",size:4,overflow:"hidden",children:t(Lc,{productType:e.isWallItem?fe.WALL:fe.FLOOR,productClassId:e.type,extraData:e.extra.toString()})}),l(T,{size:8,justifyContent:"between",overflow:"hidden",children:[l(T,{grow:!0,gap:1,children:[t(N,{fontWeight:"bold",children:p}),t(N,{truncate:!0,shrink:!0,children:_})]}),l(T,{overflow:"auto",children:[t(N,{italics:!0,children:h("inventory.marketplace.make_offer.expiration_info",["time"],[g.offerTime.toString()])}),l("div",{className:"input-group has-validation",children:[t("input",{className:"form-control form-control-sm",type:"number",min:0,value:a,onChange:I=>f(I.target.value),placeholder:h("inventory.marketplace.make_offer.price_request")}),(r<g.minimumPrice||isNaN(r))&&t(P,{className:"invalid-feedback d-block",children:h("inventory.marketplace.make_offer.min_price",["minprice"],[g.minimumPrice.toString()])}),r>g.maximumPrice&&!isNaN(r)&&t(P,{className:"invalid-feedback d-block",children:h("inventory.marketplace.make_offer.max_price",["maxprice"],[g.maximumPrice.toString()])}),!(r<g.minimumPrice||r>g.maximumPrice||isNaN(r))&&t(P,{className:"invalid-feedback d-block",children:h("inventory.marketplace.make_offer.final_price",["commission","finalprice"],[E().toString(),(r+E()).toString()])})]}),t(M,{disabled:r<g.minimumPrice||r>g.maximumPrice||isNaN(r),onClick:C,children:h("inventory.marketplace.make_offer.post")})]})]})]})})]})},Yw=i=>{const{isVisible:e=!1,setIsVisible:n=null,rootNode:r=null,currentPage:s=null,navigationHidden:a=!1,setNavigationHidden:c=null,activeNodes:u=[],searchResult:d=null,setSearchResult:g=null,openPageByName:m=null,openPageByOfferId:f=null,activateNode:p=null,getNodeById:_}=Pe();return o.useEffect(()=>{const E={linkReceived:C=>{const I=C.split("/");if(!(I.length<2))switch(I[1]){case"show":n(!0);return;case"hide":n(!1);return;case"toggle":n(b=>!b);return;case"open":if(I.length>2)if(I.length===4)switch(I[2]){case"offerId":f(parseInt(I[3]));return}else m(I[2]);else n(!0);return}},eventUrlPrefix:"catalog/"};return It(E),()=>Et(E)},[n,f,m]),l(B,{children:[e&&l(ie,{uniqueKey:"catalog",className:"nitro-catalog",style:K("catalog.headers")?{width:710}:{},children:[t(ae,{headerText:h("catalog.title"),onCloseClick:E=>n(!1)}),t(Br,{children:r&&r.children.length>0&&r.children.map(E=>E.isVisible?t(sr,{isActive:E.isActive,onClick:C=>{d&&g(null),p(E)},children:l(w,{gap:K("catalog.tab.icons")?1:0,alignItems:"center",children:[K("catalog.tab.icons")&&t(vh,{icon:E.iconId}),E.localization]})},E.pageId):null)}),t(re,{children:l(ne,{children:[!a&&t(T,{size:3,overflow:"hidden",children:u&&u.length>0&&t(mw,{node:u[0]})}),t(T,{size:a?12:9,overflow:"hidden",children:qw(s,()=>c(!0))})]})})]}),t(uw,{}),t(zw,{})]})},$w=i=>{const[e,n]=o.useState(!1),[r,s]=o.useState(""),{chatHistory:a=[]}=el(),c=o.useRef(null),u=o.useMemo(()=>{if(r.length===0)return a;let d=r.toLowerCase();return a.filter(g=>g.message&&g.message.toLowerCase().includes(d)||g.name&&g.name.toLowerCase().includes(d))},[a,r]);return o.useEffect(()=>{c&&c.current&&e&&(c.current.scrollTop=c.current.scrollHeight)},[e]),o.useEffect(()=>{const d={linkReceived:g=>{const m=g.split("/");if(!(m.length<2))switch(m[1]){case"show":n(!0);return;case"hide":n(!1);return;case"toggle":n(f=>!f);return}},eventUrlPrefix:"chat-history/"};return It(d),()=>Et(d)},[]),e?l(ie,{uniqueKey:"chat-history",className:"nitro-chat-history",theme:"primary-slim",children:[t(ae,{headerText:h("room.chathistory.button.text"),onCloseClick:d=>n(!1)}),l(re,{innerRef:c,overflow:"hidden",gap:2,children:[t("input",{type:"text",className:"form-control form-control-sm",placeholder:h("generic.search"),value:r,onChange:d=>s(d.target.value)}),t(Qo,{rows:u,scrollToBottom:!0,rowRender:d=>l(w,{alignItems:"center",className:"p-1",gap:2,children:[t(N,{variant:"muted",children:d.timestamp}),d.type===rr.TYPE_CHAT&&l("div",{className:"bubble-container",style:{position:"relative"},children:[d.style===0&&t("div",{className:"user-container-bg",style:{backgroundColor:d.color}}),l("div",{className:`chat-bubble bubble-${d.style} type-${d.chatType}`,style:{maxWidth:"100%"},children:[t("div",{className:"user-container",children:d.imageUrl&&d.imageUrl.length>0&&t("div",{className:"user-image",style:{backgroundImage:`url(${d.imageUrl})`}})}),l("div",{className:"chat-content",children:[t("b",{className:"username mr-1",dangerouslySetInnerHTML:{__html:`${d.name}: `}}),t("span",{className:"message",dangerouslySetInnerHTML:{__html:`${d.message}`}})]})]})]}),d.type===rr.TYPE_ROOM_INFO&&l(B,{children:[t("i",{className:"icon icon-small-room"}),t(N,{textBreak:!0,wrap:!0,grow:!0,children:d.name})]})]})})]})]}):null},qn=32,ms=64,ba="x0123456789abcdefghijklmnopq",Es=class Es{};Es.DOOR=0,Es.UP=1,Es.DOWN=2,Es.SET=3,Es.UNSET=4;let Lt=Es;const Kw={x:"101010",0:"0065ff",1:"0091ff",2:"00bcff",3:"00e8ff",4:"00ffea",5:"00ffbf",6:"00ff93",7:"00ff68",8:"00ff3d",9:"19ff00",a:"44ff00",b:"70ff00",c:"9bff00",d:"f2ff00",e:"ffe000",f:"ffb500",g:"ff8900",h:"ff5e00",i:"ff3200",j:"ff0700",k:"ff0023",l:"ff007a",m:"ff00a5",n:"ff00d1",o:"ff00fc",p:"d600ff",q:"aa00ff"};class Xw{constructor(){this._currentAction=Lt.SET,this._currentHeight=ba[1]}get currentAction(){return this._currentAction}set currentAction(e){this._currentAction=e}get currentHeight(){return this._currentHeight}set currentHeight(e){this._currentHeight=e}clear(){this._currentAction=Lt.SET,this._currentHeight=ba[1]}}class Ui{constructor(e,n){this._height=e,this._isBlocked=n}get height(){return this._height}set height(e){this._height=e}get isBlocked(){return this._isBlocked}set isBlocked(e){this._isBlocked=e}}const Qw=(i,e)=>{let n=i*qn/2-e*qn/2;const r=i*qn/4+e*qn/4;return n=n+1024,[n,r]},Jw=(i,e)=>{const n=i-1024,r=(n/(qn/2)+e/(qn/4))/2,s=(e/(qn/4)-n/(qn/2))/2;return[r,s]},po=i=>{switch(i=parseInt(i.toString()),i){case 0:return-2;case 1:return-1;case 3:return 1;default:return 0}},xi=i=>{switch(i){case .25:return 0;case .5:return 1;case 2:return 3;default:return 2}},Jn=class Jn extends aC{constructor(){const e=qn*ms+20,n=qn*ms/2+100;super({width:e,height:n,backgroundColor:0,antialias:!0,autoDensity:!0,resolution:1,sharedLoader:!0,sharedTicker:!0}),this._tilemap=[],this._doorLocation=new es(0,0),this._width=0,this._height=0,this._isHolding=!1,this._lastUsedTile=new es(-1,-1),this._actionSettings=new Xw}initialize(){if(this._isInitialized)return;const e=Om().getCollection("floor_editor");e&&(this._assetCollection=e,this._tilemapRenderer=new iC(e.baseTexture),this.registerEventListeners(),this.stage.addChild(this._tilemapRenderer),this._isInitialized=!0)}registerEventListeners(){const e=new es;this._tilemapRenderer.containsPoint=n=>(this._tilemapRenderer.worldTransform.applyInverse(n,e),this.tileHitDetection(e,!1)),this._tilemapRenderer.on("pointerup",()=>{this._isHolding=!1}),this._tilemapRenderer.on("pointerout",()=>{this._isHolding=!1}),this._tilemapRenderer.on("pointerdown",n=>{if(!(n.data.originalEvent instanceof PointerEvent)&&!(n.data.originalEvent instanceof TouchEvent))return;const r=n.data.originalEvent;if(r instanceof MouseEvent&&r.button===2)return;const s=n.data.global;this.tileHitDetection(s,!0)}),this._tilemapRenderer.on("click",n=>{if(!(n.data.originalEvent instanceof PointerEvent)||n.data.originalEvent.button===2)return;const s=n.data.global;this.tileHitDetection(s,!0,!0)})}tileHitDetection(e,n,r=!1){const s=this._tilemapRenderer.pointsBuf,a=sg,c=s.length;n&&(this._isHolding=!0);for(let u=0;u<c;u+=a){const d=u+a,g=s.slice(u,d),m=qn,f=qn/2,p=Math.floor(e.x),_=Math.floor(e.y),E=g[2],C=g[3],I=E+m/2,b=C+f/2,S=Math.abs(p-I),v=Math.abs(_-b);if(S/(m*.5)+v/(f*.5)<=1){if(this._isHolding){const[R,O]=Jw(E,C);r?this.onClick(R,O):(this._lastUsedTile.x!==R||this._lastUsedTile.y!==O)&&(this._lastUsedTile.x=R,this._lastUsedTile.y=O,this.onClick(R,O))}return!0}}return!1}onClick(e,n){const r=this._tilemap[n][e],s=ba.indexOf(r.height);let a=0;switch(this._actionSettings.currentAction){case Lt.DOOR:r.height!=="x"&&(this._doorLocation.x=e,this._doorLocation.y=n,this.renderTiles());return;case Lt.UP:if(r.height==="x")return;a=s+1;break;case Lt.DOWN:if(r.height==="x"||s<=1)return;a=s-1;break;case Lt.SET:a=ba.indexOf(this._actionSettings.currentHeight);break;case Lt.UNSET:a=0;break}if(a===-1||s===a)return;a>0&&(e+1>this._width&&(this._width=e+1),n+1>this._height&&(this._height=n+1));const c=ba[a];c&&(r.isBlocked||(this._tilemap[n][e].height=c,this.renderTiles()))}renderTiles(){this.tilemapRenderer.clear();for(let e=0;e<this._tilemap.length;e++)for(let n=0;n<this.tilemap[e].length;n++){const r=this.tilemap[e][n];let s=r.height;this._doorLocation.x===n&&this._doorLocation.y===e&&(s=Jn.TILE_DOOR),r.isBlocked&&(s=Jn.TILE_BLOCKED);const[a,c]=Qw(n,e);this._tilemapRenderer.tile(this._assetCollection.getTexture(`floor_editor_${s}`),a,c)}}setTilemap(e,n){this._tilemap=[];const r=e.split("\r");let s=0,a=r.length;for(let c=0;c<a;c++){const u=r[c];if(u.length===0){r.splice(c,1),a=r.length,c--;continue}u.length>s&&(s=u.length)}for(let c=0;c<a;c++){this._tilemap[c]=[];const u=r[c];for(let d=0;d<s;d++){const g=n[c]&&n[c][d]||!1,m=u[d];m!=="x"&&m!=="X"&&m?this._tilemap[c][d]=new Ui(m,g):this._tilemap[c][d]=new Ui("x",g)}for(let d=s;d<ms;d++)this.tilemap[c][d]=new Ui("x",!1)}for(let c=a;c<ms;c++){this.tilemap[c]||(this.tilemap[c]=[]);for(let u=0;u<ms;u++)this.tilemap[c][u]=new Ui("x",!1)}this._width=s,this._height=a}getCurrentTilemapString(){if(this._tilemap[this._height-1][this._width-1].height==="x"){this._width=-1,this._height=-1;for(let r=ms-1;r>=0;r--)if(this._tilemap[r])for(let s=ms-1;s>=0;s--){if(!this._tilemap[r][s])continue;this._tilemap[r][s].height!=="x"&&(s+1>this._width&&(this._width=s+1),r+1>this._height&&(this._height=r+1))}}const n=[];for(let r=0;r<this._height;r++){const s=[];for(let a=0;a<this._width;a++){const c=this._tilemap[r][a];s[a]=c.height}n[r]=s.join("")}return n.join("\r")}clear(){this._tilemapRenderer.interactive=!1,this._tilemap=[],this._doorLocation.set(-1,-1),this._width=0,this._height=0,this._isHolding=!1,this._lastUsedTile.set(-1,-1),this._actionSettings.clear(),this._tilemapRenderer.clear()}get tilemapRenderer(){return this._tilemapRenderer}get tilemap(){return this._tilemap}get doorLocation(){return this._doorLocation}set doorLocation(e){this._doorLocation=e}get actionSettings(){return this._actionSettings}static get instance(){return Jn._INSTANCE||(Jn._INSTANCE=new Jn),Jn._INSTANCE}};Jn._INSTANCE=null,Jn.TILE_BLOCKED="r_blocked",Jn.TILE_DOOR="r_door";let Bt=Jn;const Mh=o.createContext({originalFloorplanSettings:null,setOriginalFloorplanSettings:null,visualizationSettings:null,setVisualizationSettings:null}),Zw=i=>t(Mh.Provider,{...i}),jc=()=>o.useContext(Mh),eR=i=>{const{gap:e=1,children:n=null,...r}=i,[s,a]=o.useState(!1),[c,u]=o.useState(!1),{originalFloorplanSettings:d=null,setOriginalFloorplanSettings:g=null,setVisualizationSettings:m=null}=jc(),f=o.useRef(null);x(oC,_=>{const E=_.getParser();g(C=>{const I={...C};return I.reservedTiles=E.blockedTilesMap,Bt.instance.setTilemap(I.tilemap,I.reservedTiles),I}),a(!0),f.current.scrollTo(Bt.instance.view.width/3,0)}),x(lC,_=>{const E=_.getParser();g(C=>{const I={...C};return I.entryPoint=[E.x,E.y],I.entryPointDir=E.direction,I}),m(C=>{const I={...C};return I.entryPointDir=E.direction,I}),Bt.instance.doorLocation=new es(E.x,E.y),u(!0)});const p=_=>{const E=f.current;if(E)switch(_){case"up":E.scrollBy({top:-10});break;case"down":E.scrollBy({top:10});break;case"left":E.scrollBy({left:-10});break;case"right":E.scrollBy({left:10});break}};return o.useEffect(()=>()=>{Bt.instance.clear(),m(_=>({wallHeight:d.wallHeight,thicknessWall:d.thicknessWall,thicknessFloor:d.thicknessFloor,entryPointDir:_.entryPointDir}))},[d.thicknessFloor,d.thicknessWall,d.wallHeight,m]),o.useEffect(()=>{!c||!s||Bt.instance.renderTiles()},[c,s]),o.useEffect(()=>{L(new cC),L(new uC),Bt.instance.tilemapRenderer.interactive=!0,f.current&&f.current.appendChild(Bt.instance.renderer.view)},[]),l(T,{gap:e,...r,children:[l(ne,{overflow:"hidden",gap:1,children:[t(T,{center:!0,size:1,children:t(M,{className:"d-md-none",onClick:_=>p("left"),children:t(nm,{className:"fa-icon"})})}),l(T,{overflow:"hidden",size:10,gap:1,children:[t(w,{justifyContent:"center",className:"d-md-none",children:t(M,{shrink:!0,onClick:_=>p("up"),children:t(ag,{className:"fa-icon"})})}),t(P,{overflow:"auto",innerRef:f}),t(w,{justifyContent:"center",className:"d-md-none",children:t(M,{shrink:!0,onClick:_=>p("down"),children:t(ig,{className:"fa-icon"})})})]}),t(T,{center:!0,size:1,children:t(M,{className:"d-md-none",onClick:_=>p("right"),children:t(rm,{className:"fa-icon"})})})]}),n]})},id=i=>i.replace(/\r\n|\r|\n/g,`
`).toLowerCase(),tR=i=>{const{onCloseClick:e=null}=i,[n,r]=o.useState(""),{originalFloorplanSettings:s=null}=jc(),a=()=>{L(new ym(n.split(`
`).join("\r"),s.entryPoint[0],s.entryPoint[1],s.entryPointDir,po(s.thicknessWall),po(s.thicknessFloor),s.wallHeight-1))};return Nh(()=>{r(id(s.tilemap))}),l(ie,{theme:"primary-slim",className:"floorplan-import-export",children:[t(ae,{headerText:h("floor.plan.editor.import.export"),onCloseClick:e}),l(re,{children:[t("textarea",{className:"h-100",value:n,onChange:c=>r(c.target.value)}),l(w,{justifyContent:"between",children:[t(M,{onClick:c=>r(id(s.tilemap)),children:h("floor.plan.editor.revert.to.last.received.map")}),t(M,{onClick:a,children:h("floor.plan.editor.save")})]})]})]})},od=0,Fi=16,nR=0,rR=26,sR=i=>{const{visualizationSettings:e=null,setVisualizationSettings:n=null}=jc(),[r,s]=o.useState(Lt.SET),[a,c]=o.useState(0),u=C=>{s(C),Bt.instance.actionSettings.currentAction=C},d=()=>{n(C=>{const I={...C};return I.entryPointDir<7?++I.entryPointDir:I.entryPointDir=0,I})},g=C=>{(isNaN(C)||C<=0)&&(C=0),C>26&&(C=26),c(C),Bt.instance.actionSettings.currentHeight=C.toString(36)},m=C=>{n(I=>{const b={...I};return b.thicknessFloor=C,b})},f=C=>{n(I=>{const b={...I};return b.thicknessWall=C,b})},p=C=>{(isNaN(C)||C<=0)&&(C=od),C>Fi&&(C=Fi),n(I=>{const b={...I};return b.wallHeight=C,b})},_=()=>{let C=e.wallHeight+1;C>Fi&&(C=Fi),p(C)},E=()=>{let C=e.wallHeight-1;C<=0&&(C=od),p(C)};return l(T,{children:[l(w,{gap:1,children:[l(T,{size:5,gap:1,children:[t(N,{bold:!0,children:h("floor.plan.editor.draw.mode")}),l(w,{gap:3,children:[l(w,{gap:1,children:[t(be,{itemActive:r===Lt.SET,onClick:C=>u(Lt.SET),children:t("i",{className:"icon icon-set-tile"})}),t(be,{itemActive:r===Lt.UNSET,onClick:C=>u(Lt.UNSET),children:t("i",{className:"icon icon-unset-tile"})})]}),l(w,{gap:1,children:[t(be,{itemActive:r===Lt.UP,onClick:C=>u(Lt.UP),children:t("i",{className:"icon icon-increase-height"})}),t(be,{itemActive:r===Lt.DOWN,onClick:C=>u(Lt.DOWN),children:t("i",{className:"icon icon-decrease-height"})})]}),t(be,{itemActive:r===Lt.DOOR,onClick:C=>u(Lt.DOOR),children:t("i",{className:"icon icon-set-door"})})]})]}),l(T,{alignItems:"center",size:4,children:[t(N,{bold:!0,children:h("floor.plan.editor.enter.direction")}),t("i",{className:`icon icon-door-direction-${e.entryPointDir} cursor-pointer`,onClick:d})]}),l(T,{size:3,children:[t(N,{bold:!0,children:h("floor.editor.wall.height")}),l(w,{alignItems:"center",gap:1,children:[t(Zd,{className:"cursor-pointer fa-icon",onClick:E}),t("input",{type:"number",className:"form-control form-control-sm quantity-input",value:e.wallHeight,onChange:C=>p(C.target.valueAsNumber)}),t(em,{className:"cursor-pointer fa-icon",onClick:_})]})]})]}),l(w,{gap:1,children:[l(T,{size:6,children:[l(N,{bold:!0,children:[h("floor.plan.editor.tile.height"),": ",a]}),t(Mt,{className:"nitro-slider",min:nR,max:rR,step:1,value:a,onChange:C=>g(C),renderThumb:({style:C,...I},b)=>t("div",{style:{backgroundColor:`#${Kw[b.valueNow.toString(33)]}`,...C},...I,children:b.valueNow})})]}),l(T,{size:6,children:[t(N,{bold:!0,children:h("floor.plan.editor.room.options")}),l(w,{className:"align-items-center",children:[l("select",{className:"form-control form-control-sm",value:e.thicknessWall,onChange:C=>f(parseInt(C.target.value)),children:[t("option",{value:0,children:h("navigator.roomsettings.wall_thickness.thinnest")}),t("option",{value:1,children:h("navigator.roomsettings.wall_thickness.thin")}),t("option",{value:2,children:h("navigator.roomsettings.wall_thickness.normal")}),t("option",{value:3,children:h("navigator.roomsettings.wall_thickness.thick")})]}),l("select",{className:"form-control form-control-sm",value:e.thicknessFloor,onChange:C=>m(parseInt(C.target.value)),children:[t("option",{value:0,children:h("navigator.roomsettings.floor_thickness.thinnest")}),t("option",{value:1,children:h("navigator.roomsettings.floor_thickness.thin")}),t("option",{value:2,children:h("navigator.roomsettings.floor_thickness.normal")}),t("option",{value:3,children:h("navigator.roomsettings.floor_thickness.thick")})]})]})]})]})]})},aR=i=>{const[e,n]=o.useState(!1),[r,s]=o.useState(!1),[a,c]=o.useState({tilemap:"",reservedTiles:[],entryPoint:[0,0],entryPointDir:2,wallHeight:-1,thicknessWall:1,thicknessFloor:1}),[u,d]=o.useState({entryPointDir:2,wallHeight:-1,thicknessWall:1,thicknessFloor:1}),g=()=>{L(new ym(Bt.instance.getCurrentTilemapString(),Bt.instance.doorLocation.x,Bt.instance.doorLocation.y,u.entryPointDir,po(u.thicknessWall),po(u.thicknessFloor),u.wallHeight-1))},m=()=>{d({wallHeight:a.wallHeight,thicknessWall:a.thicknessWall,thicknessFloor:a.thicknessFloor,entryPointDir:a.entryPointDir}),Bt.instance.doorLocation=new es(a.entryPoint[0],a.entryPoint[1]),Bt.instance.setTilemap(a.tilemap,a.reservedTiles),Bt.instance.renderTiles()};return Ne(yn.DISPOSED,f=>n(!1)),x(dC,f=>{const p=f.getParser();c(_=>{const E={..._};return E.tilemap=p.model,E.wallHeight=p.wallHeight+1,E}),d(_=>{const E={..._};return E.wallHeight=p.wallHeight+1,E})}),x(mC,f=>{const p=f.getParser();c(_=>{const E={..._};return E.thicknessFloor=xi(p.thicknessFloor),E.thicknessWall=xi(p.thicknessWall),E}),d(_=>{const E={..._};return E.thicknessFloor=xi(p.thicknessFloor),E.thicknessWall=xi(p.thicknessWall),E})}),o.useEffect(()=>{const f={linkReceived:p=>{const _=p.split("/");if(!(_.length<2))switch(_[1]){case"show":n(!0);return;case"hide":n(!1);return;case"toggle":n(E=>!E);return}},eventUrlPrefix:"floor-editor/"};return It(f),()=>Et(f)},[]),o.useEffect(()=>{Bt.instance.initialize()},[]),l(Zw,{value:{originalFloorplanSettings:a,setOriginalFloorplanSettings:c,visualizationSettings:u,setVisualizationSettings:d},children:[e&&l(ie,{uniqueKey:"floorpan-editor",className:"nitro-floorplan-editor",theme:"primary-slim",children:[t(ae,{headerText:h("floor.plan.editor.title"),onCloseClick:()=>n(!1)}),l(re,{overflow:"hidden",children:[t(sR,{}),t(eR,{overflow:"hidden"}),l(w,{justifyContent:"between",children:[t(M,{onClick:m,children:h("floor.plan.editor.reload")}),l(Cr,{children:[t(M,{disabled:!0,children:h("floor.plan.editor.preview")}),t(M,{onClick:f=>s(!0),children:h("floor.plan.editor.import.export")}),t(M,{onClick:g,children:h("floor.plan.editor.save")})]})]})]})]}),r&&t(tR,{onCloseClick:()=>s(!1)})]})},iR=i=>{const{friend:e=null}=i,[n,r]=o.useState(!1),{followFriend:s=null}=Nn(),a=o.useRef();return o.useEffect(()=>{const c=u=>{const d=a.current;d&&u.target!==d&&!d.contains(u.target)&&r(!1)};return document.addEventListener(Oe.MOUSE_CLICK,c),()=>document.removeEventListener(Oe.MOUSE_CLICK,c)},[]),e?l("div",{ref:a,className:"btn btn-success friend-bar-item "+(n?"friend-bar-item-active":""),onClick:c=>r(u=>!u),children:[l("div",{className:`friend-bar-item-head position-absolute ${e.id>0?"avatar":"group"}`,children:[e.id>0&&t(it,{headOnly:!0,figure:e.figure,direction:2}),e.id<=0&&t(We,{isGroup:!0,badgeCode:e.figure})]}),t("div",{className:"text-truncate",children:e.name}),n&&l("div",{className:"d-flex justify-content-between",children:[t(P,{className:"nitro-friends-spritesheet icon-friendbar-chat cursor-pointer",onClick:c=>Yo(e.id)}),e.followingAllowed&&t(P,{className:"nitro-friends-spritesheet icon-friendbar-visit cursor-pointer",onClick:c=>s(e)}),t(P,{className:"nitro-friends-spritesheet icon-profile cursor-pointer",onClick:c=>hn(e.id)})]})]}):l("div",{ref:a,className:"btn btn-primary friend-bar-item friend-bar-search",children:[t("div",{className:"friend-bar-item-head position-absolute"}),t("div",{className:"text-truncate",children:h("friend.bar.find.title")})]})},Rl=6,oR=i=>{const{onlineFriends:e=null}=i,[n,r]=o.useState(0),s=o.useRef();return l(w,{innerRef:s,alignItems:"center",className:"friend-bar",children:[t(M,{variant:"black",className:"friend-bar-button",disabled:n<=0,onClick:a=>r(n-1),children:t(In,{className:"fa-icon"})}),Array.from(Array(Rl),(a,c)=>t(iR,{friend:e[n+c]||null},c)),t(M,{variant:"black",className:"friend-bar-button",disabled:!(e.length>Rl&&n+Rl<=e.length-1),onClick:a=>r(n+1),children:t(En,{className:"fa-icon"})})]})},lR=i=>{const{friend:e=null,selected:n=!1,selectFriend:r=null}=i,[s,a]=o.useState(!1),{followFriend:c=null,updateRelationship:u=null}=Nn(),d=_=>{_.stopPropagation(),c(e)},g=_=>{_.stopPropagation(),Yo(e.id)},m=_=>{_.stopPropagation(),a(!0)},f=(_,E)=>{_.stopPropagation(),u(e,E),a(!1)},p=()=>{if(!e)return"none";switch(e.relationshipStatus){case dn.RELATIONSHIP_HEART:return"heart";case dn.RELATIONSHIP_SMILE:return"smile";case dn.RELATIONSHIP_BOBBA:return"bobba";default:return"none"}};return e?l(ho,{justifyContent:"between",className:`px-2 py-1 ${n&&"bg-primary text-white"}`,onClick:_=>r(e.id),children:[l(w,{alignItems:"center",gap:1,children:[t(P,{onClick:_=>_.stopPropagation(),children:t(An,{userId:e.id})}),t("div",{children:e.name})]}),l(w,{alignItems:"center",gap:1,children:[!s&&l(B,{children:[e.followingAllowed&&t(P,{pointer:!0,onClick:d,className:"nitro-friends-spritesheet icon-follow",title:h("friendlist.tip.follow")}),e.online&&t(P,{pointer:!0,className:"nitro-friends-spritesheet icon-chat",onClick:g,title:h("friendlist.tip.im")}),e.id>0&&t(P,{className:`nitro-friends-spritesheet icon-${p()} cursor-pointer`,onClick:m,title:h("infostand.link.relationship")})]}),s&&l(B,{children:[t(P,{pointer:!0,className:"nitro-friends-spritesheet icon-heart",onClick:_=>f(_,dn.RELATIONSHIP_HEART)}),t(P,{pointer:!0,className:"nitro-friends-spritesheet icon-smile",onClick:_=>f(_,dn.RELATIONSHIP_SMILE)}),t(P,{pointer:!0,className:"nitro-friends-spritesheet icon-bobba",onClick:_=>f(_,dn.RELATIONSHIP_BOBBA)}),t(P,{pointer:!0,className:"nitro-friends-spritesheet icon-none",onClick:_=>f(_,dn.RELATIONSHIP_NONE)})]})]})]}):null},ld=i=>{const{list:e=null,selectedFriendsIds:n=null,selectFriend:r=null}=i;return!e||!e.length?null:t(B,{children:e.map((s,a)=>t(lR,{friend:s,selected:n&&n.indexOf(s.id)>=0,selectFriend:r},a))})},cR=i=>{const{request:e=null}=i,{requestResponse:n=null}=Nn();return e?l(ho,{justifyContent:"between",className:"px-2 py-1",children:[l(w,{alignItems:"center",gap:1,children:[t(An,{userId:e.id}),t("div",{children:e.name})]}),l(w,{alignItems:"center",gap:1,children:[t(P,{className:"nitro-friends-spritesheet icon-accept cursor-pointer",onClick:r=>n(e.id,!0)}),t(P,{className:"nitro-friends-spritesheet icon-deny cursor-pointer",onClick:r=>n(e.id,!1)})]})]}):null},uR=i=>{const{children:e=null,...n}=i,{requests:r=[],requestResponse:s=null}=Nn();return r.length?l(go,{...n,children:[l(T,{fullHeight:!0,justifyContent:"between",gap:1,children:[t(T,{gap:0,children:r.map((a,c)=>t(cR,{request:a},c))}),t(w,{justifyContent:"center",className:"px-2 py-1",children:t(M,{onClick:a=>s(-1,!1),children:h("friendlist.requests.dismissall")})})]}),e]}):null},dR=i=>{const{selectedFriendsIds:e=null,removeFriendsText:n=null,removeSelectedFriends:r=null,onCloseClick:s=null}=i;return l(ie,{className:"nitro-friends-remove-confirmation",theme:"primary-slim",children:[t(ae,{headerText:h("friendlist.removefriendconfirm.title"),onCloseClick:s}),l(re,{className:"text-black",children:[t("div",{children:n}),l(w,{gap:1,children:[t(M,{fullWidth:!0,variant:"danger",disabled:e.length===0,onClick:r,children:h("generic.ok")}),t(M,{fullWidth:!0,onClick:s,children:h("generic.cancel")})]})]})]})},mR=i=>{const{selectedFriendsIds:e=null,onCloseClick:n=null,sendRoomInvite:r=null}=i,[s,a]=o.useState("");return l(ie,{className:"nitro-friends-room-invite",uniqueKey:"nitro-friends-room-invite",theme:"primary-slim",children:[t(ae,{headerText:h("friendlist.invite.title"),onCloseClick:n}),l(re,{className:"text-black",children:[h("friendlist.invite.summary",["count"],[e.length.toString()]),t("textarea",{className:"form-control",value:s,maxLength:255,onChange:c=>a(c.target.value)}),t(N,{center:!0,className:"bg-muted rounded p-1",children:h("friendlist.invite.note")}),l(w,{gap:1,children:[t(M,{fullWidth:!0,variant:"success",disabled:s.length===0||e.length===0,onClick:()=>r(s),children:h("friendlist.invite.send")}),t(M,{fullWidth:!0,onClick:n,children:h("generic.cancel")})]})]})]})},hR=i=>{const{...e}=i,[n,r]=o.useState(""),[s,a]=o.useState(null),[c,u]=o.useState(null),{canRequestFriend:d=null,requestFriend:g=null}=Nn();return x(hC,m=>{const f=m.getParser();a(f.friends),u(f.others)}),o.useEffect(()=>{if(!n||!n.length)return;const m=setTimeout(()=>{!n||!n.length||L(new gC(n))},500);return()=>clearTimeout(m)},[n]),l(go,{...e,children:[t("input",{type:"text",className:"search-input form-control form-control-sm w-100 rounded-0",placeholder:h("generic.search"),value:n,maxLength:50,onChange:m=>r(m.target.value)}),l(T,{children:[s&&l(B,{children:[s.length===0&&t(N,{bold:!0,small:!0,className:"px-2 py-1",children:h("friendlist.search.nofriendsfound")}),s.length>0&&l(T,{gap:0,children:[t(N,{bold:!0,small:!0,className:"px-2 py-1",children:h("friendlist.search.friendscaption",["cnt"],[s.length.toString()])}),t("hr",{className:"mx-2 mt-0 mb-1 text-black"}),t(T,{gap:0,children:s.map(m=>l(ho,{justifyContent:"between",className:"px-2 py-1",children:[l(w,{alignItems:"center",gap:1,children:[t(An,{userId:m.avatarId}),t("div",{children:m.avatarName})]}),t(w,{alignItems:"center",gap:1,children:m.isAvatarOnline&&t(P,{className:"nitro-friends-spritesheet icon-chat cursor-pointer",onClick:f=>Yo(m.avatarId),title:h("friendlist.tip.im")})})]},m.avatarId))})]})]}),c&&l(B,{children:[c.length===0&&t(N,{bold:!0,small:!0,className:"px-2 py-1",children:h("friendlist.search.noothersfound")}),c.length>0&&l(T,{gap:0,children:[t(N,{bold:!0,small:!0,className:"px-2 py-1",children:h("friendlist.search.otherscaption",["cnt"],[c.length.toString()])}),t("hr",{className:"mx-2 mt-0 mb-1 text-black"}),t(T,{gap:0,children:c.map(m=>l(ho,{justifyContent:"between",className:"px-2 py-1",children:[l(w,{alignItems:"center",gap:1,children:[t(An,{userId:m.avatarId}),t("div",{children:m.avatarName})]}),t(w,{alignItems:"center",gap:1,children:d(m.avatarId)&&t(P,{className:"nitro-friends-spritesheet icon-add cursor-pointer",onClick:f=>g(m.avatarId,m.avatarName),title:h("friendlist.tip.addfriend")})})]},m.avatarId))})]})]})]})]})},gR=i=>{const[e,n]=o.useState(!1),[r,s]=o.useState([]),[a,c]=o.useState(!1),[u,d]=o.useState(!1),{onlineFriends:g=[],offlineFriends:m=[],requests:f=[],requestFriend:p=null}=Nn(),_=o.useMemo(()=>{if(!r||!r.length)return"";const b=[];for(const S of r){let v=g.find(y=>y.id===S);v||(v=m.find(y=>y.id===S)),v&&b.push(v.name)}return h("friendlist.removefriendconfirm.userlist",["user_names"],[b.join(", ")])},[m,g,r]),E=o.useCallback(b=>{b<0||s(S=>{const v=[...S],y=v.indexOf(b);return y>-1?v.splice(y,1):v.push(b),v})},[s]),C=b=>{!r.length||!b||!b.length||b.length>255||(L(new fC(b,r)),c(!1))},I=()=>{r.length!==0&&(s(b=>(L(new pC(...b)),[])),d(!1))};return o.useEffect(()=>{const b={linkReceived:S=>{const v=S.split("/");if(!(v.length<2))switch(v[1]){case"show":n(!0);return;case"hide":n(!1);return;case"toggle":n(y=>!y);return;case"request":if(v.length<4)return;p(parseInt(v[2]),v[3])}},eventUrlPrefix:"friends/"};return It(b),()=>Et(b)},[p]),e?l(B,{children:[l(ie,{className:"nitro-friends",uniqueKey:"nitro-friends",theme:"primary-slim",children:[t(ae,{headerText:h("friendlist.friends"),onCloseClick:b=>n(!1)}),l(re,{overflow:"hidden",gap:1,className:"text-black p-0",children:[l(IN,{fullHeight:!0,overflow:"hidden",children:[t(go,{headerText:h("friendlist.friends")+` (${g.length})`,isExpanded:!0,children:t(ld,{list:g,selectedFriendsIds:r,selectFriend:E})}),t(go,{headerText:h("friendlist.friends.offlinecaption")+` (${m.length})`,children:t(ld,{list:m,selectedFriendsIds:r,selectFriend:E})}),t(uR,{headerText:h("friendlist.tab.friendrequests")+` (${f.length})`,isExpanded:!0}),t(hR,{headerText:h("people.search.title")})]}),r&&r.length>0&&l(w,{gap:1,className:"p-1",children:[t(M,{fullWidth:!0,onClick:()=>c(!0),children:h("friendlist.tip.invite")}),t(M,{fullWidth:!0,variant:"danger",onClick:b=>d(!0),children:h("generic.delete")})]})]})]}),a&&t(mR,{selectedFriendsIds:r,onCloseClick:()=>c(!1),sendRoomInvite:C}),u&&t(dR,{selectedFriendsIds:r,removeFriendsText:_,onCloseClick:()=>d(!1),removeSelectedFriends:I})]}):null},fR=i=>{const{thread:e=null,group:n=null}=i,r=o.useMemo(()=>n.type===Ss.GROUP_CHAT&&Zm(n.chats[0].extraData),[n]),s=o.useMemo(()=>!e||!n?!1:!!(n.type===Ss.PRIVATE_CHAT&&n.userId===W().userId||r&&n.chats.length&&r.userId===W().userId),[e,n,r]);return!e||!n?null:n.userId?l(w,{fullWidth:!0,justifyContent:s?"end":"start",gap:2,children:[l(P,{shrink:!0,className:"message-avatar",children:[n.type===Ss.PRIVATE_CHAT&&!s&&t(it,{figure:e.participant.figure,direction:2}),r&&!s&&t(it,{figure:r.figure,direction:2})]}),l(P,{className:"bg-light text-black border-radius mb-2 rounded py-1 px-2 messages-group-"+(s?"right":"left"),children:[l(P,{className:"fw-bold",children:[s&&W().userName,!s&&(r?r.username:e.participant.name)]}),n.chats.map((a,c)=>t(P,{className:"text-break",children:a.message},c))]}),s&&t(P,{shrink:!0,className:"message-avatar",children:t(it,{figure:W().figure,direction:4})})]}):t(B,{children:n.chats.map((a,c)=>t(w,{fullWidth:!0,gap:2,justifyContent:"start",children:l(P,{className:"w-100 text-break",children:[a.type===Fr.SECURITY_NOTIFICATION&&l(w,{gap:2,alignItems:"center",className:"bg-light rounded mb-2 px-2 py-1 small text-muted",children:[t(P,{className:"nitro-friends-spritesheet icon-warning flex-shrink-0"}),t(P,{children:a.message})]}),a.type===Fr.ROOM_INVITE&&l(w,{gap:2,alignItems:"center",className:"bg-light rounded mb-2 px-2 py-1 small text-black",children:[t(P,{className:"messenger-notification-icon flex-shrink-0"}),l(P,{children:[h("messenger.invitation")+" ",a.message]})]})]})},c))})},pR=i=>{const{thread:e=null}=i;return e.setRead(),t(B,{children:e.groups.length>0&&e.groups.map((n,r)=>t(fR,{thread:e,group:n},r))})},IR=i=>{const[e,n]=o.useState(!1),[r,s]=o.useState(-1),[a,c]=o.useState(""),{visibleThreads:u=[],activeThread:d=null,getMessageThread:g=null,sendMessage:m=null,setActiveThreadId:f=null,closeThread:p=null}=fh(),{report:_=null}=zn(),E=o.useRef(),C=()=>d&&d.participant&&L(new Wo(d.participant.id)),I=()=>d&&d.participant&&hn(d.participant.id),b=()=>{!d||!a.length||(m(d,W().userId,a),c(""))},S=v=>{v.key==="Enter"&&b()};return o.useEffect(()=>{const v={linkReceived:y=>{const R=y.split("/");if(R.length===2){if(R[1]==="open"){n(!0);return}if(R[1]==="toggle"){n(F=>!F);return}const O=g(parseInt(R[1]));if(!O)return;f(O.threadId),n(!0)}},eventUrlPrefix:"friends-messenger/"};return It(v),()=>Et(v)},[g,f]),o.useEffect(()=>{!e||!d||(E.current.scrollTop=E.current.scrollHeight)},[e,d]),o.useEffect(()=>{if(e&&!d){r>0?f(r):u.length>0&&f(u[0].threadId);return}!e&&d&&(s(d.threadId),f(-1))},[e,d,r,u,f]),e?l(ie,{className:"nitro-friends-messenger",uniqueKey:"nitro-friends-messenger",theme:"primary-slim",children:[t(ae,{headerText:h("messenger.window.title",["OPEN_CHAT_COUNT"],[u.length.toString()]),onCloseClick:v=>n(!1)}),t(re,{children:l(ne,{overflow:"hidden",children:[l(T,{size:4,overflow:"hidden",children:[t(N,{bold:!0,children:h("toolbar.icon.label.messenger")}),t(T,{fit:!0,overflow:"auto",children:t(T,{children:u&&u.length>0&&u.map(v=>l(be,{itemActive:d===v,onClick:y=>f(v.threadId),children:[v.unread&&t(Gr,{count:v.unreadCount}),l(w,{fullWidth:!0,alignItems:"center",gap:1,children:[l(w,{alignItems:"center",className:"friend-head px-1",children:[v.participant.id>0&&t(it,{figure:v.participant.figure,headOnly:!0,direction:3}),v.participant.id<=0&&t(We,{isGroup:!0,badgeCode:v.participant.figure})]}),t(N,{truncate:!0,grow:!0,children:v.participant.name})]})]},v.threadId))})})]}),t(T,{size:8,overflow:"hidden",children:d&&l(B,{children:[t(N,{bold:!0,center:!0,children:h("messenger.window.separator",["FRIEND_NAME"],[d.participant.name])}),l(w,{alignItems:"center",justifyContent:"between",gap:1,children:[l(w,{gap:1,children:[l(Cr,{children:[t(M,{onClick:C,children:t(P,{className:"nitro-friends-spritesheet icon-follow"})}),t(M,{onClick:I,children:t(P,{className:"nitro-friends-spritesheet icon-profile-sm"})})]}),t(M,{variant:"danger",onClick:()=>_(st.IM,{reportedUserId:d.participant.id}),children:h("messenger.window.button.report")})]}),t(M,{onClick:v=>p(d.threadId),children:t(Dn,{className:"fa-icon"})})]}),t(T,{fit:!0,className:"bg-muted p-2 rounded chat-messages",children:t(T,{innerRef:E,overflow:"auto",children:t(pR,{thread:d})})}),l(w,{gap:1,children:[t("input",{type:"text",className:"form-control form-control-sm",maxLength:255,placeholder:h("messenger.window.input.default",["FRIEND_NAME"],[d.participant.name]),value:a,onChange:v=>c(v.target.value),onKeyDown:S}),t(M,{variant:"success",onClick:b,children:h("widgets.chatinput.say")})]})]})})]})})]}):null},ER=i=>{const{settings:e=null,onlineFriends:n=[]}=Nn();return e?l(B,{children:[Ic.createPortal(t(oR,{onlineFriends:n}),document.getElementById("toolbar-friend-bar-container")),t(gR,{}),t(IR,{})]}):null},CR=()=>{const{games:i,selectedGame:e,setSelectedGame:n}=tl(),r=a=>{let c=["game-icon"];return e===a&&c.push("selected"),c.join(" ")},s=a=>`url(${a.assetUrl}${a.gameNameId}_icon.png)`;return l(P,{fullWidth:!0,className:"gameList-container bg-dark p-1",children:[h("gamecenter.game_list_title"),t(w,{gap:3,children:i&&i.map((a,c)=>t(P,{className:r(a),onClick:u=>n(a),style:{backgroundImage:s(a)}},c))})]})},_R=()=>{const{gameURL:i,setGameURL:e}=tl(),[n,r]=o.useState(0),s=o.useRef();return o.useEffect(()=>{if(!s||s&&!s.current)return;r(0);let a=document.createElement("iframe");a.src=i,a.classList.add("game-center-stage"),a.classList.add("h-100"),a.onload=()=>{r(c=>c+=1)},s.current.innerHTML="",s.current.appendChild(a)},[s,i]),o.useEffect(()=>{n>1&&(e(null),L(new IC))},[n,e]),i?t(P,{innerRef:s,className:"game-center-stage"}):null},bR=()=>{const{selectedGame:i,accountStatus:e}=tl();o.useEffect(()=>{i&&(L(new EC(i.gameId)),L(new CC(i.gameId)))},[i]);const n=()=>mn.uintHexColor(i.bgColor),r=()=>`url(${i.assetUrl}${i.gameNameId}_theme.png)`,s=()=>mn.uintHexColor(i.textColor),a=()=>{L(new _C(i.gameId))};return l(w,{className:"game-view py-4",fullHeight:!0,style:{backgroundColor:n(),backgroundImage:r(),color:s()},children:[l(w,{className:"w-75",column:!0,alignItems:"center",gap:2,children:[t(N,{bold:!0,children:h(`gamecenter.${i.gameNameId}.description_title`)}),t("img",{src:i.assetUrl+i.gameNameId+"_logo.png"}),(e.hasUnlimitedGames||e.freeGamesLeft>0)&&t(B,{children:l(M,{variant:"light",position:"relative",className:"px-4",onClick:a,children:[h("gamecenter.play_now"),!e.hasUnlimitedGames&&t(Gr,{className:"me-n1 mt-n1",count:e.freeGamesLeft})]})}),t(N,{bold:!0,className:"w-50",center:!0,children:h(`gamecenter.${i.gameNameId}.description_content`)})]}),t(P,{className:"w-25"})]})},SR=()=>{const{isVisible:i,setIsVisible:e,games:n,accountStatus:r}=tl();if(o.useEffect(()=>{const s=()=>{e(c=>!c)},a={linkReceived:c=>{switch(c.split("/")[1]){case"toggle":s();break}},eventUrlPrefix:"games/"};return It(a),()=>Et(a)},[]),!(!i||!n||!r))return l(w,{position:"absolute",className:"top-0 bottom-0 start-0 end-0 bg-black",justifyContent:"center",children:[l(w,{className:"game-center-main",column:!0,children:[t(bR,{}),t(CR,{})]}),t(_R,{})]})},NR=[0,1,2,3,4,5,6,7,8],TR=i=>{const{badgeParts:e=[],setBadgeParts:n=null}=i,[r,s]=o.useState(-1),{groupCustomize:a=null}=ui(),c=(u,d,g)=>{const m=[...e];m[u][d]=g,n(m),d==="key"&&s(-1)};return!e||!e.length?null:l(B,{children:[r<0&&e&&e.length>0&&e.map((u,d)=>l(w,{alignItems:"center",justifyContent:"between",gap:2,className:"bg-muted rounded px-2 py-1",children:[l(w,{pointer:!0,center:!0,className:"bg-muted rounded p-1",onClick:g=>s(d),children:[e[d].code&&e[d].code.length>0&&t(We,{badgeCode:e[d].code,isGroup:!0}),(!e[d].code||!e[d].code.length)&&t(w,{center:!0,className:"badge-image group-badge",children:t(ei,{className:"fa-icon"})})]}),u.type!==tn.BASE&&t(ne,{gap:1,columnCount:3,children:NR.map((g,m)=>t(P,{pointer:!0,className:`group-badge-position-swatch ${e[d].position===g?"active":""}`,onClick:f=>c(d,"position",g)},m))}),t(ne,{gap:1,columnCount:8,children:a.badgePartColors.length>0&&a.badgePartColors.map((g,m)=>t(P,{pointer:!0,className:`group-badge-color-swatch ${e[d].color===m+1?"active":""}`,style:{backgroundColor:"#"+g.color},onClick:f=>c(d,"color",m+1)},m))})]},d)),r>=0&&l(ne,{gap:1,columnCount:5,children:[e[r].type===tn.SYMBOL&&t(T,{pointer:!0,center:!0,className:"bg-muted rounded p-1",onClick:u=>c(r,"key",0),children:t(w,{center:!0,className:"badge-image group-badge",children:t(Dn,{className:"fa-icon"})})}),(e[r].type===tn.BASE?a.badgeBases:a.badgeSymbols).map((u,d)=>t(T,{pointer:!0,center:!0,className:"bg-muted rounded p-1",onClick:g=>c(r,"key",u.id),children:t(We,{badgeCode:tn.getCode(e[r].type,u.id,e[r].color,4),isGroup:!0})},d))]})]})},Uh=i=>{const{groupData:e=null,setGroupData:n=null,setCloseAction:r=null,skipDefault:s=null}=i,[a,c]=o.useState(null),{groupCustomize:u=null}=ui(),d=()=>{if(!a||!a.length)return"";let m="";return a.forEach(f=>f.code&&(m+=f.code)),m},g=o.useCallback(()=>{if(!e||!a||!a.length)return!1;if(e.groupBadgeParts===a)return!0;if(e.groupId<=0)return n(f=>{const p={...f};return p.groupBadgeParts=a,p}),!0;const m=[];return a.forEach(f=>{f.code&&(m.push(f.key),m.push(f.color),m.push(f.position))}),L(new bC(e.groupId,m)),!0},[e,a,n]);return o.useEffect(()=>{if(e.groupBadgeParts)return;const m=[new tn(tn.BASE,u.badgeBases[0].id,u.badgePartColors[0].id),new tn(tn.SYMBOL,0,u.badgePartColors[0].id),new tn(tn.SYMBOL,0,u.badgePartColors[0].id),new tn(tn.SYMBOL,0,u.badgePartColors[0].id),new tn(tn.SYMBOL,0,u.badgePartColors[0].id)];n(f=>({...f,groupBadgeParts:m}))},[e.groupBadgeParts,u,n]),o.useEffect(()=>{if(e.groupId<=0){c(e.groupBadgeParts?[...e.groupBadgeParts]:null);return}c(e.groupBadgeParts)},[e]),o.useEffect(()=>(r({action:g}),()=>r(null)),[r,g]),l(ne,{overflow:"hidden",gap:1,children:[t(T,{size:2,children:t(w,{center:!0,className:"bg-muted rounded p-1",children:t(We,{badgeCode:d(),isGroup:!0})})}),t(T,{size:10,overflow:"auto",children:t(TR,{badgeParts:a,setBadgeParts:c})})]})},xh=i=>{const{groupData:e=null,setGroupData:n=null,setCloseAction:r=null}=i,[s,a]=o.useState(null),{groupCustomize:c=null}=ui(),u=m=>m===0?c.groupColorsA.find(f=>f.id===s[m]).color:c.groupColorsB.find(f=>f.id===s[m]).color,d=(m,f)=>{a(p=>{const _=[...p];return _[m]=f,_})},g=o.useCallback(()=>!e||!s||!s.length?!1:e.groupColors===s?!0:e.groupId<=0?(n(m=>{const f={...m};return f.groupColors=[...s],f}),!0):(L(new SC(e.groupId,s[0],s[1])),!0),[e,s,n]);return o.useEffect(()=>{if(!c.groupColorsA||!c.groupColorsB||e.groupColors)return;const m=[c.groupColorsA[0].id,c.groupColorsB[0].id];n(f=>({...f,groupColors:m}))},[c,e.groupColors,n]),o.useEffect(()=>{if(e.groupId<=0){a(e.groupColors?[...e.groupColors]:null);return}a(e.groupColors)},[e]),o.useEffect(()=>(r({action:g}),()=>r(null)),[r,g]),s?l(ne,{overflow:"hidden",children:[l(T,{size:2,gap:1,children:[t(N,{bold:!0,children:h("group.edit.color.guild.color")}),e.groupColors&&e.groupColors.length>0&&l(w,{overflow:"hidden",className:"rounded border",children:[t(P,{className:"group-color-swatch",style:{backgroundColor:"#"+u(0)}}),t(P,{className:"group-color-swatch",style:{backgroundColor:"#"+u(1)}})]})]}),l(T,{size:5,gap:1,overflow:"hidden",children:[t(N,{bold:!0,children:h("group.edit.color.primary.color")}),t(De,{gap:1,columnCount:7,columnMinWidth:16,columnMinHeight:16,children:e.groupColors&&c.groupColorsA&&c.groupColorsA.map((m,f)=>t("div",{className:zt("group-badge-color-swatch cursor-pointer",e.groupColors[0]===m.id&&"active"),style:{backgroundColor:"#"+m.color},onClick:()=>d(0,m.id)},f))})]}),l(T,{size:5,gap:1,overflow:"hidden",children:[t(N,{bold:!0,children:h("group.edit.color.secondary.color")}),t(De,{gap:1,columnCount:7,columnMinWidth:16,columnMinHeight:16,children:e.groupColors&&c.groupColorsB&&c.groupColorsB.map((m,f)=>t("div",{className:zt("group-badge-color-swatch cursor-pointer",e.groupColors[1]===m.id&&"active"),style:{backgroundColor:"#"+m.color},onClick:()=>d(1,m.id)},f))})]})]}):null},vR=i=>{const{groupData:e=null,setGroupData:n=null,purchaseCost:r=0}=i,{groupCustomize:s=null}=ui(),a=()=>{if(!e||!e.groupBadgeParts||!e.groupBadgeParts.length)return"";let u="";return e.groupBadgeParts.forEach(d=>d.code&&(u+=d.code)),u},c=u=>u===0?s.groupColorsA.find(d=>d.id===e.groupColors[u]).color:s.groupColorsB.find(d=>d.id===e.groupColors[u]).color;return e?l(ne,{overflow:"hidden",gap:1,children:[l(T,{size:3,children:[l(T,{center:!0,className:"bg-muted rounded p-1",gap:2,children:[t(N,{bold:!0,center:!0,children:h("group.create.confirm.guildbadge")}),t(We,{badgeCode:a(),isGroup:!0})]}),l(T,{center:!0,className:"bg-muted rounded p-1",gap:2,children:[t(N,{bold:!0,center:!0,children:h("group.edit.color.guild.color")}),l(w,{overflow:"hidden",className:"rounded border",children:[t(P,{className:"group-color-swatch",style:{backgroundColor:"#"+c(0)}}),t(P,{className:"group-color-swatch",style:{backgroundColor:"#"+c(1)}})]})]})]}),l(T,{size:9,justifyContent:"between",children:[l(T,{children:[l(T,{gap:1,children:[t(N,{bold:!0,children:e.groupName}),t(N,{children:e.groupDescription})]}),t(N,{overflow:"auto",children:h("group.create.confirm.info")})]}),t(N,{center:!0,variant:"white",className:"bg-primary rounded p-1",children:h("group.create.confirm.buyinfo",["amount"],[r.toString()])})]})]}):null},Fh=i=>{const{groupData:e=null,setGroupData:n=null,setCloseAction:r=null,onClose:s=null,isCreator:a=!1,availableRooms:c=[]}=i,[u,d]=o.useState(""),[g,m]=o.useState(""),[f,p]=o.useState(-1),{showConfirm:_=null}=ze(),E=()=>{!e||e.groupId<=0||_(h("group.deleteconfirm.desc"),()=>{L(new TC(e.groupId)),s&&s()},null,null,null,h("group.deleteconfirm.title"))},C=o.useCallback(()=>!e||!u||!u.length?!1:u===e.groupName&&g===e.groupDescription?!0:e.groupId<=0?f<=0?!1:(n(I=>{const b={...I};return b.groupName=u,b.groupDescription=g,b.groupHomeroomId=f,b}),!0):(L(new NC(e.groupId,u,g||"")),!0),[e,u,g,f,n]);return o.useEffect(()=>{d(e.groupName||""),m(e.groupDescription||""),p(e.groupHomeroomId)},[e]),o.useEffect(()=>(r({action:C}),()=>r(null)),[r,C]),e?l(T,{justifyContent:"between",overflow:"auto",children:[l(T,{gap:1,children:[l(w,{alignItems:"center",gap:1,children:[t(N,{center:!0,className:"col-3",children:h("group.edit.name")}),t("input",{type:"text",className:"form-control form-control-sm",value:u,maxLength:29,onChange:I=>d(I.target.value)})]}),l(w,{alignItems:"center",gap:1,children:[t(N,{center:!0,className:"col-3",children:h("group.edit.desc")}),t("textarea",{className:"form-control form-control-sm",value:g,maxLength:254,onChange:I=>m(I.target.value)})]}),a&&l(B,{children:[l(w,{alignItems:"center",gap:1,children:[t(N,{center:!0,className:"col-3",children:h("group.edit.base")}),t(T,{fullWidth:!0,gap:1,children:l("select",{className:"form-select form-select-sm",value:f,onChange:I=>p(parseInt(I.target.value)),children:[t("option",{value:-1,disabled:!0,children:h("group.edit.base.select.room")}),c&&c.map((I,b)=>t("option",{value:I.id,children:I.name},b))]})})]}),l(w,{gap:1,children:[t(P,{className:"col-3",children:""}),t(N,{small:!0,children:h("group.edit.base.warning")})]})]})]}),!a&&t(M,{variant:"danger",onClick:E,children:h("group.delete")}),a&&t(N,{underline:!0,center:!0,fullWidth:!0,pointer:!0,onClick:I=>Z("navigator/create"),children:h("group.createroom")})]}):null},wR=[1,2,3,4],RR=i=>{const{onClose:e=null}=i,[n,r]=o.useState(1),[s,a]=o.useState(null),[c,u]=o.useState(null),[d,g]=o.useState(null),[m,f]=o.useState(0),p=()=>{a(null),u(null),e&&e()},_=()=>{if(!c)return;const I=[];c.groupBadgeParts.forEach(b=>{b.code&&(I.push(b.key),I.push(b.color),I.push(b.position))}),L(new RC(c.groupName,c.groupDescription,c.groupHomeroomId,c.groupColors[0],c.groupColors[1],I))},E=()=>{if(!(s&&s.action&&!s.action())){if(n===1){e();return}r(I=>I-1)}},C=()=>{if(!(s&&s.action&&!s.action())){if(n===4){_();return}r(I=>I===4?I:I+1)}};return x(vC,I=>{const b=I.getParser(),S=[];b.availableRooms.forEach((v,y)=>S.push({id:y,name:v})),g(S),f(b.groupCost)}),o.useEffect(()=>{r(1),u({groupId:-1,groupName:null,groupDescription:null,groupHomeroomId:-1,groupState:1,groupCanMembersDecorate:!0,groupColors:null,groupBadgeParts:null}),L(new wC)},[u]),c?l(ie,{className:"nitro-group-creator",theme:"primary-slim",children:[t(ae,{headerText:h("group.create.title"),onCloseClick:p}),l(re,{children:[t(w,{center:!0,className:"creator-tabs",children:wR.map((I,b)=>t(w,{center:!0,className:`tab tab-${I===1?"blue-flat":I===4?"yellow":"blue-arrow"} ${n===I?"active":""}`,children:t(N,{variant:"white",children:h(`group.create.steplabel.${I}`)})},b))}),l(T,{overflow:"hidden",children:[l(w,{alignItems:"center",gap:2,children:[t(P,{className:`nitro-group-tab-image tab-${n}`}),l(T,{grow:!0,gap:0,children:[t(N,{bold:!0,fontSize:4,children:h(`group.create.stepcaption.${n}`)}),t(N,{children:h(`group.create.stepdesc.${n}`)})]})]}),l(T,{overflow:"hidden",children:[n===1&&t(Fh,{groupData:c,setGroupData:u,setCloseAction:a,onClose:null,isCreator:!0,availableRooms:d}),n===2&&t(Uh,{groupData:c,setGroupData:u,setCloseAction:a}),n===3&&t(xh,{groupData:c,setGroupData:u,setCloseAction:a}),n===4&&t(vR,{groupData:c,setGroupData:u,purchaseCost:m})]}),l(w,{justifyContent:"between",children:[t(M,{variant:"link",className:"text-black",onClick:E,children:h(n===1?"generic.cancel":"group.create.previousstep")}),t(M,{disabled:n===4&&!bs(),variant:n===4?bs()?"success":"danger":"primary",onClick:C,children:h(n===4?bs()?"group.create.confirm.buy":"group.create.confirm.viprequired":"group.create.nextstep")})]})]})]})]}):null},OR=["regular","exclusive","private"],Gh=i=>{const{groupInformation:e=null,onClose:n=null,overflow:r="hidden",...s}=i,{showConfirm:a=null}=ze(),c=e&&e.ownerName===W().userName,u=()=>e&&Dc(e.id),d=()=>{a(h("group.leaveconfirm.desc"),()=>{L(new Tc(e.id,W().userId)),n&&n()},null)},g=()=>e.membershipType===Pt.NOT_MEMBER||e.membershipType===Pt.REQUEST_PENDING?null:c?t("i",{className:"icon icon-group-owner",title:h("group.youareowner")}):e.isAdmin?t("i",{className:"icon icon-group-admin",title:h("group.youareadmin")}):t("i",{className:"icon icon-group-member",title:h("group.youaremember")}),m=()=>{if(c)return"group.youareowner";if(e.type===On.PRIVATE&&e.membershipType!==Pt.MEMBER)return"";if(e.membershipType===Pt.MEMBER)return"group.leave";if(e.membershipType===Pt.NOT_MEMBER&&e.type===On.REGULAR)return"group.join";if(e.membershipType===Pt.REQUEST_PENDING)return"group.membershippending";if(e.membershipType===Pt.NOT_MEMBER&&e.type===On.EXCLUSIVE)return"group.requestmembership"},f=()=>{if(!(e.type===On.PRIVATE&&e.membershipType===Pt.NOT_MEMBER)){if(e.membershipType===Pt.MEMBER){d();return}u()}},p=_=>{switch(_){case"members":Lu(e.id);break;case"members_pending":Lu(e.id,2);break;case"manage":th(e.id);break;case"homeroom":Sn(e.roomId);break;case"furniture":Z("catalog/open/"+no.GUILD_CUSTOM_FURNI);break;case"popular_groups":Z("navigator/search/groups");break}};return e?l(ne,{overflow:r,...s,children:[l(T,{center:!0,size:3,overflow:"hidden",children:[t(w,{alignItems:"center",overflow:"hidden",className:"group-badge",children:t(We,{badgeCode:e.badge,isGroup:!0,scale:2})}),l(T,{alignItems:"center",gap:1,children:[t(N,{small:!0,underline:!0,pointer:!0,onClick:()=>p("members"),children:h("group.membercount",["totalMembers"],[e.membersCount.toString()])}),e.pendingRequestsCount>0&&t(N,{small:!0,underline:!0,pointer:!0,onClick:()=>p("members_pending"),children:h("group.pendingmembercount",["amount"],[e.pendingRequestsCount.toString()])}),e.isOwner&&t(N,{small:!0,underline:!0,pointer:!0,onClick:()=>p("manage"),children:h("group.manage")})]}),g()]}),l(T,{size:9,justifyContent:"between",overflow:"auto",children:[l(T,{overflow:"hidden",children:[l(T,{gap:1,children:[l(w,{alignItems:"center",gap:2,children:[t(N,{bold:!0,children:e.title}),l(w,{gap:1,children:[t("i",{className:"icon icon-group-type-"+e.type,title:h(`group.edit.settings.type.${OR[e.type]}.help`)}),e.canMembersDecorate&&t("i",{className:"icon icon-group-decorate",title:h("group.memberscandecorate")})]})]}),t(N,{small:!0,children:h("group.created",["date","owner"],[e.createdAt,e.ownerName])})]}),t(N,{small:!0,overflow:"auto",className:"group-description",children:e.description})]}),l(T,{children:[l(T,{gap:1,children:[t(N,{small:!0,underline:!0,pointer:!0,onClick:()=>p("homeroom"),children:h("group.linktobase")}),t(N,{small:!0,underline:!0,pointer:!0,onClick:()=>p("furniture"),children:h("group.buyfurni")}),t(N,{small:!0,underline:!0,pointer:!0,onClick:()=>p("popular_groups"),children:h("group.showgroups")})]}),(e.type!==On.PRIVATE||e.type===On.PRIVATE&&e.membershipType===Pt.MEMBER)&&t(M,{disabled:e.membershipType===Pt.REQUEST_PENDING||c,onClick:f,children:h(m())})]})]})]}):null},yR=i=>{const[e,n]=o.useState(null);return x(ri,r=>{const s=r.getParser();(e&&e.id===s.id||s.flag)&&n(s)}),e?l(ie,{className:"nitro-group-information-standalone",theme:"primary-slim",children:[t(ae,{headerText:h("group.window.title"),onCloseClick:r=>n(null)}),t(re,{children:t(Gh,{groupInformation:e,onClose:()=>n(null)})})]}):null},kR=["regular","exclusive","private"],AR=i=>{const{groupData:e=null,setGroupData:n=null,setCloseAction:r=null}=i,[s,a]=o.useState(e.groupState),[c,u]=o.useState(e.groupCanMembersDecorate),d=o.useCallback(()=>e?s===e.groupState&&c===e.groupCanMembersDecorate?!0:e.groupId<=0?(n(g=>{const m={...g};return m.groupState=s,m.groupCanMembersDecorate=c,m}),!0):(L(new OC(e.groupId,s,c?0:1)),!0):!1,[e,s,c,n]);return o.useEffect(()=>{a(e.groupState),u(e.groupCanMembersDecorate)},[e]),o.useEffect(()=>(r({action:d}),()=>r(null)),[r,d]),l(T,{overflow:"auto",children:[t(T,{children:kR.map((g,m)=>l(w,{alignItems:"center",gap:1,children:[t("input",{className:"form-check-input",type:"radio",name:"groupState",checked:s===m,onChange:f=>a(m)}),l(T,{gap:0,children:[l(w,{gap:1,children:[t("i",{className:`icon icon-group-type-${m}`}),t(N,{bold:!0,children:h(`group.edit.settings.type.${g}.label`)})]}),t(N,{children:h(`group.edit.settings.type.${g}.help`)})]})]},m))}),t(vN,{}),l(w,{alignItems:"center",gap:1,children:[t("input",{className:"form-check-input",type:"checkbox",checked:c,onChange:g=>u(m=>!m)}),l(T,{gap:1,children:[t(N,{bold:!0,children:h("group.edit.settings.rights.caption")}),t(N,{children:h("group.edit.settings.rights.members.help")})]})]})]})},DR=[1,2,3,5],PR=i=>{const[e,n]=o.useState(1),[r,s]=o.useState(null),[a,c]=o.useState(null),u=()=>{s(g=>(g&&g.action&&g.action(),null)),c(null)},d=g=>{r&&r.action&&r.action(),n(g)};return x(ri,g=>{const m=g.getParser();!a||a.groupId!==m.id||c(f=>{const p={...f};return p.groupName=m.title,p.groupDescription=m.description,p.groupState=m.type,p.groupCanMembersDecorate=m.canMembersDecorate,p})}),x(yC,g=>{const m=g.getParser(),f=[];m.badgeParts.forEach((p,_)=>{f.push(new El(p.isBase?El.BASE:El.SYMBOL,p.key,p.color,p.position))}),c({groupId:m.id,groupName:m.title,groupDescription:m.description,groupHomeroomId:m.roomId,groupState:m.state,groupCanMembersDecorate:m.canMembersDecorate,groupColors:[m.colorA,m.colorB],groupBadgeParts:f})}),!a||a.groupId<=0?null:l(ie,{className:"nitro-group-manager",children:[t(ae,{headerText:h("group.window.title"),onCloseClick:u}),t(Br,{children:DR.map(g=>t(sr,{isActive:e===g,onClick:()=>d(g),children:h(`group.edit.tab.${g}`)},g))}),l(re,{children:[l(w,{alignItems:"center",gap:2,children:[t(P,{className:`nitro-group-tab-image tab-${e}`}),l(T,{grow:!0,gap:0,children:[t(N,{bold:!0,fontSize:4,children:h(`group.edit.tabcaption.${e}`)}),t(N,{children:h(`group.edit.tabdesc.${e}`)})]})]}),l(T,{grow:!0,overflow:"hidden",children:[e===1&&t(Fh,{groupData:a,setGroupData:c,setCloseAction:s,onClose:u}),e===2&&t(Uh,{groupData:a,setGroupData:c,setCloseAction:s,skipDefault:!0}),e===3&&t(xh,{groupData:a,setGroupData:c,setCloseAction:s}),e===5&&t(AR,{groupData:a,setGroupData:c,setCloseAction:s})]})]})]})},LR=i=>{const[e,n]=o.useState(-1),[r,s]=o.useState(-1),[a,c]=o.useState(null),[u,d]=o.useState(-1),[g,m]=o.useState(0),[f,p]=o.useState(""),[_,E]=o.useState(null),{showConfirm:C=null}=ze(),I=R=>{if(R.rank===ln.OWNER)return"group.members.owner";if(a.admin){if(R.rank===ln.ADMIN)return"group.members.removerights";if(R.rank===ln.MEMBER)return"group.members.giverights"}return""},b=o.useCallback(()=>{e===-1||r===-1||u===-1||L(new gu(e,u,f,r))},[e,r,u,f]),S=R=>{!a.admin||R.rank===ln.OWNER||(R.rank!==ln.ADMIN?L(new DC(a.groupId,R.id)):L(new PC(a.groupId,R.id)),b())},v=R=>{!a.admin||R.rank!==ln.REQUESTED||(L(new LC(a.groupId,R.id)),b())},y=R=>{if(a.admin){if(R.rank===ln.REQUESTED){L(new MC(a.groupId,R.id)),b();return}E(R.name),L(new UC(a.groupId,R.id))}};return x(kC,R=>{const O=R.getParser();c(O),s(O.level),m(Math.ceil(O.totalMembersCount/O.pageSize))}),x(AC,R=>{const O=R.getParser();C(h(O.furnitureCount>0?"group.kickconfirm.desc":"group.kickconfirm_nofurni.desc",["user","amount"],[_,O.furnitureCount.toString()]),()=>{L(new Tc(a.groupId,O.userId)),b()},null),E(null)}),o.useEffect(()=>{const R={linkReceived:O=>{const F=O.split("/");if(F.length<2)return;const U=parseInt(F[1])||-1,A=parseInt(F[2])||3;n(U),s(A),d(0)},eventUrlPrefix:"group-members/"};return It(R),()=>Et(R)},[]),o.useEffect(()=>{d(0)},[e,r,f]),o.useEffect(()=>{e===-1||r===-1||u===-1||L(new gu(e,u,f,r))},[e,r,u,f]),o.useEffect(()=>{e!==-1&&(s(-1),c(null),m(0),p(""),E(null))},[e]),e===-1||!a?null:l(ie,{className:"nitro-group-members",theme:"primary-slim",children:[t(ae,{headerText:h("group.members.title",["groupName"],[a?a.groupTitle:""]),onCloseClick:R=>n(-1)}),l(re,{overflow:"hidden",children:[l(w,{gap:2,children:[t(w,{center:!0,className:"group-badge",children:t(We,{badgeCode:a.badge,isGroup:!0,className:"mx-auto d-block"})}),l(T,{fullWidth:!0,gap:1,children:[t("input",{type:"text",className:"form-control form-control-sm w-100",placeholder:h("group.members.searchinfo"),value:f,onChange:R=>p(R.target.value)}),l("select",{className:"form-select form-select-sm w-100",value:r,onChange:R=>s(parseInt(R.target.value)),children:[t("option",{value:"0",children:h("group.members.search.all")}),t("option",{value:"1",children:h("group.members.search.admins")}),t("option",{value:"2",children:h("group.members.search.pending")})]})]})]}),t(ne,{columnCount:2,overflow:"auto",className:"nitro-group-members-list-grid",children:a.result.map((R,O)=>l(w,{gap:2,alignItems:"center",overflow:"hidden",className:"member-list-item bg-white rounded p-2",children:[t("div",{className:"avatar-head cursor-pointer",onClick:()=>hn(R.id),children:t(it,{figure:R.figure,headOnly:!0,direction:2})}),l(T,{grow:!0,gap:1,children:[t(N,{bold:!0,small:!0,pointer:!0,onClick:F=>hn(R.id),children:R.name}),R.rank!==ln.REQUESTED&&t(N,{small:!0,italics:!0,variant:"muted",children:h("group.members.since",["date"],[R.joinedAt])})]}),l(T,{gap:1,children:[R.rank!==ln.REQUESTED&&t(w,{center:!0,children:t(P,{pointer:a.admin,className:`icon icon-group-small-${R.rank===ln.OWNER?"owner":R.rank===ln.ADMIN?"admin":a.admin&&R.rank===ln.MEMBER?"not-admin":""}`,title:h(I(R)),onClick:F=>S(R)})}),a.admin&&R.rank===ln.REQUESTED&&t(w,{alignItems:"center",children:t(P,{pointer:!0,className:"nitro-friends-spritesheet icon-accept",title:h("group.members.accept"),onClick:F=>v(R)})}),a.admin&&R.rank!==ln.OWNER&&R.id!==W().userId&&t(w,{alignItems:"center",children:t(P,{pointer:!0,className:"nitro-friends-spritesheet icon-deny",title:h(R.rank===ln.REQUESTED?"group.members.reject":"group.members.kick"),onClick:F=>y(R)})})]})]},O))}),l(w,{gap:1,justifyContent:"between",alignItems:"center",children:[t(M,{disabled:a.pageIndex===0,onClick:R=>d(O=>O-1),children:t(In,{className:"fa-icon"})}),t(N,{small:!0,children:h("group.members.pageinfo",["amount","page","totalPages"],[a.totalMembersCount.toString(),(a.pageIndex+1).toString(),g.toString()])}),t(M,{disabled:a.pageIndex===g-1,onClick:R=>d(O=>O+1),children:t(En,{className:"fa-icon"})})]})]})]})},MR=i=>{const[e,n]=o.useState(!1);return ui(),x(xC,r=>{const s=r.getParser();n(!1),Sn(s.roomId)}),o.useEffect(()=>{const r={linkReceived:s=>{const a=s.split("/");if(!(a.length<2))switch(a[1]){case"create":n(!0);return;case"manage":if(!a[2])return;n(!1),L(new FC(Number(a[2])));return}},eventUrlPrefix:"groups/"};return It(r),()=>Et(r)},[]),l(B,{children:[e&&t(RR,{onClose:()=>n(!1)}),!e&&t(PR,{}),t(LR,{}),t(yR,{})]})},UR=i=>{const{helpRequestDescription:e=null,helpRequestAverageTime:n=0}=i,r=s=>L(new GC(s));return l(T,{children:[l(T,{gap:0,className:"bg-muted p-2 rounded",children:[t(N,{bold:!0,children:h("guide.help.request.guide.accept.request.title")}),t(N,{variant:"muted",children:h("guide.help.request.type.1")}),t(N,{wrap:!0,textBreak:!0,children:e})]}),l(T,{gap:1,children:[t(M,{variant:"success",onClick:s=>r(!0),children:h("guide.help.request.guide.accept.accept.button")}),t(M,{variant:"danger",onClick:s=>r(!1),children:h("guide.help.request.guide.accept.skip.link")})]})]})},xR=i=>{const{isOnDuty:e=!1,isHandlingGuideRequests:n=!1,setIsHandlingGuideRequests:r=null,isHandlingHelpRequests:s=!1,setIsHandlingHelpRequests:a=null,isHandlingBullyReports:c=!1,setIsHandlingBullyReports:u=null,guidesOnDuty:d=0,helpersOnDuty:g=0,guardiansOnDuty:m=0,processAction:f=null}=i;return l(T,{children:[l(w,{alignItems:"center",gap:2,className:"bg-muted p-2 rounded",children:[t(P,{className:"duty-switch"+(e?"":" off"),onClick:p=>f("toggle_duty")}),l(T,{gap:0,children:[t(N,{bold:!0,children:h("guide.help.guide.tool.yourstatus")}),t(N,{children:h(`guide.help.guide.tool.duty.${e?"on":"off"}`)})]})]}),l(T,{gap:1,children:[t(N,{bold:!0,children:h("guide.help.guide.tool.tickettypeselection.caption")}),l(w,{alignItems:"center",gap:1,children:[t("input",{className:"form-check-input",disabled:e,type:"checkbox",checked:n,onChange:p=>r(p.target.checked)}),t(N,{children:h("guide.help.guide.tool.tickettypeselection.guiderequests")})]}),l(w,{alignItems:"center",gap:1,children:[t("input",{className:"form-check-input",disabled:e,type:"checkbox",checked:s,onChange:p=>a(p.target.checked)}),t(N,{children:h("guide.help.guide.tool.tickettypeselection.onlyhelprequests")})]}),l(w,{alignItems:"center",gap:1,children:[t("input",{className:"form-check-input",disabled:e,type:"checkbox",checked:c,onChange:p=>u(p.target.checked)}),t(N,{children:h("guide.help.guide.tool.tickettypeselection.bullyreports")})]})]}),t("hr",{className:"bg-dark m-0"}),l(w,{center:!0,gap:2,children:[t(P,{className:"info-icon"}),l(T,{gap:1,children:[t(P,{dangerouslySetInnerHTML:{__html:h("guide.help.guide.tool.guidesonduty",["amount"],[d.toString()])}}),t(P,{dangerouslySetInnerHTML:{__html:h("guide.help.guide.tool.helpersonduty",["amount"],[g.toString()])}}),t(P,{dangerouslySetInnerHTML:{__html:h("guide.help.guide.tool.guardiansonduty",["amount"],[m.toString()])}})]})]}),t("hr",{className:"bg-dark m-0"}),l(w,{justifyContent:"between",gap:2,children:[t(M,{disabled:!0,onClick:p=>f("forum_link"),children:h("guide.help.guide.tool.forum.link")}),t(M,{disabled:!0,children:h("guide.help.guide.tool.skill.link")})]})]})},FR=i=>{const e=o.useRef(null),{isGuide:n=!1,userId:r=0,userName:s=null,userFigure:a=null,isTyping:c=!1,messageGroups:u=[]}=i,[d,g]=o.useState("");o.useEffect(()=>{var I;(I=e.current)==null||I.scrollIntoView({block:"end",behavior:"smooth"})},[u]);const m=o.useCallback(()=>{L(new VC)},[]),f=o.useCallback(()=>{L(new BC)},[]),p=o.useCallback(()=>{L(new HC)},[]);x(WC,I=>{const b=I.getParser();Sn(b.requesterRoomId)});const _=o.useCallback(()=>{!d||!d.length||(L(new jC(d)),g(""))},[d]),E=o.useCallback(I=>{I.key==="Enter"&&_()},[_]),C=o.useCallback(I=>I===W().userId,[]);return l(T,{fullHeight:!0,children:[l(w,{alignItems:"center",justifyContent:"between",gap:1,className:"bg-muted p-2 rounded",children:[n&&l(Cr,{children:[t(M,{onClick:m,children:h("guide.help.request.guide.ongoing.visit.button")}),t(M,{onClick:f,children:h("guide.help.request.guide.ongoing.invite.button")})]}),!n&&l(T,{gap:0,children:[t(N,{bold:!0,children:s}),t(N,{children:h("guide.help.request.user.ongoing.guide.desc")})]}),t(M,{variant:"danger",disabled:!0,children:h("guide.help.common.report.link")})]}),t(T,{overflow:"hidden",gap:1,className:"bg-muted rounded chat-messages p-2",children:l(T,{overflow:"auto",children:[u.map((I,b)=>l(w,{fullWidth:!0,justifyContent:C(I.userId)?"end":"start",gap:2,children:[t(P,{shrink:!0,className:"message-avatar",children:!C(I.userId)&&t(it,{figure:a,direction:2})}),l(P,{className:"bg-light text-black border-radius mb-2 rounded py-1 px-2 messages-group-"+(C(I.userId)?"right":"left"),children:[l(N,{bold:!0,children:[C(I.userId)&&W().userName,!C(I.userId)&&s]}),I.messages.map((S,v)=>t(P,{pointer:!!S.roomId,className:S.roomId?"text-break text-underline":"text-break",onClick:()=>S.roomId?Sn(S.roomId):null,children:S.message},v))]}),C(I.userId)&&t(P,{className:"message-avatar flex-shrink-0",children:t(it,{figure:W().figure,direction:4})})]},b)),t("div",{ref:e})]})}),l(T,{gap:1,children:[l(w,{gap:1,children:[t("input",{type:"text",className:"form-control form-control-sm",placeholder:h("guide.help.request.guide.ongoing.input.empty",["name"],[s]),value:d,onChange:I=>g(I.target.value),onKeyDown:E}),t(M,{variant:"success",onClick:_,children:h("widgets.chatinput.say")})]}),c&&t(N,{variant:"muted",children:h("guide.help.common.typing")})]}),t(M,{fullWidth:!0,variant:"success",onClick:p,children:h("guide.help.request."+(n?"guide":"user")+".ongoing.close.link")})]})},GR=15,VR=i=>{const{userRequest:e="",setUserRequest:n=null}=i,[r,s]=o.useState(!1),a=()=>{s(!0),L(new qC(1,e))};return l(T,{children:[t(N,{children:h("guide.help.request.user.create.help")}),t("textarea",{className:"request-message",maxLength:140,value:e,onChange:c=>n(c.target.value),placeholder:h("guide.help.request.user.create.input.help")}),t(M,{fullWidth:!0,variant:"success",disabled:e.length<GR||r,onClick:a,children:h("guide.help.request.user.create.input.button")})]})},BR=i=>{const{userName:e=null}=i,n=r=>L(new zC(r));return l(T,{children:[l(w,{justifyContent:"between",gap:1,className:"bg-muted p-2 rounded",children:[l(T,{gap:0,children:[t(N,{bold:!0,children:e}),t(N,{children:h("guide.help.request.user.feedback.guide.desc")})]}),t(M,{variant:"danger",disabled:!0,children:h("guide.help.common.report.link")})]}),l(T,{gap:1,children:[t(N,{bold:!0,children:h("guide.help.request.user.feedback.closed.title")}),t(N,{children:h("guide.help.request.user.feedback.closed.desc")})]}),e&&e.length>0&&l(B,{children:[t("hr",{className:"bg-dark m-0 mt-auto"}),l(T,{children:[t(N,{center:!0,bold:!0,children:h("guide.help.request.user.feedback.question")}),l(w,{gap:1,children:[t(M,{fullWidth:!0,variant:"success",onClick:r=>n(!0),children:h("guide.help.request.user.feedback.positive.button")}),t(M,{fullWidth:!0,variant:"danger",onClick:r=>n(!1),children:h("guide.help.request.user.feedback.negative.button")})]})]})]})]})},HR=i=>l(T,{gap:1,children:[t(N,{bold:!0,children:h("guide.help.request.no_tour_guides.title")}),t(N,{children:h("guide.help.request.no_tour_guides.message")})]}),WR=i=>{const{helpRequestDescription:e=null,helpRequestAverageTime:n=0}=i,r=()=>L(new YC);return l(T,{children:[l(T,{gap:0,className:"bg-muted rounded p-2",children:[t(N,{bold:!0,children:h("guide.help.request.guide.accept.request.title")}),t(N,{variant:"muted",children:h("guide.help.request.type.1")}),t(N,{wrap:!0,textBreak:!0,children:e})]}),l(T,{gap:1,children:[t(N,{bold:!0,children:h("guide.help.request.user.pending.info.title")}),t(N,{children:h("guide.help.request.user.pending.info.message")}),t(N,{children:h("guide.help.request.user.pending.info.waiting",["waitingtime"],[n.toString()])})]}),t(M,{variant:"danger",onClick:r,children:h("guide.help.request.user.pending.cancel.button")})]})},jR=i=>t(T,{gap:1,children:t(N,{children:h("guide.help.request.user.guide.disconnected.error.desc")})}),qR=i=>l(T,{gap:1,children:[t(N,{bold:!0,children:h("guide.help.request.user.thanks.info.title")}),t(N,{children:h("guide.help.request.user.thanks.info.desc")})]}),zR=i=>{const[e,n]=o.useState(!1),[r,s]=o.useState(h("guide.help.guide.tool.title")),[a,c]=o.useState(!1),[u,d]=o.useState(Ae.GUIDE_TOOL_MENU),[g,m]=o.useState(!1),[f,p]=o.useState(!1),[_,E]=o.useState(!1),[C,I]=o.useState(!1),[b,S]=o.useState(0),[v,y]=o.useState(0),[R,O]=o.useState(0),[F,U]=o.useState(""),[A,k]=o.useState(null),[D,V]=o.useState(0),[G,$]=o.useState(0),[X,Y]=o.useState(null),[Ee,ue]=o.useState(null),[ye,Ye]=o.useState(!1),[Ct,Je]=o.useState([]),{simpleAlert:Wt=null}=ze(),Be=o.useCallback((Me,pe)=>{switch(Me){case Ae.GUIDE_TOOL_MENU:s(h("guide.help.guide.tool.title")),c(!1);break;case Ae.GUIDE_ACCEPT:s(h("guide.help.request.guide.accept.title")),c(!0);break;case Ae.GUIDE_ONGOING:s(h("guide.help.request.guide.ongoing.title",["name"],[pe])),c(!0);break;case Ae.USER_CREATE:s(h("guide.help.request.user.create.title")),c(!1);break;case Ae.USER_PENDING:s(h("guide.help.request.user.pending.title")),c(!0);break;case Ae.USER_ONGOING:s(h("guide.help.request.user.ongoing.title",["name"],[pe])),c(!0);break;case Ae.USER_FEEDBACK:s(h("guide.help.request.user.feedback.title")),c(!0);break;case Ae.USER_THANKS:s(h("guide.help.request.user.thanks.title")),c(!1);break;case Ae.USER_NO_HELPERS:s(h("guide.help.request.no_tour_guides.heading")),c(!1);break;case Ae.USER_SOMETHING_WRONG:s(h("guide.help.request.user.guide.disconnected.error.heading")),c(!1);break}d(Me),n(!0)},[]),Xt=o.useCallback(Me=>{switch(Me.type){case pn.SHOW_GUIDE_TOOL:n(!0);return;case pn.HIDE_GUIDE_TOOL:n(!1);return;case pn.TOGGLE_GUIDE_TOOL:n(pe=>!pe);return;case pn.CREATE_HELP_REQUEST:Be(Ae.USER_CREATE);return}},[Be]);Qe(pn.SHOW_GUIDE_TOOL,Xt),Qe(pn.HIDE_GUIDE_TOOL,Xt),Qe(pn.TOGGLE_GUIDE_TOOL,Xt),Qe(pn.CREATE_HELP_REQUEST,Xt),x(Am,Me=>{!Me.getParser().isAllowed(km.USE_GUIDE_TOOL)&&g&&(m(!1),L(new fu(!1,!1,!1,!1)))}),x($C,Me=>{const pe=Me.getParser();m(pe.onDuty),y(pe.guidesOnDuty),S(pe.helpersOnDuty),O(pe.guardiansOnDuty)}),x(KC,Me=>{const pe=Me.getParser();k(pe.helpRequestDescription),V(pe.roleSpecificWaitTime),pe.asGuide&&g&&Be(Ae.GUIDE_ACCEPT),pe.asGuide||Be(Ae.USER_PENDING)}),x(XC,Me=>{const pe=Me.getParser();g?($(pe.requesterUserId),Y(pe.requesterName),ue(pe.requesterFigure),Be(Ae.GUIDE_ONGOING,pe.requesterName)):($(pe.guideUserId),Y(pe.guideName),ue(pe.guideFigure),Be(Ae.USER_ONGOING,pe.guideName))}),x(QC,Me=>{const pe=Me.getParser();Ye(pe.isTyping)}),x(JC,Me=>{const pe=Me.getParser(),ht=[...Ct];let Ut=ht[ht.length-1];(!Ut||Ut.userId!==pe.senderId)&&(Ut=new Uu(pe.senderId),ht.push(Ut)),Ut.addChat(new Mu(pe.chatMessage)),Je(ht)}),x(ZC,Me=>{const pe=Me.getParser();if(pe.roomId!==0){const ht=[...Ct];let Ut=ht[ht.length-1];const Mn=g?W().userId:G;(!Ut||Ut.userId!==Mn)&&(Ut=new Uu(Mn),ht.push(Ut)),Ut.addChat(new Mu(pe.roomName,pe.roomId)),Je(ht)}}),x(e_,Me=>{g?($(0),Y(null),ue(null),Ye(!1),Je([]),Be(Ae.GUIDE_TOOL_MENU)):Be(Ae.USER_FEEDBACK)}),x(t_,Me=>{switch(Me.getParser().errorCode){case 0:Be(Ae.USER_SOMETHING_WRONG);break;case 1:case 2:Be(Ae.USER_NO_HELPERS);break}}),x(n_,Me=>{$(0),Y(null),ue(null),Ye(!1),Je([]),Be(g?Ae.GUIDE_TOOL_MENU:Ae.USER_THANKS)}),o.useEffect(()=>{const Me={linkReceived:pe=>{const ht=pe.split("/");if(!(ht.length<2))switch(ht[1]){case"tour":return}},eventUrlPrefix:"help/"};return It(Me),()=>Et(Me)},[]);const on=o.useCallback(Me=>{switch(Me){case"close":n(!1),U(""),d(Ae.GUIDE_TOOL_MENU);return;case"toggle_duty":if(!f&&!_&&!C){Wt(h("guide.help.guide.tool.noqueueselected.message"),null,null,null,h("guide.help.guide.tool.noqueueselected.caption"),null);return}m(ht=>(L(new fu(!ht,ht?!1:_,ht?!1:C,ht?!1:f)),!ht));return;case"forum_link":const pe=K("group.homepage.url","").replace("%groupid%",K("guide.help.alpha.groupid","0"));window.open(pe);return}},[f,_,C,Wt]);return e?l(ie,{className:"nitro-guide-tool",theme:"primary-slim",children:[t(ae,{headerText:r,onCloseClick:Me=>on("close"),noCloseButton:a}),l(re,{className:"text-black",children:[u===Ae.GUIDE_TOOL_MENU&&t(xR,{isOnDuty:g,isHandlingGuideRequests:_,setIsHandlingGuideRequests:E,isHandlingHelpRequests:C,setIsHandlingHelpRequests:I,isHandlingBullyReports:f,setIsHandlingBullyReports:p,guidesOnDuty:v,helpersOnDuty:b,guardiansOnDuty:R,processAction:on}),u===Ae.GUIDE_ACCEPT&&t(UR,{helpRequestDescription:A,helpRequestAverageTime:D}),[Ae.GUIDE_ONGOING,Ae.USER_ONGOING].includes(u)&&t(FR,{isGuide:g,userId:G,userName:X,userFigure:Ee,isTyping:ye,messageGroups:Ct}),u===Ae.USER_CREATE&&t(VR,{userRequest:F,setUserRequest:U}),u===Ae.USER_PENDING&&t(WR,{helpRequestDescription:A,helpRequestAverageTime:D}),u===Ae.USER_FEEDBACK&&t(BR,{userName:X}),u===Ae.USER_THANKS&&t(qR,{}),u===Ae.USER_NO_HELPERS&&t(HR,{}),u===Ae.USER_SOMETHING_WRONG&&t(jR,{})]})]}):null},YR=i=>{const[e,n]=o.useState(!1),[r,s]=o.useState(null),[a,c]=o.useState(0),[u,d]=o.useState(null),{userFigure:g=null}=Wr(),{purse:m=null,clubStatus:f=null}=Ps(),{badgeCodes:p=[],activate:_=null,deactivate:E=null}=rl(),C=()=>m.clubDays<=0?h("purse.clubdays.zero.amount.text"):m.minutesUntilExpiration>-1&&m.minutesUntilExpiration<60*24?nr.shortFormat(m.minutesUntilExpiration*60):nr.shortFormat((m.clubPeriods*31+m.clubDays)*86400),I=()=>{switch(f){case fr.ACTIVE:return h(`hccenter.status.${f}.info`,["timeleft","joindate","streakduration"],[C(),r==null?void 0:r.firstSubscriptionDate,nr.shortFormat((r==null?void 0:r.currentHcStreak)*86400)]);case fr.EXPIRED:return h(`hccenter.status.${f}.info`,["joindate"],[r==null?void 0:r.firstSubscriptionDate]);default:return h(`hccenter.status.${f}.info`)}},b=()=>!r||r.timeUntilPayday<60?h("hccenter.special.time.soon"):nr.shortFormat(r.timeUntilPayday*60),S=()=>h("hccenter.special.sum",["credits"],[((r==null?void 0:r.creditRewardForStreakBonus)+(r==null?void 0:r.creditRewardForMonthlySpent)).toString()]);if(x(um,y=>{const R=y.getParser();c(R.giftsAvailable)}),x(r_,y=>{const R=y.getParser();s(R.data)}),o.useEffect(()=>{const y={linkReceived:R=>{const O=R.split("/");if(!(O.length<2))switch(O[1]){case"open":if(O.length>2)switch(O[2]){case"hccenter":n(!0);break}return}},eventUrlPrefix:"habboUI/"};return It(y),()=>Et(y)},[]),o.useEffect(()=>{d(QS(p))},[p]),o.useEffect(()=>{if(!e)return;const y=_();return()=>E(y)},[e,_,E]),o.useEffect(()=>{L(new dm),L(new s_)},[]),!e)return null;const v=t(Ua,{id:"popover-basic",children:l(Ua.Body,{className:"text-black py-2 px-3",children:[t("h5",{children:h("hccenter.breakdown.title")}),t("div",{children:h("hccenter.breakdown.creditsspent",["credits"],[r==null?void 0:r.totalCreditsSpent.toString()])}),t("div",{children:h("hccenter.breakdown.paydayfactor.percent",["percent"],[((r==null?void 0:r.kickbackPercentage)*100).toString()])}),t("div",{children:h("hccenter.breakdown.streakbonus",["credits"],[r==null?void 0:r.creditRewardForStreakBonus.toString()])}),t("hr",{className:"w-100 text-black my-1"}),t("div",{children:h("hccenter.breakdown.total",["credits","actual"],[S(),(((r==null?void 0:r.kickbackPercentage)*(r==null?void 0:r.totalCreditsSpent)+(r==null?void 0:r.creditRewardForStreakBonus))*100/100).toString()])}),t("div",{className:"btn btn-link text-primary p-0",onClick:()=>Z("habbopages/"+K("hc.center")["payday.habbopage"]),children:h("hccenter.special.infolink")})]})});return l(ie,{theme:"primary-slim",className:"nitro-hc-center",children:[t(ae,{headerText:h("generic.hccenter"),onCloseClick:()=>n(!1)}),l(w,{position:"relative",className:"bg-muted p-2",children:[l(T,{gap:1,children:[t("div",{className:"hc-logo"}),t(w,{children:t(M,{variant:"success",onClick:y=>Z("catalog/open/"+K("catalog.links")["hc.buy_hc"]),children:h(f===fr.ACTIVE?"hccenter.btn.extend":"hccenter.btn.buy")})})]}),t(P,{position:"absolute",className:"end-0 p-4 top-0 habbo-avatar",children:t(it,{figure:g,direction:4,scale:2})})]}),l(re,{children:[l(w,{gap:2,children:[t(We,{badgeCode:u,className:"align-self-center flex-shrink-0 me-1"}),l(T,{size:5,className:"streak-info",gap:0,children:[t(N,{children:h("hccenter.status."+f)}),t(N,{dangerouslySetInnerHTML:{__html:I()}})]})]}),K("hc.center")["payday.info"]&&l(w,{alignItems:"center",children:[l(T,{className:"rounded-start bg-primary p-2 payday-special mb-1",children:[t("h4",{className:"mb-1",children:h("hccenter.special.title")}),t("div",{children:h("hccenter.special.info")}),t("div",{className:"btn btn-link text-white p-0 mt-auto align-self-baseline",onClick:()=>Z("habbopages/"+K("hc.center")["payday.habbopage"]),children:h("hccenter.special.infolink")})]}),l("div",{className:"payday flex-shrink-0 p-2",children:[t("h5",{className:"mb-2 ms-2",children:h("hccenter.special.time.title")}),l("div",{className:"d-flex flex-row mb-2",children:[t("div",{className:"clock me-2"}),t("h6",{className:"mb-0 align-self-center",children:b()})]}),f===fr.ACTIVE&&l("div",{className:"pe-3",children:[t("h5",{className:"ms-2 mb-1 bolder",children:h("hccenter.special.amount.title")}),l("div",{className:"d-flex flex-column",children:[t("div",{className:"w-100 text-center ms-4n",children:S()}),t(sm,{trigger:["hover","focus"],placement:"left",overlay:v,children:t("div",{className:"btn btn-link align-self-end text-primary",children:h("hccenter.breakdown.infolink")})})]})]})]})]}),K("hc.center")["gift.info"]&&l("div",{className:"rounded bg-success p-2 d-flex flex-row mb-0",children:[l("div",{children:[t("h4",{className:"mb-1",children:h("hccenter.gift.title")}),t("div",{dangerouslySetInnerHTML:{__html:a>0?h("hccenter.unclaimedgifts",["unclaimedgifts"],[a.toString()]):h("hccenter.gift.info")}})]}),t("button",{className:"btn btn-primary btn-lg align-self-center ms-auto",onClick:()=>Z("catalog/open/"+K("catalog.links")["hc.hc_gifts"]),children:h(f===fr.ACTIVE?"hccenter.btn.gifts.redeem":"hccenter.btn.gifts.view")})]}),K("hc.center")["benefits.info"]&&l("div",{className:"benefits text-black py-2",children:[t("h5",{className:"mb-1 text-primary",children:h("hccenter.general.title")}),t("div",{className:"mb-2",dangerouslySetInnerHTML:{__html:h("hccenter.general.info")}}),t("button",{className:"btn btn-link p-0 text-primary",onClick:()=>Z("habbopages/"+K("hc.center")["benefits.habbopage"]),children:h("hccenter.general.infolink")})]})]})]})},$R=i=>{const[e,n]=o.useState(""),{activeReport:r=null,setActiveReport:s=null}=zn(),a=()=>{e.length<15||s(u=>{const d=$t.REPORT_SUMMARY;return{...u,message:e,currentStep:d}})},c=()=>{s(u=>({...u,currentStep:u.currentStep-1}))};return l(B,{children:[l(T,{gap:1,children:[t(N,{fontSize:4,children:h("help.emergency.chat_report.subtitle")}),t(N,{children:h("help.cfh.input.text")})]}),t("textarea",{className:"form-control h-100",value:e,onChange:u=>n(u.target.value)}),l(w,{gap:2,justifyContent:"between",children:[t(M,{variant:"secondary",disabled:!(r.reportType===st.BULLY||r.reportType===st.EMERGENCY),onClick:c,children:h("generic.back")}),t(M,{disabled:e.length<15,onClick:a,children:h("help.emergency.main.submit.button")})]})]})},KR=i=>{const{setActiveReport:e=null}=zn(),n=()=>{e(r=>{const s=$t.SELECT_USER,a=st.BULLY;return{...r,currentStep:s,reportType:a}})};return l(B,{children:[l(T,{grow:!0,center:!0,gap:1,children:[t(N,{fontSize:3,children:h("help.main.frame.title")}),t(N,{children:h("help.main.self.description")})]}),l(T,{gap:1,children:[t(M,{onClick:n,children:h("help.main.bully.subtitle")}),t(M,{onClick:()=>yt(new pn(pn.CREATE_HELP_REQUEST)),disabled:!K("guides.enabled"),children:h("help.main.help.title")}),t(M,{disabled:!0,children:h("help.main.self.tips.title")})]}),t(M,{variant:"link",textColor:"black",onClick:()=>L(new a_(!1)),children:h("help.main.my.sanction.status")})]})},XR=i=>{const{username:e="",onAction:n=null}=i,[r,s]=o.useState(!1),a=()=>{r||(s(!0),L(new o_(e)))};return x(i_,c=>{const u=c.getParser();u&&u.webId===W().userId&&n("close")}),l("div",{className:"d-flex flex-column gap-4 h-100",children:[t("div",{className:"bg-muted rounded p-2 text-center",children:h("tutorial.name_change.info.confirm")}),l("div",{className:"d-flex flex-column align-items-center gap-1 h-100",children:[t("div",{children:h("tutorial.name_change.confirm")}),t("div",{className:"fw-bold",children:e})]}),l("div",{className:"d-flex gap-2",children:[t("button",{className:"btn btn-success w-100",disabled:r,onClick:a,children:h("generic.ok")}),t("button",{className:"btn btn-primary w-100",onClick:()=>n("close"),children:h("cancel")})]})]})},QR=i=>{const{onAction:e=null}=i;return l("div",{className:"d-flex flex-column gap-4 h-100",children:[t("div",{className:"bg-muted rounded p-2 text-center",children:h("tutorial.name_change.info.main")}),t("div",{className:"fw-bold d-flex align-items-center justify-content-center h-100 w-100",children:h("tutorial.name_change.current",["name"],[W().userName])}),l("div",{className:"d-flex gap-2",children:[t("button",{className:"btn btn-success w-100",onClick:()=>e("start"),children:h("tutorial.name_change.change")}),t("button",{className:"btn btn-primary w-100",onClick:()=>e("confirmation",W().userName),children:h("tutorial.name_change.keep")})]})]})},JR=0,ZR=2,eO=3,tO=4,nO=5,rO=6,sO=i=>{const{onAction:e=null}=i,[n,r]=o.useState(""),[s,a]=o.useState(!1),[c,u]=o.useState(!1),[d,g]=o.useState(null),[m,f]=o.useState([]),p=()=>{n!==""&&(a(!1),f([]),g(null),u(!0),L(new c_(n)))},_=E=>{a(!1),f([]),g(null),r(E)};return x(l_,E=>{u(!1);const C=E.getParser();if(C)switch(C.resultCode){case JR:a(!0);break;case ZR:g("short");break;case eO:g("long");break;case tO:g("invalid");break;case nO:f(C.nameSuggestions),g("taken");break;case rO:g("change_not_allowed")}}),l("div",{className:"d-flex flex-column gap-3 h-100",children:[t("div",{children:h("tutorial.name_change.info.select")}),l("div",{className:"d-flex gap-2",children:[t("input",{type:"text",className:"form-control form-control-sm",value:n,onChange:E=>_(E.target.value)}),t("button",{className:"btn btn-primary",disabled:n===""||c,onClick:p,children:h("tutorial.name_change.check")})]}),!d&&!s&&t("div",{className:"bg-muted rounded p-2 text-center",children:h("help.tutorial.name.info")}),d&&t("div",{className:"bg-danger rounded p-2 text-center text-white",children:h(`help.tutorial.name.${d}`,["name"],[n])}),s&&t("div",{className:"bg-success rounded p-2 text-center text-white",children:h("help.tutorial.name.available",["name"],[n])}),m&&t("div",{className:"d-flex flex-column gap-2",children:m.map((E,C)=>t("div",{className:"col bg-muted rounded p-1 cursor-pointer",onClick:()=>_(E),children:E},C))}),l("div",{className:"d-flex gap-2",children:[t("button",{className:"btn btn-success w-100",disabled:!s,onClick:()=>e("confirmation",n),children:h("tutorial.name_change.pick")}),t("button",{className:"btn btn-primary w-100",onClick:()=>e("close"),children:h("cancel")})]})]})},Gi="INIT",Ol="INPUT",yl="CONFIRMATION",aO=i=>{const[e,n]=o.useState(!1),[r,s]=o.useState(Gi),[a,c]=o.useState(""),u=(g,m)=>{switch(g){case"start":s(Ol);break;case"confirmation":c(m),s(yl);break;case"close":c(""),n(!1);break}},d=o.useMemo(()=>{switch(r){case Gi:return"tutorial.name_change.title.main";case Ol:return"tutorial.name_change.title.select";case yl:return"tutorial.name_change.title.confirm"}},[r]);return Qe(Ja.INIT,g=>{s(Gi),n(!0)}),e?l(ie,{className:"nitro-change-username",theme:"primary-slim",children:[t(ae,{headerText:h(d),onCloseClick:()=>u("close")}),l(re,{className:"text-black",children:[r===Gi&&t(QR,{onAction:u}),r===Ol&&t(sO,{onAction:u}),r===yl&&t(XR,{username:a,onAction:u})]})]}):null},iO=i=>{const{activeReport:e=null,setActiveReport:n=null}=zn(),r=()=>{const s=[];switch(e.reportType){case st.BULLY:case st.EMERGENCY:case st.ROOM:{const a=e.roomId<=0?e.reportedChats[0].roomId:e.roomId;e.reportedChats.forEach(c=>s.push(c.webId,c.message)),L(new g_(e.message,e.cfhTopic,e.reportedUserId,a,s));break}case st.IM:e.reportedChats.forEach(a=>s.push(a.webId,a.message)),L(new h_(e.message,e.cfhTopic,e.reportedUserId,s));break;case st.THREAD:L(new m_(e.groupId,e.threadId,e.cfhTopic,e.message));break;case st.MESSAGE:L(new d_(e.groupId,e.threadId,e.messageId,e.cfhTopic,e.message));break;case st.PHOTO:L(new u_(e.extraData,e.roomId,e.reportedUserId,e.cfhTopic,e.roomObjectId));break}n(null)};return l(B,{children:[l(T,{gap:1,children:[t(N,{fontSize:4,children:h("help.cfh.button.send")}),t(N,{children:h("help.main.summary")})]}),t(M,{variant:"success",onClick:r,children:h("guide.help.request.emergency.submit.button")})]})},oO=i=>{const{sanctionInfo:e=null,setSanctionInfo:n=null}=zn(),r=(s,a,c)=>{let u=`help.sanction.${s}`;switch(a){case"ALERT":u=u+".alert";break;case"MUTE":u=u+".mute";break;case"BAN_PERMANENT":u=u+".permban";break;default:if(u=u+".ban",c>24)return u=u+".days",h(u,["days"],[(c/24).toString()])}return h(u,["hours"],[c.toString()])};return e?l(ie,{className:"nitro-help",theme:"primary-slim",children:[t(ae,{headerText:h("help.sanction.info.title"),onCloseClick:()=>n(null)}),t(re,{className:"text-black",children:l(ne,{children:[t(T,{center:!0,size:5,overflow:"hidden",children:t(P,{className:"index-image"})}),l(T,{justifyContent:"between",size:7,overflow:"hidden",children:[e.sanctionReason==="cfh.reason.EMPTY"?t("div",{className:"col-12 fw-bold",children:h("help.sanction.current.none")}):l(B,{children:[(e.probationHoursLeft>0||e.isSanctionActive)&&t("div",{className:"col-12 fw-bold",children:h("help.sanction.probation.reminder")}),l("div",{className:`col-12 fw-bold ${e.isSanctionNew?"text-danger":""}`,children:[h("help.sanction.last.sanction")," ",r("current",e.sanctionName,e.sanctionLengthHours)]}),l("div",{className:"col-12",children:[h("generic.start.time")," ",e.sanctionCreationTime]}),l("div",{className:"col-12",children:[h("generic.reason")," ",e.sanctionReason]}),l("div",{className:"col-12",children:[h("help.sanction.probation.days.left")," ",Math.trunc(e.probationHoursLeft/24)+1]})]}),e.hasCustomMute&&!e.isSanctionActive&&t("div",{className:"col-12 fw-bold",children:h("help.sanction.custom.mute")}),e.tradeLockExpiryTime&&e.tradeLockExpiryTime.length>0&&l("div",{className:"col-12 fw-bold",children:[h("trade.locked.until")," ",e.tradeLockExpiryTime]}),t("div",{className:"col-12",children:r("next",e.nextSanctionName,e.nextSanctionLengthHours)}),t(M,{variant:"success",onClick:s=>n(null),children:h("habbo.way.ok.button")})]})]})})]}):null},lO=i=>{const[e,n]=o.useState([]),{activeReport:r=null,setActiveReport:s=null}=zn(),{chatHistory:a=[],messengerHistory:c=[]}=el(),u=o.useMemo(()=>{switch(r.reportType){case st.BULLY:case st.EMERGENCY:return a.filter(f=>f.type===rr.TYPE_CHAT&&f.webId===r.reportedUserId&&f.entityType===pt.USER);case st.IM:return c.filter(f=>f.webId===r.reportedUserId&&f.type===rr.TYPE_IM)}return[]},[r,a,c]),d=f=>{n(p=>{const _=[...p],E=_.indexOf(f);return E>=0?_.splice(E,1):_.push(f),_})},g=()=>{!e||e.length<=0||s(f=>({...f,reportedChats:e,currentStep:$t.SELECT_TOPICS}))},m=()=>{s(f=>({...f,currentStep:f.currentStep-1}))};return l(B,{children:[l(T,{gap:1,children:[t(N,{fontSize:4,children:h("help.emergency.chat_report.subtitle")}),t(N,{children:h("help.emergency.chat_report.description")})]}),l(T,{gap:1,overflow:"hidden",children:[!u||!u.length&&t(N,{children:h("help.cfh.error.no_user_data")}),u.length>0&&t(De,{gap:1,columnCount:1,columnMinHeight:25,overflow:"auto",children:u.map((f,p)=>t(be,{onClick:_=>d(f),itemActive:e.indexOf(f)>=0,children:t(N,{children:f.message})},f.id))})]}),l(w,{gap:2,justifyContent:"between",children:[t(M,{variant:"secondary",onClick:m,disabled:r.reportType===st.IM,children:h("generic.back")}),t(M,{disabled:e.length<=0,onClick:g,children:h("help.emergency.main.submit.button")})]})]})},cO=i=>{const[e,n]=o.useState(-1),{chatHistory:r=[]}=el(),{activeReport:s=null,setActiveReport:a=null}=zn(),c=o.useMemo(()=>{const m=new Map;return r.forEach(f=>{f.type===rr.TYPE_CHAT&&f.entityType===pt.USER&&f.webId!==W().userId&&!m.has(f.webId)&&m.set(f.webId,{id:f.webId,username:f.name})}),Array.from(m.values())},[r]),u=m=>{m<=0||a(f=>({...f,reportedUserId:m,currentStep:$t.SELECT_CHATS}))},d=m=>{n(f=>m===f?-1:m)},g=()=>{a(m=>({...m,currentStep:m.currentStep-1}))};return l(B,{children:[l(T,{gap:1,children:[t(N,{fontSize:4,children:h("help.emergency.main.step.two.title")}),c.length>0&&t(N,{children:h("report.user.pick.user")})]}),l(T,{gap:1,overflow:"hidden",children:[!c.length&&t(N,{children:h("report.user.error.nolist")}),c.length>0&&t(De,{columnCount:1,columnMinHeight:25,gap:1,children:c.map((m,f)=>t(be,{onClick:p=>d(m.id),itemActive:e===m.id,children:t("span",{dangerouslySetInnerHTML:{__html:m.username}})},m.id))})]}),l(w,{gap:2,justifyContent:"between",children:[t(M,{variant:"secondary",onClick:g,children:h("generic.back")}),t(M,{disabled:e<=0,onClick:()=>u(e),children:h("help.emergency.main.submit.button")})]})]})},uO=i=>{const[e,n]=o.useState(-1),[r,s]=o.useState(-1),{setActiveReport:a=null}=zn(),{cfhCategories:c=[]}=ua(),u=()=>{e<0||r<0||a(g=>({...g,cfhCategory:e,cfhTopic:c[e].topics[r].id,currentStep:$t.INPUT_REPORT_MESSAGE}))},d=()=>{a(g=>({...g,currentStep:g.currentStep-1}))};return l(B,{children:[l(T,{gap:1,children:[t(N,{fontSize:4,children:h("help.emergency.chat_report.subtitle")}),t(N,{children:h("help.cfh.pick.topic")})]}),l(T,{gap:1,overflow:"auto",children:[e<0&&c.map((g,m)=>t(M,{variant:"danger",onClick:f=>n(m),children:h(`help.cfh.reason.${g.name}`)},m)),e>=0&&c[e].topics.map((g,m)=>t(M,{variant:"danger",onClick:f=>s(m),active:r===m,children:h(`help.cfh.topic.${g.id}`)},m))]}),l(w,{gap:2,justifyContent:"between",children:[t(M,{variant:"secondary",onClick:d,children:h("generic.back")}),t(M,{disabled:r<0,onClick:u,children:h("help.emergency.main.submit.button")})]})]})},dO=i=>{const[e,n]=o.useState(!1),{activeReport:r=null,setActiveReport:s=null,report:a=null}=zn(),c=()=>{s(null),n(!1)};o.useEffect(()=>{const d={linkReceived:g=>{const m=g.split("/");if(!(m.length<2))switch(m[1]){case"show":n(!0);return;case"hide":n(!1);return;case"toggle":n(f=>!f);return;case"tour":return;case"report":m.length>=5&&m[2]==="room"&&(parseInt(m[3]),unescape(m.splice(4).join("/")));return}},eventUrlPrefix:"help/"};return It(d),()=>Et(d)},[]),o.useEffect(()=>{r&&n(!0)},[r]);const u=()=>{if(r)switch(r.currentStep){case $t.SELECT_USER:return t(cO,{});case $t.SELECT_CHATS:return t(lO,{});case $t.SELECT_TOPICS:return t(uO,{});case $t.INPUT_REPORT_MESSAGE:return t($R,{});case $t.REPORT_SUMMARY:return t(iO,{})}return t(KR,{})};return l(B,{children:[e&&l(ie,{className:"nitro-help",theme:"primary-slim",children:[t(ae,{headerText:h("help.button.cfh"),onCloseClick:c}),t(re,{className:"text-black",children:l(ne,{children:[t(T,{center:!0,size:5,overflow:"hidden",children:t(P,{className:"index-image"})}),t(T,{justifyContent:"between",size:7,overflow:"hidden",children:t(u,{})})]})})]}),t(oO,{}),t(aO,{})]})},mO=i=>{const[e,n]=o.useState(null),[r,s]=o.useState(null),[a,c]=o.useState(null),[u,d]=o.useState(null);return x(f_,g=>{const m=g.getParser();n(m.productType),s(m.productClassId),c(m.totalCoinsForBonus),d(m.coinsStillRequiredToBuy)}),o.useEffect(()=>{L(new p_)},[]),e?l("div",{className:"bonus-rare widget d-flex",children:[e,l("div",{className:"bg-light-dark rounded overflow-hidden position-relative bonus-bar-container",children:[t("div",{className:"d-flex justify-content-center align-items-center w-100 h-100 position-absolute small top-0",children:a-u+"/"+a}),t("div",{className:"small bg-info rounded position-absolute top-0 h-100",style:{width:(a-u)/a*100+"%"}})]})]}):null},hO=i=>{const{data:e=null,level:n=0}=i;return l("div",{className:"hof-user-container",children:[l("div",{className:"hof-tooltip",children:[l("div",{className:"hof-header",children:[n,". ",e.userName," ",t(An,{userId:e.userId})]}),t("div",{className:"small text-center text-white",children:h("landing.view.competition.hof.points",["points"],[ao(e.currentScore).toString()])})]}),t(it,{figure:e.figure,direction:2})]})},gO=i=>{const{slot:e=-1,conf:n=null}=i,[r,s]=o.useState(null);return x(I_,a=>{const c=a.getParser();s(c.data)}),o.useEffect(()=>{const a=n?n.campaign:"";L(new E_(a))},[n]),r?t("div",{className:"hall-of-fame d-flex",children:r.hof&&r.hof.length>0&&r.hof.map((a,c)=>t(hO,{data:a,level:c+1},c))}):null},fO=i=>{const[e,n]=o.useState(null),[r,s]=o.useState(0);return x(C_,a=>{const c=a.getParser();n(c.articles)}),o.useEffect(()=>{L(new __)},[]),e?l("div",{className:"promo-articles widget mb-2",children:[l("div",{className:"d-flex flex-row align-items-center w-100 mb-1",children:[t("small",{className:"flex-shrink-0 pe-1",children:h("landing.view.promo.article.header")}),t("hr",{className:"w-100 my-0"})]}),t("div",{className:"d-flex flex-row mb-1",children:e&&e.length>0&&e.map((a,c)=>t("div",{className:"promo-articles-bullet cursor-pointer "+(a===e[r]?"promo-articles-bullet-active":""),onClick:u=>s(c)},a.id))}),e&&e[r]&&l("div",{className:"promo-article d-flex flex-row row mx-0",children:[t("div",{className:"promo-article-image",style:{backgroundImage:`url(${e[r].imageUrl})`}}),l("div",{className:"col-3 d-flex flex-column h-100",children:[t("h3",{className:"my-0",children:e[r].title}),t("b",{children:e[r].bodyText}),t("button",{className:"btn btn-sm mt-auto btn-gainsboro",onClick:a=>ys(e[r].linkContent),children:e[r].buttonText})]})]})]}):null},pO=i=>{const{conf:e=null}=i,n=r=>{const s=e[r];if(!s)return null;switch(r){case"image":return Ur.interpolate(s)}return s};return l("div",{className:"widgetcontainer widget d-flex flex-row overflow-hidden",children:[t("div",{className:"widgetcontainer-image flex-shrink-0",style:{backgroundImage:`url(${n("image")})`}}),l("div",{className:"d-flex flex-column align-self-center",children:[t("h3",{className:"my-0",children:h(`landing.view.${n("texts")}.header`)}),t("i",{children:h(`landing.view.${n("texts")}.body`)}),t("button",{className:"btn btn-sm btn-gainsboro align-self-start px-3 mt-auto",onClick:r=>ys(n("btnLink")),children:h(`landing.view.${n("texts")}.button`)})]})]})},IO=i=>{switch(i.widgetType){case"promoarticle":return t(fO,{});case"achievementcompetition_hall_of_fame":return t(gO,{slot:i.slot,conf:i.widgetConf});case"bonusrare":return t(mO,{});case"widgetcontainer":return t(pO,{conf:i.widgetConf});default:return null}},hs=i=>{const{widgetType:e=null,widgetSlot:n=0,widgetConf:r=null,className:s="",...a}=i;return t("div",{className:`widget-slot slot-${n} ${s||""}`,...a,children:t(IO,{widgetType:e,slot:n,widgetConf:r})})},EO=i=>{const[e,n]=o.useState(!0),{userFigure:r=null}=Wr();if(je([Kt.CREATED,Kt.ENDED],f=>{switch(f.type){case Kt.CREATED:n(!1);return;case Kt.ENDED:n(f.openLandingView);return}}),!e)return null;const s=K("hotelview").images["background.colour"],a=Ur.interpolate(K("hotelview").images.background),c=Ur.interpolate(K("hotelview").images.sun),u=Ur.interpolate(K("hotelview").images.drape),d=Ur.interpolate(K("hotelview").images.left),g=Ur.interpolate(K("hotelview").images["right.repeat"]),m=Ur.interpolate(K("hotelview").images.right);return l("div",{className:"nitro-hotel-view",style:s&&s?{background:s}:{},children:[t("div",{className:"container h-100 py-3 overflow-hidden landing-widgets",children:l("div",{className:"row h-100",children:[l("div",{className:"col-9 h-100 d-flex flex-column",children:[t(hs,{widgetSlot:1,widgetType:K("hotelview").widgets["slot.1.widget"],widgetConf:K("hotelview").widgets["slot.1.conf"],className:"col-6"}),l("div",{className:"col-12 row mx-0",children:[t(hs,{widgetSlot:2,widgetType:K("hotelview").widgets["slot.2.widget"],widgetConf:K("hotelview").widgets["slot.2.conf"],className:"col-7"}),t(hs,{widgetSlot:3,widgetType:K("hotelview").widgets["slot.3.widget"],widgetConf:K("hotelview").widgets["slot.3.conf"],className:"col-5"}),t(hs,{widgetSlot:4,widgetType:K("hotelview").widgets["slot.4.widget"],widgetConf:K("hotelview").widgets["slot.4.conf"],className:"col-7"}),t(hs,{widgetSlot:5,widgetType:K("hotelview").widgets["slot.5.widget"],widgetConf:K("hotelview").widgets["slot.5.conf"],className:"col-5"})]}),t(hs,{widgetSlot:6,widgetType:K("hotelview").widgets["slot.6.widget"],widgetConf:K("hotelview").widgets["slot.6.conf"],className:"mt-auto"})]}),t("div",{className:"col-3 h-100",children:t(hs,{widgetSlot:7,widgetType:K("hotelview").widgets["slot.7.widget"],widgetConf:K("hotelview").widgets["slot.7.conf"]})})]})}),t("div",{className:"background position-absolute",style:a&&a.length?{backgroundImage:`url(${a})`}:{}}),t("div",{className:"sun position-absolute",style:c&&c.length?{backgroundImage:`url(${c})`}:{}}),t("div",{className:"drape position-absolute",style:u&&u.length?{backgroundImage:`url(${u})`}:{}}),t("div",{className:"left position-absolute",style:d&&d.length?{backgroundImage:`url(${d})`}:{}}),t("div",{className:"right-repeat position-absolute",style:g&&g.length?{backgroundImage:`url(${g})`}:{}}),t("div",{className:"right position-absolute",style:m&&m.length?{backgroundImage:`url(${m})`}:{}}),K("hotelview")["show.avatar"]&&t("div",{className:"avatar-image",children:t(it,{figure:r,direction:2})})]})},cd=i=>{const{badgeCode:e=null,children:n=null,...r}=i,{selectedBadgeCode:s=null,setSelectedBadgeCode:a=null,toggleBadge:c=null,getBadgeId:u=null}=rl(),{isUnseen:d=null}=Pn(),g=d(at.BADGE,u(e));return l(be,{itemActive:s===e,itemUnseen:g,onMouseDown:m=>a(e),onDoubleClick:m=>c(s),...r,children:[t(We,{badgeCode:e}),n]})},CO=i=>{const[e,n]=o.useState(!1),{badgeCodes:r=[],activeBadgeCodes:s=[],selectedBadgeCode:a=null,isWearingBadge:c=null,canWearBadges:u=null,toggleBadge:d=null,getBadgeId:g=null,activate:m=null,deactivate:f=null}=rl(),{isUnseen:p=null,removeUnseen:_=null}=Pn();return o.useEffect(()=>{!a||!p(at.BADGE,g(a))||_(at.BADGE,g(a))},[a,p,_,g]),o.useEffect(()=>{if(!e)return;const E=m();return()=>f(E)},[e,m,f]),o.useEffect(()=>(n(!0),()=>n(!1)),[]),l(ne,{children:[t(T,{size:7,overflow:"hidden",children:t(De,{columnCount:4,children:r&&r.length>0&&r.map((E,C)=>c(E)?null:t(cd,{badgeCode:E},C))})}),l(T,{className:"justify-content-between",size:5,overflow:"auto",children:[l(T,{overflow:"hidden",gap:2,children:[t(N,{children:h("inventory.badges.activebadges")}),t(De,{columnCount:3,children:s&&s.length>0&&s.map((E,C)=>t(cd,{badgeCode:E},C))})]}),!!a&&l(T,{grow:!0,justifyContent:"end",gap:2,children:[l(w,{alignItems:"center",gap:2,children:[t(We,{shrink:!0,badgeCode:a}),t(N,{children:si(a)})]}),t(M,{variant:c(a)?"danger":"success",disabled:!c(a)&&!u(),onClick:E=>d(a),children:h(c(a)?"inventory.badges.clearbadge":"inventory.badges.wearbadge")})]})]})]})},qc=i=>{const{title:e="",desc:n="",children:r=null,...s}=i;return l(ne,{...s,children:[t(T,{center:!0,size:5,overflow:"hidden",children:t("div",{className:"empty-image"})}),l(T,{justifyContent:"center",size:7,overflow:"hidden",children:[t(N,{fontWeight:"bold",fontSize:5,overflow:"unset",truncate:!0,children:e}),t(N,{overflow:"auto",children:n})]}),r]})},_O=i=>{const{botItem:e=null,children:n=null,...r}=i,[s,a]=o.useState(!1),{selectedBot:c=null,setSelectedBot:u=null}=ph(),{isUnseen:d=null}=Pn(),g=d(at.BOT,e.botData.id),m=f=>{switch(f.type){case Oe.MOUSE_DOWN:u(e),a(!0);return;case Oe.MOUSE_UP:a(!1);return;case Oe.ROLL_OUT:if(!s||c!==e)return;rc(e);return;case"dblclick":rc(e);return}};return l(be,{itemActive:c===e,itemUnseen:g,onMouseDown:m,onMouseUp:m,onMouseOut:m,onDoubleClick:m,...r,children:[t(it,{figure:e.botData.figure,direction:3,headOnly:!0}),n]})},bO=i=>{const{roomSession:e=null,roomPreviewer:n=null}=i,[r,s]=o.useState(!1),{botItems:a=[],selectedBot:c=null,activate:u=null,deactivate:d=null}=ph(),{isUnseen:g=null,removeUnseen:m=null}=Pn();return o.useEffect(()=>{if(!c||!n)return;const f=c.botData,p=j();let _=p.getRoomInstanceVariable(p.activeRoomId,ee.ROOM_WALL_TYPE),E=p.getRoomInstanceVariable(p.activeRoomId,ee.ROOM_FLOOR_TYPE),C=p.getRoomInstanceVariable(p.activeRoomId,ee.ROOM_LANDSCAPE_TYPE);_=_&&_.length?_:"101",E=E&&E.length?E:"101",C=C&&C.length?C:"1.1",n.reset(!1),n.updateRoomWallsAndFloorVisibility(!0,!0),n.updateObjectRoom(E,_,C),n.addAvatarIntoRoom(f.figure,0)},[n,c]),o.useEffect(()=>{!c||!g(at.BOT,c.botData.id)||m(at.BOT,c.botData.id)},[c,g,m]),o.useEffect(()=>{if(!r)return;const f=u();return()=>d(f)},[r,u,d]),o.useEffect(()=>(s(!0),()=>s(!1)),[]),!a||!a.length?t(qc,{title:h("inventory.empty.bots.title"),desc:h("inventory.empty.bots.desc")}):l(ne,{children:[t(T,{size:7,overflow:"hidden",children:t(De,{columnCount:5,children:a&&a.length>0&&a.map(f=>t(_O,{botItem:f},f.botData.id))})}),l(T,{size:5,overflow:"auto",children:[t(T,{overflow:"hidden",position:"relative",children:t(Ko,{roomPreviewer:n,height:140})}),c&&l(T,{grow:!0,justifyContent:"between",gap:2,children:[t(N,{grow:!0,truncate:!0,children:c.botData.name}),!!e&&t(M,{variant:"success",onClick:f=>rc(c),children:h("inventory.furni.placetoroom")})]})]})]})},SO=i=>{const{groupItem:e=null,...n}=i,[r,s]=o.useState(!1),{selectedItem:a=null,setSelectedItem:c=null}=Ds(),u=g=>{switch(g.type){case Oe.MOUSE_DOWN:c(e),s(!0);return;case Oe.MOUSE_UP:s(!1);return;case Oe.ROLL_OUT:if(!r||e!==a)return;oa(e);return;case"dblclick":oa(e);return}},d=e.getUnlockedCount();return t(be,{className:d?"":"opacity-0-5 ",itemImage:e.iconUrl,itemCount:e.getUnlockedCount(),itemActive:e===a,itemUniqueNumber:e.stuffData.uniqueNumber,itemUnseen:e.hasUnseenItems,onMouseDown:u,onMouseUp:u,onMouseOut:u,onDoubleClick:u,...n})},Vh=i=>{const{groupItems:e=[],setGroupItems:n=null}=i,[r,s]=o.useState("");return o.useEffect(()=>{let a=[...e];if(r&&r.length){const c=r.toLocaleLowerCase();a=e.filter(u=>c&&c.length&&u.name.toLocaleLowerCase().includes(c)?u:null)}n(a)},[e,n,r]),l(w,{gap:1,children:[t("input",{type:"text",className:"form-control form-control-sm",placeholder:h("generic.search"),value:r,onChange:a=>s(a.target.value)}),t(M,{variant:"primary",children:t(Cc,{className:"fa-icon"})})]})},NO=i=>{const e=i.getLastItem();if(!e||!e.sellable)return!1;yt(new fo(e))},TO=i=>{const{roomSession:e=null,roomPreviewer:n=null}=i,[r,s]=o.useState(!1),[a,c]=o.useState([]),{groupItems:u=[],selectedItem:d=null,activate:g=null,deactivate:m=null}=Ds(),{resetItems:f=null}=Pn();return o.useEffect(()=>{if(!d||!n)return;const p=d.getLastItem();if(!p)return;const _=j();let E=_.getRoomInstanceVariable(_.activeRoomId,ee.ROOM_WALL_TYPE),C=_.getRoomInstanceVariable(_.activeRoomId,ee.ROOM_FLOOR_TYPE),I=_.getRoomInstanceVariable(_.activeRoomId,ee.ROOM_LANDSCAPE_TYPE);if(E=E&&E.length?E:"101",C=C&&C.length?C:"101",I=I&&I.length?I:"1.1",n.reset(!1),n.updateObjectRoom(C,E,I),n.updateRoomWallsAndFloorVisibility(!0,!0),p.category===me.WALL_PAPER||p.category===me.FLOOR||p.category===me.LANDSCAPE){if(C=p.category===me.FLOOR?d.stuffData.getLegacyString():C,E=p.category===me.WALL_PAPER?d.stuffData.getLegacyString():E,I=p.category===me.LANDSCAPE?d.stuffData.getLegacyString():I,n.updateObjectRoom(C,E,I),p.category===me.LANDSCAPE){const b=W().getWallItemDataByName("window_double_default");b&&n.addWallItemIntoRoom(b.id,new Ot(90,0,0),b.customParams)}}else d.isWallItem?n.addWallItemIntoRoom(d.type,new Ot(90),p.stuffData.getLegacyString()):n.addFurnitureIntoRoom(d.type,new Ot(90),d.stuffData,p.extra.toString())},[n,d]),o.useEffect(()=>{!d||!d.hasUnseenItems||(f(at.FURNI,d.items.map(p=>p.id)),d.hasUnseenItems=!1)},[d,f]),o.useEffect(()=>{if(!r)return;const p=g();return()=>m(p)},[r,g,m]),o.useEffect(()=>(s(!0),()=>s(!1)),[]),!u||!u.length?t(qc,{title:h("inventory.empty.title"),desc:h("inventory.empty.desc")}):l(ne,{children:[l(T,{size:7,overflow:"hidden",children:[t(Vh,{groupItems:u,setGroupItems:c}),t(De,{columnCount:5,children:a&&a.length>0&&a.map((p,_)=>t(SO,{groupItem:p},_))})]}),l(T,{size:5,overflow:"auto",children:[l(T,{overflow:"hidden",position:"relative",children:[t(Ko,{roomPreviewer:n,height:140}),d&&d.stuffData.isUnique&&t(uh,{className:"top-2 end-2",position:"absolute",uniqueNumber:d.stuffData.uniqueNumber,uniqueSeries:d.stuffData.uniqueSeries}),d&&d.stuffData.rarityLevel>-1&&t(Fc,{className:"top-2 end-2",position:"absolute",level:d.stuffData.rarityLevel})]}),d&&l(T,{grow:!0,justifyContent:"between",gap:2,children:[t(N,{grow:!0,truncate:!0,children:d.name}),l(T,{gap:1,children:[!!e&&t(M,{variant:"success",onClick:p=>oa(d),children:h("inventory.furni.placetoroom")}),d&&d.isSellable&&t(M,{onClick:p=>NO(d),children:h("inventory.marketplace.sell")})]})]})]})]})},kl=9,vO=i=>{const{cancelTrade:e=null}=i,[n,r]=o.useState(null),[s,a]=o.useState(null),[c,u]=o.useState(null),[d,g]=o.useState(null),[m,f]=o.useState(3),[p,_]=o.useState(1),{ownUser:E=null,otherUser:C=null,groupItems:I=[],tradeState:b=wt.TRADING_STATE_READY,progressTrade:S=null,removeItem:v=null,setTradeState:y=null}=Eh(),{simpleAlert:R=null}=ze(),O=(D,V,G,$,X)=>{if(!E||E.accepts||!E.userItems)return!1;if(E.userItems.length<kl)return!0;if(!$)return!1;let Y=V.toString();return G===me.POSTER?Y=Y+"poster"+X.getLegacyString():G===me.GUILD_FURNI?Y=AS(V,X):Y=(D?"I":"S")+Y,!!E.userItems.getValue(Y)},F=D=>{if(!n)return;const V=n.getTradeItems(D);if(!V||!V.length)return;let G=null;const $=[];for(const Y of V)$.push(Y.id),G||(G=Y);if(E.userItems.length+$.length<=1500)if(!G.isGroupable&&$.length)L(new pu($.pop()));else{const Y=[];for(const Ee of $)O(G.isWallItem,G.type,G.category,G.isGroupable,G.stuffData)&&Y.push(Ee);Y.length&&(Y.length===1?L(new pu(Y.pop())):L(new b_(...Y)))}else R(h("trading.items.too_many_items.desc"),ge.DEFAULT,null,null,h("trading.items.too_many_items.title"))},U=D=>D?t(Jd,{className:"text-success fa-icon"}):t(og,{className:"text-danger fa-icon"}),A=(D,V)=>{(isNaN(Number(D))||Number(D)<0||!D)&&(D=1),D=Math.max(Number(D),1),D=Math.min(Number(D),V),D!==p&&_(D)},k=D=>{A(p,D),F(p)};return o.useEffect(()=>{_(1)},[n]),o.useEffect(()=>{if(b!==wt.TRADING_STATE_COUNTDOWN)return;f(3);const D=setInterval(()=>{f(V=>{const G=V-1;return G===0&&clearInterval(D),G})},1e3);return()=>clearInterval(D)},[b,y]),o.useEffect(()=>{m===0&&y(wt.TRADING_STATE_CONFIRMING)},[m,y]),b===wt.TRADING_STATE_READY||!E||!C?null:l(ne,{children:[l(T,{size:4,overflow:"hidden",children:[t(Vh,{groupItems:I,setGroupItems:g}),l(w,{column:!0,fullHeight:!0,justifyContent:"between",overflow:"hidden",gap:2,children:[t(De,{columnCount:3,children:d&&d.length>0&&d.map((D,V)=>{const G=D.getUnlockedCount();return t(be,{className:G?"":"opacity-0-5 ",itemImage:D.iconUrl,itemCount:G,itemActive:n===D,itemUniqueNumber:D.stuffData.uniqueNumber,onClick:$=>G&&r(D),onDoubleClick:$=>F(1),children:G>0&&n===D&&t(M,{position:"absolute",variant:"success",className:"trade-button bottom-1 end-1",onClick:$=>F(1),children:t(En,{className:"fa-icon"})})},V)})}),l(T,{gap:1,alignItems:"end",children:[l(ne,{overflow:"hidden",children:[t(T,{size:6,overflow:"hidden",children:t("input",{type:"number",className:"form-control form-control-sm quantity-input",placeholder:h("catalog.bundlewidget.spinner.select.amount"),disabled:!n,value:p,onChange:D=>_(D.target.valueAsNumber)})}),t(T,{size:6,overflow:"hidden",children:t(M,{variant:"secondary",disabled:!n,onClick:D=>k(n.getUnlockedCount()),children:h("inventory.trading.areoffering")})})]}),t(P,{fullWidth:!0,className:"badge bg-muted",children:n?n.name:h("catalog_selectproduct")})]})]})]}),l(T,{size:8,overflow:"hidden",children:[l(ne,{overflow:"hidden",children:[l(T,{size:6,overflow:"hidden",children:[l(w,{justifyContent:"between",alignItems:"center",children:[l(N,{children:[h("inventory.trading.you")," ",h("inventory.trading.areoffering"),":"]}),U(E.accepts)]}),t(De,{columnCount:3,children:Array.from(Array(kl),(D,V)=>{const G=E.userItems.getWithIndex(V)||null;return G?t(be,{itemActive:s===G,itemImage:G.iconUrl,itemCount:G.getTotalCount(),itemUniqueNumber:G.stuffData.uniqueNumber,onClick:$=>a(G),onDoubleClick:$=>v(G),children:s===G&&t(M,{position:"absolute",variant:"danger",className:"trade-button bottom-1 start-1",onClick:$=>v(G),children:t(In,{className:"fa-icon"})})},V):t(be,{},V)})}),t(P,{fullWidth:!0,className:"badge bg-muted",children:s?s.name:h("catalog_selectproduct")})]}),l(T,{size:6,overflow:"hidden",children:[l(w,{justifyContent:"between",alignItems:"center",children:[l(N,{children:[C.userName," ",h("inventory.trading.isoffering"),":"]}),U(C.accepts)]}),t(De,{columnCount:3,children:Array.from(Array(kl),(D,V)=>{const G=C.userItems.getWithIndex(V)||null;return G?t(be,{itemActive:c===G,itemImage:G.iconUrl,itemCount:G.getTotalCount(),itemUniqueNumber:G.stuffData.uniqueNumber,onClick:$=>u(G)},V):t(be,{},V)})}),t(P,{fullWidth:!0,className:"badge bg-muted w-100",children:c?c.name:h("catalog_selectproduct")})]})]}),l(w,{grow:!0,justifyContent:"between",children:[t(M,{variant:"danger",onClick:e,children:h("generic.cancel")}),b===wt.TRADING_STATE_READY&&t(M,{variant:"secondary",disabled:!E.itemCount&&!C.itemCount,onClick:S,children:h("inventory.trading.accept")}),b===wt.TRADING_STATE_RUNNING&&t(M,{variant:"secondary",disabled:!E.itemCount&&!C.itemCount,onClick:S,children:h(E.accepts?"inventory.trading.modify":"inventory.trading.accept")}),b===wt.TRADING_STATE_COUNTDOWN&&t(M,{variant:"secondary",disabled:!0,children:h("inventory.trading.countdown",["counter"],[m.toString()])}),b===wt.TRADING_STATE_CONFIRMING&&t(M,{variant:"secondary",onClick:S,children:h("inventory.trading.button.restore")}),b===wt.TRADING_STATE_CONFIRMED&&t(M,{variant:"secondary",children:h("inventory.trading.info.waiting")})]})]})]})},wO=i=>{const{petItem:e=null,children:n=null,...r}=i,[s,a]=o.useState(!1),{selectedPet:c=null,setSelectedPet:u=null}=Ih(),{isUnseen:d}=Pn(),g=d(at.PET,e.petData.id),m=f=>{switch(f.type){case Oe.MOUSE_DOWN:u(e),a(!0);return;case Oe.MOUSE_UP:a(!1);return;case Oe.ROLL_OUT:if(!s||e!==c)return;nc(e);return;case"dblclick":nc(e);return}};return l(be,{itemActive:e===c,itemUnseen:g,onMouseDown:m,onMouseUp:m,onMouseOut:m,onDoubleClick:m,...r,children:[t(Ir,{figure:e.petData.figureData.figuredata,direction:3,headOnly:!0}),n]})},RO=i=>{const{roomSession:e=null,roomPreviewer:n=null}=i,[r,s]=o.useState(!1),{petItems:a=null,selectedPet:c=null,activate:u=null,deactivate:d=null}=Ih(),{isUnseen:g=null,removeUnseen:m=null}=Pn();return o.useEffect(()=>{if(!c||!n)return;const f=c.petData,p=j();let _=p.getRoomInstanceVariable(p.activeRoomId,ee.ROOM_WALL_TYPE),E=p.getRoomInstanceVariable(p.activeRoomId,ee.ROOM_FLOOR_TYPE),C=p.getRoomInstanceVariable(p.activeRoomId,ee.ROOM_LANDSCAPE_TYPE);_=_&&_.length?_:"101",E=E&&E.length?E:"101",C=C&&C.length?C:"1.1",n.reset(!1),n.updateRoomWallsAndFloorVisibility(!0,!0),n.updateObjectRoom(E,_,C),n.addPetIntoRoom(f.figureString)},[n,c]),o.useEffect(()=>{!c||!g(at.PET,c.petData.id)||m(at.PET,c.petData.id)},[c,g,m]),o.useEffect(()=>{if(!r)return;const f=u();return()=>d(f)},[r,u,d]),o.useEffect(()=>(s(!0),()=>s(!1)),[]),!a||!a.length?t(qc,{title:h("inventory.empty.pets.title"),desc:h("inventory.empty.pets.desc")}):l(ne,{children:[t(T,{size:7,overflow:"hidden",children:t(De,{columnCount:5,children:a&&a.length>0&&a.map(f=>t(wO,{petItem:f},f.petData.id))})}),l(T,{size:5,overflow:"auto",children:[t(T,{overflow:"hidden",position:"relative",children:t(Ko,{roomPreviewer:n,height:140})}),c&&c.petData&&l(T,{grow:!0,justifyContent:"between",gap:2,children:[t(N,{grow:!0,truncate:!0,children:c.petData.name}),!!e&&t(M,{variant:"success",onClick:f=>nc(c),children:h("inventory.furni.placetoroom")})]})]})]})},Bh="inventory.furni",Hh="inventory.bots",Wh="inventory.furni.tab.pets",jh="inventory.badges",ud=[Bh,Hh,Wh,jh],OO=[at.FURNI,at.BOT,at.PET,at.BADGE],yO=i=>{const[e,n]=o.useState(!1),[r,s]=o.useState(ud[0]),[a,c]=o.useState(null),[u,d]=o.useState(null),{isTrading:g=!1,stopTrading:m=null}=Eh(),{getCount:f=null,resetCategory:p=null}=Pn(),_=()=>{g&&m(),n(!1)};return Ne(St.PLACED,E=>{RS()&&(ai(!1),E.placedInRoom||n(!0))}),je([Kt.CREATED,Kt.ENDED],E=>{switch(E.type){case Kt.CREATED:c(E.session);return;case Kt.ENDED:c(null),n(!1);return}}),x(S_,E=>{const C=E.getParser();for(const I of C.data)Bm().setBadgePointLimit(I.badgeId,I.limit)}),o.useEffect(()=>{const E={linkReceived:C=>{const I=C.split("/");if(!(I.length<2))switch(I[1]){case"show":n(!0);return;case"hide":n(!1);return;case"toggle":n(b=>!b);return}},eventUrlPrefix:"inventory/"};return It(E),()=>Et(E)},[]),o.useEffect(()=>(d(new Zi(j(),++Zi.PREVIEW_COUNTER)),()=>{d(E=>(E.dispose(),null))}),[]),o.useEffect(()=>{!e&&g&&n(!0)},[e,g]),e?l(ie,{uniqueKey:"inventory",className:"nitro-inventory",theme:g?"primary-slim":"",children:[t(ae,{headerText:h("inventory.title"),onCloseClick:_}),!g&&l(B,{children:[t(Br,{children:ud.map((E,C)=>t(sr,{isActive:r===E,onClick:I=>s(E),count:f(OO[C]),children:h(E)},C))}),l(re,{children:[r===Bh&&t(TO,{roomSession:a,roomPreviewer:u}),r===Hh&&t(bO,{roomSession:a,roomPreviewer:u}),r===Wh&&t(RO,{roomSession:a,roomPreviewer:u}),r===jh&&t(CO,{})]})]}),g&&t(re,{children:t(vO,{cancelTrade:_})})]}):null},kO=i=>{const{mention:e}=i,{markMentionAsRead:n,deleteMention:r}=Gc(),[s,a]=o.useState(!1),c="mentionerUsername"in e?e.mentionerUsername:e.username||"Unknown",u="mentionerUserId"in e?e.mentionerUserId:-1,d="roomName"in e?e.roomName:"",g="roomId"in e?e.roomId:0,m=typeof e.timestamp=="number"?new Date(e.timestamp*1e3):e.timestamp,f=()=>{e.isRead||n(e.id)},p=()=>{r(e.id)},_=()=>{u>0&&(L(new Wo(u)),a(!0))},E=()=>{g>0&&Sn(g)},C=I=>{const S=new Date().getTime()-I.getTime(),v=Math.floor(S/6e4),y=Math.floor(S/36e5),R=Math.floor(S/864e5);return v<1?"just now":v<60?`${v}m ago`:y<24?`${y}h ago`:R<7?`${R}d ago`:I.toLocaleDateString()};return t(w,{className:`mention-log-item ${e.isRead?"read":"unread"}`,gap:2,alignItems:"center",children:l(w,{fullWidth:!0,column:!0,gap:1,className:"mention-content",children:[l(w,{justifyContent:"between",alignItems:"center",children:[t(P,{className:"mention-username",children:c}),t(P,{className:"mention-timestamp",children:C(m)})]}),t(P,{className:"mention-message",children:e.message}),d&&l(P,{className:"mention-room",style:{fontSize:"11px",color:"#757575",fontStyle:"italic"},children:['in "',d,'"']}),l(w,{gap:1,className:"mention-actions",alignItems:"center",style:{flexWrap:"wrap"},children:[e.isRead?t(M,{size:"sm",variant:"secondary",disabled:!0,children:"Read"}):t(M,{size:"sm",variant:"success",onClick:f,children:" Mark read"}),u>0&&t(M,{size:"sm",variant:s?"secondary":"primary",onClick:_,disabled:s,children:s?"Following":" Follow"}),g>0&&t(M,{size:"sm",variant:"info",onClick:E,children:" Go to room"}),t(M,{size:"sm",variant:"danger",onClick:p,children:""})]})]})})},AO=i=>{const[e,n]=o.useState(!1),{mentions:r,unreadCount:s,markAllMentionsAsRead:a,requestMentionsList:c}=Gc(),u=r;return o.useEffect(()=>{const d={linkReceived:g=>{const m=g.split("/");if(!(m.length<2))switch(m[1]){case"show":n(!0),c(0,20);return;case"hide":n(!1);return;case"toggle":n(f=>{const p=!f;return p&&c(0,20),p});return}},eventUrlPrefix:"mention-logs/"};return It(d),()=>Et(d)},[c]),e?l(ie,{className:"nitro-mention-logs",uniqueKey:"nitro-mention-logs",theme:"primary-slim",children:[t(ae,{headerText:`Mention Logs ${s>0?`(${s})`:""}`,onCloseClick:d=>n(!1)}),l(re,{overflow:"hidden",gap:0,className:"text-black p-0",children:[s>0&&t(w,{className:"p-2",justifyContent:"end",children:t(M,{size:"sm",variant:"primary",onClick:a,children:"Mark all as read"})}),t("div",{className:"mention-logs-list",children:u.length>0?u.map(d=>t(kO,{mention:d},d.id)):t(w,{center:!0,className:"p-4",children:t("p",{className:"text-muted",children:"No mentions yet"})})})]})]}):null},zc=i=>{const{records:e=null}=i,{openRoomInfo:n=null}=ua(),r=o.useMemo(()=>{const a=[];return e.forEach(c=>{a.push({isRoomInfo:!0,roomId:c.roomId,roomName:c.roomName}),c.chatlog.forEach(u=>{a.push({timestamp:u.timestamp,habboId:u.userId,username:u.userName,hasHighlighting:u.hasHighlighting,message:u.message,isRoomInfo:!1})})}),a},[e]),s=a=>l(w,{gap:2,alignItems:"center",justifyContent:"between",className:"bg-muted rounded p-1",children:[l(w,{gap:1,children:[t(N,{bold:!0,children:"Room name:"}),t(N,{children:a.roomName})]}),l(w,{gap:1,children:[t(M,{onClick:c=>Sn(a.roomId),children:"Visit Room"}),t(M,{onClick:c=>n(a.roomId),children:"Room Tools"})]})]});return t(B,{children:l(T,{fit:!0,gap:0,overflow:"hidden",children:[t(T,{gap:2,children:l(ne,{gap:1,className:"text-black fw-bold border-bottom pb-1",children:[t(P,{className:"g-col-2",children:"Time"}),t(P,{className:"g-col-3",children:"User"}),t(P,{className:"g-col-7",children:"Message"})]})}),e&&e.length>0&&t(Qo,{rows:r,rowRender:a=>l(B,{children:[a.isRoomInfo&&t(s,{roomId:a.roomId,roomName:a.roomName}),!a.isRoomInfo&&l(ne,{fullHeight:!1,gap:1,alignItems:"center",className:"log-entry py-1 border-bottom",children:[t(N,{className:"g-col-2",children:a.timestamp}),t(N,{className:"g-col-3",bold:!0,underline:!0,pointer:!0,onClick:c=>Z(`mod-tools/open-user-info/${a.habboId}`),children:a.username}),t(N,{textBreak:!0,wrap:!0,className:"g-col-7",children:a.message})]})]})})]})})},DO=i=>{const{roomId:e=null,onCloseClick:n=null}=i,[r,s]=o.useState(null);return x(N_,a=>{const c=a.getParser();!c||c.data.roomId!==e||s(c.data)}),o.useEffect(()=>{L(new T_(e))},[e]),r?l(ie,{className:"nitro-mod-tools-chatlog",theme:"primary-slim",windowPosition:Ht.TOP_LEFT,children:[t(ae,{headerText:`Room Chatlog ${r.roomName}`,onCloseClick:n}),t(re,{className:"text-black",overflow:"hidden",children:r&&t(zc,{records:[r]})})]}):null},PO=i=>{const{roomId:e=null,onCloseClick:n=null}=i,[r,s]=o.useState(!1),[a,c]=o.useState(null),[u,d]=o.useState(null),[g,m]=o.useState(null),[f,p]=o.useState(null),[_,E]=o.useState(!1),[C,I]=o.useState(0),[b,S]=o.useState(!1),[v,y]=o.useState(!1),[R,O]=o.useState(!1),[F,U]=o.useState(""),A=(k,D)=>{if(k)switch(k){case"alert_only":if(F.trim().length===0)return;L(new bi(bi.ACTION_ALERT,F,"")),L(new Iu(e,v?1:0,R?1:0,b?1:0));return;case"send_message":if(F.trim().length===0)return;L(new bi(bi.ACTION_MESSAGE,F,"")),L(new Iu(e,v?1:0,R?1:0,b?1:0));return}};return x(v_,k=>{const D=k.getParser();!D||D.data.flatId!==e||(c(D.data.flatId),d(D.data.room.name),m(D.data.ownerId),p(D.data.ownerName),E(D.data.ownerInRoom),I(D.data.userCount))}),o.useEffect(()=>{r||(L(new w_(e)),s(!0))},[e,r,s]),l(ie,{className:"nitro-mod-tools-room",theme:"primary-slim",windowPosition:Ht.TOP_LEFT,children:[t(ae,{headerText:"Room Info"+(u?": "+u:""),onCloseClick:k=>n()}),l(re,{className:"text-black",children:[l(w,{gap:2,children:[l(T,{justifyContent:"center",grow:!0,gap:1,children:[l(w,{alignItems:"center",gap:2,children:[t(N,{bold:!0,align:"end",className:"col-7",children:"Room Owner:"}),t(N,{underline:!0,pointer:!0,truncate:!0,children:f})]}),l(w,{alignItems:"center",gap:2,children:[t(N,{bold:!0,align:"end",className:"col-7",children:"Users in room:"}),t(N,{children:C})]}),l(w,{alignItems:"center",gap:2,children:[t(N,{bold:!0,align:"end",className:"col-7",children:"Owner in room:"}),t(N,{children:_?"Yes":"No"})]})]}),l(T,{gap:1,children:[t(M,{onClick:k=>Sn(e),children:"Visit Room"}),t(M,{onClick:k=>Z(`mod-tools/open-room-chatlog/${e}`),children:"Chatlog"})]})]}),l(T,{className:"bg-muted rounded p-2",gap:1,children:[l(w,{alignItems:"center",gap:1,children:[t("input",{className:"form-check-input",type:"checkbox",checked:b,onChange:k=>S(k.target.checked)}),t(N,{small:!0,children:"Kick everyone out"})]}),l(w,{alignItems:"center",gap:1,children:[t("input",{className:"form-check-input",type:"checkbox",checked:v,onChange:k=>y(k.target.checked)}),t(N,{small:!0,children:"Enable the doorbell"})]}),l(w,{alignItems:"center",gap:1,children:[t("input",{className:"form-check-input",type:"checkbox",checked:R,onChange:k=>O(k.target.checked)}),t(N,{small:!0,children:"Change room name"})]})]}),t("textarea",{className:"form-control",placeholder:"Type a mandatory message to the users in this text box...",value:F,onChange:k=>U(k.target.value)}),l(w,{justifyContent:"between",children:[t(M,{variant:"danger",onClick:k=>A("send_message"),children:"Send Caution"}),t(M,{onClick:k=>A("alert_only"),children:"Send Alert only"})]})]})]})},LO=i=>{const{onCloseClick:e=null,issueId:n=null}=i,[r,s]=o.useState(null);return x(R_,a=>{const c=a.getParser();!c||c.data.issueId!==n||s(c.data)}),o.useEffect(()=>{L(new O_(n))},[n]),l(ie,{className:"nitro-mod-tools-chatlog",theme:"primary-slim",children:[t(ae,{headerText:"Issue Chatlog",onCloseClick:e}),t(re,{className:"text-black",children:r&&t(zc,{records:[r.chatRecord]})})]})},MO=i=>{const{issueId:e=null,onIssueInfoClosed:n=null}=i,[r,s]=o.useState(!1),{tickets:a=[],openUserInfo:c=null}=ua(),u=a.find(m=>m.issueId===e),d=m=>{L(new Dm([m])),n(m)},g=m=>{L(new Si([e],m)),n(e)};return l(B,{children:[l(ie,{className:"nitro-mod-tools-handle-issue",theme:"primary-slim",children:[t(ae,{headerText:"Resolving issue "+e,onCloseClick:()=>n(e)}),l(re,{className:"text-black",children:[t(N,{fontSize:4,children:"Issue Information"}),l(ne,{overflow:"auto",children:[t(T,{size:8,children:t("table",{className:"table table-striped table-sm table-text-small text-black m-0",children:l("tbody",{children:[l("tr",{children:[t("th",{children:"Source"}),t("td",{children:ZS(u.categoryId)})]}),l("tr",{children:[t("th",{children:"Category"}),t("td",{className:"text-break",children:h("help.cfh.topic."+u.reportedCategoryId)})]}),l("tr",{children:[t("th",{children:"Description"}),t("td",{className:"text-break",children:u.message})]}),l("tr",{children:[t("th",{children:"Caller"}),t("td",{children:t(N,{bold:!0,underline:!0,pointer:!0,onClick:m=>c(u.reporterUserId),children:u.reporterUserName})})]}),l("tr",{children:[t("th",{children:"Reported User"}),t("td",{children:t(N,{bold:!0,underline:!0,pointer:!0,onClick:m=>c(u.reportedUserId),children:u.reportedUserName})})]})]})})}),l(T,{size:4,gap:1,children:[t(M,{variant:"secondary",onClick:()=>s(!r),children:"Chatlog"}),t(M,{onClick:m=>g(Si.RESOLUTION_USELESS),children:"Close as useless"}),t(M,{variant:"danger",onClick:m=>g(Si.RESOLUTION_ABUSIVE),children:"Close as abusive"}),t(M,{variant:"success",onClick:m=>g(Si.RESOLUTION_RESOLVED),children:"Close as resolved"}),t(M,{variant:"secondary",onClick:m=>d(e),children:"Release"})]})]})]})]}),r&&t(LO,{issueId:e,onCloseClick:()=>s(!1)})]})},UO=i=>{const{myIssues:e=null,handleIssue:n=null}=i;return l(T,{gap:0,overflow:"hidden",children:[t(T,{gap:2,children:l(ne,{gap:1,className:"text-black fw-bold border-bottom pb-1",children:[t(P,{className:"g-col-2",children:"Type"}),t(P,{className:"g-col-3",children:"Room/Player"}),t(P,{className:"g-col-3",children:"Opened"}),t(P,{className:"g-col-2"}),t(P,{className:"g-col-2"})]})}),t(T,{overflow:"auto",className:"striped-children",gap:0,children:e&&e.length>0&&e.map(r=>l(ne,{gap:1,alignItems:"center",className:"text-black py-1 border-bottom",children:[t(P,{className:"g-col-2",children:r.categoryId}),t(P,{className:"g-col-3",children:r.reportedUserName}),t(P,{className:"g-col-3",children:new Date(Date.now()-r.issueAgeInMilliseconds).toLocaleTimeString()}),t(P,{className:"g-col-2",children:t(M,{variant:"primary",onClick:s=>n(r.issueId),children:"Handle"})}),t(P,{className:"g-col-2",children:t(M,{variant:"danger",onClick:s=>L(new Dm([r.issueId])),children:"Release"})})]},r.issueId))})]})},xO=i=>{const{openIssues:e=null}=i;return l(T,{gap:0,overflow:"hidden",children:[t(T,{gap:2,children:l(ne,{gap:1,className:"text-black fw-bold border-bottom pb-1",children:[t(P,{className:"g-col-2",children:"Type"}),t(P,{className:"g-col-3",children:"Room/Player"}),t(P,{className:"g-col-4",children:"Opened"}),t(P,{className:"g-col-3"})]})}),t(T,{overflow:"auto",className:"striped-children",gap:0,children:e&&e.length>0&&e.map(n=>l(ne,{gap:1,alignItems:"center",className:"text-black py-1 border-bottom",children:[t(P,{className:"g-col-2",children:n.categoryId}),t(P,{className:"g-col-3",children:n.reportedUserName}),t(P,{className:"g-col-4",children:new Date(Date.now()-n.issueAgeInMilliseconds).toLocaleTimeString()}),t(P,{className:"g-col-3",children:t(M,{variant:"success",onClick:r=>L(new y_([n.issueId],!1,0,"pick issue button")),children:"Pick Issue"})})]},n.issueId))})]})},FO=i=>{const{pickedIssues:e=null}=i;return l(T,{gap:0,overflow:"hidden",children:[t(T,{gap:2,children:l(ne,{gap:1,className:"text-black fw-bold border-bottom pb-1",children:[t(P,{className:"g-col-2",children:"Type"}),t(P,{className:"g-col-3",children:"Room/Player"}),t(P,{className:"g-col-4",children:"Opened"}),t(P,{className:"g-col-3",children:"Picker"})]})}),t(T,{overflow:"auto",className:"striped-children",gap:0,children:e&&e.length>0&&e.map(n=>l(ne,{gap:1,alignItems:"center",className:"text-black py-1 border-bottom",children:[t(P,{className:"g-col-2",children:n.categoryId}),t(P,{className:"g-col-3",children:n.reportedUserName}),t(P,{className:"g-col-4",children:new Date(Date.now()-n.issueAgeInMilliseconds).toLocaleTimeString()}),t(P,{className:"g-col-3",children:n.pickerUserName})]},n.issueId))})]})},GO=["Open Issues","My Issues","Picked Issues"],VO=i=>{const{onCloseClick:e=null}=i,[n,r]=o.useState(0),[s,a]=o.useState([]),{tickets:c=[]}=ua(),u=c.filter(_=>_.state===Cl.STATE_OPEN),d=c.filter(_=>_.state===Cl.STATE_PICKED&&_.pickerUserId===W().userId),g=c.filter(_=>_.state===Cl.STATE_PICKED),m=_=>{a(E=>{const C=[...E],I=C.indexOf(_);return I>=0&&C.splice(I,1),C})},f=_=>{a(E=>{const C=[...E],I=C.indexOf(_);return I===-1?C.push(_):C.splice(I,1),C})},p=()=>{switch(n){case 0:return t(xO,{openIssues:u});case 1:return t(UO,{myIssues:d,handleIssue:f});case 2:return t(FO,{pickedIssues:g})}return null};return l(B,{children:[l(ie,{className:"nitro-mod-tools-tickets",children:[t(ae,{headerText:"Tickets",onCloseClick:e}),t(Br,{children:GO.map((_,E)=>t(sr,{isActive:n===E,onClick:C=>r(E),children:_},E))}),t(re,{gap:1,children:t(p,{})})]}),s&&s.length>0&&s.map(_=>t(MO,{issueId:_,onIssueInfoClosed:m},_))]})},BO=i=>{const{userId:e=null,onCloseClick:n=null}=i,[r,s]=o.useState(null),[a,c]=o.useState(null);return x(k_,u=>{const d=u.getParser();!d||d.data.userId!==e||(c(d.data.username),s(d.data.roomChatlogs))}),o.useEffect(()=>{L(new A_(e))},[e]),l(ie,{className:"nitro-mod-tools-chatlog",theme:"primary-slim",windowPosition:Ht.TOP_LEFT,children:[t(ae,{headerText:`User Chatlog: ${a||""}`,onCloseClick:n}),t(re,{className:"text-black h-100",children:r&&t(zc,{records:r})})]})},dd=[new Ge(1,"Alert",Ge.ALERT,1,0),new Ge(2,"Mute 1h",Ge.MUTE,2,0),new Ge(3,"Ban 18h",Ge.BAN,3,0),new Ge(4,"Ban 7 days",Ge.BAN,4,0),new Ge(5,"Ban 30 days (step 1)",Ge.BAN,5,0),new Ge(7,"Ban 30 days (step 2)",Ge.BAN,7,0),new Ge(6,"Ban 100 years",Ge.BAN,6,0),new Ge(106,"Ban avatar-only 100 years",Ge.BAN,6,0),new Ge(101,"Kick",Ge.KICK,0,0),new Ge(102,"Lock trade 1 week",Ge.TRADE_LOCK,0,168),new Ge(104,"Lock trade permanent",Ge.TRADE_LOCK,0,876e3),new Ge(105,"Message",Ge.MESSAGE,0,0)],HO=i=>{const{user:e=null,onCloseClick:n=null}=i,[r,s]=o.useState(-1),[a,c]=o.useState(-1),[u,d]=o.useState(""),{cfhCategories:g=null,settings:m=null}=ua(),{simpleAlert:f=null}=ze(),p=o.useMemo(()=>{const I=[];if(g&&g.length)for(const b of g)for(const S of b.topics)I.push(S);return I},[g]),_=I=>f(I,ge.DEFAULT,null,null,"Error"),E=()=>{let I=null;const b=p[r];if(r===-1&&(I="You must select a CFH topic"),I)return _(I);const S=u.trim().length===0?h(`help.cfh.topic.${b.id}`):u;L(new D_(e.userId,r,S)),n()},C=()=>{let I=null;const b=p[r],S=dd[a];if(r===-1||a===-1?I="You must select a CFH topic and Sanction":!m||!m.cfhPermission?I="You do not have permission to do this":b?S||(I="You must select a sanction"):I="You must select a CFH topic",I){_(I);return}const v=u.trim().length===0?h(`help.cfh.topic.${b.id}`):u;switch(S.actionType){case Ge.ALERT:{if(!m.alertPermission){_("You have insufficient permissions");return}L(new x_(e.userId,v,b.id));break}case Ge.MUTE:L(new U_(e.userId,v,b.id));break;case Ge.BAN:{if(!m.banPermission){_("You have insufficient permissions");return}L(new M_(e.userId,v,b.id,a,S.actionId===106));break}case Ge.KICK:{if(!m.kickPermission){_("You have insufficient permissions");return}L(new L_(e.userId,v,b.id));break}case Ge.TRADE_LOCK:{const y=S.actionLengthHours*60;L(new P_(e.userId,v,y,b.id));break}case Ge.MESSAGE:{if(u.trim().length===0){_("Please write a message to user");return}L(new Pm(e.userId,u,b.id));break}}n()};return e?l(ie,{className:"nitro-mod-tools-user-action",theme:"primary-slim",windowPosition:Ht.TOP_LEFT,children:[t(ae,{headerText:"Mod Action: "+(e?e.username:""),onCloseClick:()=>n()}),l(re,{className:"text-black",children:[l("select",{className:"form-select form-select-sm",value:r,onChange:I=>s(parseInt(I.target.value)),children:[t("option",{value:-1,disabled:!0,children:"CFH Topic"}),p.map((I,b)=>t("option",{value:b,children:h("help.cfh.topic."+I.id)},b))]}),l("select",{className:"form-select form-select-sm",value:a,onChange:I=>c(parseInt(I.target.value)),children:[t("option",{value:-1,disabled:!0,children:"Sanction Type"}),dd.map((I,b)=>t("option",{value:b,children:I.name},b))]}),l(T,{gap:1,children:[t(N,{small:!0,children:"Optional message type, overrides default"}),t("textarea",{className:"form-control",value:u,onChange:I=>d(I.target.value)})]}),l(w,{justifyContent:"between",gap:1,children:[t(M,{variant:"primary",onClick:E,children:"Default Sanction"}),t(M,{variant:"success",onClick:C,children:"Sanction"})]})]})]}):null},WO=i=>{const{userId:e=null,onCloseClick:n=null}=i,[r,s]=o.useState(null);return x(F_,a=>{const c=a.getParser();c.data.userId===e&&s(c.data)}),o.useEffect(()=>{L(new G_(e))},[e]),e?l(ie,{className:"nitro-mod-tools-user-visits",theme:"primary-slim",windowPosition:Ht.TOP_LEFT,children:[t(ae,{headerText:"User Visits",onCloseClick:n}),t(re,{className:"text-black",gap:1,children:l(T,{fullHeight:!0,gap:0,overflow:"hidden",children:[t(T,{gap:2,children:l(ne,{gap:1,className:"text-black fw-bold border-bottom pb-1",children:[t(P,{className:"g-col-2",children:"Time"}),t(P,{className:"g-col-7",children:"Room name"}),t(P,{className:"g-col-3",children:"Visit"})]})}),t(Qo,{rows:(r==null?void 0:r.rooms)??[],rowRender:a=>l(ne,{fullHeight:!1,gap:1,alignItems:"center",className:"text-black py-1 border-bottom",children:[l(N,{className:"g-col-2",children:[a.enterHour.toString().padStart(2,"0"),": ",a.enterMinute.toString().padStart(2,"0")]}),t(N,{className:"g-col-7",children:a.roomName}),t(N,{bold:!0,underline:!0,pointer:!0,variant:"primary",className:"g-col-3",onClick:c=>Sn(a.roomId),children:"Visit Room"})]})})]})})]}):null},jO=i=>{const{user:e=null,onCloseClick:n=null}=i,[r,s]=o.useState(""),{simpleAlert:a=null}=ze();if(!e)return null;const c=()=>{if(r.trim().length===0){a("Please write a message to user.",null,null,null,"Error",null);return}L(new Pm(e.userId,r,-999)),n()};return l(ie,{className:"nitro-mod-tools-user-message",theme:"primary-slim",windowPosition:Ht.TOP_LEFT,children:[t(ae,{headerText:"Send Message",onCloseClick:()=>n()}),l(re,{className:"text-black",children:[l(N,{children:["Message To: ",e.username]}),t("textarea",{className:"form-control",value:r,onChange:u=>s(u.target.value)}),t(M,{fullWidth:!0,onClick:c,children:"Send message"})]})]})},qO=i=>{const{onCloseClick:e=null,userId:n=null}=i,[r,s]=o.useState(null),[a,c]=o.useState(!1),[u,d]=o.useState(!1),[g,m]=o.useState(!1),f=o.useMemo(()=>r?[{localeKey:"modtools.userinfo.userName",value:r.userName,showOnline:!0},{localeKey:"modtools.userinfo.cfhCount",value:r.cfhCount.toString()},{localeKey:"modtools.userinfo.abusiveCfhCount",value:r.abusiveCfhCount.toString()},{localeKey:"modtools.userinfo.cautionCount",value:r.cautionCount.toString()},{localeKey:"modtools.userinfo.banCount",value:r.banCount.toString()},{localeKey:"modtools.userinfo.lastSanctionTime",value:r.lastSanctionTime},{localeKey:"modtools.userinfo.tradingLockCount",value:r.tradingLockCount.toString()},{localeKey:"modtools.userinfo.tradingExpiryDate",value:r.tradingExpiryDate},{localeKey:"modtools.userinfo.minutesSinceLastLogin",value:nr.format(r.minutesSinceLastLogin*60,".ago",2)},{localeKey:"modtools.userinfo.lastPurchaseDate",value:r.lastPurchaseDate},{localeKey:"modtools.userinfo.primaryEmailAddress",value:r.primaryEmailAddress},{localeKey:"modtools.userinfo.identityRelatedBanCount",value:r.identityRelatedBanCount.toString()},{localeKey:"modtools.userinfo.registrationAgeInMinutes",value:nr.format(r.registrationAgeInMinutes*60,".ago",2)},{localeKey:"modtools.userinfo.userClassification",value:r.userClassification}]:null,[r]);return x(V_,p=>{const _=p.getParser();!_||_.data.userId!==n||s(_.data)}),o.useEffect(()=>{L(new B_(n))},[n]),r?l(B,{children:[l(ie,{className:"nitro-mod-tools-user",theme:"primary-slim",windowPosition:Ht.TOP_LEFT,children:[t(ae,{headerText:h("modtools.userinfo.title",["username"],[r.userName]),onCloseClick:()=>e()}),t(re,{className:"text-black",children:l(ne,{overflow:"hidden",children:[t(T,{size:8,overflow:"auto",children:t("table",{className:"table table-striped table-sm table-text-small text-black m-0",children:t("tbody",{children:f.map((p,_)=>l("tr",{children:[t("th",{scope:"row",children:h(p.localeKey)}),l("td",{children:[p.value,p.showOnline&&t("i",{className:`icon icon-pf-${r.online?"online":"offline"} ms-2`})]})]},_))})})}),l(T,{size:4,gap:1,children:[t(M,{onClick:p=>Z(`mod-tools/open-user-chatlog/${n}`),children:"Room Chat"}),t(M,{onClick:p=>c(!a),children:"Send Message"}),t(M,{onClick:p=>m(!g),children:"Room Visits"}),t(M,{onClick:p=>d(!u),children:"Mod Action"})]})]})})]}),a&&t(jO,{user:{userId:n,username:r.userName},onCloseClick:()=>c(!1)}),u&&t(HO,{user:{userId:n,username:r.userName},onCloseClick:()=>d(!1)}),g&&t(WO,{userId:n,onCloseClick:()=>m(!1)})]}):null},zO=i=>{const[e,n]=o.useState(!1),[r,s]=o.useState(-1),[a,c]=o.useState(null),[u,d]=o.useState(!1),{openRooms:g=[],openRoomChatlogs:m=[],openUserChatlogs:f=[],openUserInfos:p=[],openRoomInfo:_=null,closeRoomInfo:E=null,toggleRoomInfo:C=null,openRoomChatlog:I=null,closeRoomChatlog:b=null,toggleRoomChatlog:S=null,openUserInfo:v=null,closeUserInfo:y=null,toggleUserInfo:R=null,openUserChatlog:O=null,closeUserChatlog:F=null,toggleUserChatlog:U=null}=ua(),A=o.useRef(null);return Ne([yn.INITIALIZED,yn.DISPOSED],k=>{if(!Cs.isRoomPreviewerId(k.roomId))switch(k.type){case yn.INITIALIZED:s(k.roomId);return;case yn.DISPOSED:s(-1);return}}),Vc(k=>{if(k.category!==J.UNIT)return;const D=Re();if(!D)return;const V=D.userDataManager.getUserDataByIndex(k.id);!V||V.type!==pt.USER||c({userId:V.webID,username:V.name})}),o.useEffect(()=>{const k={linkReceived:D=>{const V=D.split("/");if(!(V.length<2))switch(V[1]){case"show":n(!0);return;case"hide":n(!1);return;case"toggle":n(G=>!G);return;case"open-room-info":_(Number(V[2]));return;case"close-room-info":E(Number(V[2]));return;case"toggle-room-info":C(Number(V[2]));return;case"open-room-chatlog":I(Number(V[2]));return;case"close-room-chatlog":b(Number(V[2]));return;case"toggle-room-chatlog":S(Number(V[2]));return;case"open-user-info":v(Number(V[2]));return;case"close-user-info":y(Number(V[2]));return;case"toggle-user-info":R(Number(V[2]));return;case"open-user-chatlog":O(Number(V[2]));return;case"close-user-chatlog":F(Number(V[2]));return;case"toggle-user-chatlog":U(Number(V[2]));return}},eventUrlPrefix:"mod-tools/"};return It(k),()=>Et(k)},[_,E,C,I,b,S,v,y,R,O,F,U]),l(B,{children:[e&&l(ie,{uniqueKey:"mod-tools",className:"nitro-mod-tools",windowPosition:Ht.TOP_LEFT,theme:"primary-slim",children:[t(ae,{headerText:"Mod Tools",onCloseClick:k=>n(!1)}),l(re,{className:"text-black",gap:1,children:[l(M,{gap:1,onClick:k=>Z(`mod-tools/toggle-room-info/${r}`),disabled:r<=0,className:"position-relative",children:[t(P,{className:"icon icon-small-room position-absolute start-1"})," Room Tool"]}),l(M,{innerRef:A,gap:1,onClick:k=>Z(`mod-tools/toggle-room-chatlog/${r}`),disabled:r<=0,className:"position-relative",children:[t(P,{className:"icon icon-chat-history position-absolute start-1"})," Chatlog Tool"]}),l(M,{gap:1,onClick:()=>Z(`mod-tools/toggle-user-info/${a.userId}`),disabled:!a,className:"position-relative",children:[t(P,{className:"icon icon-user position-absolute start-1"})," User: ",a?a.username:""]}),l(M,{gap:1,onClick:()=>d(k=>!k),className:"position-relative",children:[t(P,{className:"icon icon-tickets position-absolute start-1"})," Report Tool"]})]})]}),g.length>0&&g.map(k=>t(PO,{roomId:k,onCloseClick:()=>Z(`mod-tools/close-room-info/${k}`)},k)),m.length>0&&m.map(k=>t(DO,{roomId:k,onCloseClick:()=>Z(`mod-tools/close-room-chatlog/${k}`)},k)),p.length>0&&p.map(k=>t(qO,{userId:k,onCloseClick:()=>Z(`mod-tools/close-user-info/${k}`)},k)),f.length>0&&f.map(k=>t(BO,{userId:k,onCloseClick:()=>Z(`mod-tools/close-user-chatlog/${k}`)},k)),u&&t(VO,{onCloseClick:()=>d(!1)})]})},YO=[He.START_DOORBELL,He.STATE_WAITING,He.STATE_NO_ANSWER,He.START_PASSWORD,He.STATE_WRONG_PASSWORD],$O=[He.START_DOORBELL,He.STATE_WAITING,He.STATE_NO_ANSWER],KO=i=>{const[e,n]=o.useState(""),{doorData:r=null,setDoorData:s=null}=Yn(),a=()=>{r&&r.state===He.STATE_WAITING&&ec(),s(null)},c=()=>{!r||!r.roomInfo||(_s(r.roomInfo.roomId),s(g=>{const m={...g};return m.state=He.STATE_PENDING_SERVER,m}))},u=()=>{!r||!r.roomInfo||(_s(r.roomInfo.roomId,e),s(g=>{const m={...g};return m.state=He.STATE_PENDING_SERVER,m}))};if(o.useEffect(()=>{!r||r.state!==He.STATE_NO_ANSWER||ec()},[r]),!r||r.state===He.NONE||YO.indexOf(r.state)===-1)return null;const d=$O.indexOf(r.state)>=0;return l(ie,{className:"nitro-navigator-doorbell",theme:"primary-slim",children:[t(ae,{headerText:h(d?"navigator.doorbell.title":"navigator.password.title"),onCloseClick:a}),l(re,{children:[l(T,{gap:1,children:[t(N,{bold:!0,children:r&&r.roomInfo&&r.roomInfo.roomName}),r.state===He.START_DOORBELL&&t(N,{children:h("navigator.doorbell.info")}),r.state===He.STATE_WAITING&&t(N,{children:h("navigator.doorbell.waiting")}),r.state===He.STATE_NO_ANSWER&&t(N,{children:h("navigator.doorbell.no.answer")}),r.state===He.START_PASSWORD&&t(N,{children:h("navigator.password.info")}),r.state===He.STATE_WRONG_PASSWORD&&t(N,{children:h("navigator.password.retryinfo")})]}),d&&l(T,{gap:1,children:[r.state===He.START_DOORBELL&&t(M,{variant:"success",onClick:c,children:h("navigator.doorbell.button.ring")}),t(M,{variant:"danger",onClick:a,children:h("generic.cancel")})]}),!d&&l(B,{children:[l(T,{gap:1,children:[t(N,{children:h("navigator.password.enter")}),t("input",{type:"password",className:"form-control form-control-sm",onChange:g=>n(g.target.value)})]}),l(T,{gap:1,children:[t(M,{variant:"success",onClick:u,children:h("navigator.password.button.try")}),t(M,{variant:"danger",onClick:a,children:h("generic.cancel")})]})]})]})]})},XO=i=>{const[e,n]=o.useState(null),[r,s]=o.useState(null),[a,c]=o.useState(null),[u,d]=o.useState(null),[g,m]=o.useState(null),[f,p]=o.useState(0),[_,E]=o.useState([]),[C,I]=o.useState(""),{categories:b=null}=Yn(),S=K("hc.disabled",!1),v=O=>K("images.url")+`/navigator/models/model_${O}.png`,y=(O,F)=>{!O||O.clubLevel>kn()||I(_[F].name)},R=()=>{L(new H_(r,a,"model_"+C,Number(u),Number(g),f))};return o.useEffect(()=>{if(!e){const O=[];for(let F=10;F<=100;F=F+10)O.push(F);n(O),m(O[0])}},[e]),o.useEffect(()=>{b&&b.length&&d(b[0].id)},[b]),o.useEffect(()=>{const O=K("navigator.room.models");O&&O.length&&(E(O),I(O[0].name))},[]),l(T,{overflow:"hidden",children:[l(ne,{overflow:"hidden",children:[l(T,{size:6,gap:1,overflow:"auto",children:[l(T,{gap:1,children:[t(N,{children:h("navigator.createroom.roomnameinfo")}),t("input",{type:"text",className:"form-control form-control-sm",maxLength:60,onChange:O=>s(O.target.value),placeholder:h("navigator.createroom.roomnameinfo")})]}),l(T,{grow:!0,gap:1,children:[t(N,{children:h("navigator.createroom.roomdescinfo")}),t("textarea",{className:"flex-grow-1 form-control form-control-sm w-100",maxLength:255,onChange:O=>c(O.target.value),placeholder:h("navigator.createroom.roomdescinfo")})]}),l(T,{gap:1,children:[t(N,{children:h("navigator.category")}),t("select",{className:"form-select form-select-sm",onChange:O=>d(Number(O.target.value)),children:b&&b.length>0&&b.map(O=>t("option",{value:O.id,children:h(O.name)},O.id))})]}),l(T,{gap:1,children:[t(N,{children:h("navigator.maxvisitors")}),t("select",{className:"form-select form-select-sm",onChange:O=>m(Number(O.target.value)),children:e&&e.map(O=>t("option",{value:O,children:O},O))})]}),l(T,{gap:1,children:[t(N,{children:h("navigator.tradesettings")}),l("select",{className:"form-select form-select-sm",onChange:O=>p(Number(O.target.value)),children:[t("option",{value:"0",children:h("navigator.roomsettings.trade_not_allowed")}),t("option",{value:"1",children:h("navigator.roomsettings.trade_not_with_Controller")}),t("option",{value:"2",children:h("navigator.roomsettings.trade_allowed")})]})]})]}),t(T,{size:6,gap:1,overflow:"auto",children:_.map((O,F)=>l(be,{fullHeight:!0,onClick:()=>y(O,F),itemActive:C===O.name,overflow:"unset",gap:0,className:"p-1",disabled:kn()<O.clubLevel,children:[t(w,{fullHeight:!0,center:!0,overflow:"hidden",children:t("img",{alt:"",src:v(O.name)})}),l(N,{bold:!0,children:[O.tileSize," ",h("navigator.createroom.tilesize")]}),!S&&O.clubLevel>bn.NO_CLUB&&t(dt,{position:"absolute",className:"top-1 end-1",type:"hc"})]},O.name))})]}),t(M,{fullWidth:!0,variant:!r||r.length<3?"danger":"success",onClick:R,disabled:!r||r.length<3,children:h("navigator.createroom.create")})]})},QO=i=>{const{onCloseClick:e=null}=i,[n,r]=o.useState(!1),[s,a]=o.useState(!1),{report:c=null}=zn(),{navigatorData:u=null}=Yn(),d=m=>{switch(m){case"settings":return W().userId===u.enteredGuestRoom.ownerId||W().isModerator;case"staff_pick":return W().securityLevel>=eo.COMMUNITY;default:return!1}},g=(m,f)=>{if(!(!u||!u.enteredGuestRoom))switch(m){case"set_home_room":let p=-1;u.homeRoomId!==u.enteredGuestRoom.roomId&&(p=u.enteredGuestRoom.roomId),p>0&&L(new z_(p));return;case"navigator_search_tag":Z(`navigator/search/${f}`),L(new aa("hotel_view",`tag:${f}`));return;case"open_room_thumbnail_camera":yt(new gr(gr.TOGGLE_THUMBNAIL));return;case"open_group_info":ii(u.enteredGuestRoom.habboGroupId);return;case"toggle_room_link":Z("navigator/toggle-room-link");return;case"open_room_settings":L(new Tm(u.enteredGuestRoom.roomId));return;case"toggle_pick":r(_=>!_),L(new q_(u.enteredGuestRoom.roomId));return;case"toggle_mute":a(_=>!_),L(new j_);return;case"room_filter":L(new W_(u.enteredGuestRoom.roomId));return;case"open_floorplan_editor":Z("floor-editor/toggle");return;case"report_room":c(st.ROOM,{roomId:u.enteredGuestRoom.roomId,roomName:u.enteredGuestRoom.roomName});return;case"close":e();return}};return o.useEffect(()=>{u&&(r(u.currentRoomIsStaffPick),u.enteredGuestRoom&&a(u.enteredGuestRoom.allInRoomMuted))},[u]),u.enteredGuestRoom?l(ie,{className:"nitro-room-info",theme:"primary-slim",children:[t(ae,{headerText:h("navigator.roomsettings.roominfo"),onCloseClick:()=>g("close")}),t(re,{className:"text-black",children:u.enteredGuestRoom&&l(B,{children:[l(w,{gap:2,overflow:"hidden",children:[t(Xo,{roomId:u.enteredGuestRoom.roomId,customUrl:u.enteredGuestRoom.officialRoomPicRef,children:d("settings")&&t("i",{className:"icon icon-camera-small position-absolute b-0 r-0 m-1 cursor-pointer top-0",onClick:()=>g("open_room_thumbnail_camera")})}),l(T,{grow:!0,gap:1,overflow:"hidden",children:[l(w,{gap:1,children:[l(T,{grow:!0,gap:1,children:[l(w,{gap:1,children:[t("i",{onClick:()=>g("set_home_room"),className:zt("flex-shrink-0 icon icon-house-small cursor-pointer",u.homeRoomId!==u.enteredGuestRoom.roomId&&"gray")}),t(N,{bold:!0,children:u.enteredGuestRoom.roomName})]}),u.enteredGuestRoom.showOwner&&l(w,{alignItems:"center",gap:1,children:[t(N,{variant:"muted",children:h("navigator.roomownercaption")}),l(w,{alignItems:"center",gap:1,children:[t(An,{userId:u.enteredGuestRoom.ownerId}),t(N,{children:u.enteredGuestRoom.ownerName})]})]}),l(w,{alignItems:"center",gap:1,children:[t(N,{variant:"muted",children:h("navigator.roomrating")}),t(N,{children:u.currentRoomRating})]}),u.enteredGuestRoom.tags.length>0&&t(w,{alignItems:"center",gap:1,children:u.enteredGuestRoom.tags.map(m=>l(N,{pointer:!0,className:"bg-muted rounded p-1",onClick:f=>g("navigator_search_tag",m),children:["#",m]},m))})]}),l(T,{alignItems:"center",gap:1,children:[d("settings")&&t("i",{className:"icon icon-cog cursor-pointer",title:h("navigator.room.popup.info.room.settings"),onClick:m=>g("open_room_settings")}),t(lg,{title:h("navigator.embed.caption"),className:"cursor-pointer fa-icon",onClick:m=>Z("navigator/toggle-room-link")})]})]}),t(N,{overflow:"auto",style:{maxHeight:50},children:u.enteredGuestRoom.description}),u.enteredGuestRoom.habboGroupId>0&&l(w,{pointer:!0,alignItems:"center",gap:1,onClick:()=>g("open_group_info"),children:[t(We,{className:"flex-none",badgeCode:u.enteredGuestRoom.groupBadgeCode,isGroup:!0}),t(N,{underline:!0,children:h("navigator.guildbase",["groupName"],[u.enteredGuestRoom.groupName])})]})]})]}),l(T,{gap:1,children:[d("staff_pick")&&t(M,{onClick:()=>g("toggle_pick"),children:h(n?"navigator.staffpicks.unpick":"navigator.staffpicks.pick")}),t(M,{variant:"danger",onClick:()=>g("report_room"),children:h("help.emergency.main.report.room")}),d("settings")&&l(B,{children:[t(M,{onClick:()=>g("toggle_mute"),children:h(s?"navigator.muteall_on":"navigator.muteall_off")}),t(M,{onClick:()=>g("room_filter"),children:h("navigator.roomsettings.roomfilter")}),t(M,{onClick:()=>g("open_floorplan_editor"),children:h("open.floor.plan.editor")})]})]})]})})]}):null},JO=i=>{const{onCloseClick:e=null}=i,{navigatorData:n=null}=Yn();return n.enteredGuestRoom?l(ie,{className:"nitro-room-link",theme:"primary-slim",children:[t(ae,{headerText:h("navigator.embed.title"),onCloseClick:e}),t(re,{className:"text-black d-flex align-items-center",children:l(w,{gap:2,children:[t(Xo,{roomId:n.enteredGuestRoom.roomId,customUrl:n.enteredGuestRoom.officialRoomPicRef}),l(T,{children:[t(N,{bold:!0,fontSize:5,children:h("navigator.embed.headline")}),t(N,{children:h("navigator.embed.info")}),t("input",{type:"text",readOnly:!0,className:"form-control form-control-sm",value:h("navigator.embed.src",["roomId"],[n.enteredGuestRoom.roomId.toString()]).replace("${url.prefix}",K("url.prefix",""))})]})]})})]}):null},ZO=i=>{const{roomData:e=null,handleChange:n=null}=i,[r,s]=o.useState(""),[a,c]=o.useState(""),[u,d]=o.useState(!1),g=()=>{!u||r.length<=0||a.length<=0||r!==a||n("password",r)};return o.useEffect(()=>{s(""),c(""),d(!1)},[e]),l(B,{children:[l(T,{gap:1,children:[t(N,{bold:!0,children:h("navigator.roomsettings.roomaccess.caption")}),t(N,{children:h("navigator.roomsettings.roomaccess.info")})]}),l(T,{overflow:"auto",children:[l(T,{gap:1,children:[t(N,{bold:!0,children:h("navigator.roomsettings.doormode")}),l(w,{alignItems:"center",gap:1,children:[t("input",{className:"form-check-input",type:"radio",name:"lockState",checked:e.lockState===rt.OPEN_STATE&&!u,onChange:m=>n("lock_state",rt.OPEN_STATE)}),t(N,{children:h("navigator.roomsettings.doormode.open")})]}),l(w,{alignItems:"center",gap:1,children:[t("input",{className:"form-check-input",type:"radio",name:"lockState",checked:e.lockState===rt.DOORBELL_STATE&&!u,onChange:m=>n("lock_state",rt.DOORBELL_STATE)}),t(N,{children:h("navigator.roomsettings.doormode.doorbell")})]}),l(w,{alignItems:"center",gap:1,children:[t("input",{className:"form-check-input",type:"radio",name:"lockState",checked:e.lockState===rt.INVISIBLE_STATE&&!u,onChange:m=>n("lock_state",rt.INVISIBLE_STATE)}),t(N,{children:h("navigator.roomsettings.doormode.invisible")})]}),l(w,{fullWidth:!0,gap:1,children:[t("input",{className:"form-check-input",type:"radio",name:"lockState",checked:e.lockState===rt.PASSWORD_STATE||u,onChange:m=>d(m.target.checked)}),!u&&e.lockState!==rt.PASSWORD_STATE&&t(N,{children:h("navigator.roomsettings.doormode.password")}),(u||e.lockState===rt.PASSWORD_STATE)&&l(T,{gap:1,children:[t(N,{children:h("navigator.roomsettings.doormode.password")}),t("input",{type:"password",className:"form-control form-control-sm col-4",value:r,onChange:m=>s(m.target.value),placeholder:h("navigator.roomsettings.password"),onFocus:m=>d(!0)}),u&&r.length<=0&&t(N,{bold:!0,small:!0,variant:"danger",children:h("navigator.roomsettings.passwordismandatory")}),t("input",{type:"password",className:"form-control form-control-sm col-4",value:a,onChange:m=>c(m.target.value),onBlur:g,placeholder:h("navigator.roomsettings.passwordconfirm")}),u&&r.length>0&&r!==a&&t(N,{bold:!0,small:!0,variant:"danger",children:h("navigator.roomsettings.invalidconfirm")})]})]})]}),l(T,{gap:1,children:[t(N,{bold:!0,children:h("navigator.roomsettings.pets")}),l(w,{alignItems:"center",gap:1,children:[t("input",{className:"form-check-input",type:"checkbox",checked:e.allowPets,onChange:m=>n("allow_pets",m.target.checked)}),t(N,{children:h("navigator.roomsettings.allowpets")})]}),l(w,{alignItems:"center",gap:1,children:[t("input",{className:"form-check-input",type:"checkbox",checked:e.allowPetsEat,onChange:m=>n("allow_pets_eat",m.target.checked)}),t(N,{children:h("navigator.roomsettings.allowfoodconsume")})]})]})]})]})},md=3,hd=60,gd=255,Vi=15,ey=i=>{const{roomData:e=null,handleChange:n=null,onClose:r=null}=i,[s,a]=o.useState(""),[c,u]=o.useState(""),[d,g]=o.useState(""),[m,f]=o.useState(""),[p,_]=o.useState(0),[E,C]=o.useState(""),{showConfirm:I=null}=ze(),{categories:b=null}=Yn();x(Y_,O=>{const F=O.getParser();if(F)switch(F.code){case Eu.ERROR_INVALID_TAG:C("navigator.roomsettings.unacceptablewords");case Eu.ERROR_NON_USER_CHOOSABLE_TAG:C("navigator.roomsettings.nonuserchoosabletag");break;default:C("");break}});const S=()=>{I(h("navigator.roomsettings.deleteroom.confirm.message",["room_name"],[e.roomName]),()=>{L(new $_(e.roomId)),r&&r(),Z("navigator/search/myworld_view")},null,null,null,h("navigator.roomsettings.deleteroom.confirm.title"))},v=()=>{s===e.roomName||s.length<md||s.length>hd||n("name",s)},y=()=>{c===e.roomDescription||c.length>gd||n("description",c)},R=O=>{O===0&&d===e.tags[0]||d.length>Vi||O===1&&m===e.tags[1]||m.length>Vi||(d===""&&m!==""&&f(""),C(""),_(O),n("tags",d===""&&m!==""?[m]:[d,m]))};return o.useEffect(()=>{a(e.roomName),u(e.roomDescription),g(e.tags.length>0&&e.tags[0]?e.tags[0]:""),f(e.tags.length>0&&e.tags[1]?e.tags[1]:"")},[e]),l(B,{children:[l(w,{alignItems:"center",gap:1,children:[t(N,{className:"col-3",children:h("navigator.roomname")}),l(T,{fullWidth:!0,gap:0,children:[t("input",{className:"form-control form-control-sm",value:s,maxLength:hd,onChange:O=>a(O.target.value),onBlur:v}),s.length<md&&t(N,{bold:!0,small:!0,variant:"danger",children:h("navigator.roomsettings.roomnameismandatory")})]})]}),l(w,{alignItems:"center",gap:1,children:[t(N,{className:"col-3",children:h("navigator.roomsettings.desc")}),t("textarea",{className:"form-control form-control-sm",value:c,maxLength:gd,onChange:O=>u(O.target.value),onBlur:y})]}),l(w,{alignItems:"center",gap:1,children:[t(N,{className:"col-3",children:h("navigator.category")}),t("select",{className:"form-select form-select-sm",value:e.categoryId,onChange:O=>n("category",O.target.value),children:b&&b.map(O=>t("option",{value:O.id,children:h(O.name)},O.id))})]}),l(w,{alignItems:"center",gap:1,children:[t(N,{className:"col-3",children:h("navigator.maxvisitors")}),t("select",{className:"form-select form-select-sm",value:e.userCount,onChange:O=>n("max_visitors",O.target.value),children:xu&&xu.map(O=>t("option",{value:O,children:O},O))})]}),l(w,{alignItems:"center",gap:1,children:[t(N,{className:"col-3",children:h("navigator.tradesettings")}),l("select",{className:"form-select form-select-sm",value:e.tradeState,onChange:O=>n("trade_state",O.target.value),children:[t("option",{value:"0",children:h("navigator.roomsettings.trade_not_allowed")}),t("option",{value:"1",children:h("navigator.roomsettings.trade_not_with_Controller")}),t("option",{value:"2",children:h("navigator.roomsettings.trade_allowed")})]})]}),l(w,{alignItems:"center",gap:1,children:[t(N,{className:"col-3",children:h("navigator.tags")}),l(T,{fullWidth:!0,gap:0,children:[t("input",{className:"form-control form-control-sm",value:d,onChange:O=>g(O.target.value),onBlur:()=>R(0)}),d.length>Vi&&t(N,{bold:!0,small:!0,variant:"danger",children:h("navigator.roomsettings.toomanycharacters")}),p===0&&E!=""&&t(N,{bold:!0,small:!0,variant:"danger",children:h(E)})]}),l(T,{fullWidth:!0,gap:0,children:[t("input",{className:"form-control form-control-sm",value:m,onChange:O=>f(O.target.value),onBlur:()=>R(1)}),m.length>Vi&&t(N,{bold:!0,small:!0,variant:"danger",children:h("navigator.roomsettings.toomanycharacters")}),p===1&&E!=""&&t(N,{bold:!0,small:!0,variant:"danger",children:h(E)})]})]}),l(w,{alignItems:"center",gap:1,children:[t(P,{className:"col-3"}),t("input",{className:"form-check-input",type:"checkbox",checked:e.allowWalkthrough,onChange:O=>n("allow_walkthrough",O.target.checked)}),t(N,{children:h("navigator.roomsettings.allow_walk_through")})]}),l(N,{variant:"danger",underline:!0,bold:!0,pointer:!0,className:"d-flex justify-content-center align-items-center gap-1",onClick:S,children:[t(Dn,{className:"fa-icon"}),h("navigator.roomsettings.delete")]})]})},ty=i=>{var d;const{roomData:e=null,handleChange:n=null}=i,[r,s]=o.useState(-1),[a,c]=o.useState([]),u=g=>{c(m=>{const f=[...m],p=f.findIndex(_=>_.userId===g);return p>=0&&f.splice(p,1),f}),L(new X_(g,e.roomId)),s(-1)};return x(K_,g=>{const m=g.getParser();!e||e.roomId!==m.roomId||c(m.bannedUsers)}),o.useEffect(()=>{L(new Lm(e.roomId))},[e.roomId]),l(ne,{overflow:"auto",children:[l(T,{size:6,children:[l(N,{bold:!0,children:[h("navigator.roomsettings.moderation.banned.users")," (",a.length,")"]}),t(w,{overflow:"hidden",className:"bg-white rounded list-container p-2",children:t(T,{fullWidth:!0,overflow:"auto",gap:1,children:a&&a.length>0&&a.map((g,m)=>l(w,{shrink:!0,alignItems:"center",gap:1,overflow:"hidden",children:[t(An,{userName:g.userName}),l(N,{pointer:!0,grow:!0,onClick:f=>s(g.userId),children:[" ",g.userName]})]},m))})}),l(M,{disabled:r<=0,onClick:g=>u(r),children:[h("navigator.roomsettings.moderation.unban")," ",r>0&&((d=a.find(g=>g.userId===r))==null?void 0:d.userName)]})]}),l(T,{size:6,children:[l(T,{gap:1,children:[t(N,{bold:!0,children:h("navigator.roomsettings.moderation.mute.header")}),t(w,{alignItems:"center",gap:1,children:l("select",{className:"form-select form-select-sm",value:e.moderationSettings.allowMute,onChange:g=>n("moderation_mute",g.target.value),children:[t("option",{value:Zn.MODERATION_LEVEL_NONE,children:h("navigator.roomsettings.moderation.none")}),t("option",{value:Zn.MODERATION_LEVEL_USER_WITH_RIGHTS,children:h("navigator.roomsettings.moderation.rights")})]})})]}),l(T,{gap:1,children:[t(N,{bold:!0,children:h("navigator.roomsettings.moderation.kick.header")}),t(w,{alignItems:"center",gap:1,children:l("select",{className:"form-select form-select-sm",value:e.moderationSettings.allowKick,onChange:g=>n("moderation_kick",g.target.value),children:[t("option",{value:Zn.MODERATION_LEVEL_NONE,children:h("navigator.roomsettings.moderation.none")}),t("option",{value:Zn.MODERATION_LEVEL_USER_WITH_RIGHTS,children:h("navigator.roomsettings.moderation.rights")}),t("option",{value:Zn.MODERATION_LEVEL_ALL,children:h("navigator.roomsettings.moderation.all")})]})})]}),l(T,{gap:1,children:[t(N,{bold:!0,children:h("navigator.roomsettings.moderation.ban.header")}),t(w,{alignItems:"center",gap:1,children:l("select",{className:"form-select form-select-sm",value:e.moderationSettings.allowBan,onChange:g=>n("moderation_ban",g.target.value),children:[t("option",{value:Zn.MODERATION_LEVEL_NONE,children:h("navigator.roomsettings.moderation.none")}),t("option",{value:Zn.MODERATION_LEVEL_USER_WITH_RIGHTS,children:h("navigator.roomsettings.moderation.rights")})]})})]})]})]})},ny=i=>{const{roomData:e=null}=i,[n,r]=o.useState(new Map);return x(Q_,s=>{const a=s.getParser();!e||e.roomId!==a.roomId||r(a.users)}),x(J_,s=>{const a=s.getParser();!e||e.roomId!==a.roomId||r(c=>{const u=new Map(c);return u.set(a.data.userId,a.data.userName),u})}),x(Z_,s=>{const a=s.getParser();!e||e.roomId!==a.roomId||r(c=>{const u=new Map(c);return u.delete(a.userId),u})}),o.useEffect(()=>{L(new eb(e.roomId))},[e.roomId]),l(ne,{children:[l(T,{size:6,children:[t(N,{bold:!0,children:h("navigator.flatctrls.userswithrights",["displayed","total"],[n.size.toString(),n.size.toString()])}),t(w,{overflow:"hidden",className:"bg-white rounded list-container p-2",children:t(T,{fullWidth:!0,overflow:"auto",gap:1,children:Array.from(n.entries()).map(([s,a],c)=>l(w,{shrink:!0,alignItems:"center",gap:1,overflow:"hidden",children:[t(An,{userName:a}),l(N,{pointer:!0,grow:!0,onClick:u=>L(new tb(s)),children:[" ",a]})]},c))})})]}),t(T,{size:6,justifyContent:"end",children:t(M,{variant:"danger",disabled:!n.size,onClick:s=>L(new nb(e.roomId)),children:h("navigator.flatctrls.clear")})})]})},ry=i=>{const{roomData:e=null,handleChange:n=null}=i,[r,s]=o.useState(0);return o.useEffect(()=>{s(e.chatSettings.distance)},[e.chatSettings]),l(B,{children:[l(T,{gap:1,children:[t(N,{bold:!0,children:h("navigator.roomsettings.vip.caption")}),t(N,{children:h("navigator.roomsettings.vip.info")})]}),l(ne,{overflow:"auto",children:[l(T,{size:6,gap:1,children:[t(N,{bold:!0,children:h("navigator.roomsettings.chat_settings")}),t(N,{children:h("navigator.roomsettings.chat_settings.info")}),l("select",{className:"form-select form-select-sm",value:e.chatSettings.mode,onChange:a=>n("bubble_mode",a.target.value),children:[t("option",{value:Nt.CHAT_MODE_FREE_FLOW,children:h("navigator.roomsettings.chat.mode.free.flow")}),t("option",{value:Nt.CHAT_MODE_LINE_BY_LINE,children:h("navigator.roomsettings.chat.mode.line.by.line")})]}),l("select",{className:"form-select form-select-sm",value:e.chatSettings.weight,onChange:a=>n("chat_weight",a.target.value),children:[t("option",{value:Nt.CHAT_BUBBLE_WIDTH_NORMAL,children:h("navigator.roomsettings.chat.bubbles.width.normal")}),t("option",{value:Nt.CHAT_BUBBLE_WIDTH_THIN,children:h("navigator.roomsettings.chat.bubbles.width.thin")}),t("option",{value:Nt.CHAT_BUBBLE_WIDTH_WIDE,children:h("navigator.roomsettings.chat.bubbles.width.wide")})]}),l("select",{className:"form-select form-select-sm",value:e.chatSettings.speed,onChange:a=>n("bubble_speed",a.target.value),children:[t("option",{value:Nt.CHAT_SCROLL_SPEED_FAST,children:h("navigator.roomsettings.chat.speed.fast")}),t("option",{value:Nt.CHAT_SCROLL_SPEED_NORMAL,children:h("navigator.roomsettings.chat.speed.normal")}),t("option",{value:Nt.CHAT_SCROLL_SPEED_SLOW,children:h("navigator.roomsettings.chat.speed.slow")})]}),l("select",{className:"form-select form-select-sm",value:e.chatSettings.protection,onChange:a=>n("flood_protection",a.target.value),children:[t("option",{value:Nt.FLOOD_FILTER_LOOSE,children:h("navigator.roomsettings.chat.flood.loose")}),t("option",{value:Nt.FLOOD_FILTER_NORMAL,children:h("navigator.roomsettings.chat.flood.normal")}),t("option",{value:Nt.FLOOD_FILTER_STRICT,children:h("navigator.roomsettings.chat.flood.strict")})]}),t(N,{children:h("navigator.roomsettings.chat_settings.hearing.distance")}),t("input",{type:"number",min:"0",className:"form-control form-control-sm",value:r,onChange:a=>s(a.target.valueAsNumber),onBlur:a=>n("chat_distance",r)})]}),l(T,{size:6,gap:1,children:[t(N,{bold:!0,children:h("navigator.roomsettings.vip_settings")}),l(w,{alignItems:"center",gap:1,children:[t("input",{className:"form-check-input",type:"checkbox",checked:e.hideWalls,onChange:a=>n("hide_walls",a.target.checked)}),t(N,{children:h("navigator.roomsettings.hide_walls")})]}),l("select",{className:"form-select form-select-sm",value:e.wallThickness,onChange:a=>n("wall_thickness",a.target.value),children:[t("option",{value:"0",children:h("navigator.roomsettings.wall_thickness.normal")}),t("option",{value:"1",children:h("navigator.roomsettings.wall_thickness.thick")}),t("option",{value:"-1",children:h("navigator.roomsettings.wall_thickness.thin")}),t("option",{value:"-2",children:h("navigator.roomsettings.wall_thickness.thinnest")})]}),l("select",{className:"form-select form-select-sm",value:e.floorThickness,onChange:a=>n("floor_thickness",a.target.value),children:[t("option",{value:"0",children:h("navigator.roomsettings.floor_thickness.normal")}),t("option",{value:"1",children:h("navigator.roomsettings.floor_thickness.thick")}),t("option",{value:"-1",children:h("navigator.roomsettings.floor_thickness.thin")}),t("option",{value:"-2",children:h("navigator.roomsettings.floor_thickness.thinnest")})]})]})]})]})},zr=["navigator.roomsettings.tab.1","navigator.roomsettings.tab.2","navigator.roomsettings.tab.3","navigator.roomsettings.tab.4","navigator.roomsettings.tab.5"],sy=i=>{const[e,n]=o.useState(null),[r,s]=o.useState(zr[0]);x(rb,u=>{const d=u.getParser();if(!d)return;const g=d.data;n({roomId:g.roomId,roomName:g.name,roomDescription:g.description,categoryId:g.categoryId,userCount:g.maximumVisitorsLimit,tags:g.tags,tradeState:g.tradeMode,allowWalkthrough:g.allowWalkThrough,lockState:g.doorMode,password:null,allowPets:g.allowPets,allowPetsEat:g.allowFoodConsume,hideWalls:g.hideWalls,wallThickness:g.wallThickness,floorThickness:g.floorThickness,chatSettings:{mode:g.chatSettings.mode,weight:g.chatSettings.weight,speed:g.chatSettings.speed,distance:g.chatSettings.distance,protection:g.chatSettings.protection},moderationSettings:{allowMute:g.roomModerationSettings.allowMute,allowKick:g.roomModerationSettings.allowKick,allowBan:g.roomModerationSettings.allowBan}}),L(new Lm(g.roomId))});const a=()=>{n(null),s(zr[0])},c=(u,d)=>{n(g=>{const m={...g};switch(u){case"name":m.roomName=String(d);break;case"description":m.roomDescription=String(d);break;case"category":m.categoryId=Number(d);break;case"max_visitors":m.userCount=Number(d);break;case"trade_state":m.tradeState=Number(d);break;case"tags":m.tags=d;break;case"allow_walkthrough":m.allowWalkthrough=!!d;break;case"allow_pets":m.allowPets=!!d;break;case"allow_pets_eat":m.allowPetsEat=!!d;break;case"hide_walls":m.hideWalls=!!d;break;case"wall_thickness":m.wallThickness=Number(d);break;case"floor_thickness":m.floorThickness=Number(d);break;case"lock_state":m.lockState=Number(d);break;case"password":m.lockState=rt.PASSWORD_STATE,m.password=String(d);break;case"moderation_mute":m.moderationSettings.allowMute=Number(d);break;case"moderation_kick":m.moderationSettings.allowKick=Number(d);break;case"moderation_ban":m.moderationSettings.allowBan=Number(d);break;case"bubble_mode":m.chatSettings.mode=Number(d);break;case"chat_weight":m.chatSettings.weight=Number(d);break;case"bubble_speed":m.chatSettings.speed=Number(d);break;case"flood_protection":m.chatSettings.protection=Number(d);break;case"chat_distance":m.chatSettings.distance=Number(d);break}return L(new sb(m.roomId,m.roomName,m.roomDescription,m.lockState,m.password,m.userCount,m.categoryId,m.tags.length,m.tags,m.tradeState,m.allowPets,m.allowPetsEat,m.allowWalkthrough,m.hideWalls,m.wallThickness,m.floorThickness,m.moderationSettings.allowMute,m.moderationSettings.allowKick,m.moderationSettings.allowBan,m.chatSettings.mode,m.chatSettings.weight,m.chatSettings.speed,m.chatSettings.distance,m.chatSettings.protection)),m})};return e?l(ie,{uniqueKey:"nitro-room-settings",className:"nitro-room-settings",children:[t(ae,{headerText:h("navigator.roomsettings"),onCloseClick:a}),t(Br,{children:zr.map(u=>t(sr,{isActive:r===u,onClick:d=>s(u),children:h(u)},u))}),l(re,{children:[r===zr[0]&&t(ey,{roomData:e,handleChange:c,onClose:a}),r===zr[1]&&t(ZO,{roomData:e,handleChange:c}),r===zr[2]&&t(ny,{roomData:e,handleChange:c}),r===zr[3]&&t(ry,{roomData:e,handleChange:c}),r===zr[4]&&t(ty,{roomData:e,handleChange:c})]})]}):null},fd=i=>{const{roomData:e=null}=i,[n,r]=o.useState(!1),s=o.useRef(),a=()=>{const c=100*(e.userCount/e.maxUserCount);let u="bg-primary";return c>=92?u="bg-danger":c>=50?u="bg-warning":c>0&&(u="bg-success"),u};return l(B,{children:[t(P,{pointer:!0,innerRef:s,className:"icon icon-navigator-info",onMouseOver:c=>r(!0),onMouseLeave:c=>r(!1)}),t(_c,{show:n,target:s.current,placement:"right",children:t(Ua,{children:t(re,{overflow:"hidden",className:"room-info image-rendering-pixelated bg-transparent",children:l(w,{gap:2,overflow:"hidden",children:[l(Xo,{roomId:e.roomId,customUrl:e.officialRoomPicRef,className:"d-flex flex-column align-items-center justify-content-end mb-1",children:[e.habboGroupId>0&&t(We,{badgeCode:e.groupBadgeCode,isGroup:!0,className:"position-absolute top-0 start-0 m-1 "}),e.doorMode!==rt.OPEN_STATE&&t("i",{className:"position-absolute end-0 mb-1 me-1 icon icon-navigator-room-"+(e.doorMode===rt.DOORBELL_STATE?"locked":e.doorMode===rt.PASSWORD_STATE?"password":e.doorMode===rt.INVISIBLE_STATE?"invisible":"")})]}),l(T,{gap:1,children:[t(N,{bold:!0,truncate:!0,className:"flex-grow-1",style:{maxHeight:13},children:e.roomName}),l(w,{gap:2,children:[t(N,{italics:!0,variant:"muted",children:h("navigator.roomownercaption")}),l(w,{alignItems:"center",gap:1,children:[t(An,{userId:e.ownerId}),t(N,{italics:!0,children:e.ownerName})]})]}),t(N,{className:"flex-grow-1",children:e.description}),l(w,{className:"badge p-1 position-absolute m-1 bottom-0 end-0 m-2 "+a(),gap:1,children:[t(zl,{className:"fa-icon"}),e.userCount]})]})]})})})})]})},pd=i=>{const{roomData:e=null,children:n=null,thumbnail:r=!1,...s}=i,{setDoorData:a=null}=Yn(),c=()=>{const d=100*(e.userCount/e.maxUserCount);let g="bg-primary";return d>=92?g="bg-danger":d>=50?g="bg-warning":d>0&&(g="bg-success"),g},u=d=>{if(e.ownerId!==W().userId){if(e.habboGroupId!==0){Sn(e.roomId);return}switch(e.doorMode){case rt.DOORBELL_STATE:a(g=>{const m={...g};return m.roomInfo=e,m.state=He.START_DOORBELL,m});return;case rt.PASSWORD_STATE:a(g=>{const m={...g};return m.roomInfo=e,m.state=He.START_PASSWORD,m});return}}_s(e.roomId)};return r?l(T,{pointer:!0,overflow:"hidden",alignItems:"center",onClick:u,gap:0,className:"navigator-item p-1 bg-light rounded-3 small mb-1 flex-column border border-muted",...s,children:[l(Xo,{roomId:e.roomId,customUrl:e.officialRoomPicRef,className:"d-flex flex-column align-items-center justify-content-end mb-1",children:[e.habboGroupId>0&&t(We,{badgeCode:e.groupBadgeCode,isGroup:!0,className:"position-absolute top-0 start-0 m-1"}),l(w,{center:!0,className:"badge p-1 position-absolute m-1 "+c(),gap:1,children:[t(zl,{className:"fa-icon"}),e.userCount]}),e.doorMode!==rt.OPEN_STATE&&t("i",{className:"position-absolute end-0 mb-1 me-1 icon icon-navigator-room-"+(e.doorMode===rt.DOORBELL_STATE?"locked":e.doorMode===rt.PASSWORD_STATE?"password":e.doorMode===rt.INVISIBLE_STATE?"invisible":"")})]}),l(w,{className:"w-100",children:[t(N,{truncate:!0,className:"flex-grow-1",children:e.roomName}),t(w,{reverse:!0,alignItems:"center",gap:1,children:t(fd,{roomData:e})}),n]})]}):l(w,{pointer:!0,overflow:"hidden",alignItems:"center",onClick:u,gap:2,className:"navigator-item px-2 py-1 small",...s,children:[l(w,{center:!0,className:"badge p-1 "+c(),gap:1,children:[t(zl,{className:"fa-icon"}),e.userCount]}),t(N,{truncate:!0,grow:!0,children:e.roomName}),l(w,{reverse:!0,alignItems:"center",gap:1,children:[t(fd,{roomData:e}),e.habboGroupId>0&&t("i",{className:"icon icon-navigator-room-group"}),e.doorMode!==rt.OPEN_STATE&&t("i",{className:"icon icon-navigator-room-"+(e.doorMode===rt.DOORBELL_STATE?"locked":e.doorMode===rt.PASSWORD_STATE?"password":e.doorMode===rt.INVISIBLE_STATE?"invisible":"")})]}),n]})},ay=i=>{const{searchResult:e=null,...n}=i,[r,s]=o.useState(!0),[a,c]=o.useState(0),{topLevelContext:u=null}=Yn(),d=()=>{let p=e.code;return!p||!p.length||h("navigator.searchcode.title."+p)=="navigator.searchcode.title."+p?e.data:p.startsWith("${")?p.slice(2,p.length-1):"navigator.searchcode.title."+p},g=()=>{c(p=>p===Yr.LIST?Yr.THUMBNAILS:Yr.LIST)},m=()=>{e.action==1?L(new aa(e.code,"")):e.action==2&&u&&L(new aa(u.code,""))};o.useEffect(()=>{e&&(s(!e.closed),c(e.mode))},[e]);const f=a>=Yr.THUMBNAILS;return l(T,{className:"bg-white rounded border border-muted",gap:0,children:[l(w,{fullWidth:!0,alignItems:"center",justifyContent:"between",className:"px-2 py-1",children:[l(w,{grow:!0,pointer:!0,alignItems:"center",gap:1,onClick:p=>s(_=>!_),children:[r&&t(cg,{className:"text-secondary fa-icon"}),!r&&t(ei,{className:"text-secondary fa-icon"}),t(N,{children:h(d())})]}),l(w,{gap:2,children:[a===Yr.LIST&&t(ug,{className:"text-secondary fa-icon",onClick:g}),a>=Yr.THUMBNAILS&&t(dg,{className:"text-secondary fa-icon",onClick:g}),e.action>0&&e.action===1&&t(mg,{className:"text-secondary fa-icon",onClick:m}),e.action>0&&e.action!==1&&t(hg,{className:"text-secondary fa-icon",onClick:m})]})]})," ",r&&t(B,{children:f?t(De,{columnCount:3,...n,columnMinWidth:110,columnMinHeight:130,className:"mx-2",children:e.rooms.length>0&&e.rooms.map((p,_)=>t(pd,{roomData:p,thumbnail:!0},_))}):t(ne,{columnCount:1,className:"navigator-grid",gap:0,children:e.rooms.length>0&&e.rooms.map((p,_)=>t(pd,{roomData:p},_))})})]})},iy=i=>{const{sendSearch:e=null}=i,[n,r]=o.useState(0),[s,a]=o.useState(""),{topLevelContext:c=null,searchResult:u=null}=Yn(),d=()=>{if(!c)return;let m=xs[n];m||(m=xs[0]);const f=(m.query?m.query+":":"")+s;e(f||"",c.code)},g=m=>{m.key==="Enter"&&d()};return o.useEffect(()=>{if(!u)return;const m=u.data.split(":");let f=null,p="";if(m.length>=2){const[_,...E]=m;f=xs.find(C=>C.query===_),p=E.join(":")}else p=u.data;f||(f=xs[0]),r(xs.findIndex(_=>_===f)),a(p)},[u]),l(w,{fullWidth:!0,gap:1,children:[t(w,{shrink:!0,children:t("select",{className:"form-select form-select-sm",value:n,onChange:m=>r(parseInt(m.target.value)),children:xs.map((m,f)=>t("option",{value:f,children:h("navigator.filter."+m.name)},f))})}),l(w,{fullWidth:!0,gap:1,children:[t("input",{type:"text",className:"form-control form-control-sm",placeholder:h("navigator.filter.input.placeholder"),value:s,onChange:m=>a(m.target.value),onKeyDown:m=>g(m)}),t(M,{variant:"primary",onClick:d,children:t(Cc,{className:"fa-icon"})})]})]})},oy=i=>{const[e,n]=o.useState(!1),[r,s]=o.useState(!1),[a,c]=o.useState(!1),[u,d]=o.useState(!1),[g,m]=o.useState(!1),[f,p]=o.useState(!1),[_,E]=o.useState(!0),[C,I]=o.useState(!1),{searchResult:b=null,topLevelContext:S=null,topLevelContexts:v=null,navigatorData:y=null}=Yn(),R=o.useRef(null),O=o.useRef();je(Kt.CREATED,A=>{n(!1),c(!1)});const F=o.useCallback((A,k)=>{c(!1),L(new aa(k,A)),p(!0)},[]),U=o.useCallback(()=>{if(!r){I(!0);return}if(R.current){F(R.current.value,R.current.code),R.current=null;return}if(b){F(b.data,b.code);return}S&&F("",S.code)},[r,b,S,F]);return o.useEffect(()=>{const A={linkReceived:k=>{const D=k.split("/");if(!(D.length<2))switch(D[1]){case"show":{n(!0),I(!0);return}case"hide":n(!1);return;case"toggle":{if(e){n(!1);return}n(!0),I(!0);return}case"toggle-room-info":d(V=>!V);return;case"toggle-room-link":m(V=>!V);return;case"goto":if(D.length<=2)return;switch(D[2]){case"home":if(y.homeRoomId<=0)return;Sn(y.homeRoomId);break;default:{const V=parseInt(D[2]);Sn(V)}}return;case"create":n(!0),c(!0);return;case"search":if(D.length>2){const V=D[2];let G="";D.length>3&&(G=D[3]),R.current={value:G,code:V},n(!0),I(!0)}return}},eventUrlPrefix:"navigator/"};return It(A),()=>Et(A)},[e,y]),o.useEffect(()=>{b&&(p(!1),O&&O.current&&(O.current.scrollTop=0))},[b]),o.useEffect(()=>{!e||!r||!C||(U(),I(!1))},[e,r,C,U]),o.useEffect(()=>{r||!S||s(!0)},[r,S]),o.useEffect(()=>{!e||!_||(L(new ab),E(!1))},[e,_]),o.useEffect(()=>{Va.addCallback(ti.OPENROOM,(A,k=!1,D=null)=>L(new ib(A)))},[]),l(B,{children:[e&&l(ie,{uniqueKey:"navigator",className:"nitro-navigator",children:[t(ae,{headerText:h(a?"navigator.createroom.title":"navigator.title"),onCloseClick:A=>n(!1)}),l(Br,{children:[v&&v.length>0&&v.map((A,k)=>t(sr,{isActive:S===A&&!a,onClick:D=>F("",A.code),children:h("navigator.toplevelview."+A.code)},k)),t(sr,{isActive:a,onClick:A=>c(!0),children:t(ei,{className:"fa-icon"})})]}),l(re,{position:"relative",children:[f&&t(P,{fit:!0,position:"absolute",className:"top-0 start-0 z-index-1 bg-muted opacity-0-5"}),!a&&l(B,{children:[t(iy,{sendSearch:F}),t(T,{innerRef:O,overflow:"auto",children:b&&b.results.map((A,k)=>t(ay,{searchResult:A},k))})]}),a&&t(XO,{})]})]}),t(KO,{}),u&&t(QO,{onCloseClick:()=>d(!1)}),g&&t(JO,{onCloseClick:()=>m(!1)}),t(sy,{})]})},ly=/\n\r|\n|\r/mg,cy=i=>{const[e,n]=o.useState(null),[r,s]=o.useState(""),[a,c]=o.useState(null),u=o.useRef(null);return o.useEffect(()=>{const d=async m=>{try{const f=await fetch(m);if(!f)return;const _=(await f.text()).split(ly),E=_.shift().split("|");s(E[0]),c(C=>E[1]&&E[1].split(";").length===2?{width:parseInt(E[1].split(";")[0]),height:parseInt(E[1].split(";")[1])}:null),n(_.join(""))}catch{cm.error(`Failed to fetch ${m}`)}},g={linkReceived:m=>{const f=m.split("/");f.length<2||(f.shift(),d(K("habbopages.url")+f.join("/")))},eventUrlPrefix:"habbopages/"};return It(g),()=>Et(g)},[]),o.useEffect(()=>{const d=g=>{if(!(g.target instanceof HTMLAnchorElement))return;g.preventDefault();const m=g.target.href;!m||!m.length||ys(m)};return document.addEventListener("click",d),()=>{document.removeEventListener("click",d)}},[]),e?l(ie,{className:"nitropedia",theme:"primary-slim",style:a?{width:a.width,height:a.height}:{},children:[t(ae,{headerText:r,onCloseClick:()=>n(null)}),t(re,{children:t(P,{fit:!0,innerRef:u,className:"text-black",dangerouslySetInnerHTML:{__html:e}})})]}):null},uy=i=>{const{offer:e=null,setOpen:n=null}=i;if(e)return l(Uc,{fadesOut:!1,onClose:null,onClick:r=>n(!0),gap:2,children:[t(P,{className:"nitro-targeted-offer-icon",style:{backgroundImage:`url(${K("image.library.url")+e.iconImageUrl})`}}),t(N,{variant:"light",className:"ubuntu-bold",children:e.title})]})},dy=i=>{const{offer:e=null,setOpen:n=null}=i,{getCurrencyAmount:r}=Ps(),[s,a]=o.useState(1),c=o.useMemo(()=>{let g=!1,m=!1,f=!1;return e.priceInCredits>0&&(g=r(-1)>=e.priceInCredits),e.priceInActivityPoints>0?m=r(e.activityPointType)>=e.priceInActivityPoints:m=!0,e.purchaseLimit>0&&(f=!0),g&&m&&f},[e,r]),u=()=>{let g=Math.max(0,(e.expirationTime-Date.now())/1e3);return nr.format(g)},d=()=>{L(new ob(e.id,s)),L(new Mm)};if(e)return l(ie,{theme:"primary-slim",uniqueKey:"targeted-offer",className:"nitro-targeted-offer",children:[t(ae,{headerText:h(e.title),onCloseClick:g=>n(!1)}),t(oh,{position:"relative",className:"justify-content-center align-items-center cursor-pointer",variant:"danger",gap:3,children:h("targeted.offer.timeleft",["timeleft"],[u()])}),l(re,{gap:1,children:[l(w,{gap:1,fullHeight:!0,children:[l(w,{gap:1,column:!0,className:"w-75 text-black",children:[l(T,{className:"bg-warning p-2",fullHeight:!0,children:[t("h4",{children:h(e.title)}),t(P,{dangerouslySetInnerHTML:{__html:e.description}})]}),l(w,{alignSelf:"center",alignItems:"center",justifyContent:"center",gap:2,children:[e.purchaseLimit>1&&l(w,{gap:1,children:[t(N,{variant:"muted",children:h("catalog.bundlewidget.quantity")}),t("input",{type:"number",value:s,onChange:g=>a(parseInt(g.target.value)),min:1,max:e.purchaseLimit})]}),t(M,{variant:"primary",disabled:!c,onClick:()=>d(),children:h("targeted.offer.button.buy")})]})]}),t(P,{className:"w-50",fullHeight:!0,style:{background:`url(${K("image.library.url")+e.imageUrl}) no-repeat center`}})]}),l(w,{className:"price-ray position-absolute",alignItems:"center",justifyContent:"center",column:!0,children:[t(N,{children:h("targeted.offer.price.label")}),e.priceInCredits>0&&l(w,{gap:1,children:[t(N,{variant:"light",children:e.priceInCredits}),t(dt,{type:-1})]}),e.priceInActivityPoints>0&&l(w,{gap:1,children:[l(N,{className:"ubuntu-bold",variant:"light",children:["+",e.priceInActivityPoints]})," ",t(dt,{type:e.activityPointType})]})]})]})]})},my=()=>{const[i,e]=o.useState(null),[n,r]=o.useState(!1);if(x(lb,s=>{let a=s.getParser();a&&e(a.data)}),Nh(()=>{L(new Mm)}),!!i)return t(B,{children:n?t(dy,{offer:i,setOpen:r}):t(uy,{offer:i,setOpen:r})})},hy=i=>{const[e,n]=o.useState(0),[r,s]=o.useState(null),[a,c]=o.useState(!0),{showConfirm:u=null}=ze();x(Um,p=>{n(0),s(null)}),x(Cm,p=>{n(0),s(null)}),x(ca,p=>{const _=p.getParser();_.roomEnter&&(_.data.habboGroupId>0?(n(_.data.habboGroupId),L(new Ga(_.data.habboGroupId,!1))):(n(0),s(null)))}),x(cb,p=>{const _=p.getParser();!r||_.groupId!==r.id&&_.groupId!==e||(n(0),s(null))}),x(ri,p=>{const _=p.getParser();_.id===e&&s(_)});const d=()=>{u(h("group.leaveconfirm.desc"),()=>{L(new Tc(r.id,W().userId))},null)},g=r&&r.ownerName===W().userName,m=()=>{if(g)return"group.manage";if(r.type===On.PRIVATE)return"";if(r.membershipType===Pt.MEMBER)return"group.leave";if(r.membershipType===Pt.NOT_MEMBER&&r.type===On.REGULAR)return"group.join";if(r.membershipType===Pt.REQUEST_PENDING)return"group.membershippending";if(r.membershipType===Pt.NOT_MEMBER&&r.type===On.EXCLUSIVE)return"group.requestmembership"},f=()=>{if(g)return th(r.id);if(!(r.type===On.PRIVATE&&r.membershipType===Pt.NOT_MEMBER)){if(r.membershipType===Pt.MEMBER){d();return}Dc(r.id)}};return r?t(P,{className:"nitro-notification-bubble rounded",children:l(T,{children:[l(w,{alignItems:"center",justifyContent:"between",pointer:!0,onClick:p=>c(_=>!_),children:[t(N,{variant:"white",children:h("group.homeroominfo.title")}),a&&t(bc,{className:"fa-icon"}),!a&&t(Sc,{className:"fa-icon"})]}),a&&l(B,{children:[l(w,{pointer:!0,alignItems:"center",gap:2,onClick:p=>ii(r.id),children:[t(P,{className:"group-badge",children:t(We,{badgeCode:r.badge,isGroup:!0})}),t(N,{variant:"white",children:r.title})]}),(r.type!==On.PRIVATE||g)&&t(M,{fullWidth:!0,variant:"success",disabled:r.membershipType===Pt.REQUEST_PENDING,onClick:f,children:h(m())})]})]})}):null},gy=i=>{const{title:e="Nitro",onClose:n=null,...r}=i;return t($o,{title:e,onClose:n,...r,children:l(ne,{children:[t(T,{center:!0,size:5,children:t("object",{data:"https://assets.nitrodev.co/logos/nitro-n-dark.svg",width:"100",height:"100",children:""})}),l(T,{size:7,children:[l(T,{alignItems:"center",gap:0,children:[t(N,{bold:!0,fontSize:4,children:"Nitro React"}),l(N,{children:["v",eh()]})]}),l(T,{alignItems:"center",children:[l(N,{children:[t("b",{children:"Renderer:"})," v",YS()]}),l(T,{fullWidth:!0,gap:1,children:[t(M,{fullWidth:!0,variant:"success",onClick:s=>window.open("https://discord.nitrodev.co"),children:"Discord"}),l(w,{gap:1,children:[t(M,{fullWidth:!0,onClick:s=>window.open("https://git.krews.org/nitro/nitro-react"),children:"Git"}),t(M,{fullWidth:!0,onClick:s=>window.open("https://git.krews.org/nitro/nitro-react/-/issues"),children:"Bug Report"})]})]})]})]})]})})},fy=i=>{const{item:e=null,title:n=i.item&&i.item.title||"",onClose:r=null,...s}=i,[a,c]=o.useState(!1),u=()=>{ys(e.clickUrl),r()},d=e.alertType===ge.DEFAULT;return l($o,{title:n,onClose:r,...s,type:d?ge.DEFAULT:e.alertType,children:[l(w,{fullHeight:!0,overflow:"auto",gap:d||e.imageUrl&&!a?2:0,children:[d&&!e.imageUrl&&t(P,{className:"notification-frank flex-shrink-0"}),e.imageUrl&&!a&&t("img",{src:e.imageUrl,alt:e.title,onError:()=>{c(!0)},className:"align-self-baseline"}),l(P,{classNames:["notification-text overflow-y-auto d-flex flex-column w-100",e.clickUrl&&!d?"justify-content-center":""],children:[e.messages.length>0&&e.messages.map((g,m)=>{const f=g.replace(/\r\n|\r|\n/g,"<br />");return t(P,{dangerouslySetInnerHTML:{__html:f}},m)}),e.clickUrl&&e.clickUrl.length>0&&e.imageUrl&&!a&&l(B,{children:[t("hr",{className:"my-2 w-100"}),t(M,{onClick:u,className:"align-self-center px-3",children:h(e.clickUrlText)})]})]})]}),(!e.imageUrl||e.imageUrl&&a)&&t(B,{children:l(T,{alignItems:"center",center:!0,gap:0,children:[t("hr",{className:"my-2 w-100"}),!e.clickUrl&&t(M,{onClick:r,children:h("generic.close")}),e.clickUrl&&e.clickUrl.length>0&&t(M,{onClick:u,children:h(e.clickUrlText)})]})})]})},py=i=>{const{item:e=null,title:n=i.item&&i.item.title||"",onClose:r=null,...s}=i,[a,c]=o.useState(""),[u,d]=o.useState([]),g=()=>{ys(e.clickUrl),r()},m=p=>{let _=JSON.parse(e.messages[0]);d(_.filter(E=>E.includes(p))),c(p)};o.useEffect(()=>{d(JSON.parse(e.messages[0]))},[e]);const f=e.clickUrl&&e.clickUrl.startsWith("event:");return l($o,{title:n,onClose:r,...s,children:[t(w,{fullWidth:!0,alignItems:"center",position:"relative",children:t("input",{type:"text",className:"form-control form-control-sm",placeholder:h("generic.search"),value:a,onChange:p=>m(p.target.value)})}),t(T,{fullHeight:!0,className:"py-1",overflow:"hidden",children:t(De,{gap:1,columnCount:1,children:u&&u.map((p,_)=>t("span",{children:p},_))})}),t("hr",{className:"my-2"}),l(T,{alignItems:"center",center:!0,gap:1,children:[!f&&!e.clickUrl&&t(M,{onClick:r,children:h("generic.close")}),e.clickUrl&&e.clickUrl.length>0&&t(M,{onClick:g,children:h(e.clickUrlText)})]})]})},Iy=(i,e)=>{if(!i)return null;const n={key:i.id,item:i,onClose:e};switch(i.alertType){case ge.NITRO:return t(gy,{...n});case ge.SEARCH:return t(py,{...n});default:return t(fy,{...n})}},Ey=i=>{const{item:e=null,onClose:n=null,...r}=i;return l(Uc,{fadesOut:!1,className:"flex-column club-gift",onClose:n,...r,children:[l("div",{className:"d-flex align-items-center gap-2 mb-2",children:[t(dt,{type:"hc",className:"flex-shrink-0"}),t("span",{className:"ms-1",children:h("notifications.text.club_gift")})]}),l("div",{className:"d-flex align-items-center justify-content-end gap-2",children:[t("button",{type:"button",className:"btn btn-success w-100 btn-sm",onClick:()=>ys(e.linkUrl),children:h("notifications.button.show_gift_list")}),t("span",{className:"text-decoration-underline cursor-pointer text-nowrap",onClick:n,children:h("notifications.button.later")})]})]})},Cy=i=>{const{item:e=null,onClose:n=null,...r}=i,s=e.message.replace(/\r\n|\r|\n/g,"<br />");return l(Uc,{onClose:n,gap:2,alignItems:"center",onClick:c=>{if(console.log(" [DEBUG] Notification clicked!",{linkUrl:e.linkUrl}),!e.linkUrl||!e.linkUrl.length){console.warn(" [DEBUG] No linkUrl found");return}if(e.linkUrl.startsWith("follow:")){const u=e.linkUrl.replace("follow:","");console.log(" [DEBUG] Following user:",u),Re()?(L(new ub(`:follow ${u}`,0)),console.log(" [DEBUG] Follow command sent!")):console.error(" [DEBUG] No room session found"),n()}else console.log(" [DEBUG] Opening URL:",e.linkUrl),ys(e.linkUrl)},...r,children:[t(w,{center:!0,className:"bubble-image-container",children:e.iconUrl&&e.iconUrl.length&&t("img",{className:"no-select",src:e.iconUrl,alt:""})}),t(N,{wrap:!0,variant:"white",dangerouslySetInnerHTML:{__html:s}})]})},_y=(i,e)=>{if(!i)return null;const n={key:i.id,item:i,onClose:e};switch(i.notificationType){case ft.CLUBGIFT:return t(Ey,{...n});default:return t(Cy,{...n})}},by=i=>{const{item:e=null,onClose:n=null,...r}=i,{message:s=null,onConfirm:a=null,onCancel:c=null,confirmText:u=null,cancelText:d=null,title:g=null}=e,m=()=>{a&&a(),n()},f=()=>{c&&c(),n()};return l($o,{title:g,onClose:n,...r,type:ge.ALERT,children:[t(w,{grow:!0,center:!0,children:t(N,{children:s})}),l(w,{gap:1,children:[t(M,{fullWidth:!0,variant:"danger",onClick:f,children:d}),t(M,{fullWidth:!0,onClick:m,children:u})]})]})},Sy=(i,e)=>{if(!i)return null;const n={key:i.id,item:i,onClose:e};switch(i.confirmType){default:return t(by,{...n})}},Ny=i=>{const{alerts:e=[],bubbleAlerts:n=[],confirms:r=[],closeAlert:s=null,closeBubbleAlert:a=null,closeConfirm:c=null}=ze(),u=o.useMemo(()=>{if(!e||!e.length)return null;const m=[];for(const f of e){const p=Iy(f,()=>s(f));m.push(p)}return m},[e,s]),d=o.useMemo(()=>{if(!n||!n.length)return null;const m=[];for(const f of n){const p=_y(f,()=>a(f));if(f.notificationType===ft.CLUBGIFT){m.unshift(p);continue}m.push(p)}return m},[n,a]),g=o.useMemo(()=>{if(!r||!r.length)return null;const m=[];for(const f of r){const p=Sy(f,()=>c(f));m.push(p)}return m},[r,c]);return l(B,{children:[t(T,{gap:1,children:d}),g,u]})},Id=i=>{const{type:e=-1,amount:n=-1,short:r=!1}=i,s=o.useMemo(()=>l(w,{justifyContent:"end",pointer:!0,gap:1,className:"nitro-purse-button rounded",children:[t(N,{truncate:!0,textEnd:!0,variant:"white",grow:!0,children:r?bS(n):ao(n)}),t(dt,{type:e})]}),[n,r,e]);return r?t(sm,{placement:"left",overlay:t(gg,{id:`tooltip-${e}`,children:ao(n)}),children:s}):s},Ty=i=>{const{type:e=-1,amount:n=-1}=i;return l(w,{fullWidth:!0,justifyContent:"between",className:"nitro-purse-seasonal-currency p-2 rounded",children:[t(N,{variant:"white",children:h(`purse.seasonal.currency.${e}`)}),l(w,{gap:1,children:[t(N,{variant:"white",children:ao(n)}),t(dt,{type:e})]})]})},vy=i=>{const{purse:e=null,hcDisabled:n=!1}=Ps(),r=o.useMemo(()=>K("system.currency.types",[]),[]),s=o.useMemo(()=>K("currency.display.number.short",!1),[]),a=(()=>{if(!e)return null;const u=e.clubPeriods*31+e.clubDays,d=e.minutesUntilExpiration;return e.clubLevel===bn.NO_CLUB?h("purse.clubdays.zero.amount.text"):d>-1&&d<60*24?nr.shortFormat(d*60):nr.shortFormat(u*86400)})(),c=(u,d=-1,g=!1)=>{if(!e||!e.activityPoints||!e.activityPoints.size)return null;const m=Array.from(e.activityPoints.keys()).filter(_=>r.indexOf(_)>=0);let f=0;for(;f<u;)m.shift(),f++;f=0;const p=[];for(const _ of m){if(d>-1&&f===d)break;g?p.push(t(Ty,{type:_,amount:e.activityPoints.get(_)},_)):p.push(t(Id,{type:_,amount:e.activityPoints.get(_),short:s},_)),f++}return p};return e?l(T,{alignItems:"end",className:"nitro-purse-container",gap:1,children:[t(w,{className:"nitro-purse rounded-bottom p-1",children:l(ne,{fullWidth:!0,gap:1,children:[l(T,{justifyContent:"center",size:n?10:6,gap:0,children:[t(Id,{type:-1,amount:e.credits,short:s}),c(0,2)]}),!n&&l(T,{center:!0,pointer:!0,size:4,gap:1,className:"nitro-purse-subscription rounded",onClick:u=>Z("habboUI/open/hccenter"),children:[t(dt,{type:"hc"}),t(N,{variant:"white",children:a})]}),l(T,{justifyContent:"center",size:2,gap:0,children:[t(w,{center:!0,pointer:!0,fullHeight:!0,className:"nitro-purse-button p-1 rounded",onClick:u=>Z("help/show"),children:t("i",{className:"icon icon-help"})}),t(w,{center:!0,pointer:!0,fullHeight:!0,className:"nitro-purse-button p-1 rounded",onClick:u=>Z("user-settings/toggle"),children:t("i",{className:"icon icon-cog"})})]})]})}),c(2,-1,!0)]}):null},wy={purple:9452386,blue:3891856,green:6459451,yellow:10658089,lilac:6897548,orange:10841125,turquoise:2661026,red:10104881},Ry=i=>{const[e,n]=o.useState(!0),[r,s]=o.useState(""),[a,c]=o.useState("");yN(db.MYSTERY_BOX_KEYS_UPDATE,d=>{s(d.keyColor),c(d.boxColor)});const u=d=>{const g=wy[d];return mn.int2rgb(g)};return r===""&&a===""?null:t(P,{className:"nitro-notification-bubble rounded mysterybox-extension",children:l(T,{children:[l(w,{alignItems:"center",justifyContent:"between",pointer:!0,onClick:d=>n(g=>!g),children:[t(N,{variant:"white",children:h("mysterybox.tracker.title")}),e&&t(bc,{className:"fa-icon"}),!e&&t(Sc,{className:"fa-icon"})]}),e&&l(B,{children:[t(N,{variant:"white",children:h("mysterybox.tracker.description")}),l(w,{justifyContent:"center",alignItems:"center",gap:2,children:[t(be,{className:"mysterybox-container",children:t("div",{className:"box-image flex-shrink-0",style:{backgroundColor:u(a)},children:t("div",{className:"chain-overlay-image"})})}),t(be,{className:"mysterybox-container",children:t("div",{className:"key-image flex-shrink-0",style:{backgroundColor:u(r)},children:t("div",{className:"key-overlay-image"})})})]})]})]})})},Oy=i=>{const{eventId:e=-1,eventName:n="",eventDescription:r="",setIsEditingPromote:s=null}=i,[a,c]=o.useState(n),[u,d]=o.useState(r),g=()=>{L(new mb(e,a,u)),s(!1)};return l(ie,{className:"nitro-guide-tool",theme:"primary-slim",children:[t(ae,{headerText:h("navigator.eventsettings.editcaption"),onCloseClick:()=>s(!1)}),l(re,{className:"text-black",children:[l(T,{children:[t(N,{bold:!0,children:h("navigator.eventsettings.name")}),t("input",{type:"text",className:"form-control form-control-sm",placeholder:h("navigator.eventsettings.name"),maxLength:64,value:a,onChange:m=>c(m.target.value)})]}),l(T,{children:[t(N,{bold:!0,children:h("navigator.eventsettings.desc")}),t("textarea",{className:"form-control form-control-sm",placeholder:h("navigator.eventsettings.desc"),maxLength:64,value:u,onChange:m=>d(m.target.value)})]}),t(T,{children:t(M,{fullWidth:!0,disabled:!a||!u,variant:!a||!u?"danger":"success",onClick:m=>g(),children:h("navigator.eventsettings.edit")})})]})]})},yy=i=>{const{eventDescription:e="",setIsEditingPromote:n=null}=i,{setIsExtended:r}=Bc(),s=()=>{r(!0),Z("catalog/open/room_event")};return l(B,{children:[t(w,{alignItems:"center",gap:2,style:{overflowWrap:"anywhere"},children:t(N,{variant:"white",children:e})}),t("br",{}),t("br",{}),l(ne,{className:"d-flex align-items-center justify-content-end gap-2",children:[t(M,{className:"btn btn-primary w-100 btn-sm",onClick:a=>n(!0),children:h("navigator.roominfo.editevent")}),t(M,{className:"btn btn-success w-100 btn-sm",onClick:a=>s(),children:h("roomad.extend.event")})]})]})},ky=i=>{const{eventDescription:e=""}=i;return l(B,{children:[t(w,{alignItems:"center",gap:2,style:{overflowWrap:"anywhere"},children:t(N,{variant:"white",children:e})}),t("br",{}),t("br",{}),t(T,{alignItems:"center",gap:1,children:l(P,{fullWidth:!0,overflow:"hidden",position:"relative",className:"bg-light-dark rounded",children:[t(w,{fit:!0,center:!0,position:"absolute",children:t(N,{variant:"white",center:!0,children:h("navigator.eventinprogress")})}),t(N,{children:""})]})})]})},Ay=i=>{const[e,n]=o.useState(!1),[r,s]=o.useState(!0),{promoteInformation:a,setPromoteInformation:c}=Bc();return x(Um,u=>{c(null)}),a?t(B,{children:a.data.adId!==-1&&t(P,{className:"nitro-notification-bubble rounded",children:l(T,{children:[l(w,{alignItems:"center",justifyContent:"between",pointer:!0,onClick:u=>s(d=>!d),children:[t(N,{variant:"white",overflow:"hidden",children:a.data.eventName}),r&&t(bc,{className:"fa-icon"}),!r&&t(Sc,{className:"fa-icon"})]}),r&&W().userId!==a.data.ownerAvatarId&&t(ky,{eventDescription:a.data.eventDescription}),r&&W().userId===a.data.ownerAvatarId&&t(yy,{eventDescription:a.data.eventDescription,setIsEditingPromote:()=>n(!0)}),e&&t(Oy,{eventId:a.data.adId,eventName:a.data.eventName,eventDescription:a.data.eventDescription,setIsEditingPromote:()=>n(!1)})]})})}):null},Dy=i=>t("div",{className:"nitro-right-side",children:l(T,{position:"relative",gap:1,children:[t(vy,{}),t(hy,{}),t(Ry,{}),t(my,{}),t(Ay,{}),t(Ny,{})]})}),Py=i=>t("div",{className:"room-spectator"}),Ly=i=>{const[e,n]=o.useState(null),[r,s]=o.useState(null),{chatStyleId:a=0}=Wr(),{roomSession:c=null}=Le();x(hb,d=>{const g=d.getParser();if(!g)return;const m=c.userDataManager.getPetData(g.petId);m&&(n(m),s(g))});const u=(d,g)=>{!d||!g||c==null||c.sendChatMessage(`${d} ${g}`,a)};return!e||!r?null:l(ie,{uniqueKey:"user-settings",className:"user-settings-window no-resize",theme:"primary-slim",children:[t(ae,{headerText:h("widgets.pet.commands.title"),onCloseClick:()=>s(null)}),l(re,{className:"text-black",children:[t(w,{alignItems:"center",justifyContent:"center",gap:2,children:l(ne,{columnCount:2,children:[t(T,{fullWidth:!0,overflow:"hidden",className:"body-image pet p-1",children:t(Ir,{figure:e.figure,posture:"std",direction:2})}),t(N,{variant:"black",small:!0,wrap:!0,children:e.name})]})}),t(ne,{columnCount:2,children:r.commands&&r.commands.length>0&&r.commands.map((d,g)=>t(M,{disabled:!r.enabledCommands.includes(d),onClick:()=>u(e.name,h(`pet.command.${d}`)),children:h(`pet.command.${d}`)},g))})]})]})},rn=i=>{const{justifyContent:e="center",alignItems:n="center",classNames:r=[],...s}=i,a=o.useMemo(()=>{const c=["menu-header","p-1"];return r.length&&c.push(...r),c},[r]);return t(w,{justifyContent:e,alignItems:n,classNames:a,...s})},My=i=>{const{chatEvent:e=null,onClose:n=null}=i,[r,s]=o.useState(e.chat==="${bot.skill.chatter.configuration.text.placeholder}"?"":e.chat),[a,c]=o.useState(e.automaticChat),[u,d]=o.useState(e.mixSentences),[g,m]=o.useState(e.chatDelay),f=o.useMemo(()=>Rc(Re().roomId,e.objectId,e.category,1),[e]),p=E=>E.replace(/;#;/g," ").replace(/\r\n|\r|\n/g,"\r"),_=()=>{const E=p(r)+";#;"+a+";#;"+g+";#;"+u;L(new yr(e.botId,qe.SETUP_CHAT,E)),n()};return t(as,{windowPosition:Ht.NOTHING,handleSelector:".drag-handler",dragStyle:{top:f.y,left:f.x},children:l(P,{className:"nitro-context-menu bot-chat",children:[t(rn,{className:"drag-handler",children:h("bot.skill.chatter.configuration.title")}),l(T,{className:"p-1",children:[l(T,{gap:1,children:[t(N,{variant:"white",children:h("bot.skill.chatter.configuration.chat.text")}),t("textarea",{className:"form-control form-control-sm",placeholder:h("bot.skill.chatter.configuration.text.placeholder"),value:r,rows:7,onChange:E=>s(E.target.value)})]}),l(T,{gap:1,children:[l(w,{gap:1,alignItems:"center",justifyContent:"between",children:[t(N,{fullWidth:!0,variant:"white",children:h("bot.skill.chatter.configuration.automatic.chat")}),t("input",{type:"checkbox",className:"form-check-input",checked:a,onChange:E=>c(E.target.checked)})]}),l(w,{gap:1,alignItems:"center",justifyContent:"between",children:[t(N,{fullWidth:!0,variant:"white",children:h("bot.skill.chatter.configuration.markov")}),t("input",{type:"checkbox",className:"form-check-input",checked:u,onChange:E=>d(E.target.checked)})]}),l(w,{gap:1,alignItems:"center",justifyContent:"between",children:[t(N,{fullWidth:!0,variant:"white",children:h("bot.skill.chatter.configuration.chat.delay")}),t("input",{type:"number",className:"form-control form-control-sm",value:g,onChange:E=>m(E.target.valueAsNumber)})]})]}),l(w,{alignItems:"center",justifyContent:"between",gap:1,children:[t(M,{fullWidth:!0,variant:"primary",onClick:n,children:h("cancel")}),t(M,{fullWidth:!0,variant:"success",onClick:_,children:h("save")})]})]})]})})},Ed=-1,Cd=0,_d=1,bd=2,Sd=3,Nd=4,Td=5,vd=6,Uy=i=>{const{item:e=null,onClose:n=null}=i,[r,s]=o.useState(Ed),[a,c]=o.useState(null),[u,d]=o.useState(null),{roomSession:g=null}=Le(),m=()=>{a&&j().selectRoomObject(g.roomId,a.roomIndex,J.UNIT)},f=()=>{g.usePetProduct(e.requestRoomObjectId,a.webID),n()},p=o.useMemo(()=>{if(!a||!u)return null;const _=new sa(a.figure),E=u.customParams.split(" "),C=parseInt(E[0]);switch(u.specialType){case me.PET_SHAMPOO:{if(E.length<2)return null;const I=j().getPetColorResult(C,_.paletteId),b=j().getPetColorResultsForTag(C,E[1]);let S=-1;for(const v of b)if(v.breed===I.breed){S=parseInt(v.id);break}return t(Ir,{typeId:_.typeId,paletteId:S,petColor:_.color,customParts:_.customParts,direction:2})}case me.PET_CUSTOM_PART:{if(E.length<4)return null;const I=[],b=E[1].split(",").map(R=>parseInt(R)),S=E[2].split(",").map(R=>parseInt(R)),v=E[3].split(",").map(R=>parseInt(R));let y=0;for(;y<b.length;){const R=b[y],O=_.getCustomPart(R);let F=v[y];O!=null&&(F=O.paletteId),I.push(new _l(R,S[y],F)),y++}return t(Ir,{typeId:_.typeId,paletteId:_.paletteId,petColor:_.color,customParts:I,direction:2})}case me.PET_CUSTOM_PART_SHAMPOO:{if(E.length<3)return null;const I=[],b=E[1].split(",").map(y=>parseInt(y)),S=E[2].split(",").map(y=>parseInt(y));let v=0;for(;v<b.length;){const y=b[v],R=_.getCustomPart(y);let O=-1;R!=null&&(O=R.partId),I.push(new _l(b[v],O,S[v])),v++}return t(Ir,{typeId:_.typeId,paletteId:_.paletteId,petColor:_.color,customParts:I,direction:2})}case me.PET_SADDLE:{if(E.length<4)return null;const I=[],b=E[1].split(",").map(R=>parseInt(R)),S=E[2].split(",").map(R=>parseInt(R)),v=E[3].split(",").map(R=>parseInt(R));let y=0;for(;y<b.length;)I.push(new _l(b[y],S[y],v[y])),y++;for(const R of _.customParts)b.indexOf(R.layerId)===-1&&I.push(R);return t(Ir,{typeId:_.typeId,paletteId:_.paletteId,petColor:_.color,customParts:I,direction:2})}case me.MONSTERPLANT_REBREED:case me.MONSTERPLANT_REVIVAL:case me.MONSTERPLANT_FERTILIZE:{let I="rip";const b=j().getRoomObject(g.roomId,a.roomIndex,J.UNIT);if(b&&(I=b.model.getValue(ee.FIGURE_POSTURE),I==="rip")){const S=a.petLevel;S<7?I=`grw${S}`:I="std"}return t(Ir,{typeId:_.typeId,paletteId:_.paletteId,petColor:_.color,customParts:_.customParts,posture:I,direction:2})}}},[a,u,g]);return o.useEffect(()=>{const _=g.userDataManager.getUserDataByIndex(e.id);c(_);const E=jo(g.roomId,e.requestRoomObjectId,J.FLOOR);if(!E)return;d(E);let C=Ed;switch(E.specialType){case me.PET_SHAMPOO:C=Cd;break;case me.PET_CUSTOM_PART:C=_d;break;case me.PET_CUSTOM_PART_SHAMPOO:C=bd;break;case me.PET_SADDLE:C=Sd;break;case me.MONSTERPLANT_REVIVAL:C=Nd;break;case me.MONSTERPLANT_REBREED:C=Td;break;case me.MONSTERPLANT_FERTILIZE:C=vd;break}s(C)},[g,e]),a?l(ie,{className:"nitro-use-product-confirmation",children:[t(ae,{headerText:h("useproduct.widget.title",["name"],[a.name]),onCloseClick:n}),t(re,{center:!0,children:l(w,{gap:2,overflow:"hidden",children:[t(T,{children:t(P,{pointer:!0,className:"product-preview",onClick:m,children:p})}),l(T,{justifyContent:"between",overflow:"auto",children:[l(T,{gap:2,children:[r===Cd&&l(B,{children:[t(N,{children:h("useproduct.widget.text.shampoo",["productName"],[u.name])}),t(N,{children:h("useproduct.widget.info.shampoo")})]}),r===_d&&l(B,{children:[t(N,{children:h("useproduct.widget.text.custompart",["productName"],[u.name])}),t(N,{children:h("useproduct.widget.info.custompart")})]}),r===bd&&l(B,{children:[t(N,{children:h("useproduct.widget.text.custompartshampoo",["productName"],[u.name])}),t(N,{children:h("useproduct.widget.info.custompartshampoo")})]}),r===Sd&&l(B,{children:[t(N,{children:h("useproduct.widget.text.saddle",["productName"],[u.name])}),t(N,{children:h("useproduct.widget.info.saddle")})]}),r===Nd&&l(B,{children:[t(N,{children:h("useproduct.widget.text.revive_monsterplant",["productName"],[u.name])}),t(N,{children:h("useproduct.widget.info.revive_monsterplant")})]}),r===Td&&l(B,{children:[t(N,{children:h("useproduct.widget.text.rebreed_monsterplant",["productName"],[u.name])}),t(N,{children:h("useproduct.widget.info.rebreed_monsterplant")})]}),r===vd&&l(B,{children:[t(N,{children:h("useproduct.widget.text.fertilize_monsterplant",["productName"],[u.name])}),t(N,{children:h("useproduct.widget.info.fertilize_monsterplant")})]})]}),l(w,{alignItems:"center",justifyContent:"between",children:[t(M,{variant:"danger",onClick:n,children:h("useproduct.widget.cancel")}),t(M,{variant:"success",onClick:f,children:h("useproduct.widget.use")})]})]})]})})]}):null},q=i=>{const{disabled:e=!1,fullWidth:n=!0,justifyContent:r="center",alignItems:s="center",classNames:a=[],onClick:c=null,...u}=i,d=m=>{e||c&&c(m)},g=o.useMemo(()=>{const m=["menu-item","list-item"];return e&&m.push("disabled"),a.length&&m.push(...a),m},[e,a]);return t(w,{fullWidth:n,justifyContent:r,alignItems:s,classNames:g,onClick:d,...u})},xy=i=>{const{justifyContent:e="center",alignItems:n="center",classNames:r=[],collapsed:s=!0,...a}=i,c=o.useMemo(()=>{const u=["menu-footer"];return r.length&&u.push(...r),u},[r]);return l(w,{justifyContent:e,alignItems:n,classNames:c,...a,children:[!s&&t(pc,{className:"fa-icon align-self-center"}),s&&t(fc,{className:"fa-icon align-self-center"})]})},Fy=25,wd=3,Gy=5e3,Vy=75,Vs=10;let Al=!1,Bi=null,Hi=-1e6,Dl=1;const wr=i=>{const{objectId:e=-1,category:n=-1,userType:r=-1,fades:s=!1,onClose:a=null,position:c="absolute",classNames:u=[],style:d={},children:g=null,collapsable:m=!1,...f}=i,[p,_]=o.useState({x:null,y:null}),[E,C]=o.useState(1),[I,b]=o.useState(!1),[S,v]=o.useState(Al),y=o.useRef(),R=o.useCallback(A=>{if(!I)return;Dl+=A;let k=(1-Dl/Vy)*1;if(k<=0)return a(),!1;C(k)},[I,a]),O=o.useCallback((A,k)=>{if(!A||!k||!Bi)return;let D=-y.current.offsetHeight;r>-1&&(r===pt.USER||r===pt.BOT||r===pt.RENTABLE_BOT)?D=D+(A.height>50?15:0):D=D-14,Bi.addValue(k.y-A.top);let V=Bi.getMax();V<Hi-wd&&(V=Hi-wd),Hi=V;const G=k.y-V;let $=~~(k.x-y.current.offsetWidth/2),X=~~(G+D);const Y=_e().width-y.current.offsetWidth-Vs,Ee=_e().height-y.current.offsetHeight-Vs;$<Vs?$=Vs:$>Y&&($=Y),X<Vs?X=Vs:X>Ee&&(X=Ee),_({x:$,y:X})},[r]),F=o.useMemo(()=>{const A=["nitro-context-menu"];return S&&A.push("menu-hidden"),A.push(p.x!==null?"visible":"invisible"),u.length&&A.push(...u),A},[p,u,S]),U=o.useMemo(()=>{let A={};return A.left=p.x||0,A.top=p.y||0,A.opacity=E,Object.keys(d).length&&(A={...A,...d}),A},[p,E,d]);return o.useEffect(()=>{if(!y.current)return;const A=k=>{if(!y.current)return;R(k);const D=Rc(Re().roomId,e,n),V=jm(Re().roomId,e,n);O(D,V)};return Vr().add(A),()=>{Vr().remove(A)}},[e,n,R,O]),o.useEffect(()=>{if(!s)return;const A=setTimeout(()=>b(!0),Gy);return()=>clearTimeout(A)},[s]),o.useEffect(()=>{Al=S},[S]),o.useEffect(()=>{Bi=new gb(Fy),Hi=-1e6,Dl=1},[]),l(P,{innerRef:y,position:c,classNames:F,style:U,...f,children:[!(m&&Al)&&g,m&&t(xy,{onClick:()=>v(!S),collapsed:S})]})},Rd=0,Od=1,yd=2,kd=3,Ad=4,Dd=5,Pd=6,Ld=7,By=i=>{const{item:e=null,updateConfirmingProduct:n=null,onClose:r=null}=i,[s,a]=o.useState(0),{roomSession:c=null}=Le(),u=d=>{if(d)switch(d){case"use_product":case"use_product_shampoo":case"use_product_custom_part":case"use_product_custom_part_shampoo":case"use_product_saddle":case"replace_product_saddle":case"revive_monsterplant":case"rebreed_monsterplant":case"fertilize_monsterplant":n(e);break}};return o.useEffect(()=>{if(!e)return;const d=jo(c.roomId,e.requestRoomObjectId,J.FLOOR);if(!d)return;let g=Rd;switch(d.specialType){case me.PET_SHAMPOO:g=Od;break;case me.PET_CUSTOM_PART:g=yd;break;case me.PET_CUSTOM_PART_SHAMPOO:g=kd;break;case me.PET_SADDLE:g=Ad;break;case me.MONSTERPLANT_REVIVAL:g=Dd;break;case me.MONSTERPLANT_REBREED:g=Pd;break;case me.MONSTERPLANT_FERTILIZE:g=Ld;break}a(g)},[c,e]),l(wr,{objectId:e.id,category:J.UNIT,userType:pt.PET,onClose:r,collapsable:!0,children:[t(rn,{children:e.name}),s===Rd&&t(q,{onClick:d=>u("use_product"),children:h("infostand.button.useproduct")}),s===Od&&t(q,{onClick:d=>u("use_product_shampoo"),children:h("infostand.button.useproduct_shampoo")}),s===yd&&t(q,{onClick:d=>u("use_product_custom_part"),children:h("infostand.button.useproduct_custom_part")}),s===kd&&t(q,{onClick:d=>u("use_product_custom_part_shampoo"),children:h("infostand.button.useproduct_custom_part_shampoo")}),s===Ad&&l(B,{children:[e.replace&&t(q,{onClick:d=>u("replace_product_saddle"),children:h("infostand.button.replaceproduct_saddle")}),!e.replace&&t(q,{onClick:d=>u("use_product_saddle"),children:h("infostand.button.useproduct_saddle")})]}),s===Dd&&t(q,{onClick:d=>u("revive_monsterplant"),children:h("infostand.button.revive_monsterplant")}),s===Pd&&t(q,{onClick:d=>u("rebreed_monsterplant"),children:h("infostand.button.rebreed_monsterplant")}),s===Ld&&t(q,{onClick:d=>u("fertilize_monsterplant"),children:h("infostand.button.fertilize_monsterplant")})]})},Hy=i=>{const{avatarInfo:e=null,onClose:n=null}=i;return e?t(T,{className:"nitro-infostand rounded",children:l(T,{overflow:"visible",className:"container-fluid content-area",gap:1,children:[l(T,{gap:1,children:[l(w,{alignItems:"center",justifyContent:"between",gap:1,children:[t(N,{variant:"white",small:!0,wrap:!0,children:e.name}),t(Dn,{className:"cursor-pointer fa-icon",onClick:n})]}),t("hr",{className:"m-0"})]}),l(T,{gap:1,children:[l(w,{gap:1,children:[t(T,{fullWidth:!0,className:"body-image bot",children:t(it,{figure:e.figure,direction:4})}),t(T,{grow:!0,center:!0,gap:0,children:e.badges.length>0&&e.badges.map(r=>t(We,{badgeCode:r,showInfo:!0},r))})]}),t("hr",{className:"m-0"})]}),t(w,{alignItems:"center",className:"bg-light-dark rounded py-1 px-2",children:t(N,{fullWidth:!0,wrap:!0,textBreak:!0,variant:"white",small:!0,className:"motto-content",children:e.motto})}),e.carryItem>0&&l(T,{gap:1,children:[t("hr",{className:"m-0"}),t(N,{variant:"white",small:!0,wrap:!0,children:h("infostand.text.handitem",["item"],[h("handitem"+e.carryItem)])})]})]})}):null},Pl=0,Md=1,Ud=2,Wy=i=>{const{avatarInfo:e=null,onClose:n=null}=i,{roomSession:r=null}=Le(),[s,a]=o.useState(0),[c,u]=o.useState(!1),[d,g]=o.useState(!1),[m,f]=o.useState(!1),[p,_]=o.useState([]),[E,C]=o.useState([]),[I,b]=o.useState([]),[S,v]=o.useState([]),[y,R]=o.useState(!1),[O,F]=o.useState(0),[U,A]=o.useState(0),[k,D]=o.useState(!1),[V,G]=o.useState(!1),[$,X]=o.useState(null),[Y,Ee]=o.useState(!1),[ue,ye]=o.useState(!1),[Ye,Ct]=o.useState(-1),[Je,Wt]=o.useState(""),[Be,Xt]=o.useState(""),[on,Me]=o.useState({x:-1,y:-1,z:-1}),[pe,ht]=o.useState(!1),[Ut,Mn]=o.useState(null),[da,Ls]=o.useState(null),[vn,Ce]=o.useState(null),[Ue,Un]=o.useState(null),[ma,fn]=o.useState(null);fs(_m.NPE_SONG_CHANGED,oe=>{Ct(oe.id)},Y||ue),fs(Eb.SIR_TRAX_SONG_INFO_RECEIVED,oe=>{if(oe.id!==Ye)return;const se=_e().soundManager.musicController.getSongInfo(oe.id);se&&(Wt(se.name),Xt(se.creator))},Y||ue);const Qt=o.useCallback((oe,se,le=0,Se=0)=>{if(console.log(" sendUpdate chamado:",{deltaX:oe,deltaY:se,deltaZ:le,deltaDirection:Se,avatarInfo:e}),!e)return;const xe=j().activeRoomId,Ze=j().getRoomObject(xe,e.id,e.category);if(!Ze){console.error(" RoomObject no encontrado!");return}if(console.log(" RoomObject encontrado:",Ze),e.isWallItem){const xt=j().getLegacyWallGeometry(xe);if(!xt)return;const H=Ze.getLocation();let z=Ze.getDirection().x;if(Se!==0){const he=[0,90,180,270],ke=he.indexOf(z);if(ke!==-1){let et;Se>0?et=(ke+1)%he.length:et=(ke-1+he.length)%he.length,z=he[et]}else z<90||z===360?z=Se>0?90:270:z<180?z=Se>0?180:0:z<270?z=Se>0?270:90:z=Se>0?0:180}const Q=new Ot(H.x+oe,H.y+se,le!==0?le:H.z),te=xt.getOldLocationString(Q,z);te?(console.log(" Enviando FurnitureWallUpdateComposer:",{itemId:e.id,location:te}),L(new tN(e.id,te))):console.error(" locationString invlido!")}else{const xt=Ze.getLocation(),H=xt.x+oe,z=xt.y+se,Q=le!==0?le*1e4:xt.z*1e4,te=Ze.getDirection().x,he=Se!==0?mi(Ze,Se>0)/45:te/45;console.log(" Enviando UpdateFurniturePositionComposer:",{itemId:e.id,x:H,y:z,z:Q,direction:he,currentLocation:xt,currentDirection:te,deltaZ:le}),L(new fb(e.id,H,z,Q,he))}},[e]);function ha(oe){switch(oe.x){case 0:return 0;case 45:return 1;case 90:return 2;case 135:return 3;case 180:return 4;case 225:return 5;case 270:return 6;case 315:return 7;default:return null}}function mi(oe,se){if(!oe||!oe.model)return 0;let le=[];oe.type==="monster_plant"?le=oe.model.getValue("pet_allowed_directions"):le=oe.model.getValue("furniture_allowed_directions");let Se=oe.getDirection().x;if(le&&le.length){let xe=le.indexOf(Se);if(xe<0){xe=0;for(let Ze=0;Ze<le.length&&!(Se<=le[Ze]);Ze++)xe++;xe=xe%le.length}se?xe=(xe+1)%le.length:xe=(xe-1+le.length)%le.length,Se=le[xe]}return Se}const Ms=o.useCallback(oe=>{let se=parseFloat(oe.target.value);isNaN(se)||se<-5?se=-5:se>40&&(se=40),Ce(se),Qt(0,0,se,0)},[Qt]),ga=o.useCallback(oe=>{let se=parseFloat(oe.target.value);isNaN(se)||se<-5?se=-5:se>40&&(se=40),se=parseFloat(se.toFixed(4)),Ce(se),Qt(0,0,se,0)},[Qt]),Rr=o.useCallback(oe=>{let se=vn+oe;se<-5?se=-5:se>40&&(se=40),se=parseFloat(se.toFixed(4)),Ce(se),Qt(0,0,se,0)},[vn,Qt]);o.useEffect(()=>{let oe=Pl,se=!1,le=!1,Se=!1,xe=[],Ze=[],xt=[],H=[],z=!1,Q=0,te=0,he=!1,ke=!1,et=!1,Ie=!1,Jt=-1;const fi=e.roomControllerLevel>=nt.GUEST;(fi||e.isOwner||e.isRoomOwner||e.isAnyRoomController)&&(se=!0,le=!0,e.roomControllerLevel>=nt.MODERATOR&&(he=!0));const il=j().getRoomObject(r.roomId,e.id,e.isWallItem?J.WALL:J.FLOOR),pi=il==null?void 0:il.getLocation();if(pi&&Me({x:pi.x,y:pi.y,z:pi.z}),e.isAnyRoomController&&(ke=!0),(e.usagePolicy===Cu.EVERYBODY||e.usagePolicy===Cu.CONTROLLER&&fi||e.extraParam===kr.JUKEBOX&&fi||e.extraParam===kr.USABLE_PRODUCT&&fi)&&(Se=!0),e.extraParam){if(e.extraParam===kr.CRACKABLE_FURNI){const Fn=e.stuffData;Se=!0,z=!0,Q=Fn.hits,te=Fn.target}else if(e.extraParam===kr.JUKEBOX){const Fn=_e().soundManager.musicController.getRoomItemPlaylist();Fn&&(Jt=Fn.nowPlayingSongId),et=!0}else e.extraParam.indexOf(kr.SONGDISK)===0&&(Jt=parseInt(e.extraParam.substr(kr.SONGDISK.length)),Ie=!0);if(he){const Fn=e.extraParam.substr(kr.BRANDING_OPTIONS.length);if(Fn){const fa=Fn.split("	");for(const ol of fa){const ls=ol.split("=");ls&&ls.length===2&&(xe.push(ls[0]),Ze.push(ls[1]))}}}}if(he){const Fn=j().getRoomObject(r.roomId,e.id,e.isWallItem?J.WALL:J.FLOOR);if(Fn){const fa=Fn.model.getValue(ee.FURNITURE_CUSTOM_VARIABLES),ol=Fn.model.getValue(ee.FURNITURE_DATA);if(fa&&fa.length)for(const ls of fa)xt.push(ls),H.push(ol[ls]||"")}}e.isOwner||e.isAnyRoomController?oe=Ud:(e.isRoomOwner||e.roomControllerLevel>=nt.GUILD_ADMIN)&&(oe=Md),e.isStickie&&(oe=Pl),a(oe),u(se),g(le),f(Se),_(xe),C(Ze),b(xt),v(H),R(z),F(Q),A(te),D(he),G(ke),X(null),Ee(et),ye(Ie),Ct(Jt),e.groupId&&L(new Ga(e.groupId,!1))},[r,e]),o.useEffect(()=>{var xe;const oe=r.roomId,se=e.id,le=e.isWallItem?J.WALL:J.FLOOR,Se=j().getRoomObject(oe,se,le);if(Se){const Ze=Se.getLocation();Ze&&(Mn(Ze.x),Ls(Ze.y),Ce(Ze.z));const xt=Se.getDirection(),H=xt?ha(xt):null;Un(H);const z=(xe=Se.model)==null?void 0:xe.getValue(ee.FURNITURE_DATA);fn(z)}},[e,r]),x(pb,oe=>{const le=oe.getParser().item;if(console.log(" FurnitureFloorUpdateEvent recebido:",{itemId:le.itemId,x:le.x,y:le.y,z:le.z,direction:le.direction,isMyItem:le.itemId===(e==null?void 0:e.id)}),le.itemId!==e.id)return;const Se={x:le.x,y:le.y,z:le.z};Se&&(Mn(Se.x),Ls(Se.y),Ce(Se.z));const xe={x:le.direction},Ze=xe?ha(xe):null,xt=le.state;Un(Ze),fn(xt),console.log(" Posio atualizada no InfoStand:",Se)}),x(ri,oe=>{const se=oe.getParser();!e||e.groupId!==se.id||se.flag||($&&X(null),X(se.title))}),o.useEffect(()=>{const oe=_e().soundManager.musicController.getSongInfo(Ye);Wt((oe==null?void 0:oe.name)??""),Xt((oe==null?void 0:oe.creator)??"")},[Ye]);const Us=o.useCallback((oe,se)=>{const le=Array.from(E);le[oe]=se,C(le)},[E]),hi=o.useCallback((oe,se)=>{const le=Array.from(S);le[oe]=se,v(le)},[S]),os=o.useCallback(()=>{if(p.length===0||E.length===0)return"";let oe="",se=0;for(;se<p.length;){const le=p[se],Se=E[se];oe=oe+(le+"="+Se+"	"),se++}return oe},[p,E]),xn=o.useCallback(oe=>{if(!(!oe||oe===""))switch(oe){case"buy_one":Z(`catalog/open/offerId/${e.purchaseOfferId}`);return;case"move":j().processRoomObjectOperation(e.id,e.category,tr.OBJECT_MOVE);break;case"rotate":e.isWallItem?Qt(0,0,0,1):j().processRoomObjectOperation(e.id,e.category,tr.OBJECT_ROTATE_POSITIVE);break;case"pickup":s===Ud?j().processRoomObjectOperation(e.id,e.category,tr.OBJECT_PICKUP):j().processRoomObjectOperation(e.id,e.category,tr.OBJECT_EJECT);break;case"use":j().useRoomObject(e.id,e.category);break;case"save_branding_configuration":{const se=new Map,le=os().split("	");if(le)for(const Se of le){const[xe,Ze]=Se.split("=",2);se.set(xe,Ze)}j().modifyRoomObjectDataWithMap(e.id,e.category,tr.OBJECT_SAVE_STUFF_DATA,se);break}case"save_custom_variables":{const se=new Map;for(let le=0;le<I.length;le++){const Se=I[le],xe=S[le];Se&&Se.length&&xe&&xe.length&&se.set(Se,xe)}L(new Ib(e.id,se));break}}},[e,s,I,S,os,Qt]),gi=o.useCallback(()=>{const oe=e.stuffData;return!oe||!(oe instanceof ni)?null:oe.getValue(2)},[e]);return e?l(T,{gap:1,alignItems:"end",children:[t(T,{className:"nitro-infostand rounded",children:l(T,{overflow:"visible",className:"container-fluid content-area",gap:1,children:[l(T,{gap:1,children:[l(w,{alignItems:"center",justifyContent:"between",gap:1,children:[t(N,{variant:"white",small:!0,wrap:!0,children:e.name}),t(Dn,{className:"cursor-pointer fa-icon",onClick:n})]}),t("hr",{className:"m-0"})]}),l(T,{gap:1,children:[l(w,{position:"relative",gap:1,children:[e.stuffData.isUnique&&t("div",{className:"position-absolute end-0",children:t(uh,{uniqueNumber:e.stuffData.uniqueNumber,uniqueSeries:e.stuffData.uniqueSeries})}),e.stuffData.rarityLevel>-1&&t("div",{className:"position-absolute end-0",children:t(Fc,{level:e.stuffData.rarityLevel})}),e.image&&e.image.src.length&&t("img",{className:"d-block mx-auto",src:e.image.src,alt:""})]}),t("hr",{className:"m-0"})]}),l(T,{gap:1,children:[t(N,{fullWidth:!0,wrap:!0,textBreak:!0,variant:"white",small:!0,children:e.description}),t("hr",{className:"m-0"})]}),l(T,{gap:1,children:[l(w,{alignItems:"center",gap:1,children:[t(An,{userId:e.ownerId}),t(N,{variant:"white",small:!0,wrap:!0,children:h("furni.owner",["name"],[e.ownerName])})]}),e.purchaseOfferId>0&&t(w,{children:t(N,{variant:"white",small:!0,underline:!0,pointer:!0,onClick:oe=>xn("buy_one"),children:h("infostand.button.buy")})})]}),(Y||ue)&&l(T,{gap:1,children:[t("hr",{className:"m-0"}),Ye===-1&&t(N,{variant:"white",small:!0,wrap:!0,children:h("infostand.jukebox.text.not.playing")}),!!Je.length&&l(w,{alignItems:"center",gap:1,children:[t(P,{className:"icon disk-icon"}),t(N,{variant:"white",small:!0,wrap:!0,children:Je})]}),!!Be.length&&l(w,{alignItems:"center",gap:1,children:[t(P,{className:"icon disk-creator"}),t(N,{variant:"white",small:!0,wrap:!0,children:Be})]})]}),l(T,{gap:1,children:[y&&l(B,{children:[t("hr",{className:"m-0"}),t(N,{variant:"white",small:!0,wrap:!0,children:h("infostand.crackable_furni.hits_remaining",["hits","target"],[O.toString(),U.toString()])})]}),e.groupId>0&&l(B,{children:[t("hr",{className:"m-0"}),l(w,{pointer:!0,alignItems:"center",gap:2,onClick:()=>ii(e.groupId),children:[t(We,{badgeCode:gi(),isGroup:!0}),t(N,{variant:"white",underline:!0,children:$})]})]}),k&&l(B,{children:[t("hr",{className:"m-0"}),c&&l(B,{children:[l(M,{variant:"dark",onClick:()=>ht(!pe),children:[pe?"Fechar":"Abrir"," Buildtools"]}),pe&&l(B,{children:[t("hr",{className:"m-0"}),l(N,{small:!0,wrap:!0,variant:"white",children:["X = ",on.x,"  and  Y = ",on.y,t("br",{}),"BuildHeight = ",on.z<.01?0:on.z,t("br",{}),V&&l(N,{wrap:!0,variant:"white",children:[" Room Furnishing ID: ",e.id]})]}),t("hr",{className:"m-0"}),l(w,{gap:1,children:[t(T,{className:"buildtool-box buildtool-box-left",children:l(T,{fullWidth:!0,children:[t(N,{variant:"white",children:"Posio"}),l(T,{justifyContent:"center",alignItems:"center",className:"button-w-height",children:[l(w,{className:"floor-spaceing",children:[l(P,{className:"buildtool-movefurni button-leftup",onClick:()=>Qt(-1,0,vn,0),children:[" ",t(Ii,{className:"fa-icon icon-color",size:"1.7em"})," "]}),l(P,{className:"buildtool-movefurni button-rightup",onClick:()=>Qt(0,-1,vn,0),children:[" ",t(Ii,{className:"fa-icon icon-color",size:"1.7em"})," "]})]}),l(w,{className:"floor-spaceing",children:[l(P,{className:"buildtool-movefurni button-leftdown",onClick:()=>Qt(0,1,vn,0),children:[" ",t(Ii,{className:"fa-icon icon-color",size:"1.7em"})," "]}),l(P,{className:"buildtool-movefurni button-rightdown",onClick:()=>Qt(1,0,vn,0),children:[" ",t(Ii,{className:"fa-icon icon-color",size:"1.7em"})," "]})]})]}),d&&l(B,{children:[t(N,{variant:"white",children:"Rotao"}),l(w,{center:!0,className:"floor-spaceing",children:[l(P,{className:"buildtool-rotatefurni",onClick:()=>Qt(0,0,vn,-1),children:[" ",t(fg,{className:"fa-icon icon-color",size:"1.4em"})," "]}),l(P,{className:"buildtool-rotatefurni",onClick:()=>Qt(0,0,vn,1),children:[" ",t(pg,{className:"fa-icon icon-color",size:"1.4em"})," "]})]})]})]})}),t(T,{className:"buildtool-box buildtool-box-right",children:l(T,{fullWidth:!0,children:[t(N,{variant:"white",children:"Altura"}),t("input",{spellCheck:"false",type:"number",className:"form-control form-control-sm",value:vn!==null?vn.toString():"",onChange:Ms,onBlur:ga,min:-5,max:40,step:.1}),l(w,{justifyContent:"center",gap:1,children:[l(T,{children:[t(P,{className:"buildtool-setheight buildtool-setheightup",onClick:()=>Rr(1),children:""}),t(N,{variant:"white",align:"center",children:""}),t(P,{className:"buildtool-setheight buildtool-setheightdown",onClick:()=>Rr(-1),children:""})]}),l(T,{children:[t(P,{className:"buildtool-setheight buildtool-setheightup",onClick:()=>Rr(.1),children:""}),t(N,{variant:"white",align:"center",children:""}),t(P,{className:"buildtool-setheight buildtool-setheightdown",onClick:()=>Rr(-.1),children:""})]}),l(T,{children:[t(P,{className:"buildtool-setheight buildtool-setheightup",onClick:()=>Rr(.01),children:""}),t(N,{variant:"white",align:"center",children:"_"}),t(P,{className:"buildtool-setheight buildtool-setheightdown",onClick:()=>Rr(-.01),children:""})]})]})]})})]})]})]}),p.length>0&&l(B,{children:[t("hr",{className:"m-0"}),t(T,{gap:1,children:p.map((oe,se)=>l(w,{alignItems:"center",gap:1,children:[t(N,{small:!0,wrap:!0,align:"end",variant:"white",className:"col-4",children:oe}),t("input",{type:"text",className:"form-control form-control-sm",value:E[se],onChange:le=>Us(se,le.target.value)})]},se))})]})]}),I.length>0&&l(B,{children:[t("hr",{className:"m-0 my-1"}),t(T,{gap:1,children:I.map((oe,se)=>l(w,{alignItems:"center",gap:1,children:[t(N,{small:!0,wrap:!0,align:"end",variant:"white",className:"col-4",children:oe}),t("input",{type:"text",className:"form-control form-control-sm",value:S[se],onChange:le=>hi(se,le.target.value)})]},se))})]})]})]})}),l(w,{gap:1,justifyContent:"end",children:[c&&t(M,{variant:"dark",onClick:oe=>xn("move"),children:h("infostand.button.move")}),d&&t(M,{variant:"dark",onClick:oe=>xn("rotate"),children:h("infostand.button.rotate")}),s!==Pl&&t(M,{variant:"dark",onClick:oe=>xn("pickup"),children:h(s===Md?"infostand.button.eject":"infostand.button.pickup")}),m&&t(M,{variant:"dark",onClick:oe=>xn("use"),children:h("infostand.button.use")}),p.length>0&&E.length>0&&p.length===E.length&&t(M,{variant:"dark",onClick:()=>xn("save_branding_configuration"),children:h("save")}),I.length>0&&S.length>0&&I.length===S.length&&t(M,{variant:"dark",onClick:()=>xn("save_custom_variables"),children:h("save")})]})]}):null},jy=i=>{const{avatarInfo:e=null,onClose:n=null}=i,[r,s]=o.useState(0),[a,c]=o.useState(0),{roomSession:u=null}=Le(),{petRespectRemaining:d=0,respectPet:g=null}=Wr();if(o.useEffect(()=>{s(e.remainingGrowTime),c(e.remainingTimeToLive)},[e]),o.useEffect(()=>{if(e.petType!==Gt.MONSTERPLANT||e.dead)return;const f=setInterval(()=>{s(p=>p-1),c(p=>p-1)},1e3);return()=>clearInterval(f)},[e]),!e)return null;const m=f=>{let p=!0;if(!(!f||f=="")){switch(f){case"respect":g(e.id),d-1>=1&&(p=!1);break;case"buyfood":Z("catalog/open/"+K("catalog.links")["pets.buy_food"]);break;case"train":u==null||u.requestPetCommands(e.id);break;case"treat":L(new vc(e.id));break;case"compost":u==null||u.compostPlant(e.id);break;case"pick_up":u==null||u.pickupPet(e.id);break}p&&n()}};return l(T,{gap:1,alignItems:"end",children:[t(T,{className:"nitro-infostand rounded",children:l(T,{overflow:"visible",className:"container-fluid content-area",gap:1,children:[l(T,{gap:1,children:[l(w,{alignItems:"center",justifyContent:"between",gap:1,children:[t(N,{variant:"white",small:!0,wrap:!0,children:e.name}),t(Dn,{className:"cursor-pointer fa-icon",onClick:n})]}),t(N,{variant:"white",small:!0,wrap:!0,children:h(`pet.breed.${e.petType}.${e.petBreed}`)}),t("hr",{className:"m-0"})]}),e.petType===Gt.MONSTERPLANT&&l(B,{children:[l(T,{center:!0,gap:1,children:[t(Ir,{figure:e.petFigure,posture:e.posture,direction:4}),t("hr",{className:"m-0"})]}),l(T,{gap:2,children:[!e.dead&&t(T,{alignItems:"center",gap:1,children:t(N,{variant:"white",center:!0,small:!0,wrap:!0,children:h("pet.level",["level","maxlevel"],[e.level.toString(),e.maximumLevel.toString()])})}),l(T,{alignItems:"center",gap:1,children:[t(N,{variant:"white",small:!0,truncate:!0,children:h("infostand.pet.text.wellbeing")}),l(P,{fullWidth:!0,overflow:"hidden",position:"relative",className:"bg-light-dark rounded",children:[t(w,{fit:!0,center:!0,position:"absolute",children:t(N,{variant:"white",small:!0,children:e.dead?"00:00:00":us(a==0?e.remainingTimeToLive:a).split(":")[1]+":"+us(a==null||a==null?0:a).split(":")[2]+":"+us(a==null||a==null?0:a).split(":")[3]})}),t(P,{className:"bg-success rounded pet-stats",style:{width:e.dead?"0":Math.round(e.maximumTimeToLive*100/a).toString()}})]})]}),r!=0&&r>0&&l(T,{alignItems:"center",gap:1,children:[t(N,{variant:"white",small:!0,truncate:!0,children:h("infostand.pet.text.growth")}),t(_N,{className:"top-2 end-2",day:us(r).split(":")[0],hour:us(r).split(":")[1],minutes:us(r).split(":")[2],seconds:us(r).split(":")[3]})]}),l(T,{alignItems:"center",gap:1,children:[t(N,{variant:"white",small:!0,truncate:!0,children:h("infostand.pet.text.raritylevel",["level"],[h(`infostand.pet.raritylevel.${e.rarityLevel}`)])}),t(Fc,{className:"top-2 end-2",level:e.rarityLevel})]}),t("hr",{className:"m-0"})]}),l(T,{gap:1,children:[t(N,{variant:"white",small:!0,wrap:!0,children:h("pet.age",["age"],[e.age.toString()])}),t("hr",{className:"m-0"})]})]}),e.petType!==Gt.MONSTERPLANT&&l(B,{children:[l(T,{gap:1,children:[l(w,{gap:1,children:[t(T,{fullWidth:!0,overflow:"hidden",className:"body-image pet p-1",children:t(Ir,{figure:e.petFigure,posture:e.posture,direction:4})}),l(T,{grow:!0,gap:1,children:[t(N,{variant:"white",center:!0,small:!0,wrap:!0,children:h("pet.level",["level","maxlevel"],[e.level.toString(),e.maximumLevel.toString()])}),l(T,{alignItems:"center",gap:1,children:[t(N,{variant:"white",small:!0,truncate:!0,children:h("infostand.pet.text.happiness")}),l(P,{fullWidth:!0,overflow:"hidden",position:"relative",className:"bg-light-dark rounded",children:[t(w,{fit:!0,center:!0,position:"absolute",children:t(N,{variant:"white",small:!0,children:e.happyness+"/"+e.maximumHappyness})}),t(P,{className:"bg-info rounded pet-stats",style:{width:e.happyness/e.maximumHappyness*100+"%"}})]})]}),l(T,{alignItems:"center",gap:1,children:[t(N,{variant:"white",small:!0,truncate:!0,children:h("infostand.pet.text.experience")}),l(P,{fullWidth:!0,overflow:"hidden",position:"relative",className:"bg-light-dark rounded",children:[t(w,{fit:!0,center:!0,position:"absolute",children:t(N,{variant:"white",small:!0,children:e.experience+"/"+e.levelExperienceGoal})}),t(P,{className:"bg-purple rounded pet-stats",style:{width:e.experience/e.levelExperienceGoal*100+"%"}})]})]}),l(T,{alignItems:"center",gap:1,children:[t(N,{variant:"white",small:!0,truncate:!0,children:h("infostand.pet.text.energy")}),l(P,{fullWidth:!0,overflow:"hidden",position:"relative",className:"bg-light-dark rounded",children:[t(w,{fit:!0,center:!0,position:"absolute",children:t(N,{variant:"white",small:!0,children:e.energy+"/"+e.maximumEnergy})}),t(P,{className:"bg-success rounded pet-stats",style:{width:e.energy/e.maximumEnergy*100+"%"}})]})]})]})]}),t("hr",{className:"m-0"})]}),l(T,{gap:1,children:[e.petType!==Gt.MONSTERPLANT&&t(N,{variant:"white",small:!0,wrap:!0,children:h("infostand.text.petrespect",["count"],[e.respect.toString()])}),t(N,{variant:"white",small:!0,wrap:!0,children:h("pet.age",["age"],[e.age.toString()])}),t("hr",{className:"m-0"})]})]}),t(T,{gap:1,children:l(w,{alignItems:"center",gap:1,children:[t(An,{userId:e.ownerId}),t(N,{variant:"white",small:!0,wrap:!0,children:h("infostand.text.petowner",["name"],[e.ownerName])})]})})]})}),l(w,{gap:1,justifyContent:"end",children:[e.petType!==Gt.MONSTERPLANT&&t(M,{variant:"dark",onClick:f=>m("buyfood"),children:h("infostand.button.buyfood")}),e.isOwner&&e.petType!==Gt.MONSTERPLANT&&t(M,{variant:"dark",onClick:f=>m("train"),children:h("infostand.button.train")}),!e.dead&&e.energy/e.maximumEnergy<.98&&e.petType===Gt.MONSTERPLANT&&t(M,{variant:"dark",onClick:f=>m("treat"),children:h("infostand.button.pettreat")}),(u==null?void 0:u.isRoomOwner)&&e.petType===Gt.MONSTERPLANT&&t(M,{variant:"dark",onClick:f=>m("compost"),children:h("infostand.button.compost")}),e.isOwner&&t(M,{variant:"dark",onClick:f=>m("pick_up"),children:h("inventory.pets.pickup")}),d>0&&e.petType!==Gt.MONSTERPLANT&&t(M,{variant:"dark",onClick:f=>m("respect"),children:h("infostand.button.petrespect",["count"],[d.toString()])})]})]})},qy=i=>{const{avatarInfo:e=null,onClose:n=null}=i,r=o.useMemo(()=>!(e.botSkills.indexOf(qe.NO_PICK_UP)>=0||!e.amIOwner&&!e.amIAnyRoomController),[e]),s=()=>L(new xm(e.webID));if(e)return l(T,{gap:1,children:[t(T,{className:"nitro-infostand rounded",children:l(T,{overflow:"visible",className:"container-fluid content-area",gap:1,children:[l(T,{gap:1,children:[l(w,{alignItems:"center",justifyContent:"between",gap:1,children:[t(N,{variant:"white",small:!0,wrap:!0,children:e.name}),t(Dn,{className:"cursor-pointer fa-icon",onClick:n})]}),t("hr",{className:"m-0"})]}),l(T,{gap:1,children:[l(w,{gap:1,children:[t(T,{fullWidth:!0,className:"body-image bot",children:t(it,{figure:e.figure,direction:4})}),t(T,{grow:!0,center:!0,gap:0,children:e.badges.length>0&&e.badges.map(a=>t(We,{badgeCode:a,showInfo:!0},a))})]}),t("hr",{className:"m-0"})]}),l(T,{gap:1,children:[t(w,{alignItems:"center",className:"bg-light-dark rounded py-1 px-2",children:t(N,{fullWidth:!0,wrap:!0,textBreak:!0,variant:"white",small:!0,className:"motto-content",children:e.motto})}),t("hr",{className:"m-0"})]}),l(T,{gap:1,children:[l(w,{alignItems:"center",gap:1,children:[t(An,{userId:e.ownerId}),t(N,{variant:"white",small:!0,wrap:!0,children:h("infostand.text.botowner",["name"],[e.ownerName])})]}),e.carryItem>0&&l(B,{children:[t("hr",{className:"m-0"}),t(N,{variant:"white",small:!0,wrap:!0,children:h("infostand.text.handitem",["item"],[h("handitem"+e.carryItem)])})]})]})]})}),r&&t(w,{justifyContent:"end",children:t(M,{variant:"dark",onClick:s,children:h("infostand.button.pickup")})})]})},Ll=i=>{const{type:e=-1,relationship:n=null}=i;if(!n)return null;const r=er.RELATIONSHIP_NAMES[e].toLocaleLowerCase();return l(w,{alignItems:"center",gap:1,children:[t("i",{className:`nitro-friends-spritesheet icon-${r}`}),t(w,{alignItems:"center",gap:0,children:l(N,{small:!0,variant:"white",onClick:s=>hn(n.randomFriendId),children:[t("u",{children:n.randomFriendName}),n.friendCount>1&&" "+h(`extendedprofile.relstatus.others.${r}`,["count"],[(n.friendCount-1).toString()])]})})]})},zy=i=>{const{relationships:e=null}=i;return!e||!e.relationshipStatusMap.length?null:l(B,{children:[t(Ll,{type:er.HEART,relationship:e.relationshipStatusMap.getValue(er.HEART)}),t(Ll,{type:er.SMILE,relationship:e.relationshipStatusMap.getValue(er.SMILE)}),t(Ll,{type:er.BOBBA,relationship:e.relationshipStatusMap.getValue(er.BOBBA)})]})},Yy=i=>{Z(`navigator/search/${i}`),L(new aa("hotel_view",`tag:${i}`))},$y=i=>{const{tags:e=null}=i;return!e||!e.length?null:l(B,{children:[t("hr",{className:"m-0"}),t(w,{className:"flex-tags",children:e&&e.length>0&&e.map((n,r)=>t(N,{variant:"white",className:"text-tags",onClick:s=>Yy(n),children:n},r))})]})},Ky=i=>{const{avatarInfo:e=null,setAvatarInfo:n=null,onClose:r=null}=i,[s,a]=o.useState(null),[c,u]=o.useState(!1),[d,g]=o.useState(null),{roomSession:m=null}=Le(),f=E=>{!c||E.length>K("motto.max.length",38)||(m.sendMottoMessage(E),u(!1))},p=E=>f(E.target.value),_=E=>{switch(E.stopPropagation(),E.key){case"Enter":f(E.target.value);return}};return je(Cb.RSUBE_BADGES,E=>{!e||e.webID!==E.userId||e.badges.join("")===E.badges.join("")||n(I=>{const b=sn(I);return b.badges=E.badges,b})}),je(_b.USER_FIGURE,E=>{!e||e.roomIndex!==E.roomIndex||n(C=>{const I=sn(C);return I.figure=E.figure,I.motto=E.customInfo,I.achievementScore=E.activityPoints,I})}),je(bb.FAVOURITE_GROUP_UPDATE,E=>{!e||e.roomIndex!==E.roomIndex||n(C=>{const I=sn(C),b=E.status===-1||E.habboGroupId<=0;return I.groupId=b?-1:E.habboGroupId,I.groupName=b?null:E.habboGroupName,I.groupBadgeId=b?null:W().getGroupBadge(E.habboGroupId),I})}),x(Fm,E=>{const C=E.getParser();!e||e.webID!==C.userId||g(C)}),o.useEffect(()=>(u(!1),a(e.motto),L(new Gm(e.webID)),()=>{u(!1),a(null),g(null)}),[e]),e?t(T,{className:"nitro-infostand rounded",children:l(T,{overflow:"visible",className:"container-fluid content-area",gap:1,children:[l(T,{gap:1,children:[l(w,{alignItems:"center",justifyContent:"between",children:[l(w,{alignItems:"center",gap:1,children:[t(An,{userId:e.webID}),t(N,{variant:"white",small:!0,wrap:!0,children:e.name})]}),t(Dn,{className:"cursor-pointer fa-icon",onClick:r})]}),t("hr",{className:"m-0"})]}),l(T,{gap:1,children:[l(w,{gap:1,children:[t(T,{fullWidth:!0,className:"body-image",onClick:E=>hn(e.webID),children:t(it,{figure:e.figure,direction:4})}),l(T,{grow:!0,alignItems:"center",gap:0,children:[l(w,{gap:1,children:[t(w,{center:!0,className:"badge-image",children:e.badges[0]&&t(We,{badgeCode:e.badges[0],showInfo:!0})}),t(w,{center:!0,pointer:e.groupId>0,className:"badge-image",onClick:E=>ii(e.groupId),children:e.groupId>0&&t(We,{badgeCode:e.groupBadgeId,isGroup:!0,showInfo:!0,customTitle:e.groupName})})]}),l(w,{center:!0,gap:1,children:[t(w,{center:!0,className:"badge-image",children:e.badges[1]&&t(We,{badgeCode:e.badges[1],showInfo:!0})}),t(w,{center:!0,className:"badge-image",children:e.badges[2]&&t(We,{badgeCode:e.badges[2],showInfo:!0})})]}),l(w,{center:!0,gap:1,children:[t(w,{center:!0,className:"badge-image",children:e.badges[3]&&t(We,{badgeCode:e.badges[3],showInfo:!0})}),t(w,{center:!0,className:"badge-image",children:e.badges[4]&&t(We,{badgeCode:e.badges[4],showInfo:!0})})]})]})]}),t("hr",{className:"m-0"})]}),l(T,{gap:1,children:[l(w,{alignItems:"center",className:"bg-light-dark rounded py-1 px-2",children:[e.type!==vt.OWN_USER&&t(w,{grow:!0,alignItems:"center",className:"motto-content",children:t(N,{fullWidth:!0,pointer:!0,wrap:!0,textBreak:!0,small:!0,variant:"white",children:s})}),e.type===vt.OWN_USER&&l(w,{grow:!0,alignItems:"center",gap:2,children:[t(Ig,{className:"small fa-icon"}),l(w,{grow:!0,alignItems:"center",className:"motto-content",children:[!c&&l(N,{fullWidth:!0,pointer:!0,wrap:!0,textBreak:!0,small:!0,variant:"white",onClick:E=>u(!0),children:[s,""]}),c&&t("input",{type:"text",className:"motto-input",maxLength:K("motto.max.length",38),value:s,onChange:E=>a(E.target.value),onBlur:p,onKeyDown:_,autoFocus:!0})]})]})]}),t("hr",{className:"m-0"})]}),l(T,{gap:1,children:[t(N,{variant:"white",small:!0,wrap:!0,children:h("infostand.text.achievement_score")+" "+e.achievementScore}),e.carryItem>0&&l(B,{children:[t("hr",{className:"m-0"}),t(N,{variant:"white",small:!0,wrap:!0,children:h("infostand.text.handitem",["item"],[h("handitem"+e.carryItem)])})]})]}),t(T,{gap:1,children:t(zy,{relationships:d})}),K("user.tags.enabled")&&t(T,{gap:1,className:"mt-1",children:t($y,{tags:W().tags})})]})}):null},Wi=0,Ml=1,xd=2,Fd=3,Ul=4,Gd=5,Vd=6,Xy=i=>{const{avatarInfo:e=null,onClose:n=null}=i,[r,s]=o.useState(Wi),{canRequestFriend:a=null}=Nn(),{report:c=null}=zn(),{roomSession:u=null}=Le(),{userRespectRemaining:d=0,respectUser:g=null}=Wr(),m=o.useMemo(()=>e.amIOwner&&e.targetRoomControllerLevel<nt.GUEST&&!e.isGuildRoom,[e]),f=o.useMemo(()=>e.amIOwner&&e.targetRoomControllerLevel===nt.GUEST&&!e.isGuildRoom,[e]),p=o.useMemo(()=>e.canBeKicked||e.canBeBanned||e.canBeMuted||m||f,[m,f,e]),_=o.useMemo(()=>{let C=!1;const I=As();if(I){const b=I.model.getValue(ee.FIGURE_CARRY_OBJECT);b>0&&b<999999&&(C=!0)}return C},[]),E=C=>{let I=!0;if(C)switch(C){case"moderate":I=!1,s(Ml);break;case"ban":I=!1,s(xd);break;case"mute":I=!1,s(Fd);break;case"ambassador":I=!1,s(Ul);break;case"ambassador_mute":I=!1,s(Gd);break;case"back_moderate":I=!1,s(Ml);break;case"back_ambassador":I=!1,s(Ul);break;case"back":I=!1,s(Wi);break;case"whisper":yt(new Ns(Ns.WHISPER,e.name));break;case"friend":Z(`friends/request/${e.webID}/${e.name}`);break;case"relationship":I=!1,s(Vd);break;case"respect":{g(e.webID),d-1>=1&&(I=!1);break}case"ignore":W().ignoreUser(e.name);break;case"unignore":W().unignoreUser(e.name);break;case"kick":u.sendKickMessage(e.webID);break;case"ban_hour":u.sendBanMessage(e.webID,"RWUAM_BAN_USER_HOUR");break;case"ban_day":u.sendBanMessage(e.webID,"RWUAM_BAN_USER_DAY");break;case"perm_ban":u.sendBanMessage(e.webID,"RWUAM_BAN_USER_PERM");break;case"mute_2min":u.sendMuteMessage(e.webID,2);break;case"mute_5min":u.sendMuteMessage(e.webID,5);break;case"mute_10min":u.sendMuteMessage(e.webID,10);break;case"give_rights":u.sendGiveRightsMessage(e.webID);break;case"remove_rights":u.sendTakeRightsMessage(e.webID);break;case"trade":L(new Nb(e.roomIndex));break;case"report":c(st.BULLY,{reportedUserId:e.webID});break;case"pass_hand_item":L(new Sb(e.webID));break;case"ambassador_alert":u.sendAmbassadorAlertMessage(e.webID);break;case"ambassador_kick":u.sendKickMessage(e.webID);break;case"ambassador_mute_2min":u.sendMuteMessage(e.webID,2);break;case"ambassador_mute_10min":u.sendMuteMessage(e.webID,10);break;case"ambassador_mute_60min":u.sendMuteMessage(e.webID,60);break;case"ambassador_mute_18hour":u.sendMuteMessage(e.webID,1080);break;case"rship_heart":L(new Ea(e.webID,dn.RELATIONSHIP_HEART));break;case"rship_smile":L(new Ea(e.webID,dn.RELATIONSHIP_SMILE));break;case"rship_bobba":L(new Ea(e.webID,dn.RELATIONSHIP_BOBBA));break;case"rship_none":L(new Ea(e.webID,dn.RELATIONSHIP_NONE));break}I&&n()};return o.useEffect(()=>{s(Wi)},[e]),l(wr,{objectId:e.roomIndex,category:J.UNIT,userType:e.userType,onClose:n,collapsable:!0,children:[t(rn,{className:"cursor-pointer",onClick:C=>hn(e.webID),children:e.name}),r===Wi&&l(B,{children:[a(e.webID)&&t(q,{onClick:C=>E("friend"),children:h("infostand.button.friend")}),t(q,{onClick:C=>E("trade"),children:h("infostand.button.trade")}),t(q,{onClick:C=>E("whisper"),children:h("infostand.button.whisper")}),d>0&&t(q,{onClick:C=>E("respect"),children:h("infostand.button.respect",["count"],[d.toString()])}),!a(e.webID)&&l(q,{onClick:C=>E("relationship"),children:[h("infostand.link.relationship"),t(En,{className:"right fa-icon"})]}),!e.isIgnored&&t(q,{onClick:C=>E("ignore"),children:h("infostand.button.ignore")}),e.isIgnored&&t(q,{onClick:C=>E("unignore"),children:h("infostand.button.unignore")}),t(q,{onClick:C=>E("report"),children:h("infostand.button.report")}),p&&l(q,{onClick:C=>E("moderate"),children:[t(En,{className:"right fa-icon"}),h("infostand.link.moderate")]}),e.isAmbassador&&l(q,{onClick:C=>E("ambassador"),children:[t(En,{className:"right fa-icon"}),h("infostand.link.ambassador")]}),_&&t(q,{onClick:C=>E("pass_hand_item"),children:h("avatar.widget.pass_hand_item")})]}),r===Ml&&l(B,{children:[t(q,{onClick:C=>E("kick"),children:h("infostand.button.kick")}),l(q,{onClick:C=>E("mute"),children:[t(En,{className:"right fa-icon"}),h("infostand.button.mute")]}),l(q,{onClick:C=>E("ban"),children:[t(En,{className:"right fa-icon"}),h("infostand.button.ban")]}),m&&t(q,{onClick:C=>E("give_rights"),children:h("infostand.button.giverights")}),f&&t(q,{onClick:C=>E("remove_rights"),children:h("infostand.button.removerights")}),l(q,{onClick:C=>E("back"),children:[t(In,{className:"left fa-icon"}),h("generic.back")]})]}),r===xd&&l(B,{children:[t(q,{onClick:C=>E("ban_hour"),children:h("infostand.button.ban_hour")}),t(q,{onClick:C=>E("ban_day"),children:h("infostand.button.ban_day")}),t(q,{onClick:C=>E("perm_ban"),children:h("infostand.button.perm_ban")}),l(q,{onClick:C=>E("back_moderate"),children:[t(In,{className:"left fa-icon"}),h("generic.back")]})]}),r===Fd&&l(B,{children:[t(q,{onClick:C=>E("mute_2min"),children:h("infostand.button.mute_2min")}),t(q,{onClick:C=>E("mute_5min"),children:h("infostand.button.mute_5min")}),t(q,{onClick:C=>E("mute_10min"),children:h("infostand.button.mute_10min")}),l(q,{onClick:C=>E("back_moderate"),children:[t(In,{className:"left fa-icon"}),h("generic.back")]})]}),r===Ul&&l(B,{children:[t(q,{onClick:C=>E("ambassador_alert"),children:h("infostand.button.alert")}),t(q,{onClick:C=>E("ambassador_kick"),children:h("infostand.button.kick")}),l(q,{onClick:C=>E("ambassador_mute"),children:[h("infostand.button.mute"),t(En,{className:"right fa-icon"})]}),l(q,{onClick:C=>E("back"),children:[t(In,{className:"left fa-icon"}),h("generic.back")]})]}),r===Gd&&l(B,{children:[t(q,{onClick:C=>E("ambassador_mute_2min"),children:h("infostand.button.mute_2min")}),t(q,{onClick:C=>E("ambassador_mute_10min"),children:h("infostand.button.mute_10min")}),t(q,{onClick:C=>E("ambassador_mute_60min"),children:h("infostand.button.mute_60min")}),t(q,{onClick:C=>E("ambassador_mute_18hr"),children:h("infostand.button.mute_18hour")}),l(q,{onClick:C=>E("back_ambassador"),children:[t(In,{className:"left fa-icon"}),h("generic.back")]})]}),r===Vd&&l(B,{children:[l(w,{className:"menu-list-split-3",children:[t(q,{onClick:C=>E("rship_heart"),children:t(P,{pointer:!0,className:"nitro-friends-spritesheet icon-heart"})}),t(q,{onClick:C=>E("rship_smile"),children:t(P,{pointer:!0,className:"nitro-friends-spritesheet icon-smile"})}),t(q,{onClick:C=>E("rship_bobba"),children:t(P,{pointer:!0,className:"nitro-friends-spritesheet icon-bobba"})})]}),t(q,{onClick:C=>E("rship_none"),children:h("avatar.widget.clear_relationship")}),l(q,{onClick:C=>E("back"),children:[t(In,{className:"left fa-icon"}),h("generic.back")]})]})]})},qh=i=>{const{classNames:e=[],...n}=i,r=o.useMemo(()=>{const s=["menu-list"];return e.length&&s.push(...e),s},[e]);return t(T,{classNames:r,...n})},Qy=i=>{const{userId:e=-1,userName:n="",roomIndex:r=-1,setIsDecorating:s=null}=i;return t(wr,{objectId:r,category:J.UNIT,onClose:null,children:t(qh,{children:t(q,{onClick:a=>s(!1),children:h("widget.avatar.stop_decorating")})})})},Jy=i=>{const{avatarInfo:e=null,onClose:n=null}=i,r=s=>{if(s)switch(s){case"move":Hs(e.id,e.category,tr.OBJECT_MOVE);break;case"rotate":Hs(e.id,e.category,tr.OBJECT_ROTATE_POSITIVE);break;case"pickup":Hs(e.id,e.category,tr.OBJECT_PICKUP);break;case"eject":Hs(e.id,e.category,tr.OBJECT_EJECT);break}};return l(wr,{objectId:e.id,category:e.category,onClose:n,collapsable:!0,children:[t(rn,{children:e.name}),l(w,{className:"menu-list-split-3",children:[t(q,{onClick:s=>r("move"),children:t(Eg,{className:"center fa-icon"})}),t(q,{onClick:s=>r("rotate"),disabled:e.isWallItem,children:t(Cg,{className:"center fa-icon"})}),(e.isOwner||e.isAnyRoomController)&&t(q,{onClick:s=>r("pickup"),children:t(eu,{className:"center fa-icon"})}),!e.isOwner&&!e.isAnyRoomController&&(e.isRoomOwner||e.roomControllerLevel>=nt.GUILD_ADMIN)&&t(q,{onClick:s=>r("eject"),children:t(eu,{className:"center fa-icon"})})]})]})},Bd=i=>{const{nameInfo:e=null,onClose:n=null}=i,r=o.useMemo(()=>{const s=["name-only"];return e.isFriend&&s.push("is-friend"),s},[e]);return t(wr,{objectId:e.roomIndex,category:e.category,userType:e.userType,fades:e.id!==W().userId,classNames:r,onClose:n,children:t("div",{className:"text-shadow",children:e.name})})},xl=0,Fl=1,Hd=3,Wd=4,Zy=i=>{const{avatarInfo:e=null,isDancing:n=!1,setIsDecorating:r=null,onClose:s=null}=i,[a,c]=o.useState(n&&bs()?Fl:xl),{roomSession:u=null}=Le(),d=f=>{let p=!0;if(f)if(f.startsWith("sign_")){const _=parseInt(f.split("_")[1]);u.sendSignMessage(_)}else switch(f){case"decorate":r(!0);break;case"change_name":yt(new Ja(Ja.INIT));break;case"change_looks":Z("avatar-editor/show");break;case"expressions":p=!1,c(Hd);break;case"sit":u.sendPostureMessage(uo.POSTURE_SIT);break;case"stand":u.sendPostureMessage(uo.POSTURE_STAND);break;case"wave":u.sendExpressionMessage(hr.WAVE.ordinal);break;case"blow":u.sendExpressionMessage(hr.BLOW.ordinal);break;case"laugh":u.sendExpressionMessage(hr.LAUGH.ordinal);break;case"idle":u.sendExpressionMessage(hr.IDLE.ordinal);break;case"dance_menu":p=!1,c(Fl);break;case"dance":u.sendDanceMessage(1);break;case"dance_stop":u.sendDanceMessage(0);break;case"dance_1":case"dance_2":case"dance_3":case"dance_4":u.sendDanceMessage(parseInt(f.charAt(f.length-1)));break;case"signs":p=!1,c(Wd);break;case"back":p=!1,c(xl);break;case"drop_carry_item":L(new Tb);break}p&&s()},g=()=>e.amIOwner||e.amIAnyRoomController||e.roomControllerLevel>nt.GUEST,m=fS();return l(wr,{objectId:e.roomIndex,category:J.UNIT,userType:e.userType,onClose:s,collapsable:!0,children:[t(rn,{className:"cursor-pointer",onClick:f=>hn(e.webID),children:e.name}),a===xl&&l(B,{children:[e.allowNameChange&&t(q,{onClick:f=>d("change_name"),children:h("widget.avatar.change_name")}),g()&&t(q,{onClick:f=>d("decorate"),children:h("widget.avatar.decorate")}),t(q,{onClick:f=>d("change_looks"),children:h("widget.memenu.myclothes")}),bs()&&!m&&l(q,{onClick:f=>d("dance_menu"),children:[t(En,{className:"right fa-icon"}),h("widget.memenu.dance")]}),!n&&!bs()&&!m&&t(q,{onClick:f=>d("dance"),children:h("widget.memenu.dance")}),n&&!bs()&&!m&&t(q,{onClick:f=>d("dance_stop"),children:h("widget.memenu.dance.stop")}),l(q,{onClick:f=>d("expressions"),children:[t(En,{className:"right fa-icon"}),h("infostand.link.expressions")]}),l(q,{onClick:f=>d("signs"),children:[t(En,{className:"right fa-icon"}),h("infostand.show.signs")]}),e.carryItem>0&&t(q,{onClick:f=>d("drop_carry_item"),children:h("avatar.widget.drop_hand_item")})]}),a===Fl&&l(B,{children:[n&&t(q,{onClick:f=>d("dance_stop"),children:h("widget.memenu.dance.stop")}),t(q,{onClick:f=>d("dance_1"),children:h("widget.memenu.dance1")}),t(q,{onClick:f=>d("dance_2"),children:h("widget.memenu.dance2")}),t(q,{onClick:f=>d("dance_3"),children:h("widget.memenu.dance3")}),t(q,{onClick:f=>d("dance_4"),children:h("widget.memenu.dance4")}),l(q,{onClick:f=>d("back"),children:[t(In,{className:"left fa-icon"}),h("generic.back")]})]}),a===Hd&&l(B,{children:[hS()===ta.POSTURE_STAND&&t(q,{onClick:f=>d("sit"),children:h("widget.memenu.sit")}),tS()&&t(q,{onClick:f=>d("stand"),children:h("widget.memenu.stand")}),Tl()&&t(q,{onClick:f=>d("wave"),children:h("widget.memenu.wave")}),Tl()&&l(q,{disabled:!Ai(),onClick:f=>d("laugh"),children:[!Ai()&&t(dt,{type:"hc"}),h("widget.memenu.laugh")]}),Tl()&&l(q,{disabled:!Ai(),onClick:f=>d("blow"),children:[!Ai()&&t(dt,{type:"hc"}),h("widget.memenu.blow")]}),t(q,{onClick:f=>d("idle"),children:h("widget.memenu.idle")}),l(q,{onClick:f=>d("back"),children:[t(In,{className:"left fa-icon"}),h("generic.back")]})]}),a===Wd&&l(B,{children:[l(w,{className:"menu-list-split-3",children:[t(q,{onClick:f=>d("sign_1"),children:"1"}),t(q,{onClick:f=>d("sign_2"),children:"2"}),t(q,{onClick:f=>d("sign_3"),children:"3"})]}),l(w,{className:"menu-list-split-3",children:[t(q,{onClick:f=>d("sign_4"),children:"4"}),t(q,{onClick:f=>d("sign_5"),children:"5"}),t(q,{onClick:f=>d("sign_6"),children:"6"})]}),l(w,{className:"menu-list-split-3",children:[t(q,{onClick:f=>d("sign_7"),children:"7"}),t(q,{onClick:f=>d("sign_8"),children:"8"}),t(q,{onClick:f=>d("sign_9"),children:"9"})]}),l(w,{className:"menu-list-split-3",children:[t(q,{onClick:f=>d("sign_10"),children:"10"}),t(q,{onClick:f=>d("sign_11"),children:t("i",{className:"icon icon-sign-heart"})}),t(q,{onClick:f=>d("sign_12"),children:t("i",{className:"icon icon-sign-skull"})})]}),l(w,{className:"menu-list-split-3",children:[t(q,{onClick:f=>d("sign_0"),children:"0"}),t(q,{onClick:f=>d("sign_13"),children:t("i",{className:"icon icon-sign-exclamation"})}),t(q,{onClick:f=>d("sign_15"),children:t("i",{className:"icon icon-sign-smile"})})]}),l(w,{className:"menu-list-split-3",children:[t(q,{onClick:f=>d("sign_14"),children:t("i",{className:"icon icon-sign-soccer"})}),t(q,{onClick:f=>d("sign_17"),children:t("i",{className:"icon icon-sign-yellow"})}),t(q,{onClick:f=>d("sign_16"),children:t("i",{className:"icon icon-sign-red"})})]}),l(q,{onClick:f=>d("back"),children:[t(In,{className:"left fa-icon"}),h("generic.back")]})]})]})},Gl=0,jd=1,qd=2,zd=3,ek=i=>{const{avatarInfo:e=null,onClose:n=null}=i,[r,s]=o.useState(Gl),{roomSession:a=null}=Le(),{petRespectRemaining:c=0,respectPet:u=null}=Wr(),d=o.useMemo(()=>{let m=!1;const f=As();if(f){const p=f.model.getValue(ee.FIGURE_CARRY_OBJECT);p>0&&p<999999&&(m=!0)}return m},[]),g=m=>{let f=!0;if(m)switch(m){case"respect":u(e.id),c-1>=1&&(f=!1);break;case"treat":L(new vc(e.id));break;case"pass_handitem":L(new Vm(e.id));break;case"train":a.requestPetCommands(e.id);break;case"pick_up":a.pickupPet(e.id);break;case"mount":a.mountPet(e.id);break;case"toggle_riding_permission":a.togglePetRiding(e.id);break;case"toggle_breeding_permission":a.togglePetBreeding(e.id);break;case"dismount":a.dismountPet(e.id);break;case"saddle_off":a.removePetSaddle(e.id);break;case"breed":break;case"harvest":a.harvestPet(e.id);break;case"revive":break;case"compost":a.compostPlant(e.id);break;case"buy_saddle":Z("catalog/open/"+K("catalog.links")["pets.buy_saddle"]);break}f&&n()};return o.useEffect(()=>{s(m=>e.petType===Gt.MONSTERPLANT?zd:e.saddle&&!e.rider?jd:e.rider?qd:Gl)},[e]),l(wr,{objectId:e.roomIndex,category:J.UNIT,userType:pt.PET,onClose:n,collapsable:!0,children:[t(rn,{children:e.name}),r===Gl&&l(B,{children:[c>0&&t(q,{onClick:m=>g("respect"),children:h("infostand.button.petrespect",["count"],[c.toString()])}),t(q,{onClick:m=>g("train"),children:h("infostand.button.train")}),t(q,{onClick:m=>g("pick_up"),children:h("infostand.button.pickup")}),e.petType===Gt.HORSE&&t(q,{onClick:m=>g("buy_saddle"),children:h("infostand.button.buy_saddle")}),[Gt.BEAR,Gt.TERRIER,Gt.CAT,Gt.DOG,Gt.PIG].indexOf(e.petType)>-1&&t(q,{onClick:m=>g("breed"),children:h("infostand.button.breed")})]}),r===jd&&l(B,{children:[t(q,{onClick:m=>g("mount"),children:h("infostand.button.mount")}),l(q,{onClick:m=>g("toggle_riding_permission"),gap:1,children:[t("input",{type:"checkbox",checked:!!e.publiclyRideable,readOnly:!0}),h("infostand.button.toggle_riding_permission")]}),c>0&&t(q,{onClick:m=>g("respect"),children:h("infostand.button.petrespect",["count"],[c.toString()])}),t(q,{onClick:m=>g("train"),children:h("infostand.button.train")}),t(q,{onClick:m=>g("pick_up"),children:h("infostand.button.pickup")}),t(q,{onClick:m=>g("saddle_off"),children:h("infostand.button.saddleoff")})]}),r===qd&&l(B,{children:[t(q,{onClick:m=>g("dismount"),children:h("infostand.button.dismount")}),c>0&&t(q,{onClick:m=>g("respect"),children:h("infostand.button.petrespect",["count"],[c.toString()])})]}),r===zd&&l(B,{children:[t(q,{onClick:m=>g("pick_up"),children:h("infostand.button.pickup")}),e.dead&&t(q,{onClick:m=>g("revive"),children:h("infostand.button.revive")}),a.isRoomOwner&&t(q,{onClick:m=>g("compost"),children:h("infostand.button.compost")}),!e.dead&&e.energy/e.maximumEnergy<.98&&t(q,{onClick:m=>g("treat"),children:h("infostand.button.pettreat")}),!e.dead&&e.level===e.maximumLevel&&e.breedable&&l(B,{children:[l(q,{onClick:m=>g("toggle_breeding_permission"),gap:1,children:[t("input",{type:"checkbox",checked:e.publiclyBreedable,readOnly:!0}),h("infostand.button.toggle_breeding_permission")]}),t(q,{onClick:m=>g("breed"),children:h("infostand.button.breed")})]})]}),d&&t(q,{onClick:m=>g("pass_hand_item"),children:h("infostand.button.pass_hand_item")})]})},Vl=0,Yd=1,$d=2,Kd=3,tk=i=>{const{avatarInfo:e=null,onClose:n=null}=i,[r,s]=o.useState(Vl),{roomSession:a=null}=Le(),{petRespectRemaining:c=0,respectPet:u=null}=Wr(),d=o.useMemo(()=>a.isRoomOwner||a.controllerLevel>=nt.GUEST||W().isModerator,[a]),g=o.useMemo(()=>{let f=!1;const p=As();if(p){const _=p.model.getValue(ee.FIGURE_CARRY_OBJECT);_>0&&_<999999&&(f=!0)}return f},[]),m=f=>{let p=!0;if(f)switch(f){case"respect":u(e.id),c-1>=1&&(p=!1);break;case"treat":L(new vc(e.id));break;case"pass_handitem":L(new Vm(e.id));break;case"pick_up":a.pickupPet(e.id);break;case"mount":a.mountPet(e.id);break;case"dismount":a.dismountPet(e.id);break}p&&n()};return o.useEffect(()=>{s(f=>e.petType===Gt.MONSTERPLANT?Kd:e.saddle&&!e.rider?Yd:e.rider?$d:Vl)},[e]),l(wr,{objectId:e.roomIndex,category:J.UNIT,userType:pt.PET,onClose:n,collapsable:!0,children:[t(rn,{children:e.name}),r===Vl&&c>0&&t(q,{onClick:f=>m("respect"),children:h("infostand.button.petrespect",["count"],[c.toString()])}),r===Yd&&l(B,{children:[!!e.publiclyRideable&&t(q,{onClick:f=>m("mount"),children:h("infostand.button.mount")}),c>0&&t(q,{onClick:f=>m("respect"),children:h("infostand.button.petrespect",["count"],[c.toString()])})]}),r===$d&&l(B,{children:[t(q,{onClick:f=>m("dismount"),children:h("infostand.button.dismount")}),c>0&&t(q,{onClick:f=>m("respect"),children:h("infostand.button.petrespect",["count"],[c.toString()])})]}),r===Kd&&!e.dead&&e.energy/e.maximumEnergy<.98&&t(q,{onClick:f=>m("treat"),children:h("infostand.button.pettreat")}),d&&t(q,{onClick:f=>m("pick_up"),children:h("infostand.button.pickup")}),g&&t(q,{onClick:f=>m("pass_hand_item"),children:h("infostand.button.pass_hand_item")})]})},Bl=0,Xd=1,Qd=2,nk=i=>{const{avatarInfo:e=null,onClose:n=null}=i,[r,s]=o.useState(Bl),[a,c]=o.useState(""),[u,d]=o.useState("");x(vb,p=>{const _=p.getParser();if(_.botId===e.webID)switch(_.commandId){case qe.CHANGE_BOT_NAME:c(_.data),s(Xd);return;case qe.CHANGE_BOT_MOTTO:d(_.data),s(Qd);return;case qe.SETUP_CHAT:{const E=_.data,C=E.split(E.indexOf(";#;")===-1?";":";#;");(C.length===3||C.length===4)&&(yt(new co(e.roomIndex,J.UNIT,e.webID,C[0],C[1].toLowerCase()==="true"||C[1]==="1",parseInt(C[2]),C[3]?C[3].toLowerCase()==="true"||C[3]==="1":!1)),n());return}}});const g=p=>L(new wb(e.webID,p)),m=p=>{let _=!0;if(p)switch(p){case"donate_to_all":g(qe.DONATE_TO_ALL),L(new yr(e.webID,qe.DONATE_TO_ALL,""));break;case"donate_to_user":g(qe.DONATE_TO_USER),L(new yr(e.webID,qe.DONATE_TO_USER,""));break;case"change_bot_name":g(qe.CHANGE_BOT_NAME),_=!1;break;case"save_bot_name":L(new yr(e.webID,qe.CHANGE_BOT_NAME,a));break;case"change_bot_motto":g(qe.CHANGE_BOT_MOTTO),_=!1;break;case"save_bot_motto":L(new yr(e.webID,qe.CHANGE_BOT_MOTTO,u));break;case"dress_up":L(new yr(e.webID,qe.DRESS_UP,""));break;case"random_walk":L(new yr(e.webID,qe.RANDOM_WALK,""));break;case"setup_chat":g(qe.SETUP_CHAT),_=!1;break;case"dance":L(new yr(e.webID,qe.DANCE,""));break;case"nux_take_tour":_e().createLinkEvent("help/tour"),L(new yr(e.webID,qe.NUX_TAKE_TOUR,""));break;case"pick":L(new xm(e.webID));break}_&&n()};o.useEffect(()=>{s(Bl)},[e]);const f=e.amIOwner||e.amIAnyRoomController;return l(wr,{objectId:e.roomIndex,category:J.UNIT,userType:pt.RENTABLE_BOT,onClose:n,collapsable:!0,children:[t(rn,{children:e.name}),r===Bl&&f&&l(B,{children:[e.botSkills.indexOf(qe.DONATE_TO_ALL)>=0&&t(q,{onClick:p=>m("donate_to_all"),children:h("avatar.widget.donate_to_all")}),e.botSkills.indexOf(qe.DONATE_TO_USER)>=0&&t(q,{onClick:p=>m("donate_to_user"),children:h("avatar.widget.donate_to_user")}),e.botSkills.indexOf(qe.CHANGE_BOT_NAME)>=0&&t(q,{onClick:p=>m("change_bot_name"),children:h("avatar.widget.change_bot_name")}),e.botSkills.indexOf(qe.CHANGE_BOT_MOTTO)>=0&&t(q,{onClick:p=>m("change_bot_motto"),children:h("avatar.widget.change_bot_motto")}),e.botSkills.indexOf(qe.DRESS_UP)>=0&&t(q,{onClick:p=>m("dress_up"),children:h("avatar.widget.dress_up")}),e.botSkills.indexOf(qe.RANDOM_WALK)>=0&&t(q,{onClick:p=>m("random_walk"),children:h("avatar.widget.random_walk")}),e.botSkills.indexOf(qe.SETUP_CHAT)>=0&&t(q,{onClick:p=>m("setup_chat"),children:h("avatar.widget.setup_chat")}),e.botSkills.indexOf(qe.DANCE)>=0&&t(q,{onClick:p=>m("dance"),children:h("avatar.widget.dance")}),e.botSkills.indexOf(qe.NO_PICK_UP)===-1&&t(q,{onClick:p=>m("pick"),children:h("avatar.widget.pick_up")})]}),r===Xd&&l(T,{className:"menu-item",onClick:null,gap:1,children:[t(N,{variant:"white",children:h("bot.skill.name.configuration.new.name")}),t("input",{type:"text",className:"form-control form-control-sm",value:a,maxLength:K("bot.name.max.length",15),onChange:p=>c(p.target.value)}),l(w,{alignItems:"center",justifyContent:"between",gap:1,children:[t(M,{fullWidth:!0,variant:"secondary",onClick:p=>m(null),children:h("cancel")}),t(M,{fullWidth:!0,variant:"success",onClick:p=>m("save_bot_name"),children:h("save")})]})]}),r===Qd&&l(T,{className:"menu-item",onClick:null,gap:1,children:[t(N,{variant:"white",children:h("bot.skill.name.configuration.new.motto")}),t("input",{type:"text",className:"form-control form-control-sm",value:u,maxLength:K("motto.max.length",38),onChange:p=>d(p.target.value)}),l(w,{alignItems:"center",justifyContent:"between",gap:1,children:[t(M,{fullWidth:!0,variant:"secondary",onClick:p=>m(null),children:h("cancel")}),t(M,{fullWidth:!0,variant:"success",onClick:p=>m("save_bot_motto"),children:h("save")})]})]})]})},rk=i=>{const[e,n]=o.useState(!1),[r,s]=o.useState(!1),[a,c]=o.useState(null),{avatarInfo:u=null,setAvatarInfo:d=null,activeNameBubble:g=null,setActiveNameBubble:m=null,nameBubbles:f=[],removeNameBubble:p=null,productBubbles:_=[],confirmingProduct:E=null,updateConfirmingProduct:C=null,removeProductBubble:I=null,isDecorating:b=!1,setIsDecorating:S=null}=gv(),{roomSession:v=null}=Le();Ne(yn.NORMAL_MODE,O=>{e&&n(!1)}),Ne(yn.GAME_MODE,O=>{e||n(!0)}),je(Rb.RSDE_DANCE,O=>{O.roomIndex===v.ownRoomIndex&&s(O.danceId!==0)}),Qe(co.UPDATE_CHAT,O=>c(O));const y=()=>{if(!v||e)return null;if(g)return t(Bd,{nameInfo:g,onClose:()=>m(null)});if(u)switch(u.type){case vs.FURNI:{const O=u;return b?t(Jy,{avatarInfo:O,onClose:()=>d(null)}):null}case vt.OWN_USER:case vt.PEER:{const O=u;return K("user.tags.enabled")&&W().getUserTags(O.roomIndex),O.isSpectatorMode?null:O.isOwnUser?Yl.isRunning()?null:t(Zy,{avatarInfo:O,isDancing:r,setIsDecorating:S,onClose:()=>d(null)}):t(Xy,{avatarInfo:O,onClose:()=>d(null)})}case ws.PET_INFO:{const O=u;return O.isOwner?t(ek,{avatarInfo:O,onClose:()=>d(null)}):t(tk,{avatarInfo:O,onClose:()=>d(null)})}case Rs.RENTABLE_BOT:return t(nk,{avatarInfo:u,onClose:()=>d(null)})}return null},R=()=>{if(!u)return null;switch(u.type){case vs.FURNI:return t(Wy,{avatarInfo:u,onClose:()=>d(null)});case vt.OWN_USER:case vt.PEER:return t(Ky,{avatarInfo:u,setAvatarInfo:d,onClose:()=>d(null)});case vt.BOT:return t(Hy,{avatarInfo:u,onClose:()=>d(null)});case Rs.RENTABLE_BOT:return t(qy,{avatarInfo:u,onClose:()=>d(null)});case ws.PET_INFO:return t(jy,{avatarInfo:u,onClose:()=>d(null)})}};return l(B,{children:[b&&t(Qy,{userId:W().userId,userName:W().userName,roomIndex:v.ownRoomIndex,setIsDecorating:S}),y(),u&&t(T,{alignItems:"end",className:"nitro-infostand-container",children:R()}),f.length>0&&f.map((O,F)=>t(Bd,{nameInfo:O,onClose:()=>p(F)},F)),_.length>0&&_.map((O,F)=>t(By,{item:O,updateConfirmingProduct:C,onClose:()=>I(F)},O.id)),a&&t(My,{chatEvent:a,onClose:()=>c(null)}),E&&t(Uy,{item:E,onClose:()=>C(null)}),t(Ly,{})]})},sk=i=>{const{addChatEmoji:e=null}=i,[n,r]=o.useState(!1),s=o.useRef(null),a=o.useRef(null),c=g=>{e(g.native),r(!1)},u=g=>{const m="emoji-icon";a.current&&!a.current.contains(g.target)&&!g.target.classList.contains(m)&&(r(!1),document.removeEventListener("mousedown",u))},d=g=>{r(m=>!m)};return o.useEffect(()=>{n&&document.addEventListener("mousedown",u)},[a,n]),l(B,{children:[t(P,{pointer:!0,onClick:d,innerRef:s,className:"emoji-icon",children:""}),t(_c,{show:n,target:s,placement:"top-end",children:t(Ua,{children:t(_g,{data:bg,onEmojiSelect:c,theme:"light",perLine:7,emojiSize:19})})})]})},ak=i=>{const{chatStyleId:e=0,chatStyleIds:n=null,selectChatStyleId:r=null}=i,[s,a]=o.useState(null),[c,u]=o.useState(!1),d=m=>{r(m),u(!1)},g=m=>{let f=!1;u(p=>(f=!p,f)),f&&a(m.target)};return o.useEffect(()=>{c||a(null)},[c]),l(B,{children:[t(P,{pointer:!0,className:"icon chatstyles-icon",onClick:g}),t(_c,{show:c,target:s,placement:"top",children:t(Ua,{className:"nitro-chat-style-selector-container image-rendering-pixelated",children:t(re,{overflow:"hidden",className:"bg-transparent",children:t(ne,{columnCount:3,overflow:"auto",children:n&&n.length>0&&n.map(m=>t(w,{center:!0,pointer:!0,className:"bubble-parent-container",onClick:f=>d(m),children:t(P,{className:"bubble-container",children:t(P,{className:`chat-bubble bubble-${m}`,children:""})},m)},m))})})})})]})},ik=i=>{const[e,n]=o.useState(""),{chatStyleId:r=0,updateChatStyleId:s=null}=Wr(),{selectedUsername:a="",floodBlocked:c=!1,floodBlockedSeconds:u=0,setIsTyping:d=null,setIsIdle:g=null,sendChat:m=null}=pv(),{roomSession:f=null}=Le(),p=o.useRef(),_=o.useMemo(()=>h("widgets.chatinput.mode.whisper"),[]),E=o.useMemo(()=>h("widgets.chatinput.mode.shout"),[]),C=o.useMemo(()=>h("widgets.chatinput.mode.speak"),[]),I=o.useMemo(()=>K("chat.input.maxlength",100),[]),b=o.useCallback(()=>{const A=document.activeElement;return!(!A||p&&p.current===A||!(A instanceof HTMLInputElement)&&!(A instanceof HTMLTextAreaElement))},[p]),S=o.useCallback(()=>{p.current.focus(),p.current.setSelectionRange(p.current.value.length*2,p.current.value.length*2)},[p]),v=o.useCallback(()=>{n(A=>A!==_||!a.length?A:`${A} ${a}`)},[a,_]),y=o.useCallback((A,k=!1)=>{if(!A||A==="")return;let D=k?pr.CHAT_SHOUT:pr.CHAT_DEFAULT,V=A;const G=V.split(" ");let $="",X="";switch(G[0]){case _:D=pr.CHAT_WHISPER,$=G[1],X=_+" "+$+" ",G.shift(),G.shift();break;case E:D=pr.CHAT_SHOUT,G.shift();break;case C:D=pr.CHAT_DEFAULT,G.shift();break}V=G.join(" "),d(!1),g(!1),V.length<=I&&(/%CC%/g.test(encodeURIComponent(V))?n(""):(n(""),m(V,D,$,r))),n(X)},[_,E,C,I,r,d,g,m]),R=o.useCallback(A=>{!A||!A.length?d(!1):(d(!0),g(!0)),n(A)},[d,g]),O=o.useCallback(A=>{if(c||!p.current||b())return;document.activeElement!==p.current&&S();const k=A.target.value;switch(A.key){case" ":case"Space":v();return;case"NumpadEnter":case"Enter":y(k,A.shiftKey);return;case"Backspace":if(k){const D=k.split(" ");D[0]===_&&D.length===3&&D[2]===""&&n("")}return}},[c,p,_,b,S,v,y]);Qe(Ns.CHAT_INPUT_CONTENT,A=>{switch(A.chatMode){case Ns.WHISPER:{n(`${_} ${A.userName} `);return}case Ns.SHOUT:return}});const F=o.useMemo(()=>{let A=[];const k=K("chat.styles");for(const D of k)if(D){if(D.minRank>0){W().hasSecurity(D.minRank)&&A.push(D.styleId);continue}if(D.isSystemStyle&&W().hasSecurity(nt.MODERATOR)){A.push(D.styleId);continue}if(!(K("chat.styles.disabled").indexOf(D.styleId)>=0)){if(D.isHcOnly&&kn()>=bn.CLUB){A.push(D.styleId);continue}if(D.isAmbassadorOnly&&W().isAmbassador){A.push(D.styleId);continue}!D.isHcOnly&&!D.isAmbassadorOnly&&A.push(D.styleId)}}return A},[]),U=o.useCallback(A=>{n(k=>k+A),d(!0)},[d]);return o.useEffect(()=>(document.body.addEventListener("keydown",O),()=>{document.body.removeEventListener("keydown",O)}),[O]),!f||f.isSpectator?null:Ic.createPortal(l("div",{className:"nitro-chat-input-container",children:[l("div",{className:"input-sizer align-items-center",children:[!c&&t("input",{ref:p,type:"text",className:"chat-input",placeholder:h("widgets.chatinput.default"),value:e,maxLength:I,onChange:A=>R(A.target.value),onMouseDown:A=>S()}),c&&l(N,{variant:"danger",children:[h("chat.input.alert.flood",["time"],[u.toString()])," "]})]}),t(sk,{addChatEmoji:U}),t(ak,{chatStyleId:r,chatStyleIds:F,selectChatStyleId:s})]}),document.getElementById("chat-input-container"))},ok=()=>{let i=null;self.onmessage=e=>{if(!e)return;const n=e.data;switch(n.action){case"START":i=setInterval(()=>postMessage(null),n.content);break;case"STOP":i&&(clearInterval(i),i=null);break}}};class lk extends Worker{constructor(e){const n=e.toString(),r=new Blob([`(${n})()`]);super(URL.createObjectURL(r))}}const ck=i=>{const{chat:e=null,makeRoom:n=null,bubbleWidth:r=Nt.CHAT_BUBBLE_WIDTH_NORMAL}=i,[s,a]=o.useState(!1),[c,u]=o.useState(!1),d=o.useRef(),g=o.useMemo(()=>{switch(r){case Nt.CHAT_BUBBLE_WIDTH_NORMAL:return 350;case Nt.CHAT_BUBBLE_WIDTH_THIN:return 240;case Nt.CHAT_BUBBLE_WIDTH_WIDE:return 2e3}},[r]);return o.useEffect(()=>{a(!1);const m=d.current;if(!m)return;const f=m.offsetWidth,p=m.offsetHeight;e.width=f,e.height=p,e.elementRef=m;let _=e.left,E=e.top;return!_&&!E&&(_=e.location.x-f/2,E=m.parentElement.offsetHeight-p,e.left=_,e.top=E),u(!0),()=>{e.elementRef=null,u(!1)}},[e]),o.useEffect(()=>{!c||!e||s||(n&&n(e),a(!0))},[e,c,s,n]),l("div",{ref:d,className:`bubble-container ${s?"visible":"invisible"}`,onClick:m=>j().selectRoomObject(e.roomId,e.senderId,J.UNIT),children:[e.styleId===0&&t("div",{className:"user-container-bg",style:{backgroundColor:e.color}}),l("div",{className:`chat-bubble bubble-${e.styleId} type-${e.type}`,style:{maxWidth:g},children:[t("div",{className:"user-container",children:e.imageUrl&&e.imageUrl.length>0&&t("div",{className:"user-image",style:{backgroundImage:`url(${e.imageUrl})`}})}),l("div",{className:"chat-content",children:[t("b",{className:"username mr-1",dangerouslySetInnerHTML:{__html:`${e.username}: `}}),t("span",{className:"message",dangerouslySetInnerHTML:{__html:`${e.formattedText}`}})]}),t("div",{className:"pointer"})]})]})},uk=i=>{const{chatMessages:e=[],setChatMessages:n=null,chatSettings:r=null,getScrollSpeed:s=6e3}=Ev(),a=o.useRef(),c=o.useCallback(()=>{n(g=>{if(g){const m=g.filter(f=>f.top>-f.height*2);if(m.length!==g.length)return m}return g})},[n]),u=o.useCallback((g,m,f)=>{for(let p=e.indexOf(g)-1;p>=0;p--){const _=e[p];if(!(!_||g===_||f.indexOf(_)>=0||_.top+_.height-m>g.top+g.height)&&nN(g,_,-m,0)){const E=Math.abs(_.top+_.height-g.top);f.push(_),_.top-=E,_.skipMovement=!0,u(_,E,f)}}},[e]),d=o.useCallback(g=>{if(r.mode===Nt.CHAT_MODE_FREE_FLOW)g.skipMovement=!0,u(g,0,[g]),c();else{const m=g.top+g.height,f=g.height,p=a.current.offsetHeight-m,_=f-p;p<f&&(n(E=>(E.forEach(C=>{C!==g&&(C.top-=_)}),E)),c())}},[r,u,c,n]);return o.useEffect(()=>{const g=(m=null)=>{if(!a||!a.current)return;const f=a.current.offsetHeight,p=Math.round(document.body.offsetHeight*K("chat.viewer.height.percentage"));a.current.style.height=`${p}px`,n(_=>(_&&_.forEach(E=>E.top-=f-p),_))};return window.addEventListener("resize",g),g(),()=>{window.removeEventListener("resize",g)}},[n]),o.useEffect(()=>{const g=f=>{n(p=>(p.forEach(_=>{if(_.skipMovement){_.skipMovement=!1;return}_.top-=f}),p)),c()},m=new lk(ok);return m.onmessage=()=>g(15),m.postMessage({action:"START",content:s}),()=>{m.postMessage({action:"STOP"})}},[s,c,n]),t("div",{ref:a,className:"nitro-chat-widget",children:e.map(g=>t(ck,{chat:g,makeRoom:d,bubbleWidth:r.weight},g.id))})},zh=i=>{const{title:e=null,items:n=[],selectItem:r=null,onClose:s=null}=i,[a,c]=o.useState(null),[u,d]=o.useState(""),g=W().isModerator,m=o.useMemo(()=>{const f=u.toLocaleLowerCase();return n.filter(p=>{var _;return(_=p.name)==null?void 0:_.toLocaleLowerCase().includes(f)})},[n,u]);return o.useEffect(()=>{a&&r(a)},[a,r]),l(ie,{className:"nitro-chooser-widget",theme:"primary-slim",children:[t(ae,{headerText:e,onCloseClick:s}),l(re,{overflow:"hidden",gap:2,children:[t("input",{type:"text",className:"form-control form-control-sm",placeholder:h("generic.search"),value:u,onChange:f=>d(f.target.value)}),t(Qo,{rows:m,rowRender:f=>t(w,{alignItems:"center",className:zt("rounded p-1",a===f&&"bg-muted"),pointer:!0,onClick:p=>c(f),children:l(N,{truncate:!0,children:[f.name," ",g&&" - "+f.id]})})})]})]})},dk=i=>{const{items:e=null,onClose:n=null,selectItem:r=null,populateChooser:s=null}=wv();return o.useEffect(()=>{const a={linkReceived:c=>{c.split("/"),s()},eventUrlPrefix:"furni-chooser/"};return It(a),()=>Et(a)},[s]),e?t(zh,{title:h("widget.chooser.furni.title"),items:e,selectItem:r,onClose:n}):null},mk=i=>{const{items:e=null,onClose:n=null,selectItem:r=null,populateChooser:s=null}=Dv();return o.useEffect(()=>{const a={linkReceived:c=>{c.split("/"),s()},eventUrlPrefix:"user-chooser/"};return It(a),()=>Et(a)},[s]),e?t(zh,{title:h("widget.chooser.user.title"),items:e,selectItem:r,onClose:n}):null},hk=i=>{const[e,n]=o.useState(!1),{users:r=[],answer:s=null}=_v();return o.useEffect(()=>{n(!!r.length)},[r]),e?l(ie,{className:"nitro-widget-doorbell",theme:"primary-slim",children:[t(ae,{headerText:h("navigator.doorbell.title"),onCloseClick:a=>n(!1)}),l(re,{overflow:"hidden",gap:0,children:[t(T,{gap:2,children:l(ne,{gap:1,className:"text-black fw-bold border-bottom px-1 pb-1",children:[t(P,{className:"g-col-6",children:h("generic.username")}),t(P,{className:"g-col-6"})]})}),t(T,{overflow:"auto",className:"striped-children",gap:0,children:r&&r.length>0&&r.map(a=>l(ne,{gap:1,alignItems:"center",className:"text-black border-bottom p-1",children:[t(P,{className:"g-col-6",children:a}),t(P,{className:"g-col-6",children:l(w,{alignItems:"center",justifyContent:"end",gap:1,children:[t(M,{variant:"success",onClick:()=>s(a,!0),children:h("generic.accept")}),t(M,{variant:"danger",onClick:()=>s(a,!1),children:h("generic.deny")})]})})]},a))})]})]}):null},Yc=i=>{const{objectId:e=-1,category:n=-1,noFollow:r=!1,position:s="absolute",...a}=i,[c,u]=o.useState({x:-1,y:-1}),d=o.useRef();return o.useEffect(()=>{let g=!1;const m=()=>{const p=Re();return Rc(p.roomId,e,n,1)},f=()=>{const p=m();!p||!d.current||u({x:Math.round(p.left+p.width/2-d.current.offsetWidth/2),y:Math.round(p.top-d.current.offsetHeight+10)})};return r?f():(g=!0,Vr().add(f)),()=>{g&&Vr().remove(f)}},[e,n,r]),t(P,{innerRef:d,position:s,visible:c.x+(d.current?d.current.offsetWidth:0)>-1,className:"object-location",style:{left:c.x,top:c.y},...a})},gk=i=>{const{roomIndex:e=-1,request:n=null,hideFriendRequest:r=null,requestResponse:s=null}=i;return t(Yc,{objectId:e,category:J.UNIT,children:t(P,{className:"nitro-friend-request-dialog nitro-context-menu p-2",children:l(T,{children:[l(w,{alignItems:"center",justifyContent:"between",gap:2,children:[t(N,{variant:"white",fontSize:6,children:h("widget.friendrequest.from",["username"],[n.name])}),t(Dn,{className:"cursor-pointer fa-icon",onClick:a=>r(n.requesterUserId)})]}),l(w,{justifyContent:"end",gap:1,children:[t(M,{variant:"danger",onClick:a=>s(n.requesterUserId,!1),children:h("widget.friendrequest.decline")}),t(M,{variant:"success",onClick:a=>s(n.requesterUserId,!0),children:h("widget.friendrequest.accept")})]})]})})})},fk=i=>{const{displayedRequests:e=[],hideFriendRequest:n=null}=Tv(),{requestResponse:r=null}=Nn();return e.length?t(B,{children:e.map((s,a)=>t(gk,{roomIndex:s.roomIndex,request:s.request,hideFriendRequest:n,requestResponse:r},a))}):null},pk=i=>{const{productType:e=fe.FLOOR,classId:n=-1,extraParam:r=void 0}=i;switch(e){case fe.WALL:case fe.FLOOR:return t(Lc,{productType:e,productClassId:n});case fe.BADGE:return t(We,{badgeCode:r});case fe.HABBO_CLUB:return t(dt,{type:"hc"})}return null},Ik=i=>{const{ownerId:e=-1}=i,[n,r]=o.useState(0),[s,a]=o.useState(void 0),c=()=>{n===1&&L(new Ab(e)),r(0),a(void 0)};x(Ob,d=>{r(1)}),x(yb,d=>{r(0),a(void 0)}),x(kb,d=>{const g=d.getParser();a({contentType:g.contentType,classId:g.classId}),r(2)});const u=W().userId===e;return n===0?null:l(ie,{className:"nitro-mysterybox-dialog",theme:"primary-slim",children:[t(ae,{headerText:h(n===1?`mysterybox.dialog.${u?"owner":"other"}.title`:"mysterybox.reward.title"),onCloseClick:c}),l(re,{children:[n===1&&l(B,{children:[l(N,{variant:"primary",children:[" ",h(`mysterybox.dialog.${u?"owner":"other"}.subtitle`)," "]}),l(N,{children:[" ",h(`mysterybox.dialog.${u?"owner":"other"}.description`)," "]}),l(N,{children:[" ",h(`mysterybox.dialog.${u?"owner":"other"}.waiting`)]}),l(M,{variant:"danger",onClick:c,className:"mt-auto",children:[" ",h(`mysterybox.dialog.${u?"owner":"other"}.cancel`)," "]})]}),n===2&&s&&l(B,{children:[l(N,{variant:"black",children:[" ",h("mysterybox.reward.text")," "]}),t(w,{className:"prize-container justify-content-center mx-auto",children:t(pk,{classId:s.classId,productType:s.contentType})}),l(M,{variant:"success",onClick:c,className:"mt-auto",children:[" ",h("mysterybox.reward.close")," "]})]})]})]})},Ek=i=>{const{objectId:e=-1,onClose:n=null}=i,[r,s]=o.useState(""),a=()=>{L(new Db(e,r)),n()};return e===-1?null:l(ie,{className:"nitro-mysterytrophy-dialog no-resize",theme:"primary-slim",children:[t(ae,{center:!0,headerText:h("mysterytrophy.header.title"),onCloseClick:n}),l(re,{children:[l(w,{className:"mysterytrophy-dialog-top p-3",children:[t("div",{className:"mysterytrophy-image flex-shrink-0"}),t("div",{className:"m-2",children:t(N,{variant:"white",className:"mysterytrophy-text-big",children:h("mysterytrophy.header.description")})})]}),t(w,{className:"mysterytrophy-dialog-bottom p-2",children:l(T,{gap:1,children:[l(w,{alignItems:"center",className:"bg-white rounded py-1 px-2 input-mysterytrophy-dialog",children:[t("textarea",{className:"form-control form-control-sm input-mysterytrophy",value:r,onChange:c=>s(c.target.value)}),t("div",{className:"mysterytrophy-pencil-image flex-shrink-0 small fa-icon"})]}),l(w,{className:"mt-2",gap:5,display:"flex",justifyContent:"center",alignItems:"center",children:[t(N,{pointer:!0,className:"text-decoration",onClick:()=>n(),children:h("cancel")}),t(M,{variant:"success",onClick:()=>a(),children:h("generic.ok")})]})]})})]})]})},Ck=i=>{const{objectId:e=-1,onClose:n=null}=i,{roomSession:r=null}=Le(),s=()=>{r.useMultistateItem(e),n()};return l(ie,{className:"nitro-use-product-confirmation",children:[t(ae,{headerText:h("effectbox.header.title"),onCloseClick:n}),t(re,{center:!0,children:t(w,{gap:2,children:l(T,{justifyContent:"between",children:[t(N,{children:h("effectbox.header.description")}),l(w,{alignItems:"center",justifyContent:"between",children:[t(M,{variant:"danger",onClick:n,children:h("generic.cancel")}),t(M,{variant:"success",onClick:s,children:h("generic.ok")})]})]})})})]})},ji=-1,_k=0,bk=i=>{const{objectId:e=-1,onClose:n=null}=i,[r,s]=o.useState(null),[a,c]=o.useState(ji),{roomSession:u=null}=Le(),d=()=>{u.useMultistateItem(e),n()};return o.useEffect(()=>{if(!u||e===-1)return;const g=jo(u.roomId,e,J.FLOOR);if(!g)return;s(g);let m=ji;switch(g.specialType){case me.MONSTERPLANT_SEED:m=_k;break}if(m===ji){n();return}c(m)},[u,e,n]),a===ji?null:l(ie,{className:"nitro-use-product-confirmation",children:[t(ae,{headerText:h("useproduct.widget.title.plant_seed",["name"],[r.name]),onCloseClick:n}),t(re,{center:!0,children:l(w,{gap:2,overflow:"hidden",children:[t(T,{children:t(P,{className:"product-preview",children:t(P,{className:"monsterplant-image"})})}),l(T,{justifyContent:"between",overflow:"auto",children:[l(T,{gap:2,children:[t(N,{children:h("useproduct.widget.text.plant_seed",["productName"],[r.name])}),t(N,{children:h("useproduct.widget.info.plant_seed")})]}),l(w,{alignItems:"center",justifyContent:"between",children:[t(M,{variant:"danger",onClick:n,children:h("useproduct.widget.cancel")}),t(M,{variant:"success",onClick:d,children:h("widget.monsterplant_seed.button.use")})]})]})]})})]})},qi=-1,Sk=0,Nk=i=>{const{objectId:e=-1,onClose:n=null}=i,[r,s]=o.useState(qi),[a,c]=o.useState(we.MALE),[u,d]=o.useState(null),{roomSession:g=null}=Le(),m=()=>{Jl().send(new Pb(e)),Jl().send(new wm(a,u)),n()};return o.useEffect(()=>{let f=qi;const p=W().figure,_=W().gender,E=[];if(g&&e>=0){const C=jo(g.roomId,e,J.FLOOR);if(C)switch(C.specialType){case me.FIGURE_PURCHASABLE_SET:f=Sk;const I=C.customParams.split(",").map(b=>parseInt(b));for(const b of I)kt().isValidFigureSetForGender(b,_)&&E.push(b);break}}if(f===qi){n();return}c(_),d(kt().getFigureStringWithFigureIds(p,_,E)),s(f)},[g,e,n]),r===qi?null:l(ie,{className:"nitro-use-product-confirmation",children:[t(ae,{headerText:h("useproduct.widget.title.bind_clothing"),onCloseClick:n}),t(re,{center:!0,children:l(w,{gap:2,overflow:"hidden",children:[t(T,{children:t(P,{className:"mannequin-preview",children:t(it,{figure:u,direction:2})})}),l(T,{justifyContent:"between",overflow:"auto",children:[l(T,{gap:2,children:[t(N,{children:h("useproduct.widget.text.bind_clothing")}),t(N,{children:h("useproduct.widget.info.bind_clothing")})]}),l(w,{alignItems:"center",justifyContent:"between",children:[t(M,{variant:"danger",onClick:n,children:h("useproduct.widget.cancel")}),t(M,{variant:"success",onClick:m,children:h("useproduct.widget.bind_clothing")})]})]})]})})]})},Tk=i=>{const{closeConfirm:e=null,processAction:n=null,onClose:r=null,objectId:s=-1,mode:a=null,confirmMode:c=null,confirmingObjectId:u=-1,groupData:d=null,isGroupMember:g=!1,objectOwnerId:m=-1}=NT(),{simpleAlert:f=null}=ze();x(Lb,_=>{const E=_.getParser();if(E)switch(E.count){case 1:f(h("costumehopper.costumerequired.bodytext"),null,"catalog/open/temporary_effects",h("costumehopper.costumerequired.buy"),h("costumehopper.costumerequired.header"),null);break;case 2:f(h("viphopper.viprequired.bodytext"),null,"catalog/open/habbo_club",h("viprequired.buy.vip"),h("viprequired.header"),null);break;case 3:f(h("gate.viprequired.bodytext"),null,"catalog/open/habbo_club",h("viprequired.buy.vip"),h("gate.viprequired.title"),null);break}});const p=W().userId===m;return l(B,{children:[c===dc&&t(bk,{objectId:u,onClose:e}),c===mc&&t(Nk,{objectId:u,onClose:e}),c===Sh&&t(Ck,{objectId:u,onClose:e}),c===hc&&t(Ek,{objectId:u,onClose:e}),t(Ik,{ownerId:m}),s>=0&&a&&l(wr,{objectId:s,category:J.FLOOR,onClose:r,fades:!0,children:[a===Ft.FRIEND_FURNITURE&&l(B,{children:[t(rn,{children:h("friendfurni.context.title")}),t(q,{onClick:_=>n("use_friend_furni"),children:h("friendfurni.context.use")})]}),a===Ft.MONSTERPLANT_SEED&&l(B,{children:[t(rn,{children:h("furni.mnstr_seed.name")}),t(q,{onClick:_=>n("use_monsterplant_seed"),children:h("widget.monsterplant_seed.button.use")})]}),a===Ft.RANDOM_TELEPORT&&l(B,{children:[t(rn,{children:h("furni.random_teleport.name")}),t(q,{onClick:_=>n("use_random_teleport"),children:h("widget.random_teleport.button.use")})]}),a===Ft.PURCHASABLE_CLOTHING&&l(B,{children:[t(rn,{children:h("furni.generic_usable.name")}),t(q,{onClick:_=>n("use_purchaseable_clothing"),children:h("widget.generic_usable.button.use")})]}),a===Ft.MYSTERY_BOX&&l(B,{children:[t(rn,{children:h("mysterybox.context.title")}),t(q,{onClick:_=>n("use_mystery_box"),children:h("mysterybox.context."+(p?"owner":"other")+".use")})]}),a===Ft.MYSTERY_TROPHY&&l(B,{children:[t(rn,{children:h("mysterytrophy.header.title")}),t(q,{onClick:_=>n("use_mystery_trophy"),children:h("friendfurni.context.use")})]}),a===bh&&d&&l(B,{children:[t(rn,{className:"cursor-pointer text-truncate",onClick:()=>ii(d.guildId),children:d.guildName}),!g&&t(q,{onClick:_=>n("join_group"),children:h("widget.furniture.button.join.group")}),t(q,{onClick:_=>n("go_to_group_homeroom"),children:h("widget.furniture.button.go.to.group.home.room")}),d.guildHasReadableForum&&t(q,{onClick:_=>n("open_forum"),children:h("widget.furniture.button.open_group_forum")})]})]})]})},vk=i=>{const{objectId:e=-1,color:n=0,setColor:r=null,applyToner:s=null,toggleToner:a=null,onClose:c=null}=CT();return e===-1?null:l(ie,{theme:"primary-slim",className:"nitro-room-widget-toner",children:[t(ae,{headerText:h("widget.backgroundcolor.title"),onCloseClick:c}),l(re,{overflow:"hidden",justifyContent:"between",children:[t(T,{overflow:"auto",gap:1,children:t("input",{type:"color",className:"form-control",value:mn.makeColorNumberHex(n),onChange:u=>r(mn.convertFromHex(u.target.value))})}),l(T,{gap:1,children:[t(M,{fullWidth:!0,variant:"primary",onClick:a,children:h("widget.backgroundcolor.button.on")}),t(M,{fullWidth:!0,variant:"primary",onClick:s,children:h("widget.backgroundcolor.button.apply")})]})]})]})},wk=i=>{const{objectId:e=-1,color:n="1",badgeName:r="",badgeDesc:s="",date:a="",senderName:c="",onClose:u=null}=bT();return e===-1?null:t(dh,{color:n,message:s,date:a,senderName:c,customTitle:r,onCloseClick:u})},Rk=i=>{const{objectId:e=-1,recipes:n=[],ingredients:r=[],selectedRecipe:s=null,requiredIngredients:a=null,isCrafting:c=!1,craft:u=null,selectRecipe:d=null,onClose:g=null}=vT(),{roomSession:m=null}=Le(),[f,p]=o.useState(!1),_=o.useMemo(()=>{const I=j().getRoomObject(m.roomId,e,J.FLOOR);return Yt(I)},[e,m.roomId]),E=o.useMemo(()=>{if(!a||!a.length)return!1;for(const I of a){const b=r.find(S=>S.name===I.itemName);if(!b||b.count<I.count)return!1}return!0},[r,a]),C=()=>{if(!f){p(!0);return}u(),p(!1)};return o.useEffect(()=>{p(!1)},[s]),e===-1?null:l(ie,{className:"nitro-widget-crafting",theme:"primary-slim",children:[t(ae,{headerText:h("crafting.title"),onCloseClick:g}),t(re,{children:l(w,{grow:!0,overflow:"hidden",gap:2,children:[l(w,{column:!0,fullWidth:!0,gap:2,children:[l(T,{overflow:"hidden",fullHeight:!0,children:[t("div",{className:"bg-muted rounded py-1 text-center",children:h("crafting.title.products")}),t(De,{columnCount:5,children:n.length>0&&n.map(I=>t(be,{itemImage:I.iconUrl,itemActive:s&&s.name===I.name,onClick:()=>d(I)},I.name))})]}),l(T,{overflow:"hidden",fullHeight:!0,children:[t("div",{className:"bg-muted rounded py-1 text-center",children:h("crafting.title.mixer")}),t(De,{columnCount:5,children:r.length>0&&r.map(I=>t(be,{itemImage:I.iconUrl,itemCount:I.count,itemCountMinimum:0,className:(I.count?"":"opacity-0-5 ")+"cursor-default"},I.name))})]})]}),l(w,{column:!0,fullWidth:!0,gap:2,children:[!s&&t(T,{center:!0,fullHeight:!0,className:"text-black text-center",children:h("crafting.info.start")}),s&&l(B,{children:[l(T,{overflow:"hidden",fullHeight:!0,children:[t("div",{className:"bg-muted rounded py-1 text-center",children:h("crafting.current_recipe")}),t(De,{columnCount:5,children:!!a&&a.length>0&&a.map(I=>{const b=r.find(v=>v.name===I.itemName),S=[];for(let v=0;v<I.count;v++)S.push(t(be,{itemImage:b.iconUrl,className:(b.count-v<=0?"opacity-0-5 ":"")+"cursor-default"},v));return S})})]}),l(w,{gap:2,column:!0,fullHeight:!0,children:[l(w,{gap:2,className:"bg-muted rounded",column:!0,fullHeight:!0,children:[t("div",{className:"py-1 text-center",children:h("crafting.result")}),l(w,{gap:1,center:!0,column:!0,fullHeight:!0,className:"pb-1",children:[t(T,{fullHeight:!0,children:t("img",{src:s.iconUrl})}),t("div",{className:"text-black",children:s.localizedName})]})]}),l(M,{variant:!_||!E?"danger":f?"warning":c?"primary":"success",disabled:!_||!E||c,onClick:C,children:[!c&&h(_?E?f?"generic.confirm":"crafting.btn.craft":"crafting.status.recipe.incomplete":"crafting.btn.notowner"),c&&t(Mc,{})]})]})]})]})]})})]})},Ok=i=>{const[e,n]=o.useState(!1),{presets:r=[],dimmerState:s=0,selectedPresetId:a=0,color:c=16777215,brightness:u=255,effectId:d=0,selectedColor:g=0,setSelectedColor:m=null,selectedBrightness:f=0,setSelectedBrightness:p=null,selectedEffectId:_=0,setSelectedEffectId:E=null,selectPresetId:C=null,applyChanges:I}=RT(),b=()=>{Wn.previewDimmer(c,u,d===2),n(!1)};Ne(ve.REMOVE_DIMMER,v=>n(!1)),o.useEffect(()=>{!r||!r.length||n(!0)},[r]);const S=o.useMemo(()=>K("widget.dimmer.colorwheel",!1),[]);return e?l(ie,{className:"nitro-room-widget-dimmer",children:[t(ae,{headerText:h("widget.dimmer.title"),onCloseClick:b}),s===1&&t(Br,{children:r.map(v=>t(sr,{isActive:a===v.id,onClick:y=>C(v.id),children:h(`widget.dimmer.tab.${v.id}`)},v.id))}),l(re,{children:[s===0&&l(T,{alignItems:"center",children:[t(P,{className:"dimmer-banner"}),t(N,{center:!0,className:"bg-muted rounded p-1",children:h("widget.dimmer.info.off")}),t(M,{fullWidth:!0,variant:"success",onClick:()=>Wn.changeState(),children:h("widget.dimmer.button.on")})]}),s===1&&l(B,{children:[l(T,{gap:1,children:[t(N,{fontWeight:"bold",children:h("widget.backgroundcolor.hue")}),S&&t("input",{type:"color",className:"form-control",value:mn.makeColorNumberHex(g),onChange:v=>m(mn.convertFromHex(v.target.value))}),!S&&t(ne,{gap:1,columnCount:7,children:Wn.AVAILABLE_COLORS.map((v,y)=>t(T,{fullWidth:!0,pointer:!0,className:zt("color-swatch rounded",v===g&&"active"),onClick:()=>m(v),style:{backgroundColor:Wn.HTML_COLORS[y]}},y))})]}),l(T,{gap:1,children:[t(N,{fontWeight:"bold",children:h("widget.backgroundcolor.lightness")}),t(Mt,{className:"nitro-slider",min:Wn.MIN_BRIGHTNESS,max:Wn.MAX_BRIGHTNESS,value:f,onChange:v=>p(v),thumbClassName:"thumb percent",renderThumb:(v,y)=>t("div",{...v,children:Wn.scaleBrightness(y.valueNow)})})]}),l(w,{alignItems:"center",gap:1,children:[t("input",{className:"form-check-input",type:"checkbox",checked:_===2,onChange:v=>E(v.target.checked?2:1)}),t(N,{children:h("widget.dimmer.type.checkbox")})]}),l(w,{gap:1,children:[t(M,{fullWidth:!0,variant:"danger",onClick:()=>Wn.changeState(),children:h("widget.dimmer.button.off")}),t(M,{fullWidth:!0,variant:"success",onClick:I,children:h("widget.dimmer.button.apply")})]})]})]})]}):null},yk=i=>{const{objectId:e=-1,value:n=0,onClose:r=null,redeem:s=null}=yT();return e===-1?null:l(ie,{className:"nitro-widget-exchange-credit",theme:"primary-slim",children:[t(ae,{headerText:h("catalog.redeem.dialog.title"),onCloseClick:r}),t(re,{center:!0,children:l(w,{overflow:"hidden",gap:2,children:[t(T,{center:!0,children:t(P,{className:"exchange-image"})}),l(T,{grow:!0,justifyContent:"between",overflow:"hidden",children:[l(T,{gap:1,overflow:"auto",children:[t(N,{fontWeight:"bold",children:h("creditfurni.description",["credits"],[n.toString()])}),t(N,{children:h("creditfurni.prompt")})]}),t(M,{variant:"success",onClick:s,children:h("catalog.redeem.dialog.button.exchange")})]})]})})]})},kk=i=>{const{currentIndex:e=-1,currentPhotos:n=null}=i,[r,s]=o.useState(0),a=n&&n.length?n[r]:null,c=()=>{s(d=>{let g=d+1;return g>=n.length&&(g=0),g})},u=()=>{s(d=>{let g=d-1;return g<0&&(g=n.length-1),g})};return o.useEffect(()=>{s(e)},[e]),a?l(ne,{style:{display:"flex",flexDirection:"column"},children:[t(w,{center:!0,className:"picture-preview border border-black",style:a.w?{backgroundImage:"url("+a.w+")"}:{},children:!a.w&&t(N,{bold:!0,children:h("camera.loading")})}),a.m&&a.m.length&&t(N,{center:!0,children:a.m}),l(w,{alignItems:"center",justifyContent:"between",children:[t(N,{children:a.n||""}),t(N,{children:new Date(a.t*1e3).toLocaleDateString()})]}),n.length>1&&l(w,{className:"picture-preview-buttons",children:[t(nm,{className:"cursor-pointer picture-preview-buttons-previous fa-icon",onClick:u}),t(N,{underline:!0,className:"cursor-pointer",onClick:d=>hn(a.oi),children:a.o}),t(rm,{className:"cursor-pointer picture-preview-buttons-next fa-icon",onClick:c})]})]}):null},Ak=i=>{const{objectId:e=-1,currentPhotoIndex:n=-1,currentPhotos:r=null,onClose:s=null}=AT(),{report:a=null}=zn();return e===-1||n===-1?null:l(ie,{className:"nitro-external-image-widget",theme:"primary-slim",children:[t(ae,{headerText:"",isGalleryPhoto:!0,onReportPhoto:()=>a(st.PHOTO,{extraData:r[n].w,roomId:r[n].s,reportedUserId:W().userId,roomObjectId:Number(r[n].u)}),onCloseClick:s}),t(re,{children:t(kk,{currentIndex:n,currentPhotos:r})})]})},Dk=i=>{const{objectId:e=-1,type:n=0,stage:r=0,usernames:s=[],figures:a=[],date:c=null,onClose:u=null,respond:d=null}=PT();if(e===-1)return null;if(r>0)return l(ie,{className:"nitro-engraving-lock",theme:"primary-slim",children:[t(ae,{headerText:h("friend.furniture.confirm.lock.caption"),onCloseClick:u}),l(re,{children:[t("h5",{className:"text-black text-center fw-bold mt-2 mb-2",children:h("friend.furniture.confirm.lock.subtitle")}),t("div",{className:"d-flex justify-content-center mb-2",children:t("div",{className:`engraving-lock-stage-${r}`})}),r===2&&t("div",{className:"text-small text-black text-center mb-2",children:h("friend.furniture.confirm.lock.other.locked")}),l(w,{gap:1,children:[t(M,{fullWidth:!0,onClick:g=>d(!1),children:h("friend.furniture.confirm.lock.button.cancel")}),t(M,{fullWidth:!0,variant:"success",onClick:g=>d(!0),children:h("friend.furniture.confirm.lock.button.confirm")})]})]})]});if(s.length>0)return t(as,{handleSelector:".nitro-engraving-lock-view",children:l("div",{className:`nitro-engraving-lock-view engraving-lock-${n}`,children:[t("div",{className:"engraving-lock-close",onClick:u}),l(w,{justifyContent:"center",children:[t("div",{className:"engraving-lock-avatar",children:t(it,{figure:a[0],direction:2})}),t("div",{className:"engraving-lock-avatar",children:t(it,{figure:a[1],direction:4})})]}),l(T,{justifyContent:"between",className:"mt-1",children:[l(T,{alignItems:"center",justifyContent:"center",gap:1,children:[l("div",{children:[n===0&&h("lovelock.engraving.caption"),n===3&&h("wildwest.engraving.caption")]}),t("div",{children:c})]}),l(w,{justifyContent:"center",gap:4,children:[t("div",{children:s[0]}),t("div",{children:s[1]})]})]})]})})},Pk=i=>{const{objectId:e=-1,classId:n=-1,itemType:r=null,text:s=null,isOwnerOfFurniture:a=!1,senderName:c=null,senderFigure:u=null,placedItemId:d=-1,placedItemType:g=null,placedInRoom:m=!1,imageUrl:f=null,openPresent:p=null,onClose:_=null}=$T(),{groupItems:E=[]}=Ds();if(e===-1)return null;const C=I=>{const b=E.find(S=>{var v;return((v=S.getItemById(I))==null?void 0:v.id)===I});b&&oa(b),_()};return l(ie,{className:"nitro-gift-opening",theme:"primary-slim",children:[t(ae,{headerText:h(c?"widget.furni.present.window.title_from":"widget.furni.present.window.title",["name"],[c]),onCloseClick:_}),l(re,{children:[d===-1&&l(T,{overflow:"hidden",children:[t(w,{center:!0,overflow:"auto",children:t(ch,{userName:c,figure:u,message:s})}),a&&l(w,{gap:1,children:[c&&t(M,{fullWidth:!0,onClick:I=>Z("catalog/open"),children:h("widget.furni.present.give_gift",["name"],[c])}),t(M,{fullWidth:!0,variant:"success",onClick:p,children:h("widget.furni.present.open_gift")})]})]}),d>-1&&l(w,{gap:2,overflow:"hidden",children:[t(T,{center:!0,className:"p-2",children:t(vr,{imageUrl:f})}),l(T,{grow:!0,children:[l(T,{center:!0,gap:1,children:[t(N,{wrap:!0,small:!0,children:h("widget.furni.present.message_opened")}),t(N,{bold:!0,fontSize:5,children:s})]}),l(T,{grow:!0,gap:1,children:[l(w,{gap:1,children:[m&&t(M,{fullWidth:!0,onClick:null,children:h("widget.furni.present.put_in_inventory")}),t(M,{fullWidth:!0,variant:"success",onClick:I=>C(d),children:h(m?"widget.furni.present.keep_in_room":"widget.furni.present.place_in_room")})]}),c&&c.length&&t(M,{fullWidth:!0,onClick:I=>Z("catalog/open"),children:h("widget.furni.present.give_gift",["name"],[c])})]})]})]})]})]})},Lk=i=>{const{stuffDatas:e=null,getScoreType:n=null,getClearType:r=null}=xT();return!e||!e.size?null:t(B,{children:Array.from(e.entries()).map(([s,a],c)=>t(Yc,{objectId:s,category:J.FLOOR,children:l(T,{className:"nitro-widget-high-score nitro-context-menu",gap:0,children:[t(rn,{children:h("high.score.display.caption",["scoretype","cleartype"],[h(`high.score.display.scoretype.${n(a.scoreType)}`),h(`high.score.display.cleartype.${r(a.clearType)}`)])}),l(qh,{overflow:"hidden",gap:1,className:"h-100",children:[l(T,{gap:1,children:[l(w,{alignItems:"center",children:[t(N,{center:!0,bold:!0,variant:"white",className:"col-8",children:h("high.score.display.users.header")}),t(N,{center:!0,bold:!0,variant:"white",className:"col-4",children:h("high.score.display.score.header")})]}),t("hr",{className:"m-0"})]}),t(T,{overflow:"auto",gap:1,className:"overflow-y-scroll",children:a.entries.map((u,d)=>l(w,{alignItems:"center",children:[t(N,{center:!0,variant:"white",className:"col-8",children:u.users.join(", ")}),t(N,{center:!0,variant:"white",className:"col-4",children:u.score})]},d))})]})]})},c))})},Mk=i=>(VT(),null),Uk=-1,zi=0,Hl=1,Wl=2,jl=3,ql=4,xk=i=>{const[e,n]=o.useState(null),[r,s]=o.useState(Uk),{objectId:a=-1,figure:c=null,gender:u=null,clubLevel:d=bn.NO_CLUB,name:g=null,setName:m=null,saveFigure:f=null,wearFigure:p=null,saveName:_=null,onClose:E=null}=HT();return o.useEffect(()=>{if(a===-1)return;const C=Re();if(C.isRoomOwner||C.controllerLevel>=nt.GUEST||W().isModerator){s(zi);return}if(W().gender.toLowerCase()!==u.toLowerCase()){s(ql);return}if(kn()<d){s(jl);return}s(Wl)},[a,u,d]),o.useEffect(()=>{switch(r){case zi:case ql:{const C=kt().createFigureContainer(c);ra.transformAsMannequinFigure(C),n(C.getFigureString());break}case Hl:{const C=kt().createFigureContainer(W().figure);ra.transformAsMannequinFigure(C),n(C.getFigureString());break}case Wl:case jl:{const C=ra.getMergedMannequinFigureContainer(W().figure,c);n(C.getFigureString());break}}},[r,c,d]),a===-1?null:l(ie,{className:"nitro-mannequin no-resize",theme:"primary-slim",children:[t(ae,{headerText:h("mannequin.widget.title"),onCloseClick:E}),t(re,{center:!0,children:l(w,{fullWidth:!0,gap:2,overflow:"hidden",children:[t(T,{children:l(P,{position:"relative",className:"mannequin-preview",children:[t(it,{position:"absolute",figure:e,direction:2}),d>0&&t(dt,{className:"position-absolute end-2 bottom-2",type:"hc"})]})}),l(T,{grow:!0,justifyContent:"between",overflow:"auto",children:[r===zi&&l(B,{children:[t("input",{type:"text",className:"form-control form-control-sm",value:g,onChange:C=>m(C.target.value),onBlur:_}),l(T,{gap:1,children:[t(M,{variant:"success",onClick:C=>s(Hl),children:h("mannequin.widget.style")}),t(M,{variant:"success",onClick:p,children:h("mannequin.widget.wear")})]})]}),r===Hl&&l(B,{children:[l(T,{gap:1,children:[t(N,{bold:!0,children:g}),t(N,{wrap:!0,children:h("mannequin.widget.savetext")})]}),l(w,{alignItems:"center",justifyContent:"between",children:[t(N,{underline:!0,pointer:!0,onClick:C=>s(zi),children:h("mannequin.widget.back")}),t(M,{variant:"success",onClick:f,children:h("mannequin.widget.save")})]})]}),r===Wl&&l(B,{children:[l(T,{gap:1,children:[t(N,{bold:!0,children:g}),t(N,{children:h("mannequin.widget.weartext")})]}),t(M,{variant:"success",onClick:p,children:h("mannequin.widget.wear")})]}),r===jl&&t(w,{center:!0,grow:!0,children:t(N,{children:h("mannequin.widget.clubnotification")})}),r===ql&&t(N,{children:h("mannequin.widget.wronggender")})]})]})})]})},Fk=i=>(QT(),null),Yh=["9CCEFF","FF9CFF","9CFF9C","FFFF33"],Gk=["blue","pink","green","yellow"],Vk=i=>{let e=Yh.indexOf(i);return e===-1&&(e=0),Gk[e]},Bk=i=>{const{objectId:e=-1,color:n="0",setColor:r=null,text:s="",setText:a=null,canModify:c=!1,onClose:u=null}=ZT();return e===-1?null:t(as,{handleSelector:".drag-handler",windowPosition:Ht.TOP_LEFT,children:l("div",{className:"nitro-stickie nitro-stickie-image stickie-"+Vk(n),children:[l("div",{className:"d-flex align-items-center stickie-header drag-handler",children:[t("div",{className:"d-flex align-items-center flex-grow-1 h-100",children:c&&l(B,{children:[t("div",{className:"nitro-stickie-image stickie-trash header-trash",onClick:u}),Yh.map(d=>t("div",{className:"stickie-color ms-1",onClick:g=>r(d),style:{backgroundColor:mn.makeColorHex(d)}},d))]})}),t("div",{className:"d-flex align-items-center nitro-stickie-image stickie-close header-close",onClick:u})]}),t("div",{className:"stickie-context",children:t("textarea",{className:"context-text",value:s,onChange:d=>a(d.target.value),tabIndex:0,autoFocus:!0})})]})})},Hk=i=>{const{objectId:e=-1,height:n=0,maxHeight:r=40,onClose:s=null,updateHeight:a=null}=tv(),[c,u]=o.useState(""),d=g=>{u(g);const m=parseFloat(g);isNaN(m)||m===n||a(m)};return o.useEffect(()=>{u(n.toString())},[n]),e===-1?null:l(ie,{className:"nitro-widget-custom-stack-height",theme:"primary-slim",children:[t(ae,{headerText:h("widget.custom.stack.height.title"),onCloseClick:s}),l(re,{justifyContent:"between",children:[t(N,{children:h("widget.custom.stack.height.text")}),l(w,{gap:2,children:[t(Mt,{className:"nitro-slider",min:0,max:r,step:.01,value:n,onChange:g=>a(g),renderThumb:(g,m)=>t("div",{...g,children:m.valueNow})}),t("input",{className:"show-number-arrows",style:{width:50},type:"number",min:0,max:r,value:c,onChange:g=>d(g.target.value)})]}),l(T,{gap:1,children:[t(M,{onClick:g=>L(new Xl(e,-100)),children:h("furniture.above.stack")}),t(M,{onClick:g=>L(new Xl(e,0)),children:h("furniture.floor.level")})]})]})]})},$h=["9CCEFF","FF9CFF","9CFF9C","FFFF33"],Wk=["blue","pink","green","yellow"],jk=["post_it","post_it_shakesp","post_it_dreams","post_it_xmas","post_it_vd","post_it_juninas"],qk=["post_it","shakesp","dreams","christmas","heart","juninas"],zk=i=>{let e=$h.indexOf(i);return e===-1&&(e=0),Wk[e]},Yk=i=>{let e=jk.indexOf(i);return e===-1&&(e=0),qk[e]},$k=i=>{const{objectId:e=-1,color:n="0",text:r="",type:s="",canModify:a=!1,updateColor:c=null,updateText:u=null,trash:d=null,onClose:g=null}=rv(),[m,f]=o.useState(!1);return o.useEffect(()=>{f(!1)},[e,n,r,s]),e===-1?null:t(as,{handleSelector:".drag-handler",windowPosition:Ht.TOP_LEFT,children:l("div",{className:"nitro-stickie nitro-stickie-image stickie-"+(s=="post_it"?zk(n):Yk(s)),children:[l("div",{className:"d-flex align-items-center stickie-header drag-handler",children:[t("div",{className:"d-flex align-items-center flex-grow-1 h-100",children:a&&l(B,{children:[t("div",{className:"nitro-stickie-image stickie-trash header-trash",onClick:d}),s=="post_it"&&t(B,{children:$h.map(p=>t("div",{className:"stickie-color ms-1",onClick:_=>c(p),style:{backgroundColor:mn.makeColorHex(p)}},p))})]})}),t("div",{className:"d-flex align-items-center nitro-stickie-image stickie-close header-close",onClick:g})]}),t("div",{className:"stickie-context",children:!m||!a?t("div",{className:"context-text",onClick:p=>a&&f(!0),children:r}):t("textarea",{className:"context-text",defaultValue:r,tabIndex:0,onBlur:p=>u(p.target.value),autoFocus:!0})})]})})},Kk=i=>{const{objectId:e=-1,color:n="1",senderName:r="",date:s="",message:a="",onClose:c=null}=av();return e===-1?null:t(dh,{color:n,message:a,date:s,senderName:r,onCloseClick:c})},Xk=i=>{const[e,n]=o.useState(null),{objectId:r=-1,videoId:s=null,videoStart:a=0,videoEnd:c=0,currentVideoState:u=null,selectedVideo:d=null,playlists:g=[],onClose:m=null,previous:f=null,next:p=null,pause:_=null,play:E=null,selectVideo:C=null}=dv(),I=S=>{if(n(S.target),r!==-1)switch(S.target.getPlayerState()){case-1:case 1:u!==1&&E();return;case 2:u!==2&&_()}};if(o.useEffect(()=>{if(!(u===null||!e)){if(u===Zr.PLAYING&&e.getPlayerState()!==Zr.PLAYING){e.playVideo();return}if(u===Zr.PAUSED&&e.getPlayerState()!==Zr.PAUSED){e.pauseVideo();return}}},[u,e]),r===-1)return null;const b={height:"375",width:"500",playerVars:{autoplay:1,disablekb:1,controls:0,origin:window.origin,modestbranding:1,start:a,end:c}};return l(ie,{className:"youtube-tv-widget",children:[t(ae,{headerText:h("catalog.page.youtube_tvs"),onCloseClick:m}),t(re,{children:l("div",{className:"row w-100 h-100",children:[l("div",{className:"youtube-video-container col-9 overflow-hidden",children:[s&&s.length>0&&t(Sg,{videoId:s,opts:b,onReady:S=>n(S.target),onStateChange:I,containerClassName:"youtubeContainer"}),(!s||s.length===0)&&t("div",{className:"empty-video w-100 h-100 justify-content-center align-items-center d-flex",children:h("widget.furni.video_viewer.no_videos")})]}),l("div",{className:"playlist-container col-3 d-flex flex-column",children:[l("span",{className:"playlist-controls justify-content-center d-flex",children:[t("i",{className:"icon icon-youtube-prev cursor-pointer",onClick:f}),t("i",{className:"icon icon-youtube-next cursor-pointer",onClick:p})]}),t("div",{className:"mb-1",children:h("widget.furni.video_viewer.playlists")}),t(De,{columnCount:1,columnMinWidth:80,columnMinHeight:100,className:"mb-1",overflow:"auto",children:g&&g.map((S,v)=>t(be,{onClick:y=>C(S.video),itemActive:S.video===d,children:t("b",{children:S.title})},v))})]})]})})]})},Qk=i=>{const{diskInventory:e=null,addToPlaylist:n=null}=i,[r,s]=o.useState(-1),[a,c]=o.useState(-1),u=o.useCallback((m,f)=>{m.stopPropagation(),c(p=>p===f?-1:f)},[]),d=o.useCallback((m,f)=>{var p,_;m.stopPropagation(),n(f,(_=(p=_e().soundManager.musicController)==null?void 0:p.getRoomItemPlaylist())==null?void 0:_.length)},[n]),g=()=>{Z("catalog/open/"+no.TRAX_SONGS)};return o.useEffect(()=>{var m;if(a!==-1)return(m=_e().soundManager.musicController)==null||m.playSong(a,Ca.PRIORITY_SONG_PLAY,0,0,0,0),()=>{var f;(f=_e().soundManager.musicController)==null||f.stop(Ca.PRIORITY_SONG_PLAY)}},[a]),o.useEffect(()=>()=>c(-1),[]),l(B,{children:[l("div",{className:"bg-success py-3 container-fluid justify-content-center d-flex rounded",children:[t("img",{src:K("image.library.url")+"playlist/title_mymusic.gif",className:"my-music"}),t("h2",{className:"ms-4",children:h("playlist.editor.my.music")})]}),t("div",{className:"h-100 overflow-y-scroll mt-4 py-2",children:t(De,{columnCount:3,columnMinWidth:95,gap:1,children:e&&e.getKeys().map((m,f)=>{var C;const p=e.getKey(f),_=e.getWithIndex(f),E=(C=_e().soundManager.musicController)==null?void 0:C.getSongInfo(_);return l(be,{itemActive:r===f,onClick:()=>s(I=>I===f?-1:f),classNames:["text-black"],children:[t("div",{className:"disk-image flex-shrink-0 mb-n2",style:{backgroundColor:rh(E==null?void 0:E.songData)}}),t(N,{truncate:!0,fullWidth:!0,className:"text-center",children:E==null?void 0:E.name}),r===f&&l(w,{position:"absolute",className:"bottom-0 mb-1 bg-secondary p-1 rounded",alignItems:"center",justifyContent:"center",gap:2,children:[t(M,{onClick:I=>u(I,_),variant:"light",children:t(P,{className:a===_?"pause-btn":"preview-song"})}),t(M,{onClick:I=>d(I,p),variant:"light",children:t(P,{className:"move-disk"})})]})]},f)})})}),l("div",{className:"playlist-bottom text-black p-1",children:[t("h5",{children:h("playlist.editor.text.get.more.music")}),t("div",{children:h("playlist.editor.text.you.have.no.songdisks.available")}),t("div",{children:h("playlist.editor.text.you.can.buy.some.from.the.catalogue")}),t("button",{className:"btn btn-primary btn-sm",onClick:()=>g(),children:h("playlist.editor.button.open.catalogue")})]}),t("img",{src:K("image.library.url")+"playlist/background_get_more_music.gif",className:"get-more"})]})},Jk=i=>{var m,f;const{furniId:e=-1,playlist:n=null,currentPlayingIndex:r=-1,removeFromPlaylist:s=null,togglePlayPause:a=null}=i,[c,u]=o.useState(-1),d=p=>{c===p&&s(p)},g=(p,_)=>{a(p,_!==-1?_:0)};return l(B,{children:[l("div",{className:"bg-primary py-3 container-fluid justify-content-center d-flex rounded",children:[t("img",{src:K("image.library.url")+"playlist/title_playlist.gif",className:"playlist-img"}),t("h2",{className:"ms-4",children:h("playlist.editor.playlist")})]}),t("div",{className:"h-100 overflow-y-scroll py-2",children:t(w,{column:!0,gap:2,children:n&&n.map((p,_)=>l(w,{gap:1,className:"text-black cursor-pointer "+(c===_?"border border-muted border-2 rounded":"border-2"),alignItems:"center",onClick:()=>u(E=>E===_?-1:_),children:[t(P,{onClick:()=>d(_),className:"disk-2 "+(c===_?"selected-song":""),style:{backgroundColor:c===_?"":rh(p.songData)}}),p.name]},_))})}),(!n||n.length===0)&&l(B,{children:[l("div",{className:"playlist-bottom text-black p-1 ms-5",children:[t("h5",{children:h("playlist.editor.add.songs.to.your.playlist")}),t("div",{children:h("playlist.editor.text.click.song.to.choose.click.again.to.move")})]}),t("img",{src:K("image.library.url")+"playlist/background_add_songs.gif",className:"add-songs"})]}),n&&n.length>0&&l(B,{children:[r===-1&&t(M,{variant:"success",size:"lg",onClick:()=>g(e,c),children:h("playlist.editor.button.play.now")}),r!==-1&&l(w,{gap:1,children:[t(M,{variant:"danger",onClick:()=>g(e,c),children:t(P,{className:"pause-song"})}),l(w,{column:!0,children:[t(N,{bold:!0,display:"block",children:h("playlist.editor.text.now.playing.in.your.room")}),t(N,{children:((m=n[r])==null?void 0:m.name)+" - "+((f=n[r])==null?void 0:f.creator)})]})]})]})]})},Zk=i=>{const{objectId:e=-1,currentPlayingIndex:n=-1,playlist:r=null,diskInventory:s=null,onClose:a=null,togglePlayPause:c=null,removeFromPlaylist:u=null,addToPlaylist:d=null}=jT();return e===-1?null:l(ie,{className:"nitro-playlist-editor-widget",theme:"primary-slim",children:[t(ae,{headerText:h("playlist.editor.title"),onCloseClick:a}),t(re,{children:l("div",{className:"d-flex flex-row gap-1 h-100",children:[t("div",{className:"w-50 position-relative overflow-hidden h-100 rounded d-flex flex-column",children:t(Qk,{addToPlaylist:d,diskInventory:s})}),t("div",{className:"w-50 position-relative overflow-hidden h-100 rounded d-flex flex-column",children:t(Jk,{furniId:e,removeFromPlaylist:u,playlist:r,togglePlayPause:c,currentPlayingIndex:n})})]})})]})},e1=i=>l(P,{fit:!0,position:"absolute",className:"nitro-room-widgets top-0 start-0",children:[t(vk,{}),t(wk,{}),t(Rk,{}),t(Ok,{}),t(yk,{}),t(Ak,{}),t(Dk,{}),t(Pk,{}),t(Lk,{}),t(Mk,{}),t(xk,{}),t(Zk,{}),t(Fk,{}),t(Bk,{}),t(Hk,{}),t($k,{}),t(Kk,{}),t(Tk,{}),t(Xk,{})]}),t1=i=>{const{isVisible:e=!1,errorResult:n=null,petName:r=null,objectType:s=null,onChangePetName:a=null,onConfirm:c=null,onClose:u=null}=Ov();return t(B,{children:e&&l(ie,{className:"nitro-pet-package no-resize",theme:"primary-slim",children:[t(ae,{center:!0,headerText:h(s==="gnome_box"?"widgets.gnomepackage.name.title":"furni.petpackage.open"),onCloseClick:()=>u()}),l(re,{children:[l(w,{className:"pet-package-container-top p-3",children:[t("div",{className:`package-image-${s} flex-shrink-0`}),t("div",{className:"m-2",children:t(N,{variant:"white",className:"package-text-big",children:h(s==="gnome_box"?"widgets.gnomepackage.name.title":"furni.petpackage")})})]}),t(w,{className:"pet-package-container-bottom p-2",children:l(T,{gap:1,children:[l(w,{alignItems:"center",className:"bg-white rounded py-1 px-2 input-pet-package-container",children:[t("input",{type:"text",className:"form-control form-control-sm input-pet-package",maxLength:K("pet.package.name.max.length"),placeholder:h(s==="gnome_box"?"widgets.gnomepackage.name.select":"widgets.petpackage.name.title"),value:r,onChange:d=>a(d.target.value)}),t("div",{className:"package-pencil-image flex-shrink-0 small fa-icon"})]}),n.length>0&&t(P,{className:"invalid-feedback d-block m-0",children:n}),l(w,{className:"mt-2",gap:5,display:"flex",justifyContent:"center",alignItems:"center",children:[t(N,{pointer:!0,className:"text-decoration",onClick:()=>u(),children:h("cancel")}),t(Ng,{variant:r.length<3?"danger":"success",disabled:r.length<3,onClick:()=>c(),children:h(s==="gnome_box"?"widgets.gnomepackage.name.pick":"furni.petpackage.confirm")})]})]})})]})]})})},n1=i=>{const[e,n]=o.useState("bobba"),[r,s]=o.useState(""),[a,c]=o.useState(!1),{wordsFilter:u=[],isVisible:d=null,setWordsFilter:g,onClose:m=null}=Sv(),{navigatorData:f=null}=Yn(),p=C=>{(a?!r:!e)||(L(new Mb(f.enteredGuestRoom.roomId,C,a?r:e)),s(""),n("bobba"),c(!1),!(C&&u.includes(a?r:e))&&g(I=>{const b=[...I];return C?b.push(a?r:e):b.splice(b.indexOf(a?r:e),1),b}))},_=C=>{n(C),c(!1)},E=C=>{s(C),c(!0)};return d?l(ie,{className:"nitro-guide-tool no-resize",theme:"primary-slim",children:[t(ae,{headerText:h("navigator.roomsettings.roomfilter"),onCloseClick:()=>m()}),l(re,{className:"text-black",children:[l(ne,{className:"d-flex align-items-center justify-content-end gap-2",children:[t("input",{type:"text",className:"form-control form-control-sm",maxLength:255,value:e,onChange:C=>_(C.target.value)}),t(M,{onClick:()=>p(!0),children:h("navigator.roomsettings.roomfilter.addword")})]}),t(T,{overflow:"auto",gap:0,className:"form-control form-control-sm",style:{height:"100px"},children:u&&u.length>0&&u.map((C,I)=>t(w,{alignItems:"center",className:zt("rounded p-1",r===C&&"bg-muted"),pointer:!0,onClick:b=>E(C),children:t(N,{truncate:!0,children:C})},I))}),t(ne,{className:"d-flex align-items-center justify-content-end gap-2",children:t(M,{variant:"danger",onClick:()=>p(!1),disabled:u.length===0||!a,children:h("navigator.roomsettings.roomfilter.removeword")})})]})]}):null},r1=i=>{const[e,n]=o.useState(!1),{roomSession:r=null}=Le();Qe([gr.SHOW_THUMBNAIL,gr.HIDE_THUMBNAIL,gr.TOGGLE_THUMBNAIL],a=>{switch(a.type){case gr.SHOW_THUMBNAIL:n(!0);return;case gr.HIDE_THUMBNAIL:n(!1);return;case gr.TOGGLE_THUMBNAIL:n(c=>!c);return}});const s=a=>{j().saveTextureAsScreenshot(a,!0),n(!1)};return e?t(SN,{roomId:r.roomId,textureReceiver:s,onClose:()=>n(!1)}):null},s1=i=>{const[e,n]=o.useState(!1),[r,s]=o.useState(null),[a,c]=o.useState(null),[u,d]=o.useState(null),[g,m]=o.useState(!1),{navigatorData:f=null}=Yn(),{roomSession:p=null}=Le(),_=(E,C)=>{switch(E){case"settings":Z("navigator/toggle-room-info");return;case"zoom":n(I=>{let b=j().getRoomInstanceRenderingCanvasScale(p.roomId,1);return I?b*=2:b/=2,j().setRoomInstanceRenderingCanvasScale(p.roomId,1,b),!I});return;case"chat_history":Z("chat-history/toggle");return;case"like_room":L(new Ub(1));return;case"toggle_room_link":Z("navigator/toggle-room-link");return;case"navigator_search_tag":Z(`navigator/search/${C}`),L(new aa("hotel_view",`tag:${C}`));return}};return x(ca,E=>{const C=E.getParser();!C.roomEnter||C.data.roomId!==p.roomId||(r!==C.data.roomName&&s(C.data.roomName),a!==C.data.ownerName&&c(C.data.ownerName),u!==C.data.tags&&d(C.data.tags))}),o.useEffect(()=>{m(!0);const E=setTimeout(()=>m(!1),5e3);return()=>clearTimeout(E)},[r,a,u]),l(w,{className:"nitro-room-tools-container",gap:2,children:[l(T,{center:!0,className:"nitro-room-tools p-2",children:[t(P,{pointer:!0,title:h("room.settings.button.text"),className:"icon icon-cog",onClick:()=>_("settings")}),t(P,{pointer:!0,title:h("room.zoom.button.text"),onClick:()=>_("zoom"),className:zt("icon",!e&&"icon-zoom-less",e&&"icon-zoom-more")}),t(P,{pointer:!0,title:h("room.chathistory.button.text"),onClick:()=>_("chat_history"),className:"icon icon-chat-history"}),f.canRate&&t(P,{pointer:!0,title:h("room.like.button.text"),onClick:()=>_("like_room"),className:"icon icon-like-room"})]}),t(T,{justifyContent:"center",children:t(ci,{type:un.SLIDE_LEFT,inProp:g,timeout:300,children:t(T,{center:!0,children:l(T,{className:"nitro-room-tools-info rounded py-2 px-3",children:[l(T,{gap:1,children:[t(N,{wrap:!0,variant:"white",fontSize:4,children:r}),t(N,{variant:"muted",fontSize:5,children:a})]}),u&&u.length>0&&t(w,{gap:2,children:u.map((E,C)=>l(N,{small:!0,pointer:!0,variant:"white",className:"rounded bg-primary p-1",onClick:()=>_("navigator_search_tag",E),children:["#",E]},C))})]})})})})]})},a1=i=>{const{question:e=null,canVote:n=null,vote:r=null,noVotes:s=null,yesVotes:a=null}=i;return l(T,{gap:2,className:"wordquiz-question p-2",children:[!n&&l(w,{fullWidth:!0,alignItems:"center",gap:2,children:[t(w,{center:!0,pointer:!0,className:"bg-danger rounded p-2",children:t(N,{variant:"white",children:s})}),t(N,{variant:"white",center:!0,textBreak:!0,children:e}),t(w,{center:!0,pointer:!0,className:"bg-success rounded p-2",children:t(N,{variant:"white",children:a})})]}),n&&l(T,{children:[t(N,{variant:"white",center:!0,textBreak:!0,children:e}),l(w,{fullWidth:!0,justifyContent:"center",gap:1,children:[t(w,{center:!0,pointer:!0,className:"bg-danger rounded p-1",onClick:c=>r(mo),children:t(P,{className:"word-quiz-dislike"})}),t(w,{center:!0,pointer:!0,className:"bg-success rounded p-1",onClick:c=>r(sh),children:t(P,{className:"word-quiz-like"})})]})]})]})},i1=i=>{const{userIndex:e=null,vote:n=null,...r}=i;return t(Yc,{objectId:e,category:J.UNIT,...r,children:t(w,{center:!0,pointer:!0,className:`bg-${n===mo?"danger":"success"} rounded p-1`,children:t(P,{className:`word-quiz-${n===mo?"dislike":"like"}-sm`})})})},o1=i=>{const{question:e=null,answerSent:n=!1,answerCounts:r=null,userAnswers:s=null,vote:a=null}=Mv();return l(B,{children:[e&&t(a1,{question:e.content,canVote:!n,vote:a,noVotes:r.get(mo)||0,yesVotes:r.get(sh)||0}),s&&Array.from(s.entries()).map(([c,u],d)=>t(i1,{userIndex:c,vote:u.value},d))]})},l1=i=>{const{roomSession:e=null}=Le(),{simpleAlert:n=null}=ze();return Ne(Ql.ROOM_ZOOM,r=>j().setRoomInstanceRenderingCanvasScale(r.roomId,1,r.level,null,null,!1,r.asDelta)),Ne([ve.REQUEST_TEASER,ve.REQUEST_ECOTRONBOX,ve.REQUEST_CLOTHING_CHANGE,ve.REQUEST_PLAYLIST_EDITOR,ve.OPEN_WIDGET,ve.CLOSE_WIDGET,Ni.FURNI_CLICK,Ni.FURNI_DOUBLE_CLICK,Ni.TOOLTIP_SHOW,Ni.TOOLTIP_HIDE],r=>{if(e)switch(r.objectId,r.category,r.type){}}),je([gt.RSEME_KICKED,gt.RSEME_PETS_FORBIDDEN_IN_HOTEL,gt.RSEME_PETS_FORBIDDEN_IN_FLAT,gt.RSEME_MAX_PETS,gt.RSEME_MAX_NUMBER_OF_OWN_PETS,gt.RSEME_NO_FREE_TILES_FOR_PET,gt.RSEME_SELECTED_TILE_NOT_FREE_FOR_PET,gt.RSEME_BOTS_FORBIDDEN_IN_HOTEL,gt.RSEME_BOTS_FORBIDDEN_IN_FLAT,gt.RSEME_BOT_LIMIT_REACHED,gt.RSEME_SELECTED_TILE_NOT_FREE_FOR_BOT,gt.RSEME_BOT_NAME_NOT_ACCEPTED],r=>{let s=h("error.title"),a="";switch(r.type){case gt.RSEME_MAX_PETS:a=h("room.error.max_pets");break;case gt.RSEME_MAX_NUMBER_OF_OWN_PETS:a=h("room.error.max_own_pets");break;case gt.RSEME_KICKED:a=h("room.error.kicked"),s=h("generic.alert.title");break;case gt.RSEME_PETS_FORBIDDEN_IN_HOTEL:a=h("room.error.pets.forbidden_in_hotel");break;case gt.RSEME_PETS_FORBIDDEN_IN_FLAT:a=h("room.error.pets.forbidden_in_flat");break;case gt.RSEME_NO_FREE_TILES_FOR_PET:a=h("room.error.pets.no_free_tiles");break;case gt.RSEME_SELECTED_TILE_NOT_FREE_FOR_PET:a=h("room.error.pets.selected_tile_not_free");break;case gt.RSEME_BOTS_FORBIDDEN_IN_HOTEL:a=h("room.error.bots.forbidden_in_hotel");break;case gt.RSEME_BOTS_FORBIDDEN_IN_FLAT:a=h("room.error.bots.forbidden_in_flat");break;case gt.RSEME_BOT_LIMIT_REACHED:a=h("room.error.max_bots");break;case gt.RSEME_SELECTED_TILE_NOT_FREE_FOR_BOT:a=h("room.error.bots.selected_tile_not_free");break;case gt.RSEME_BOT_NAME_NOT_ACCEPTED:a=h("room.error.bots.name.not.accepted");break;default:return}n(a,ge.DEFAULT,null,null,s)}),l(B,{children:[t(rk,{}),t(uk,{}),t(ik,{}),t(hk,{}),t(e1,{}),t(s1,{}),t(n1,{}),t(r1,{}),t(dk,{}),t(t1,{}),t(mk,{}),t(o1,{}),t(fk,{})]})},c1=i=>{const{roomSession:e=null}=Le(),n=o.useRef();return o.useEffect(()=>{if(!e)return;const r=_e().application.renderer.view;if(!r)return;r.onclick=p=>Ri(p),r.onmousemove=p=>Ri(p),r.onmousedown=p=>Ri(p),r.onmouseup=p=>Ri(p),r.ontouchstart=p=>ki(p),r.ontouchmove=p=>ki(p),r.ontouchend=p=>ki(p),r.ontouchcancel=p=>ki(p);const s=new Set,a=new Map;let c=null;const u=50,d=(p=3)=>{if(s.size===0)return;const _=j();if(!_||!e)return;const E=e.roomId,C=e.ownRoomIndex,I=_.getRoomObject(E,C,100);if(!I)return;const b=I.getLocation();if(!b)return;let S=Math.floor(b.x),v=Math.floor(b.y),y=!1;s.has("ArrowUp")&&(S-=p,y=!0),s.has("ArrowDown")&&(S+=p,y=!0),s.has("ArrowLeft")&&(v+=p,y=!0),s.has("ArrowRight")&&(v-=p,y=!0),y&&L(new xb(S,v))},g=p=>{if(["ArrowUp","ArrowDown","ArrowLeft","ArrowRight"].includes(p.key)){p.preventDefault();const E=Date.now();if(!s.has(p.key)){let C=!1;for(const[I,b]of a.entries())if(I!==p.key&&s.has(I)&&E-b<=u){C=!0;break}!C&&s.size>0&&(c&&(clearInterval(c),c=null),s.clear(),a.clear()),s.add(p.key),a.set(p.key,E),d(1),setTimeout(()=>{s.has(p.key)&&!c&&(c=setInterval(()=>d(3),150))},200)}}},m=p=>{["ArrowUp","ArrowDown","ArrowLeft","ArrowRight"].includes(p.key)&&(p.preventDefault(),s.delete(p.key),a.delete(p.key),s.size===0&&c&&(clearInterval(c),c=null))};window.addEventListener("keydown",g),window.addEventListener("keyup",m);const f=n.current;if(f)return f.appendChild(r),()=>{window.removeEventListener("keydown",g),window.removeEventListener("keyup",m),c&&(clearInterval(c),c=null),s.clear(),a.clear()}},[e]),t(P,{fit:!0,innerRef:n,className:!e&&"d-none",children:e&&l(B,{children:[t(l1,{}),e.isSpectator&&t(Py,{})]})})},u1=i=>{const{useGuideTool:e=!1,unseenAchievementCount:n=0,setMeExpanded:r=null,children:s=null,...a}=i,c=o.useRef();return o.useEffect(()=>{const u=Re();u&&j().selectRoomObject(u.roomId,u.ownRoomIndex,J.UNIT)},[]),o.useEffect(()=>{const u=d=>r(!1);return document.addEventListener("click",u),()=>document.removeEventListener(Oe.MOUSE_CLICK,u)},[r]),l(w,{innerRef:c,alignItems:"center",className:"nitro-toolbar-me p-2",gap:2,children:[K("guides.enabled")&&e&&t(P,{pointer:!0,className:"navigation-item icon icon-me-helper-tool",onClick:u=>yt(new pn(pn.TOGGLE_GUIDE_TOOL))}),t(P,{pointer:!0,className:"navigation-item icon icon-me-achievements",onClick:u=>Z("achievements/toggle"),children:n>0&&t(Gr,{count:n})}),t(P,{pointer:!0,className:"navigation-item icon icon-me-profile",onClick:u=>hn(W().userId)}),t(P,{pointer:!0,className:"navigation-item icon icon-me-rooms",onClick:u=>Z("navigator/search/myworld_view")}),t(P,{pointer:!0,className:"navigation-item icon icon-me-clothing",onClick:u=>Z("avatar-editor/toggle")}),t(P,{pointer:!0,className:"navigation-item icon icon-me-settings",onClick:u=>Z("user-settings/toggle")}),s]})},d1=i=>{const{isInRoom:e}=i,[n,r]=o.useState(!1),[s,a]=o.useState(!1),{userFigure:c=null}=Wr(),{getFullCount:u=0}=Pn(),{getTotalUnseen:d=0}=Jo(),{requests:g=[]}=Nn(),{iconState:m=Er.HIDDEN}=fh(),{unreadCount:f=0}=Gc(),p=W().isModerator;return x(Am,_=>{const E=_.getParser();a(E.isAllowed(km.USE_GUIDE_TOOL))}),Ne(Fb.ANIMATE_ICON,_=>{((C,I,b,S)=>{const v=document.body.getElementsByClassName(C)[0];if(!v)return;I.className="toolbar-icon-animation",I.style.visibility="visible",I.style.left=b+"px",I.style.top=S+"px",document.body.append(I);const y=v.getBoundingClientRect(),R=I.getBoundingClientRect(),O=R.x-y.x,F=R.y-y.y,U=Math.sqrt(O*O+F*F),A=500-Math.abs(1/U*100*500*.5),k=20,D=`ToolbarBouncing[${C}]`;bl.getMotionByTag(D)||(bl.runMotion(new _u(new Gb(A+8),new Vb(v,400,12))).tag=D);const V=new _u(new Bb(new Hb(I,A,y.x-R.x+k,y.y-R.y,100,1),1),new Wb(I));bl.runMotion(V)})("icon-inventory",_.image,_.x,_.y)}),l(B,{children:[t(ci,{type:un.FADE_IN,inProp:n,timeout:300,children:t(u1,{useGuideTool:s,unseenAchievementCount:d,setMeExpanded:r})}),l(w,{alignItems:"center",justifyContent:"between",gap:2,className:"nitro-toolbar py-1 px-3",children:[t(w,{gap:2,alignItems:"center",children:l(w,{alignItems:"center",gap:2,children:[l(w,{center:!0,pointer:!0,className:"navigation-item item-avatar "+(n?"active ":""),onClick:_=>r(!n),children:[t(it,{figure:c,direction:2,position:"absolute"}),d>0&&t(Gr,{count:d})]}),e&&t(P,{pointer:!0,className:"navigation-item icon icon-habbo",onClick:_=>wc()}),!e&&t(P,{pointer:!0,className:"navigation-item icon icon-house",onClick:_=>Z("navigator/goto/home")}),t(P,{pointer:!0,className:"navigation-item icon icon-rooms",onClick:_=>Z("navigator/toggle")}),K("game.center.enabled")&&t(P,{pointer:!0,className:"navigation-item icon icon-game",onClick:_=>Z("games/toggle")}),t(P,{pointer:!0,className:"navigation-item icon icon-catalog",onClick:_=>Z("catalog/toggle")}),t(P,{pointer:!0,className:"navigation-item icon icon-inventory",onClick:_=>Z("inventory/toggle"),children:u>0&&t(Gr,{count:u})}),e&&t(P,{pointer:!0,className:"navigation-item icon icon-camera",onClick:_=>Z("camera/toggle")}),p&&t(P,{pointer:!0,className:"navigation-item icon icon-modtools",onClick:_=>Z("mod-tools/toggle")})]})}),l(w,{alignItems:"center",gap:2,children:[l(w,{gap:2,children:[l(P,{pointer:!0,className:"navigation-item",style:{position:"relative",width:"32px",height:"33px"},onClick:_=>Z("mention-logs/toggle"),children:[t("img",{src:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAB4AAAAWCAYAAADXYyzPAAABLElEQVR42r2WsRHCMAxFwwLswBhMQMEQlFT0oWKUdOyQNjVNpqDKDOYkIp8sS7HOycV3/2I7lt6XY0iaZn0Ls3ZrCAzfC2oPAwnw059j3zCw2lACBLW3YwaWBlh/eyD0rbkacBVQg8LYA18E0tXaZpijecjTPk64tgQO0zT9A+bFMrEHyKE0vwRGaNd1cXtoyzQDS8AkPq04mJWSMIA5LhlQgaJixsih4ziivAZKQBrDGthNDo+Dw/2tGrAq8AD5ehOMuj4TA/KQlACWQShi6F85WExGA9xELZCUgWkL6MYaAxJI+Sg3/WoimMM9BjwVynzESU42h/MA6xGIv8IYp8Va0AzODchE/NCB+D0J40ALqsI1Ex5pOdwvCS24RjUfAqHWhHgcm3zQeVVsP3VweUKbAKONAAAAAElFTkSuQmCC",alt:"Mention Logs",className:"icon-mention-logs",style:{width:"100%",height:"100%",display:"block"}}),f>0&&t(Gr,{count:f})]}),t(P,{pointer:!0,className:"navigation-item icon icon-friendall",onClick:_=>Z("friends/toggle"),children:g.length>0&&t(Gr,{count:g.length})}),(m===Er.SHOW||m===Er.UNREAD)&&t(P,{pointer:!0,className:`navigation-item icon icon-message ${m===Er.UNREAD&&"is-unseen"}`,onClick:_=>Yo()})]}),t(P,{id:"toolbar-friend-bar-container",className:"d-none d-lg-block"})]})]})]})},m1=i=>{const{badges:e=null,gap:n=1,justifyContent:r="between",...s}=i;return t(B,{children:e&&e.length>0&&e.map((a,c)=>t(T,{center:!0,children:t(We,{badgeCode:a},a)},a))})},h1=i=>{const{relationships:e=null}=i,n=({type:r})=>{const s=e&&e.relationshipStatusMap.hasKey(r)?e.relationshipStatusMap.getValue(r):null,a=er.RELATIONSHIP_NAMES[r].toLocaleLowerCase();return l(w,{fullWidth:!0,gap:1,children:[t(w,{center:!0,className:"user-relationship",children:t("i",{className:`nitro-friends-spritesheet icon-${a}`})}),l(T,{grow:!0,gap:0,children:[l(w,{alignItems:"center",justifyContent:"between",className:"bg-white rounded px-2 py-1 user-relationship",children:[l(N,{small:!0,underline:!0,pointer:!0,onClick:c=>s&&s.randomFriendId>=1&&hn(s.randomFriendId),children:[(!s||s.friendCount===0)&&h("extendedprofile.add.friends"),s&&s.friendCount>=1&&s.randomFriendName]}),s&&s.friendCount>=1&&t(w,{center:!0,position:"relative",className:"avatar-image-container",children:t(it,{figure:s.randomFriendFigure,headOnly:!0,direction:4})})]}),l(N,{small:!0,italics:!0,className:"user-relationship-count",children:[(!s||s.friendCount===0)&&h("extendedprofile.no.friends.in.this.category"),s&&s.friendCount>1&&h(`extendedprofile.relstatus.others.${a}`,["count"],[(s.friendCount-1).toString()]),""]})]})]})};return l(B,{children:[t(n,{type:er.HEART}),t(n,{type:er.SMILE}),t(n,{type:er.BOBBA})]})},g1=i=>{const{relationships:e=null,friendsCount:n=null}=i;return l(T,{gap:1,children:[l(N,{small:!0,children:[t("b",{children:h("extendedprofile.friends.count")})," ",n]}),t(N,{bold:!0,small:!0,children:h("extendedprofile.relstatus")}),t(T,{children:t(h1,{relationships:e})})]})},f1=i=>{const{itsMe:e=null,groups:n=null,onLeaveGroup:r=null,overflow:s="hidden",gap:a=2,...c}=i,[u,d]=o.useState(null),[g,m]=o.useState(null);return x(ri,f=>{const p=f.getParser();!u||u!==p.id||p.flag||m(p)}),o.useEffect(()=>{u&&L(new Ga(u,!1))},[u]),o.useEffect(()=>{m(null),n.length>0&&d(f=>(f===n[0].groupId&&L(new Ga(n[0].groupId,!1)),n[0].groupId))},[n]),!n||!n.length?t(T,{center:!0,fullHeight:!0,children:l(w,{justifyContent:"center",gap:2,children:[t(P,{className:"no-group-spritesheet image-1"}),t(P,{className:"no-group-spritesheet image-2"}),t(P,{className:"no-group-spritesheet image-3"})]})}):l(ne,{overflow:s,gap:2,...c,children:[t(T,{alignItems:"center",size:2,overflow:"auto",children:t(De,{overflow:null,columnCount:1,columnMinHeight:50,className:"user-groups-container",children:n.map((f,p)=>l(be,{overflow:"unset",itemActive:u===f.groupId,onClick:()=>d(f.groupId),className:"p-1",children:[e&&t("i",{className:"position-absolute end-0 top-0 z-index-1 icon icon-group-"+(f.favourite?"favorite":"not-favorite"),onClick:()=>$S(f)}),t(We,{badgeCode:f.badgeCode,isGroup:!0})]},p))})}),t(T,{size:10,overflow:"hidden",children:g&&t(Gh,{groupInformation:g,onClose:r})})]})},p1=i=>{const{userProfile:e=null}=i,[n,r]=o.useState(e.requestSent),s=e.id===W().userId,a=!n&&!s&&!e.isMyFriend&&!e.requestSent,c=()=>{r(!0),L(new gm(e.username))};return o.useEffect(()=>{r(e.requestSent)},[e]),l(w,{gap:2,children:[t(T,{center:!0,className:"avatar-container",children:t(it,{figure:e.figure,direction:2})}),l(T,{children:[l(T,{gap:0,children:[t(N,{bold:!0,children:e.username}),l(N,{italics:!0,textBreak:!0,small:!0,children:[e.motto,""]})]}),l(T,{gap:1,children:[l(N,{small:!0,children:[t("b",{children:h("extendedprofile.created")})," ",e.registration]}),l(N,{small:!0,children:[t("b",{children:h("extendedprofile.last.login")})," ",nr.format(e.secondsSinceLastVisit,".ago",2)]}),l(N,{small:!0,children:[t("b",{children:h("extendedprofile.achievementscore")})," ",e.achievementPoints]})]}),l(w,{gap:1,children:[e.isOnline&&t("i",{className:"icon icon-pf-online"}),!e.isOnline&&t("i",{className:"icon icon-pf-offline"}),l(w,{alignItems:"center",gap:1,children:[a&&t(N,{small:!0,underline:!0,pointer:!0,onClick:c,children:h("extendedprofile.addasafriend")}),!a&&l(B,{children:[t("i",{className:"icon icon-pf-tick"}),s&&t(N,{children:h("extendedprofile.me")}),e.isMyFriend&&t(N,{children:h("extendedprofile.friend")}),(n||e.requestSent)&&t(N,{children:h("extendedprofile.friendrequestsent")})]})]})]})]})]})},I1=i=>{const[e,n]=o.useState(null),[r,s]=o.useState([]),[a,c]=o.useState(null),u=()=>{n(null),s([]),c(null)},d=()=>{!e||e.id!==W().userId||hn(e.id)};return x(jb,g=>{const m=g.getParser();!e||m.userId!==e.id||s(m.badges)}),x(Fm,g=>{const m=g.getParser();!e||m.userId!==e.id||c(m)}),x(zb,g=>{const m=g.getParser();let f=!1;n(p=>(p&&p.id&&(f=p.id===m.id),m)),f||(s([]),c(null)),L(new qb(m.id)),L(new Gm(m.id))}),x(Yb,g=>{const m=g.getParser();m.userId==(e==null?void 0:e.id)&&hn(m.userId)}),Ne(St.SELECTED,g=>{if(!e||g.category!==J.UNIT)return;const m=Re().userDataManager.getUserDataByIndex(g.objectId);m.type===pt.USER&&hn(m.webID)}),e?l(ie,{uniqueKey:"nitro-user-profile",theme:"primary-slim",className:"user-profile",children:[t(ae,{headerText:h("extendedprofile.caption"),onCloseClick:u}),l(re,{overflow:"hidden",children:[l(ne,{fullHeight:!1,gap:2,children:[l(T,{size:7,gap:1,className:"user-container pe-2",children:[t(p1,{userProfile:e}),t(ne,{columnCount:5,fullHeight:!0,className:"bg-muted rounded px-2 py-1",children:t(m1,{fullWidth:!0,center:!0,badges:r})})]}),t(T,{size:5,children:a&&t(g1,{relationships:a,friendsCount:e.friendsCount})})]}),t(w,{alignItems:"center",className:"rooms-button-container px-2 py-1",children:l(w,{alignItems:"center",gap:1,onClick:g=>Z(`navigator/search/hotel_view/owner:${e.username}`),children:[t("i",{className:"icon icon-rooms"}),t(N,{bold:!0,underline:!0,pointer:!0,children:h("extendedprofile.rooms")})]})}),t(f1,{fullWidth:!0,itsMe:e.id===W().userId,groups:e.groups,onLeaveGroup:d})]})]}):null},E1=i=>{const[e,n]=o.useState(!1),[r,s]=o.useState(null),[a,c]=hh(),[u,d]=gh(),[g,m]=o.useState(!1),{roomSession:f=null}=Le(),p=(C,I)=>{let b=!0;const S=r.clone();switch(C){case"close_view":n(!1),b=!1;return;case"oldchat":S.oldChat=I,L(new Xb(S.oldChat));break;case"room_invites":S.roomInvites=I,L(new Kb(S.roomInvites));break;case"camera_follow":S.cameraFollow=I,L(new $b(S.cameraFollow));break;case"system_volume":S.volumeSystem=I,S.volumeSystem=Math.max(0,S.volumeSystem),S.volumeSystem=Math.min(100,S.volumeSystem);break;case"furni_volume":S.volumeFurni=I,S.volumeFurni=Math.max(0,S.volumeFurni),S.volumeFurni=Math.min(100,S.volumeFurni);break;case"trax_volume":S.volumeTrax=I,S.volumeTrax=Math.max(0,S.volumeTrax),S.volumeTrax=Math.min(100,S.volumeTrax);break}b&&s(S),tc(S)},_=C=>{switch(C){case"volume":L(new Qb(Math.round(r.volumeSystem),Math.round(r.volumeFurni),Math.round(r.volumeTrax)));break}};x(vm,C=>{const I=C.getParser(),b=new Jb;b.volumeSystem=I.volumeSystem,b.volumeFurni=I.volumeFurni,b.volumeTrax=I.volumeTrax,b.oldChat=I.oldChat,b.roomInvites=I.roomInvites,b.cameraFollow=I.cameraFollow,b.flags=I.flags,b.chatType=I.chatType,s(b),tc(b)}),o.useEffect(()=>{const C={linkReceived:I=>{const b=I.split("/");if(!(b.length<2))switch(b[1]){case"show":n(!0);return;case"hide":n(!1);return;case"toggle":n(S=>!S);return}},eventUrlPrefix:"user-settings/"};return It(C),()=>Et(C)},[]);const E=C=>{if(m(C),!f)return;const I=C?":mentions off":":mentions on";f.sendChatMessage(I,0),console.log(` Comando enviado no chat: ${I}`)};return o.useEffect(()=>{r&&yt(r)},[r]),!e||!r?null:l(ie,{uniqueKey:"user-settings",className:"user-settings-window",theme:"primary-slim",children:[t(ae,{headerText:h("widget.memenu.settings.title"),onCloseClick:C=>p("close_view")}),l(re,{className:"text-black",children:[l(T,{gap:1,children:[l(w,{alignItems:"center",gap:1,children:[t("input",{className:"form-check-input",type:"checkbox",checked:r.oldChat,onChange:C=>p("oldchat",C.target.checked)}),t(N,{children:h("memenu.settings.chat.prefer.old.chat")})]}),l(w,{alignItems:"center",gap:1,children:[t("input",{className:"form-check-input",type:"checkbox",checked:r.roomInvites,onChange:C=>p("room_invites",C.target.checked)}),t(N,{children:h("memenu.settings.other.ignore.room.invites")})]}),l(w,{alignItems:"center",gap:1,children:[t("input",{className:"form-check-input",type:"checkbox",checked:r.cameraFollow,onChange:C=>p("camera_follow",C.target.checked)}),t(N,{children:h("memenu.settings.other.disable.room.camera.follow")})]}),l(w,{alignItems:"center",gap:1,children:[t("input",{className:"form-check-input",type:"checkbox",checked:a,onChange:C=>c(C.target.checked)}),t(N,{children:h("memenu.settings.other.place.multiple.objects")})]}),l(w,{alignItems:"center",gap:1,children:[t("input",{className:"form-check-input",type:"checkbox",checked:u,onChange:C=>d(C.target.checked)}),t(N,{children:h("memenu.settings.other.skip.purchase.confirmation")})]}),l(w,{alignItems:"center",gap:1,children:[t("input",{className:"form-check-input",type:"checkbox",checked:g,onChange:C=>E(C.target.checked)}),t(N,{children:"Disable mentions"})]})]}),l(T,{children:[t(N,{bold:!0,children:h("widget.memenu.settings.volume")}),l(T,{gap:1,children:[t(N,{children:h("widget.memenu.settings.volume.ui")}),l(w,{alignItems:"center",gap:1,children:[r.volumeSystem===0&&t(ll,{className:zt(r.volumeSystem>=50&&"text-muted","fa-icon")}),r.volumeSystem>0&&t(cl,{className:zt(r.volumeSystem>=50&&"text-muted","fa-icon")}),t("input",{type:"range",className:"custom-range w-100",min:"0",max:"100",step:"1",id:"volumeSystem",value:r.volumeSystem,onChange:C=>p("system_volume",C.target.value),onMouseUp:()=>_("volume")}),t(ul,{className:zt(r.volumeSystem<50&&"text-muted","fa-icon")})]})]}),l(T,{gap:1,children:[t(N,{children:h("widget.memenu.settings.volume.furni")}),l(w,{alignItems:"center",gap:1,children:[r.volumeFurni===0&&t(ll,{className:zt(r.volumeFurni>=50&&"text-muted","fa-icon")}),r.volumeFurni>0&&t(cl,{className:zt(r.volumeFurni>=50&&"text-muted","fa-icon")}),t("input",{type:"range",className:"custom-range w-100",min:"0",max:"100",step:"1",id:"volumeFurni",value:r.volumeFurni,onChange:C=>p("furni_volume",C.target.value),onMouseUp:()=>_("volume")}),t(ul,{className:zt(r.volumeFurni<50&&"text-muted","fa-icon")})]})]}),l(T,{gap:1,children:[t(N,{children:h("widget.memenu.settings.volume.trax")}),l(w,{alignItems:"center",gap:1,children:[r.volumeTrax===0&&t(ll,{className:zt(r.volumeTrax>=50&&"text-muted","fa-icon")}),r.volumeTrax>0&&t(cl,{className:zt(r.volumeTrax>=50&&"text-muted","fa-icon")}),t("input",{type:"range",className:"custom-range w-100",min:"0",max:"100",step:"1",id:"volumeTrax",value:r.volumeTrax,onChange:C=>p("trax_volume",C.target.value),onMouseUp:()=>_("volume")}),t(ul,{className:zt(r.volumeTrax<50&&"text-muted","fa-icon")})]})]})]})]})]})},C1=i=>{const{trigger:e=null,furniIds:n=[]}=Te();return l(T,{gap:1,children:[t(N,{bold:!0,children:h("wiredfurni.pickfurnis.caption",["count","limit"],[n.length.toString(),e.maximumItemSelectionCount.toString()])}),t(N,{small:!0,children:h("wiredfurni.pickfurnis.desc")})]})},$c=i=>{const{wiredType:e="",requiresFurni:n=de.STUFF_SELECTION_OPTION_NONE,save:r=null,validate:s=null,children:a=null,hasSpecialInput:c=!1}=i,[u,d]=o.useState(null),[g,m]=o.useState(null),[f,p]=o.useState(!1),{trigger:_=null,setTrigger:E=null,setIntParams:C=null,setStringParam:I=null,setFurniIds:b=null,setAllowsFurni:S=null,saveWired:v=null}=Te(),y=()=>E(null),R=()=>{s&&!s()||(r&&r(),p(!0))};return o.useEffect(()=>{f&&(v(),p(!1))},[f,v]),o.useEffect(()=>{if(!_)return;const O=_.spriteId||-1,F=W().getFloorItemData(O);F?(d(F.name),m(F.description)):(d("NAME: "+O),m("NAME: "+O)),c&&(C(_.intData),I(_.stringData)),n>de.STUFF_SELECTION_OPTION_NONE&&b(U=>(U&&U.length&&Ts.clearSelectionShaderFromFurni(U),_.selectedItems&&_.selectedItems.length?(Ts.applySelectionShaderToFurni(_.selectedItems),_.selectedItems):[])),S(n)},[_,c,n,C,I,b,S]),l(ie,{uniqueKey:"nitro-wired",className:"nitro-wired",theme:"primary-slim",children:[t(ae,{headerText:h("wiredfurni.title"),onCloseClick:y}),l(re,{children:[l(T,{gap:1,children:[l(w,{alignItems:"center",gap:1,children:[t("i",{className:`icon icon-wired-${e}`}),t(N,{bold:!0,children:u})]}),t(N,{small:!0,children:g})]}),!!a&&t("hr",{className:"m-0 bg-dark"}),a,n>de.STUFF_SELECTION_OPTION_NONE&&l(B,{children:[t("hr",{className:"m-0 bg-dark"}),t(C1,{})]}),l(w,{alignItems:"center",gap:1,children:[t(M,{fullWidth:!0,variant:"success",onClick:R,children:h("wiredfurni.ready")}),t(M,{fullWidth:!0,variant:"secondary",onClick:y,children:h("cancel")})]})]})]})},mt=i=>{const{requiresFurni:e=de.STUFF_SELECTION_OPTION_NONE,save:n=null,hasSpecialInput:r=!1,children:s=null}=i,{trigger:a=null,actionDelay:c=0,setActionDelay:u=null}=Te();return o.useEffect(()=>{u(a.delayInPulses)},[a,u]),l($c,{wiredType:"action",requiresFurni:e,save:n,hasSpecialInput:r,children:[s,!!s&&t("hr",{className:"m-0 bg-dark"}),l(T,{children:[t(N,{bold:!0,children:h("wiredfurni.params.delay",["seconds"],[li(c)])}),t(Mt,{className:"nitro-slider",min:0,max:20,value:c,onChange:d=>u(d)})]})]})},_1="hd-180-1.ch-210-66.lg-270-82.sh-290-81",b1=i=>{const[e,n]=o.useState(""),[r,s]=o.useState(""),{trigger:a=null,setStringParam:c=null}=Te(),u=()=>c(e+la+r);return o.useEffect(()=>{const d=a.stringData.split(la);d.length>0&&n(d[0]),d.length>1&&s(d[1].length>0?d[1]:_1)},[a]),l(mt,{requiresFurni:de.STUFF_SELECTION_OPTION_NONE,hasSpecialInput:!0,save:u,children:[l(T,{gap:1,children:[t(N,{bold:!0,children:h("wiredfurni.params.bot.name")}),t("input",{type:"text",className:"form-control form-control-sm",maxLength:32,value:e,onChange:d=>n(d.target.value)})]}),l(w,{center:!0,children:[t(it,{figure:r,direction:4}),t(M,{onClick:d=>s(W().figure),children:h("wiredfurni.params.capture.figure")})]})]})},S1=i=>{const[e,n]=o.useState(""),[r,s]=o.useState(-1),{trigger:a=null,setStringParam:c=null,setIntParams:u=null}=Te(),d=()=>{c(e),u([r])};return o.useEffect(()=>{n(a.stringData),s(a.intData.length>0?a.intData[0]:0)},[a]),l(mt,{requiresFurni:de.STUFF_SELECTION_OPTION_NONE,hasSpecialInput:!0,save:d,children:[l(T,{gap:1,children:[t(N,{bold:!0,children:h("wiredfurni.params.bot.name")}),t("input",{type:"text",className:"form-control form-control-sm",maxLength:32,value:e,onChange:g=>n(g.target.value)})]}),l(T,{gap:1,children:[l(w,{alignItems:"center",gap:1,children:[t("input",{className:"form-check-input",type:"radio",name:"followMode",id:"followMode1",checked:r===1,onChange:g=>s(1)}),t(N,{children:h("wiredfurni.params.start.following")})]}),l(w,{alignItems:"center",gap:1,children:[t("input",{className:"form-check-input",type:"radio",name:"followMode",id:"followMode2",checked:r===0,onChange:g=>s(0)}),t(N,{children:h("wiredfurni.params.stop.following")})]})]})]})},N1=[2,5,7,8,9,10,27],T1=i=>{const[e,n]=o.useState(""),[r,s]=o.useState(-1),{trigger:a=null,setStringParam:c=null,setIntParams:u=null}=Te(),d=()=>{c(e),u([r])};return o.useEffect(()=>{n(a.stringData),s(a.intData.length>0?a.intData[0]:0)},[a]),l(mt,{requiresFurni:de.STUFF_SELECTION_OPTION_NONE,hasSpecialInput:!0,save:d,children:[l(T,{gap:1,children:[t(N,{bold:!0,children:h("wiredfurni.params.bot.name")}),t("input",{type:"text",className:"form-control form-control-sm",maxLength:32,value:e,onChange:g=>n(g.target.value)})]}),l(T,{gap:1,children:[t(N,{bold:!0,children:h("wiredfurni.params.handitem")}),l("select",{className:"form-select form-select-sm",value:r,onChange:g=>s(parseInt(g.target.value)),children:[t("option",{value:"0",children:"------"}),N1.map(g=>t("option",{value:g,children:h(`handitem${g}`)},g))]})]})]})},v1=i=>{const[e,n]=o.useState(""),{trigger:r=null,setStringParam:s=null}=Te(),a=()=>s(e);return o.useEffect(()=>{n(r.stringData)},[r]),t(mt,{requiresFurni:de.STUFF_SELECTION_OPTION_BY_ID,hasSpecialInput:!0,save:a,children:l(T,{gap:1,children:[t(N,{bold:!0,children:h("wiredfurni.params.bot.name")}),t("input",{type:"text",className:"form-control form-control-sm",maxLength:32,value:e,onChange:c=>n(c.target.value)})]})})},w1=i=>{const[e,n]=o.useState(""),[r,s]=o.useState(""),[a,c]=o.useState(-1),{trigger:u=null,setStringParam:d=null,setIntParams:g=null}=Te(),m=()=>{d(e+la+r),g([a])};return o.useEffect(()=>{const f=u.stringData.split(la);f.length>0&&n(f[0]),f.length>1&&s(f[1].length>0?f[1]:""),c(u.intData.length>0?u.intData[0]:0)},[u]),l(mt,{requiresFurni:de.STUFF_SELECTION_OPTION_NONE,hasSpecialInput:!0,save:m,children:[l(T,{gap:1,children:[t(N,{bold:!0,children:h("wiredfurni.params.bot.name")}),t("input",{type:"text",className:"form-control form-control-sm",maxLength:32,value:e,onChange:f=>n(f.target.value)})]}),l(T,{gap:1,children:[t(N,{bold:!0,children:h("wiredfurni.params.message")}),t("input",{type:"text",className:"form-control form-control-sm",maxLength:K("wired.action.bot.talk.to.avatar.max.length",64),value:r,onChange:f=>s(f.target.value)})]}),l(T,{gap:1,children:[l(w,{alignItems:"center",gap:1,children:[t("input",{className:"form-check-input",type:"radio",name:"talkMode",id:"talkMode1",checked:a===0,onChange:f=>c(0)}),t(N,{children:h("wiredfurni.params.talk")})]}),l(w,{alignItems:"center",gap:1,children:[t("input",{className:"form-check-input",type:"radio",name:"talkMode",id:"talkMode2",checked:a===1,onChange:f=>c(1)}),t(N,{children:h("wiredfurni.params.whisper")})]})]})]})},R1=i=>{const[e,n]=o.useState(""),[r,s]=o.useState(""),[a,c]=o.useState(-1),{trigger:u=null,setStringParam:d=null,setIntParams:g=null}=Te(),m=()=>{d(e+la+r),g([a])};return o.useEffect(()=>{const f=u.stringData.split(la);f.length>0&&n(f[0]),f.length>1&&s(f[1].length>0?f[1]:""),c(u.intData.length>0?u.intData[0]:0)},[u]),l(mt,{requiresFurni:de.STUFF_SELECTION_OPTION_NONE,hasSpecialInput:!0,save:m,children:[l(T,{gap:1,children:[t(N,{bold:!0,children:h("wiredfurni.params.bot.name")}),t("input",{type:"text",className:"form-control form-control-sm",maxLength:32,value:e,onChange:f=>n(f.target.value)})]}),l(T,{gap:1,children:[t(N,{bold:!0,children:h("wiredfurni.params.message")}),t("input",{type:"text",className:"form-control form-control-sm",maxLength:K("wired.action.bot.talk.max.length",64),value:r,onChange:f=>s(f.target.value)})]}),l(T,{gap:1,children:[l(w,{alignItems:"center",gap:1,children:[t("input",{className:"form-check-input",type:"radio",name:"talkMode",id:"talkMode1",checked:a===0,onChange:f=>c(0)}),t(N,{children:h("wiredfurni.params.talk")})]}),l(w,{alignItems:"center",gap:1,children:[t("input",{className:"form-check-input",type:"radio",name:"talkMode",id:"talkMode2",checked:a===1,onChange:f=>c(1)}),t(N,{children:h("wiredfurni.params.shout")})]})]})]})},O1=i=>{const[e,n]=o.useState(""),{trigger:r=null,setStringParam:s=null}=Te(),a=()=>s(e);return o.useEffect(()=>{n(r.stringData)},[r]),t(mt,{requiresFurni:de.STUFF_SELECTION_OPTION_BY_ID,hasSpecialInput:!0,save:a,children:l(T,{gap:1,children:[t(N,{bold:!0,children:h("wiredfurni.params.bot.name")}),t("input",{type:"text",className:"form-control form-control-sm",maxLength:32,value:e,onChange:c=>n(c.target.value)})]})})},y1=i=>t(mt,{requiresFurni:de.STUFF_SELECTION_OPTION_BY_ID_BY_TYPE_OR_FROM_CONTEXT,hasSpecialInput:!1,save:null}),k1=i=>t(mt,{requiresFurni:de.STUFF_SELECTION_OPTION_BY_ID_BY_TYPE_OR_FROM_CONTEXT,hasSpecialInput:!1,save:null}),A1=i=>{const[e,n]=o.useState(""),{trigger:r=null,setStringParam:s=null}=Te(),a=()=>s(e);return o.useEffect(()=>{n(r.stringData)},[r]),t(mt,{requiresFurni:de.STUFF_SELECTION_OPTION_NONE,hasSpecialInput:!0,save:a,children:l(T,{gap:1,children:[t(N,{bold:!0,children:h("wiredfurni.params.message")}),t("input",{type:"text",className:"form-control form-control-sm",value:e,onChange:c=>n(c.target.value),maxLength:K("wired.action.chat.max.length",100)})]})})},D1=i=>t(mt,{requiresFurni:de.STUFF_SELECTION_OPTION_BY_ID_BY_TYPE_OR_FROM_CONTEXT,hasSpecialInput:!1,save:null}),P1=i=>{const[e,n]=o.useState(!1),[r,s]=o.useState(1),[a,c]=o.useState(!1),[u,d]=o.useState(1),[g,m]=o.useState(1),[f,p]=o.useState([]),{trigger:_=null,setIntParams:E=null,setStringParam:C=null}=Te(),I=()=>p(y=>[...y,{isBadge:!1,itemCode:"",probability:null}]),b=y=>{p(R=>{const O=Array.from(R);return O.splice(y,1),O})},S=(y,R,O,F)=>{const U=Array.from(f),A=U[y];A&&(A.isBadge=R,A.itemCode=O,A.probability=F,p(U))},v=()=>{let y=[];for(const R of f){if(!R.itemCode)continue;const O=[R.isBadge?"0":"1",R.itemCode,R.probability.toString()];y.push(O.join(","))}y.length>0&&(C(y.join(";")),E([r,a?1:0,u,g]))};return o.useEffect(()=>{const y=[];if(_.stringData.length>0&&_.stringData.includes(";")){const R=_.stringData.split(";");for(const O of R){const F=O.split(",");F.length===3&&y.push({isBadge:F[0]==="0",itemCode:F[1],probability:Number(F[2])})}}y.length===0&&y.push({isBadge:!1,itemCode:"",probability:null}),s(_.intData.length>0?_.intData[0]:0),c(_.intData.length>1?_.intData[1]===1:!1),d(_.intData.length>2?_.intData[2]:0),m(_.intData.length>3?_.intData[3]:0),n(_.intData.length>3?_.intData[3]>0:!1),p(y)},[_]),l(mt,{requiresFurni:de.STUFF_SELECTION_OPTION_NONE,hasSpecialInput:!0,save:v,children:[l(w,{alignItems:"center",gap:1,children:[t("input",{className:"form-check-input",type:"checkbox",id:"limitEnabled",onChange:y=>n(y.target.checked)}),t(N,{children:h("wiredfurni.params.prizelimit",["amount"],[e?u.toString():""])})]}),!e&&t(N,{center:!0,small:!0,className:"bg-muted rounded p-1",children:"Reward limit not set. Make sure rewards are badges or non-tradeable items."}),e&&t(Mt,{className:"nitro-slider",min:1,max:1e3,value:u,onChange:y=>d(y)}),t("hr",{className:"m-0 bg-dark"}),l(T,{gap:1,children:[t(N,{bold:!0,children:"How often can a user be rewarded?"}),l(w,{gap:1,children:[l("select",{className:"form-select form-select-sm w-100",value:r,onChange:y=>s(Number(y.target.value)),children:[t("option",{value:"0",children:"Once"}),l("option",{value:"3",children:["Once every ",g," minutes"]}),l("option",{value:"2",children:["Once every ",g," hours"]}),l("option",{value:"1",children:["Once every ",g," days"]})]}),r>0&&t("input",{type:"number",className:"form-control form-control-sm",value:g,onChange:y=>m(Number(y.target.value))})]})]}),t("hr",{className:"m-0 bg-dark"}),l(w,{alignItems:"center",gap:1,children:[t("input",{className:"form-check-input",type:"checkbox",id:"uniqueRewards",checked:a,onChange:y=>c(y.target.checked)}),t(N,{children:"Unique rewards"})]}),t(N,{center:!0,small:!0,className:"bg-muted rounded p-1",children:"If checked each reward will be given once to each user. This will disable the probabilities option."}),t("hr",{className:"m-0 bg-dark"}),l(w,{justifyContent:"between",alignItems:"center",children:[t(N,{bold:!0,children:"Rewards"}),t(M,{variant:"success",onClick:I,children:t(ei,{className:"fa-icon"})})]}),t(T,{gap:1,children:f&&f.map((y,R)=>l(w,{gap:1,children:[l(w,{alignItems:"center",gap:1,children:[t("input",{className:"form-check-input",type:"checkbox",checked:y.isBadge,onChange:O=>S(R,O.target.checked,y.itemCode,y.probability)}),t(N,{small:!0,children:"Badge?"})]}),t("input",{type:"text",className:"form-control form-control-sm",value:y.itemCode,onChange:O=>S(R,y.isBadge,O.target.value,y.probability),placeholder:"Item Code"}),t("input",{type:"number",className:"form-control form-control-sm",value:y.probability,onChange:O=>S(R,y.isBadge,y.itemCode,Number(O.target.value)),placeholder:"Probability"}),R>0&&t(M,{variant:"danger",onClick:O=>b(R),children:t(Ec,{className:"fa-icon"})})]},R))})]})},L1=i=>{const[e,n]=o.useState(1),[r,s]=o.useState(1),[a,c]=o.useState(1),{trigger:u=null,setIntParams:d=null}=Te(),g=()=>d([e,r,a]);return o.useEffect(()=>{u.intData.length>=2?(n(u.intData[0]),s(u.intData[1]),c(u.intData[2])):(n(1),s(1),c(1))},[u]),l(mt,{requiresFurni:de.STUFF_SELECTION_OPTION_NONE,hasSpecialInput:!0,save:g,children:[l(T,{gap:1,children:[t(N,{bold:!0,children:h("wiredfurni.params.setpoints",["points"],[e.toString()])}),t(Mt,{className:"nitro-slider",min:1,max:100,value:e,onChange:m=>n(m)})]}),l(T,{gap:1,children:[t(N,{bold:!0,children:h("wiredfurni.params.settimesingame",["times"],[r.toString()])}),t(Mt,{className:"nitro-slider",min:1,max:10,value:r,onChange:m=>s(m)})]}),l(T,{gap:1,children:[t(N,{bold:!0,children:h("wiredfurni.params.team")}),[1,2,3,4].map(m=>l(w,{gap:1,children:[t("input",{className:"form-check-input",type:"radio",name:"selectedTeam",id:`selectedTeam${m}`,checked:a===m,onChange:f=>c(m)}),t(N,{children:h("wiredfurni.params.team."+m)})]},m))]})]})},M1=i=>{const[e,n]=o.useState(1),[r,s]=o.useState(1),{trigger:a=null,setIntParams:c=null}=Te(),u=()=>c([e,r]);return o.useEffect(()=>{a.intData.length>=2?(n(a.intData[0]),s(a.intData[1])):(n(1),s(1))},[a]),l(mt,{requiresFurni:de.STUFF_SELECTION_OPTION_NONE,hasSpecialInput:!0,save:u,children:[l(T,{gap:1,children:[t(N,{bold:!0,children:h("wiredfurni.params.setpoints",["points"],[e.toString()])}),t(Mt,{className:"nitro-slider",min:1,max:100,value:e,onChange:d=>n(d)})]}),l(T,{gap:1,children:[t(N,{bold:!0,children:h("wiredfurni.params.settimesingame",["times"],[r.toString()])}),t(Mt,{className:"nitro-slider",min:1,max:10,value:r,onChange:d=>s(d)})]})]})},U1=i=>{const[e,n]=o.useState(-1),{trigger:r=null,setIntParams:s=null}=Te(),a=()=>s([e]);return o.useEffect(()=>{n(r.intData.length>0?r.intData[0]:0)},[r]),t(mt,{requiresFurni:de.STUFF_SELECTION_OPTION_NONE,hasSpecialInput:!0,save:a,children:l(T,{gap:1,children:[t(N,{bold:!0,children:h("wiredfurni.params.team")}),[1,2,3,4].map(c=>l(w,{gap:1,children:[t("input",{className:"form-check-input",type:"radio",name:"selectedTeam",id:`selectedTeam${c}`,checked:e===c,onChange:u=>n(c)}),t(N,{children:h(`wiredfurni.params.team.${c}`)})]},c))]})})},x1=i=>{const[e,n]=o.useState(""),{trigger:r=null,setStringParam:s=null}=Te(),a=()=>s(e);return o.useEffect(()=>{n(r.stringData)},[r]),t(mt,{requiresFurni:de.STUFF_SELECTION_OPTION_NONE,hasSpecialInput:!0,save:a,children:l(T,{gap:1,children:[t(N,{bold:!0,children:h("wiredfurni.params.message")}),t("input",{type:"text",className:"form-control form-control-sm",value:e,onChange:c=>n(c.target.value),maxLength:K("wired.action.kick.from.room.max.length",100)})]})})},F1=i=>t(mt,{requiresFurni:de.STUFF_SELECTION_OPTION_NONE,hasSpecialInput:!1,save:null}),G1=[{value:0,icon:"ne"},{value:2,icon:"se"},{value:4,icon:"sw"},{value:6,icon:"nw"}],V1=[0,1,2,3,4,5,6],B1=i=>{const[e,n]=o.useState(-1),[r,s]=o.useState(-1),{trigger:a=null,setIntParams:c=null}=Te(),u=()=>c([e,r]);return o.useEffect(()=>{a.intData.length>=2?(n(a.intData[0]),s(a.intData[1])):(n(-1),s(-1))},[a]),l(mt,{requiresFurni:de.STUFF_SELECTION_OPTION_BY_ID_BY_TYPE_OR_FROM_CONTEXT,hasSpecialInput:!0,save:u,children:[l(T,{gap:1,children:[t(N,{bold:!0,children:h("wiredfurni.params.startdir")}),t(w,{gap:1,children:G1.map(d=>l(w,{alignItems:"center",gap:1,children:[t("input",{className:"form-check-input",type:"radio",name:"movement",id:`movement${d.value}`,checked:e===d.value,onChange:g=>n(d.value)}),t(N,{children:t("i",{className:`icon icon-${d.icon}`})})]},d.value))})]}),l(T,{gap:1,children:[t(N,{bold:!0,children:h("wiredfurni.params.turn")}),V1.map(d=>l(w,{alignItems:"center",gap:1,children:[t("input",{className:"form-check-input",type:"radio",name:"rotation",id:`rotation${d}`,checked:r===d,onChange:g=>s(d)}),t(N,{children:h(`wiredfurni.params.turn.${d}`)})]},d))]})]})},H1=[{value:0,icon:"ne"},{value:2,icon:"se"},{value:4,icon:"sw"},{value:6,icon:"nw"}],W1=i=>{const[e,n]=o.useState(-1),[r,s]=o.useState(-1),{trigger:a=null,setIntParams:c=null}=Te(),u=()=>c([r,e]);return o.useEffect(()=>{a.intData.length>=2?(n(a.intData[1]),s(a.intData[0])):(n(-1),s(-1))},[a]),l(mt,{requiresFurni:de.STUFF_SELECTION_OPTION_BY_ID_OR_BY_TYPE,hasSpecialInput:!0,save:u,children:[l(T,{gap:1,children:[t(N,{bold:!0,children:h("wiredfurni.params.emptytiles",["tiles"],[e.toString()])}),t(Mt,{className:"nitro-slider",min:1,max:5,value:e,onChange:d=>n(d)})]}),l(T,{gap:1,children:[t(N,{bold:!0,children:h("wiredfurni.params.startdir")}),t(w,{gap:1,children:H1.map(d=>l(w,{alignItems:"center",gap:1,children:[t("input",{className:"form-check-input",type:"radio",name:"movement",id:`movement${d.value}`,checked:r===d.value,onChange:g=>s(d.value)}),t(N,{children:t("i",{className:`icon icon-${d.icon}`})})]},d.value))})]})]})},j1=[{value:4,icon:"ne"},{value:5,icon:"se"},{value:6,icon:"sw"},{value:7,icon:"nw"},{value:2,icon:"mv-2"},{value:3,icon:"mv-3"},{value:1,icon:"mv-1"}],q1=[0,1,2,3],z1=i=>{const[e,n]=o.useState(-1),[r,s]=o.useState(-1),{trigger:a=null,setIntParams:c=null}=Te(),u=()=>c([e,r]);return o.useEffect(()=>{a.intData.length>=2?(n(a.intData[0]),s(a.intData[1])):(n(-1),s(-1))},[a]),l(mt,{requiresFurni:de.STUFF_SELECTION_OPTION_BY_ID_BY_TYPE_OR_FROM_CONTEXT,hasSpecialInput:!0,save:u,children:[l(T,{gap:1,children:[t(N,{bold:!0,children:h("wiredfurni.params.movefurni")}),l(w,{alignItems:"center",gap:1,children:[t("input",{className:"form-check-input",type:"radio",name:"selectedTeam",id:"movement0",checked:e===0,onChange:d=>n(0)}),t(N,{children:h("wiredfurni.params.movefurni.0")})]}),l(w,{gap:1,children:[j1.map(d=>l(w,{alignItems:"center",gap:1,children:[t("input",{className:"form-check-input",type:"radio",name:"movement",id:`movement${d.value}`,checked:e===d.value,onChange:g=>n(d.value)}),t("i",{className:`icon icon-${d.icon}`})]},d.value)),t("div",{className:"col"})]})]}),l(T,{gap:1,children:[t(N,{bold:!0,children:h("wiredfurni.params.rotatefurni")}),q1.map(d=>l(w,{alignItems:"center",gap:1,children:[t("input",{className:"form-check-input",type:"radio",name:"rotation",id:`rotation${d}`,checked:r===d,onChange:g=>s(d)}),l(N,{children:[[1,2].includes(d)&&t("i",{className:`icon icon-rot-${d}`}),h(`wiredfurni.params.rotatefurni.${d}`)]})]},d))]})]})},Y1=i=>{const[e,n]=o.useState(-1),[r,s]=o.useState(""),{trigger:a=null,setIntParams:c=null,setStringParam:u=null}=Te(),d=()=>{c([e]),u(r)};return o.useEffect(()=>{n(a.intData.length>0?a.intData[0]:0),s(a.stringData)},[a]),l(mt,{requiresFurni:de.STUFF_SELECTION_OPTION_NONE,hasSpecialInput:!0,save:d,children:[l(T,{gap:1,children:[t(N,{bold:!0,children:h("wiredfurni.params.length.minutes",["minutes"],[e.toString()])}),t(Mt,{className:"nitro-slider",min:1,max:10,value:e,onChange:g=>n(g)})]}),l(T,{gap:1,children:[t(N,{bold:!0,children:h("wiredfurni.params.message")}),t("input",{type:"text",className:"form-control form-control-sm",value:r,onChange:g=>s(g.target.value),maxLength:K("wired.action.mute.user.max.length",100)})]})]})},$1=i=>t(mt,{requiresFurni:de.STUFF_SELECTION_OPTION_NONE,hasSpecialInput:!1,save:null}),K1=i=>{const[e,n]=o.useState(0),[r,s]=o.useState(0),[a,c]=o.useState(0),{trigger:u=null,setIntParams:d=null}=Te(),g=()=>d([e,r,a]);return o.useEffect(()=>{n(u.getBoolean(0)?1:0),s(u.getBoolean(1)?1:0),c(u.getBoolean(2)?1:0)},[u]),t(mt,{requiresFurni:de.STUFF_SELECTION_OPTION_BY_ID,hasSpecialInput:!0,save:g,children:l(T,{gap:1,children:[t(N,{bold:!0,children:h("wiredfurni.params.conditions")}),l(w,{alignItems:"center",gap:1,children:[t("input",{className:"form-check-input",type:"checkbox",id:"stateFlag",checked:!!e,onChange:m=>n(m.target.checked?1:0)}),t(N,{children:h("wiredfurni.params.condition.state")})]}),l(w,{alignItems:"center",gap:1,children:[t("input",{className:"form-check-input",type:"checkbox",id:"directionFlag",checked:!!r,onChange:m=>s(m.target.checked?1:0)}),t(N,{children:h("wiredfurni.params.condition.direction")})]}),l(w,{alignItems:"center",gap:1,children:[t("input",{className:"form-check-input",type:"checkbox",id:"positionFlag",checked:!!a,onChange:m=>c(m.target.checked?1:0)}),t(N,{children:h("wiredfurni.params.condition.position")})]})]})})},X1=i=>t(mt,{requiresFurni:de.STUFF_SELECTION_OPTION_BY_ID_BY_TYPE_OR_FROM_CONTEXT,hasSpecialInput:!1,save:null}),Q1=i=>t(mt,{requiresFurni:de.STUFF_SELECTION_OPTION_BY_ID_BY_TYPE_OR_FROM_CONTEXT,hasSpecialInput:!1,save:null}),J1=i=>{switch(i){case tt.BOT_CHANGE_FIGURE:return t(b1,{});case tt.BOT_FOLLOW_AVATAR:return t(S1,{});case tt.BOT_GIVE_HAND_ITEM:return t(T1,{});case tt.BOT_MOVE:return t(v1,{});case tt.BOT_TALK:return t(R1,{});case tt.BOT_TALK_DIRECT_TO_AVTR:return t(w1,{});case tt.BOT_TELEPORT:return t(O1,{});case tt.CALL_ANOTHER_STACK:return t(y1,{});case tt.CHASE:return t(k1,{});case tt.CHAT:return t(A1,{});case tt.FLEE:return t(D1,{});case tt.GIVE_REWARD:return t(P1,{});case tt.GIVE_SCORE:return t(M1,{});case tt.GIVE_SCORE_TO_PREDEFINED_TEAM:return t(L1,{});case tt.JOIN_TEAM:return t(U1,{});case tt.KICK_FROM_ROOM:return t(x1,{});case tt.LEAVE_TEAM:return t(F1,{});case tt.MOVE_FURNI:return t(z1,{});case tt.MOVE_AND_ROTATE_FURNI:return t(B1,{});case tt.MOVE_FURNI_TO:return t(W1,{});case tt.MUTE_USER:return t(Y1,{});case tt.RESET:return t($1,{});case tt.SET_FURNI_STATE:return t(K1,{});case tt.TELEPORT:return t(X1,{});case tt.TOGGLE_FURNI_STATE:return t(Q1,{})}return null},gn=i=>{const{requiresFurni:e=de.STUFF_SELECTION_OPTION_NONE,save:n=null,hasSpecialInput:r=!1,children:s=null}=i;return t($c,{wiredType:"condition",requiresFurni:e,hasSpecialInput:r,save:()=>n&&n(),children:s})},Z1=[2,5,7,8,9,10,27],eA=i=>{const[e,n]=o.useState(-1),{trigger:r=null,setIntParams:s=null}=Te(),a=()=>s([e]);return o.useEffect(()=>{n(r.intData.length>0?r.intData[0]:0)},[r]),t(gn,{requiresFurni:de.STUFF_SELECTION_OPTION_NONE,hasSpecialInput:!0,save:a,children:l(T,{gap:1,children:[t(N,{bold:!0,children:h("wiredfurni.params.handitem")}),t("select",{className:"form-select form-select-sm",value:e,onChange:c=>n(parseInt(c.target.value)),children:Z1.map(c=>t("option",{value:c,children:h(`handitem${c}`)},c))})]})})},tA=i=>t(gn,{requiresFurni:de.STUFF_SELECTION_OPTION_NONE,hasSpecialInput:!1,save:null}),nA=i=>t(gn,{requiresFurni:de.STUFF_SELECTION_OPTION_BY_ID,hasSpecialInput:!1,save:null}),rA=[1,2,3,4],sA=i=>{const[e,n]=o.useState(-1),{trigger:r=null,setIntParams:s=null}=Te(),a=()=>s([e]);return o.useEffect(()=>{n(r.intData.length>0?r.intData[0]:0)},[r]),t(gn,{requiresFurni:de.STUFF_SELECTION_OPTION_NONE,hasSpecialInput:!0,save:a,children:l(T,{gap:1,children:[t(N,{bold:!0,children:h("wiredfurni.params.team")}),rA.map(c=>l(w,{gap:1,alignItems:"center",children:[t("input",{className:"form-check-input",type:"radio",name:"selectedTeam",id:`selectedTeam${c}`,checked:e===c,onChange:u=>n(c)}),t(N,{children:h(`wiredfurni.params.team.${c}`)})]},c))]})})},aA=i=>{const[e,n]=o.useState(""),{trigger:r=null,setStringParam:s=null}=Te(),a=()=>s(e);return o.useEffect(()=>{n(r.stringData)},[r]),t(gn,{requiresFurni:de.STUFF_SELECTION_OPTION_NONE,hasSpecialInput:!0,save:a,children:l(T,{gap:1,children:[t(N,{bold:!0,children:h("wiredfurni.params.badgecode")}),t("input",{type:"text",className:"form-control form-control-sm",value:e,onChange:c=>n(c.target.value)})]})})},iA=i=>{const[e,n]=o.useState(-1),{trigger:r=null,setIntParams:s=null}=Te(),a=()=>s([e]);return o.useEffect(()=>{n((r==null?void 0:r.intData[0])??0)},[r]),t(gn,{requiresFurni:de.STUFF_SELECTION_OPTION_NONE,hasSpecialInput:!0,save:a,children:l(T,{gap:1,children:[t(N,{bold:!0,children:h("wiredfurni.tooltip.effectid")}),t("input",{type:"number",className:"form-control form-control-sm",value:e,onChange:c=>n(parseInt(c.target.value))})]})})},oA=i=>{const[e,n]=o.useState(""),[r,s]=o.useState(""),{trigger:a=null,setIntParams:c=null}=Te(),u=()=>{let d=0,g=0;const m=new Date(e),f=new Date(r);m&&f&&(d=m.getTime()/1e3,g=f.getTime()/1e3),c([d,g])};return o.useEffect(()=>{if(a.intData.length>=2){let d=new Date,g=new Date;a.intData[0]>0&&(d=new Date(a.intData[0]*1e3)),a.intData[1]>0&&(g=new Date(a.intData[1]*1e3)),n(Bu(d)),s(Bu(g))}},[a]),l(gn,{requiresFurni:de.STUFF_SELECTION_OPTION_NONE,hasSpecialInput:!0,save:u,children:[l(T,{gap:1,children:[t(N,{bold:!0,children:h("wiredfurni.params.startdate")}),t("input",{type:"text",className:"form-control form-control-sm",value:e,onChange:d=>n(d.target.value)})]}),l(T,{gap:1,children:[t(N,{bold:!0,children:h("wiredfurni.params.enddate")}),t("input",{type:"text",className:"form-control form-control-sm",value:r,onChange:d=>s(d.target.value)})]})]})},lA=i=>t(gn,{requiresFurni:de.STUFF_SELECTION_OPTION_BY_ID,hasSpecialInput:!1,save:null}),cA=i=>{const[e,n]=o.useState(-1),{trigger:r=null,setIntParams:s=null}=Te(),a=()=>s([e]);return o.useEffect(()=>{n(r.intData.length>0?r.intData[0]:0)},[r]),t(gn,{requiresFurni:de.STUFF_SELECTION_OPTION_BY_ID,hasSpecialInput:!0,save:a,children:l(T,{gap:1,children:[t(N,{bold:!0,children:h("wiredfurni.params.requireall")}),[0,1].map(c=>l(w,{alignItems:"center",gap:1,children:[t("input",{className:"form-check-input",type:"radio",name:"requireAll",id:`requireAll${c}`,checked:e===c,onChange:u=>n(c)}),t(N,{children:h("wiredfurni.params.requireall."+c)})]},c))]})})},uA=i=>{const[e,n]=o.useState(-1),{trigger:r=null,setIntParams:s=null}=Te(),a=()=>s([e]);return o.useEffect(()=>{n(r.intData.length>0?r.intData[0]:0)},[r]),t(gn,{requiresFurni:de.STUFF_SELECTION_OPTION_BY_ID,hasSpecialInput:!0,save:a,children:l(T,{gap:1,children:[t(N,{bold:!0,children:h("wiredfurni.params.not_requireall")}),[0,1].map(c=>l(w,{alignItems:"center",gap:1,children:[t("input",{className:"form-check-input",type:"radio",name:"requireAll",id:`requireAll${c}`,checked:e===c,onChange:u=>n(c)}),t(N,{children:h(`wiredfurni.params.not_requireall.${c}`)})]},c))]})})},dA=i=>t(gn,{requiresFurni:de.STUFF_SELECTION_OPTION_BY_ID_OR_BY_TYPE,hasSpecialInput:!1,save:null}),mA=i=>{const[e,n]=o.useState(0),[r,s]=o.useState(0),[a,c]=o.useState(0),{trigger:u=null,setIntParams:d=null}=Te(),g=()=>d([e,r,a]);return o.useEffect(()=>{n(u.getBoolean(0)?1:0),s(u.getBoolean(1)?1:0),c(u.getBoolean(2)?1:0)},[u]),t(gn,{requiresFurni:de.STUFF_SELECTION_OPTION_BY_ID,hasSpecialInput:!0,save:g,children:l(T,{gap:1,children:[t(N,{bold:!0,children:h("wiredfurni.params.conditions")}),l(w,{alignItems:"center",gap:1,children:[t("input",{className:"form-check-input",type:"checkbox",id:"stateFlag",checked:!!e,onChange:m=>n(m.target.checked?1:0)}),t(N,{children:h("wiredfurni.params.condition.state")})]}),l(w,{alignItems:"center",gap:1,children:[t("input",{className:"form-check-input",type:"checkbox",id:"directionFlag",checked:!!r,onChange:m=>s(m.target.checked?1:0)}),t(N,{children:h("wiredfurni.params.condition.direction")})]}),l(w,{alignItems:"center",gap:1,children:[t("input",{className:"form-check-input",type:"checkbox",id:"positionFlag",checked:!!a,onChange:m=>c(m.target.checked?1:0)}),t(N,{children:h("wiredfurni.params.condition.position")})]})]})})},hA=i=>{const[e,n]=o.useState(-1),{trigger:r=null,setIntParams:s=null}=Te(),a=()=>s([e]);return o.useEffect(()=>{n(r.intData.length>0?r.intData[0]:0)},[r]),t(gn,{requiresFurni:de.STUFF_SELECTION_OPTION_NONE,hasSpecialInput:!0,save:a,children:l(T,{gap:1,children:[t(N,{bold:!0,children:h("wiredfurni.params.allowbefore",["seconds"],[li(e)])}),t(Mt,{className:"nitro-slider",min:1,max:1200,value:e,onChange:c=>n(c)})]})})},gA=i=>{const[e,n]=o.useState(-1),{trigger:r=null,setIntParams:s=null}=Te(),a=()=>s([e]);return o.useEffect(()=>{n(r.intData.length>0?r.intData[0]:0)},[r]),t(gn,{requiresFurni:de.STUFF_SELECTION_OPTION_NONE,hasSpecialInput:!0,save:a,children:l(T,{gap:1,children:[t(N,{bold:!0,children:h("wiredfurni.params.allowafter",["seconds"],[li(e)])}),t(Mt,{className:"nitro-slider",min:1,max:1200,value:e,onChange:c=>n(c)})]})})},fA=i=>{const[e,n]=o.useState(1),[r,s]=o.useState(1),{trigger:a=null,setIntParams:c=null}=Te(),u=()=>c([e,r]);return o.useEffect(()=>{a.intData.length>=2?(n(a.intData[0]),s(a.intData[1])):(n(1),s(1))},[a]),l(gn,{requiresFurni:de.STUFF_SELECTION_OPTION_NONE,hasSpecialInput:!0,save:u,children:[l(T,{gap:1,children:[t(N,{bold:!0,children:h("wiredfurni.params.usercountmin",["value"],[e.toString()])}),t(Mt,{className:"nitro-slider",min:1,max:50,value:e,onChange:d=>n(d)})]}),l(T,{gap:1,children:[t(N,{bold:!0,children:h("wiredfurni.params.usercountmax",["value"],[r.toString()])}),t(Mt,{className:"nitro-slider",min:1,max:50,value:r,onChange:d=>s(d)})]})]})},pA=i=>{switch(i){case ot.ACTOR_HAS_HANDITEM:return t(eA,{});case ot.ACTOR_IS_GROUP_MEMBER:case ot.NOT_ACTOR_IN_GROUP:return t(tA,{});case ot.ACTOR_IS_ON_FURNI:case ot.NOT_ACTOR_ON_FURNI:return t(nA,{});case ot.ACTOR_IS_IN_TEAM:case ot.NOT_ACTOR_IN_TEAM:return t(sA,{});case ot.ACTOR_IS_WEARING_BADGE:case ot.NOT_ACTOR_WEARS_BADGE:return t(aA,{});case ot.ACTOR_IS_WEARING_EFFECT:case ot.NOT_ACTOR_WEARING_EFFECT:return t(iA,{});case ot.DATE_RANGE_ACTIVE:return t(oA,{});case ot.FURNIS_HAVE_AVATARS:case ot.FURNI_NOT_HAVE_HABBO:return t(lA,{});case ot.HAS_STACKED_FURNIS:return t(cA,{});case ot.NOT_HAS_STACKED_FURNIS:return t(uA,{});case ot.STUFF_TYPE_MATCHES:case ot.NOT_FURNI_IS_OF_TYPE:return t(dA,{});case ot.STATES_MATCH:case ot.NOT_STATES_MATCH:return t(mA,{});case ot.TIME_ELAPSED_LESS:return t(hA,{});case ot.TIME_ELAPSED_MORE:return t(gA,{});case ot.USER_COUNT_IN:case ot.NOT_USER_COUNT_IN:return t(fA,{})}return null},Tn=i=>{const{requiresFurni:e=de.STUFF_SELECTION_OPTION_NONE,save:n=null,hasSpecialInput:r=!1,children:s=null}=i;return t($c,{wiredType:"trigger",requiresFurni:e,hasSpecialInput:r,save:()=>n&&n(),children:s})},IA=i=>{const[e,n]=o.useState(""),[r,s]=o.useState(0),{trigger:a=null,setStringParam:c=null}=Te(),u=()=>c(r===1?e:"");return o.useEffect(()=>{n(a.stringData),s(a.stringData?1:0)},[a]),t(Tn,{requiresFurni:de.STUFF_SELECTION_OPTION_NONE,hasSpecialInput:!0,save:u,children:l(T,{gap:1,children:[t(N,{bold:!0,children:h("wiredfurni.params.picktriggerer")}),l(w,{alignItems:"center",gap:1,children:[t("input",{className:"form-check-input",type:"radio",name:"avatarMode",id:"avatarMode0",checked:r===0,onChange:d=>s(0)}),t(N,{children:h("wiredfurni.params.anyavatar")})]}),l(w,{alignItems:"center",gap:1,children:[t("input",{className:"form-check-input",type:"radio",name:"avatarMode",id:"avatarMode1",checked:r===1,onChange:d=>s(1)}),t(N,{children:h("wiredfurni.params.certainavatar")})]}),r===1&&t("input",{type:"text",className:"form-control form-control-sm",value:e,onChange:d=>n(d.target.value)})]})})},EA=i=>{const[e,n]=o.useState(""),[r,s]=o.useState(-1),{trigger:a=null,setStringParam:c=null,setIntParams:u=null}=Te(),d=()=>{c(e),u([r])};return o.useEffect(()=>{n(a.stringData),s(a.intData.length>0?a.intData[0]:0)},[a]),l(Tn,{requiresFurni:de.STUFF_SELECTION_OPTION_NONE,hasSpecialInput:!0,save:d,children:[l(T,{gap:1,children:[t(N,{bold:!0,children:h("wiredfurni.params.whatissaid")}),t("input",{type:"text",className:"form-control form-control-sm",value:e,onChange:g=>n(g.target.value)})]}),l(T,{gap:1,children:[t(N,{bold:!0,children:h("wiredfurni.params.picktriggerer")}),l(w,{alignItems:"center",gap:1,children:[t("input",{className:"form-check-input",type:"radio",name:"triggererAvatar",id:"triggererAvatar0",checked:r===0,onChange:g=>s(0)}),t(N,{children:h("wiredfurni.params.anyavatar")})]}),l(w,{alignItems:"center",gap:1,children:[t("input",{className:"form-check-input",type:"radio",name:"triggererAvatar",id:"triggererAvatar1",checked:r===1,onChange:g=>s(1)}),t(N,{children:W().userName})]})]})]})},CA=i=>t(Tn,{requiresFurni:de.STUFF_SELECTION_OPTION_BY_ID_OR_BY_TYPE,hasSpecialInput:!1,save:null}),_A=i=>t(Tn,{requiresFurni:de.STUFF_SELECTION_OPTION_BY_ID_OR_BY_TYPE,hasSpecialInput:!1,save:null}),bA=i=>{const[e,n]=o.useState(""),{trigger:r=null,setStringParam:s=null}=Te(),a=()=>s(e);return o.useEffect(()=>{n(r.stringData)},[r]),t(Tn,{requiresFurni:de.STUFF_SELECTION_OPTION_NONE,hasSpecialInput:!0,save:a,children:l(T,{gap:1,children:[t(N,{bold:!0,children:h("wiredfurni.params.bot.name")}),t("input",{type:"text",className:"form-control form-control-sm",maxLength:32,value:e,onChange:c=>n(c.target.value)})]})})},SA=i=>{const[e,n]=o.useState(""),{trigger:r=null,setStringParam:s=null}=Te(),a=()=>s(e);return o.useEffect(()=>{n(r.stringData)},[r]),t(Tn,{requiresFurni:de.STUFF_SELECTION_OPTION_BY_ID_OR_BY_TYPE,hasSpecialInput:!0,save:a,children:l(T,{gap:1,children:[t(N,{bold:!0,children:h("wiredfurni.params.bot.name")}),t("input",{type:"text",className:"form-control form-control-sm",maxLength:32,value:e,onChange:c=>n(c.target.value)})]})})},NA=i=>t(Tn,{requiresFurni:de.STUFF_SELECTION_OPTION_NONE,hasSpecialInput:!1,save:null}),TA=i=>{const[e,n]=o.useState(1),{trigger:r=null,setIntParams:s=null}=Te(),a=()=>s([e]);return o.useEffect(()=>{n(r.intData.length>0?r.intData[0]:0)},[r]),t(Tn,{requiresFurni:de.STUFF_SELECTION_OPTION_NONE,hasSpecialInput:!0,save:a,children:l(T,{gap:1,children:[t(N,{bold:!0,children:h("wiredfurni.params.settime",["seconds"],[li(e)])}),t(Mt,{className:"nitro-slider",min:1,max:1200,value:e,onChange:c=>n(c)})]})})},vA=i=>{const[e,n]=o.useState(1),{trigger:r=null,setIntParams:s=null}=Te(),a=()=>s([e]);return o.useEffect(()=>{n(r.intData.length>0?r.intData[0]:0)},[r]),t(Tn,{requiresFurni:de.STUFF_SELECTION_OPTION_NONE,hasSpecialInput:!0,save:a,children:l(T,{gap:1,children:[t(N,{bold:!0,children:h("wiredfurni.params.setlongtime",["time"],[nr.format(e*5).toString()])}),t(Mt,{className:"nitro-slider",min:1,max:120,value:e,onChange:c=>n(c)})]})})},wA=i=>{const[e,n]=o.useState(1),{trigger:r=null,setIntParams:s=null}=Te(),a=()=>s([e]);return o.useEffect(()=>{n(r.intData.length>0?r.intData[0]:0)},[r]),t(Tn,{requiresFurni:de.STUFF_SELECTION_OPTION_NONE,hasSpecialInput:!0,save:a,children:l(T,{gap:1,children:[t(N,{bold:!0,children:h("wiredfurni.params.settime",["seconds"],[li(e)])}),t(Mt,{className:"nitro-slider",min:1,max:60,value:e,onChange:c=>n(c)})]})})},RA=i=>t(Tn,{requiresFurni:de.STUFF_SELECTION_OPTION_NONE,hasSpecialInput:!1,save:null}),OA=i=>t(Tn,{requiresFurni:de.STUFF_SELECTION_OPTION_NONE,hasSpecialInput:!1,save:null}),yA=i=>{const[e,n]=o.useState(1),{trigger:r=null,setIntParams:s=null}=Te(),a=()=>s([e]);return o.useEffect(()=>{n(r.intData.length>0?r.intData[0]:0)},[r]),t(Tn,{requiresFurni:de.STUFF_SELECTION_OPTION_NONE,hasSpecialInput:!0,save:a,children:l(T,{gap:1,children:[t(N,{bold:!0,children:h("wiredfurni.params.setscore",["points"],[e.toString()])}),t(Mt,{className:"nitro-slider",min:1,max:1e3,value:e,onChange:c=>n(c)})]})})},kA=i=>t(Tn,{requiresFurni:de.STUFF_SELECTION_OPTION_BY_ID_OR_BY_TYPE,hasSpecialInput:!1,save:null}),AA=i=>{switch(i){case Zt.AVATAR_ENTERS_ROOM:return t(IA,{});case Zt.AVATAR_SAYS_SOMETHING:return t(EA,{});case Zt.AVATAR_WALKS_OFF_FURNI:return t(CA,{});case Zt.AVATAR_WALKS_ON_FURNI:return t(_A,{});case Zt.BOT_REACHED_AVATAR:return t(bA,{});case Zt.BOT_REACHED_STUFF:return t(SA,{});case Zt.COLLISION:return t(NA,{});case Zt.EXECUTE_ONCE:return t(TA,{});case Zt.EXECUTE_PERIODICALLY:return t(wA,{});case Zt.EXECUTE_PERIODICALLY_LONG:return t(vA,{});case Zt.GAME_ENDS:return t(RA,{});case Zt.GAME_STARTS:return t(OA,{});case Zt.SCORE_ACHIEVED:return t(yA,{});case Zt.TOGGLE_FURNI:return t(kA,{})}return null},DA=i=>{const{trigger:e=null}=Te();return e?e instanceof bm?J1(e.code):e instanceof Sm?AA(e.code):e instanceof Nm?pA(e.code):null:null},PA=i=>{const[e,n]=o.useState(!1),[r,s]=o.useState(!0);return je(Kt.CREATED,a=>s(!1)),je(Kt.ENDED,a=>s(a.openLandingView)),o.useEffect(()=>{n(!0),Ba().connection.onReady()},[]),o.useEffect(()=>{const a={linkReceived:c=>{const u=c.split("/");if(!(u.length<2))switch(u[1]){case"open":if(u.length>2)switch(u[2]){case"credits":break;default:{const d=u[2];ti.openHabblet(d)}}return}},eventUrlPrefix:"habblet/"};return It(a),()=>Et(a)},[]),l(P,{fit:!0,children:[t(ci,{type:un.FADE_IN,inProp:r,timeout:300,children:t(EO,{})}),t("div",{className:"top-left-icon",onClick:()=>alert("Clicou no cone!"),title:"Opes futuras",children:t("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"currentColor",children:t("path",{d:"M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm-2 15l-5-5 1.41-1.41L10 14.17l7.59-7.59L19 8l-9 9z"})})}),t(P,{id:"chat-input-container"}),t(d1,{isInRoom:!r}),t(zO,{}),t(c1,{}),t($w,{}),t(DA,{}),t(Zv,{}),t(jv,{}),t(oy,{}),t(yO,{}),t(Yw,{}),t(ER,{}),t(AO,{}),t(Dy,{}),t(E1,{}),t(I1,{}),t(MR,{}),t(iw,{}),t(dO,{}),t(cy,{}),t(zR,{}),t(YR,{}),t(cw,{}),t(SR,{}),t(aR,{})]})};am.UI_VERSION=eh();const LA=i=>{const[e,n]=o.useState(!1),[r,s]=o.useState(!1),[a,c]=o.useState("Getting Ready"),[u,d]=o.useState(0),[g,m]=o.useState(!0);if(!_e()){if(!NitroConfig)throw new Error("NitroConfig is not defined!");Bs.bootstrap()}const f=o.useCallback(async p=>{switch(p.type){case Ti.LOADED:_e().localization.init(),d(_=>_+20);return;case Ti.FAILED:s(!0),c("Configuration Failed");return;case Bs.WEBGL_UNAVAILABLE:s(!0),c("WebGL Required");return;case Bs.WEBGL_CONTEXT_LOST:s(!0),c("WebGL Context Lost - Reloading"),setTimeout(()=>window.location.reload(),1500);return;case ir.CONNECTION_HANDSHAKING:d(_=>_+20);return;case ir.CONNECTION_HANDSHAKE_FAILED:s(!0),c("Handshake Failed");return;case ir.CONNECTION_AUTHENTICATED:d(_=>_+20),_e().init(),Va.available&&Va.call("legacyTrack","authentication","authok",[]);return;case ir.CONNECTION_ERROR:s(!0),c("Connection Error");return;case ir.CONNECTION_CLOSED:c("Connection Error"),ti.send(-1,"client.init.handshake.fail");return;case yn.ENGINE_INITIALIZED:d(_=>_+20),setTimeout(()=>n(!0),300);return;case bu.LOADED:{const _=K("preload.assets.urls"),E=[];if(_&&_.length)for(const I of _)E.push(Ur.interpolate(I));await Om().downloadAssets(E)?(Ba().init(),d(I=>I+20)):(s(!0),c("Assets Failed"));return}}},[]);return ds(Bs.WEBGL_UNAVAILABLE,f),ds(Bs.WEBGL_CONTEXT_LOST,f),ds(ir.CONNECTION_HANDSHAKING,f),ds(ir.CONNECTION_HANDSHAKE_FAILED,f),ds(ir.CONNECTION_AUTHENTICATED,f),ds(ir.CONNECTION_ERROR,f),ds(ir.CONNECTION_CLOSED,f),Ne(yn.ENGINE_INITIALIZED,f),ON(bu.LOADED,f),ju(Ti.LOADED,f),ju(Ti.FAILED,f),o.useEffect(()=>{_e().core.configuration.init();const p=_=>m(!(window.devicePixelRatio%1));return window.addEventListener("resize",p),p(),()=>{window.removeEventListener("resize",p)}},[]),l(P,{fit:!0,overflow:"hidden",className:g&&"image-rendering-pixelated",children:[(!e||r)&&t(wN,{isError:r,message:a,percent:u}),t(ci,{type:un.FADE_IN,inProp:e,children:t(PA,{})}),t(P,{id:"draggable-windows-container"})]})};Tg(document.getElementById("root")).render(t(LA,{}));
